/*! For license information please see main.f5f6ab12.js.LICENSE.txt */
(()=>{var e={4:(e,t,n)=>{"use strict";var r=n(853),i=n(43),o=n(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(s(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var h=Object.assign,f=Symbol.for("react.element"),p=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),E=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope");var A=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var I=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var _=Symbol.iterator;function T(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=_&&e[_]||e["@@iterator"])?e:null}var L=Symbol.for("react.client.reference");function R(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===L?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case m:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case k:return"Suspense";case x:return"SuspenseList";case A:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case E:return(e.displayName||"Context")+".Provider";case b:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case C:return null!==(t=e.displayName||null)?t:R(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return R(e(t))}catch(n){}}return null}var N=Array.isArray,M=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O={pending:!1,data:null,method:null,action:null},z=[],F=-1;function U(e){return{current:e}}function B(e){0>F||(e.current=z[F],z[F]=null,F--)}function q(e,t){F++,z[F]=e.current,e.current=t}var V=U(null),K=U(null),j=U(null),W=U(null);function H(e,t){switch(q(j,t),q(K,e),q(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?id(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=od(t=id(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(V),q(V,e)}function Q(){B(V),B(K),B(j)}function G(e){null!==e.memoizedState&&q(W,e);var t=V.current,n=od(t,e.type);t!==n&&(q(K,e),q(V,n))}function Y(e){K.current===e&&(B(V),B(K)),W.current===e&&(B(W),Gd._currentValue=O)}var $=Object.prototype.hasOwnProperty,X=r.unstable_scheduleCallback,Z=r.unstable_cancelCallback,J=r.unstable_shouldYield,ee=r.unstable_requestPaint,te=r.unstable_now,ne=r.unstable_getCurrentPriorityLevel,re=r.unstable_ImmediatePriority,ie=r.unstable_UserBlockingPriority,oe=r.unstable_NormalPriority,se=r.unstable_LowPriority,ae=r.unstable_IdlePriority,le=r.log,ce=r.unstable_setDisableYieldValue,ue=null,de=null;function he(e){if("function"===typeof le&&ce(e),de&&"function"===typeof de.setStrictMode)try{de.setStrictMode(ue,e)}catch(t){}}var fe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(pe(e)/ge|0)|0},pe=Math.log,ge=Math.LN2;var me=256,ve=4194304;function ye(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function we(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,o=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var a=134217727&r;return 0!==a?0!==(r=a&~o)?i=ye(r):0!==(s&=a)?i=ye(s):n||0!==(n=a&~e)&&(i=ye(n)):0!==(a=r&~o)?i=ye(a):0!==s?i=ye(s):n||0!==(n=r&~e)&&(i=ye(n)),0===i?0:0!==t&&t!==i&&0===(t&o)&&((o=i&-i)>=(n=t&-t)||32===o&&0!==(4194048&n))?t:i}function be(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ee(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Se(){var e=me;return 0===(4194048&(me<<=1))&&(me=256),e}function ke(){var e=ve;return 0===(62914560&(ve<<=1))&&(ve=4194304),e}function xe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ce(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Pe(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-fe(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194090&n}function Ae(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-fe(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Ie(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function _e(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Te(){var e=D.p;return 0!==e?e:void 0===(e=window.event)?32:ch(e.type)}var Le=Math.random().toString(36).slice(2),Re="__reactFiber$"+Le,Ne="__reactProps$"+Le,Me="__reactContainer$"+Le,De="__reactEvents$"+Le,Oe="__reactListeners$"+Le,ze="__reactHandles$"+Le,Fe="__reactResources$"+Le,Ue="__reactMarker$"+Le;function Be(e){delete e[Re],delete e[Ne],delete e[De],delete e[Oe],delete e[ze]}function qe(e){var t=e[Re];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Me]||n[Re]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=wd(e);null!==e;){if(n=e[Re])return n;e=wd(e)}return t}n=(e=n).parentNode}return null}function Ve(e){if(e=e[Re]||e[Me]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ke(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function je(e){var t=e[Fe];return t||(t=e[Fe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function We(e){e[Ue]=!0}var He=new Set,Qe={};function Ge(e,t){Ye(e,t),Ye(e+"Capture",t)}function Ye(e,t){for(Qe[e]=t,e=0;e<t.length;e++)He.add(t[e])}var $e,Xe,Ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Je={},et={};function tt(e,t,n){if(i=t,$.call(et,i)||!$.call(Je,i)&&(Ze.test(i)?et[i]=!0:(Je[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function nt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function rt(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function it(e){if(void 0===$e)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);$e=t&&t[1]||"",Xe=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+$e+e+Xe}var ot=!1;function st(e,t){if(!e||ot)return"";ot=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(i){var r=i}Reflect.construct(e,[],n)}else{try{n.call()}catch(o){r=o}e.call(n.prototype)}}else{try{throw Error()}catch(s){r=s}(n=e())&&"function"===typeof n.catch&&n.catch((function(){}))}}catch(a){if(a&&r&&"string"===typeof a.stack)return[a.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=r.DetermineComponentFrameRoot(),s=o[0],a=o[1];if(s&&a){var l=s.split("\n"),c=a.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==c[i]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{ot=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?it(n):""}function at(e){switch(e.tag){case 26:case 27:case 5:return it(e.type);case 16:return it("Lazy");case 13:return it("Suspense");case 19:return it("SuspenseList");case 0:case 15:return st(e.type,!1);case 11:return st(e.type.render,!1);case 1:return st(e.type,!0);case 31:return it("Activity");default:return""}}function lt(e){try{var t="";do{t+=at(e),e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function gt(e){return e.replace(pt,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function mt(e,t,n,r,i,o,s,a){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?yt(e,s,ct(t)):null!=n?yt(e,s,ct(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=o&&(e.defaultChecked=!!o),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ct(a):e.removeAttribute("name")}function vt(e,t,n,r,i,o,s,a){if(null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.type=o),null!=t||null!=n){if(!("submit"!==o&&"reset"!==o||void 0!==t&&null!==t))return;n=null!=n?""+ct(n):"",t=null!=t?""+ct(t):n,a||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s)}function yt(e,t,n){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function wt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ct(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function bt(e,t,n){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ct(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Et(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(s(92));if(N(r)){if(1<r.length)throw Error(s(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ct(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r)}function St(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var kt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||kt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Ct(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&xt(e,i,r)}else for(var o in t)t.hasOwnProperty(o)&&xt(e,o,t[o])}function Pt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var At=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),It=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _t(e){return It.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Tt=null;function Lt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Rt=null,Nt=null;function Mt(e){var t=Ve(e);if(t&&(e=t.stateNode)){var n=e[Ne]||null;e:switch(e=t.stateNode,t.type){case"input":if(mt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+gt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[Ne]||null;if(!i)throw Error(s(90));mt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ht(r)}break e;case"textarea":bt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&wt(e,!!n.multiple,t,!1)}}}var Dt=!1;function Ot(e,t,n){if(Dt)return e(t,n);Dt=!0;try{return e(t)}finally{if(Dt=!1,(null!==Rt||null!==Nt)&&(qc(),Rt&&(t=Rt,e=Nt,Nt=Rt=null,Mt(t),e)))for(t=0;t<e.length;t++)Mt(e[t])}}function zt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Ne]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Ft=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Ut=!1;if(Ft)try{var Bt={};Object.defineProperty(Bt,"passive",{get:function(){Ut=!0}}),window.addEventListener("test",Bt,Bt),window.removeEventListener("test",Bt,Bt)}catch(Nh){Ut=!1}var qt=null,Vt=null,Kt=null;function jt(){if(Kt)return Kt;var e,t,n=Vt,r=n.length,i="value"in qt?qt.value:qt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[o-t];t++);return Kt=i.slice(e,1<t?1-t:void 0)}function Wt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Ht(){return!0}function Qt(){return!1}function Gt(e){function t(t,n,r,i,o){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Ht:Qt,this.isPropagationStopped=Qt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Ht)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Ht)},persist:function(){},isPersistent:Ht}),t}var Yt,$t,Xt,Zt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jt=Gt(Zt),en=h({},Zt,{view:0,detail:0}),tn=Gt(en),nn=h({},en,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xt&&(Xt&&"mousemove"===e.type?(Yt=e.screenX-Xt.screenX,$t=e.screenY-Xt.screenY):$t=Yt=0,Xt=e),Yt)},movementY:function(e){return"movementY"in e?e.movementY:$t}}),rn=Gt(nn),on=Gt(h({},nn,{dataTransfer:0})),sn=Gt(h({},en,{relatedTarget:0})),an=Gt(h({},Zt,{animationName:0,elapsedTime:0,pseudoElement:0})),ln=Gt(h({},Zt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),cn=Gt(h({},Zt,{data:0})),un={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=hn[e])&&!!t[e]}function pn(){return fn}var gn=Gt(h({},en,{key:function(e){if(e.key){var t=un[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Wt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pn,charCode:function(e){return"keypress"===e.type?Wt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Wt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),mn=Gt(h({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),vn=Gt(h({},en,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pn})),yn=Gt(h({},Zt,{propertyName:0,elapsedTime:0,pseudoElement:0})),wn=Gt(h({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),bn=Gt(h({},Zt,{newState:0,oldState:0})),En=[9,13,27,32],Sn=Ft&&"CompositionEvent"in window,kn=null;Ft&&"documentMode"in document&&(kn=document.documentMode);var xn=Ft&&"TextEvent"in window&&!kn,Cn=Ft&&(!Sn||kn&&8<kn&&11>=kn),Pn=String.fromCharCode(32),An=!1;function In(e,t){switch(e){case"keyup":return-1!==En.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _n(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Tn=!1;var Ln={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ln[e.type]:"textarea"===t}function Nn(e,t,n,r){Rt?Nt?Nt.push(r):Nt=[r]:Rt=r,0<(t=ju(t,"onChange")).length&&(n=new Jt("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Mn=null,Dn=null;function On(e){Ou(e,0)}function zn(e){if(ht(Ke(e)))return e}function Fn(e,t){if("change"===e)return t}var Un=!1;if(Ft){var Bn;if(Ft){var qn="oninput"in document;if(!qn){var Vn=document.createElement("div");Vn.setAttribute("oninput","return;"),qn="function"===typeof Vn.oninput}Bn=qn}else Bn=!1;Un=Bn&&(!document.documentMode||9<document.documentMode)}function Kn(){Mn&&(Mn.detachEvent("onpropertychange",jn),Dn=Mn=null)}function jn(e){if("value"===e.propertyName&&zn(Dn)){var t=[];Nn(t,Dn,e,Lt(e)),Ot(On,t)}}function Wn(e,t,n){"focusin"===e?(Kn(),Dn=n,(Mn=t).attachEvent("onpropertychange",jn)):"focusout"===e&&Kn()}function Hn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return zn(Dn)}function Qn(e,t){if("click"===e)return zn(t)}function Gn(e,t){if("input"===e||"change"===e)return zn(t)}var Yn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function $n(e,t){if(Yn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!$.call(t,i)||!Yn(e[i],t[i]))return!1}return!0}function Xn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Zn(e,t){var n,r=Xn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Xn(r)}}function Jn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Jn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function er(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ft((e=t.contentWindow).document)}return t}function tr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var nr=Ft&&"documentMode"in document&&11>=document.documentMode,rr=null,ir=null,or=null,sr=!1;function ar(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;sr||null==rr||rr!==ft(r)||("selectionStart"in(r=rr)&&tr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},or&&$n(or,r)||(or=r,0<(r=ju(ir,"onSelect")).length&&(t=new Jt("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=rr)))}function lr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var cr={animationend:lr("Animation","AnimationEnd"),animationiteration:lr("Animation","AnimationIteration"),animationstart:lr("Animation","AnimationStart"),transitionrun:lr("Transition","TransitionRun"),transitionstart:lr("Transition","TransitionStart"),transitioncancel:lr("Transition","TransitionCancel"),transitionend:lr("Transition","TransitionEnd")},ur={},dr={};function hr(e){if(ur[e])return ur[e];if(!cr[e])return e;var t,n=cr[e];for(t in n)if(n.hasOwnProperty(t)&&t in dr)return ur[e]=n[t];return e}Ft&&(dr=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);var fr=hr("animationend"),pr=hr("animationiteration"),gr=hr("animationstart"),mr=hr("transitionrun"),vr=hr("transitionstart"),yr=hr("transitioncancel"),wr=hr("transitionend"),br=new Map,Er="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sr(e,t){br.set(e,t),Ge(t,[e])}Er.push("scrollEnd");var kr=new WeakMap;function xr(e,t){if("object"===typeof e&&null!==e){var n=kr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:lt(t)},kr.set(e,t),t)}return{value:e,source:t,stack:lt(t)}}var Cr=[],Pr=0,Ar=0;function Ir(){for(var e=Pr,t=Ar=Pr=0;t<e;){var n=Cr[t];Cr[t++]=null;var r=Cr[t];Cr[t++]=null;var i=Cr[t];Cr[t++]=null;var o=Cr[t];if(Cr[t++]=null,null!==r&&null!==i){var s=r.pending;null===s?i.next=i:(i.next=s.next,s.next=i),r.pending=i}0!==o&&Rr(n,i,o)}}function _r(e,t,n,r){Cr[Pr++]=e,Cr[Pr++]=t,Cr[Pr++]=n,Cr[Pr++]=r,Ar|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Tr(e,t,n,r){return _r(e,t,n,r),Nr(e)}function Lr(e,t){return _r(e,null,null,t),Nr(e)}function Rr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(r=o.alternate)&&(r.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(i=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,i&&null!==t&&(i=31-fe(n),null===(r=(e=o.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),o):null}function Nr(e){if(50<Rc)throw Rc=0,Nc=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Mr={};function Dr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Or(e,t,n,r){return new Dr(e,t,n,r)}function zr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Fr(e,t){var n=e.alternate;return null===n?((n=Or(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Ur(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Br(e,t,n,r,i,o){var a=0;if(r=e,"function"===typeof e)zr(e)&&(a=1);else if("string"===typeof e)a=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case A:return(e=Or(31,n,t,i)).elementType=A,e.lanes=o,e;case m:return qr(n.children,i,o,t);case v:a=8,i|=24;break;case y:return(e=Or(12,n,t,2|i)).elementType=y,e.lanes=o,e;case k:return(e=Or(13,n,t,i)).elementType=k,e.lanes=o,e;case x:return(e=Or(19,n,t,i)).elementType=x,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case w:case E:a=10;break e;case b:a=9;break e;case S:a=11;break e;case C:a=14;break e;case P:a=16,r=null;break e}a=29,n=Error(s(130,null===e?"null":typeof e,"")),r=null}return(t=Or(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function qr(e,t,n,r){return(e=Or(7,e,r,t)).lanes=n,e}function Vr(e,t,n){return(e=Or(6,e,null,t)).lanes=n,e}function Kr(e,t,n){return(t=Or(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var jr=[],Wr=0,Hr=null,Qr=0,Gr=[],Yr=0,$r=null,Xr=1,Zr="";function Jr(e,t){jr[Wr++]=Qr,jr[Wr++]=Hr,Hr=e,Qr=t}function ei(e,t,n){Gr[Yr++]=Xr,Gr[Yr++]=Zr,Gr[Yr++]=$r,$r=e;var r=Xr;e=Zr;var i=32-fe(r)-1;r&=~(1<<i),n+=1;var o=32-fe(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Xr=1<<32-fe(t)+i|n<<i|r,Zr=o+e}else Xr=1<<o|n<<i|r,Zr=e}function ti(e){null!==e.return&&(Jr(e,1),ei(e,1,0))}function ni(e){for(;e===Hr;)Hr=jr[--Wr],jr[Wr]=null,Qr=jr[--Wr],jr[Wr]=null;for(;e===$r;)$r=Gr[--Yr],Gr[Yr]=null,Zr=Gr[--Yr],Gr[Yr]=null,Xr=Gr[--Yr],Gr[Yr]=null}var ri=null,ii=null,oi=!1,si=null,ai=!1,li=Error(s(519));function ci(e){throw gi(xr(Error(s(418,"")),e)),li}function ui(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Re]=e,t[Ne]=r,n){case"dialog":zu("cancel",t),zu("close",t);break;case"iframe":case"object":case"embed":zu("load",t);break;case"video":case"audio":for(n=0;n<Mu.length;n++)zu(Mu[n],t);break;case"source":zu("error",t);break;case"img":case"image":case"link":zu("error",t),zu("load",t);break;case"details":zu("toggle",t);break;case"input":zu("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),dt(t);break;case"select":zu("invalid",t);break;case"textarea":zu("invalid",t),Et(t,r.value,r.defaultValue,r.children),dt(t)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||$u(t.textContent,n)?(null!=r.popover&&(zu("beforetoggle",t),zu("toggle",t)),null!=r.onScroll&&zu("scroll",t),null!=r.onScrollEnd&&zu("scrollend",t),null!=r.onClick&&(t.onclick=Xu),t=!0):t=!1,t||ci(e)}function di(e){for(ri=e.return;ri;)switch(ri.tag){case 5:case 13:return void(ai=!1);case 27:case 3:return void(ai=!0);default:ri=ri.return}}function hi(e){if(e!==ri)return!1;if(!oi)return di(e),oi=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||sd(e.type,e.memoizedProps)),t=!t),t&&ii&&ci(e),di(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,n=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===n){ii=vd(e.nextSibling);break e}n--}else"$"!==t&&"$!"!==t&&"$?"!==t||n++;e=e.nextSibling}ii=null}}else 27===n?(n=ii,fd(e.type)?(e=yd,yd=null,ii=e):ii=n):ii=ri?vd(e.stateNode.nextSibling):null;return!0}function fi(){ii=ri=null,oi=!1}function pi(){var e=si;return null!==e&&(null===wc?wc=e:wc.push.apply(wc,e),si=null),e}function gi(e){null===si?si=[e]:si.push(e)}var mi=U(null),vi=null,yi=null;function wi(e,t,n){q(mi,t._currentValue),t._currentValue=n}function bi(e){e._currentValue=mi.current,B(mi)}function Ei(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Si(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var o=i.dependencies;if(null!==o){var a=i.child;o=o.firstContext;e:for(;null!==o;){var l=o;o=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ei(o.return,n,e),r||(a=null);break e}o=l.next}}else if(18===i.tag){if(null===(a=i.return))throw Error(s(341));a.lanes|=n,null!==(o=a.alternate)&&(o.lanes|=n),Ei(a,n,e),a=null}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===e){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}}function ki(e,t,n,r){e=null;for(var i=t,o=!1;null!==i;){if(!o)if(0!==(524288&i.flags))o=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var a=i.alternate;if(null===a)throw Error(s(387));if(null!==(a=a.memoizedProps)){var l=i.type;Yn(i.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(i===W.current){if(null===(a=i.alternate))throw Error(s(387));a.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Gd):e=[Gd])}i=i.return}null!==e&&Si(t,e,n,r),t.flags|=262144}function xi(e){for(e=e.firstContext;null!==e;){if(!Yn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ci(e){vi=e,yi=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Pi(e){return Ii(vi,e)}function Ai(e,t){return null===vi&&Ci(e),Ii(e,t)}function Ii(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===yi){if(null===e)throw Error(s(308));yi=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else yi=yi.next=t;return n}var _i="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Ti=r.unstable_scheduleCallback,Li=r.unstable_NormalPriority,Ri={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ni(){return{controller:new _i,data:new Map,refCount:0}}function Mi(e){e.refCount--,0===e.refCount&&Ti(Li,(function(){e.controller.abort()}))}var Di=null,Oi=0,zi=0,Fi=null;function Ui(){if(0===--Oi&&null!==Di){null!==Fi&&(Fi.status="fulfilled");var e=Di;Di=null,zi=0,Fi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Bi=M.S;M.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Di){var n=Di=[];Oi=0,zi=_u(),Fi={status:"pending",value:void 0,then:function(e){n.push(e)}}}Oi++,t.then(Ui,Ui)}(0,t),null!==Bi&&Bi(e,t)};var qi=U(null);function Vi(){var e=qi.current;return null!==e?e:rc.pooledCache}function Ki(e,t){q(qi,null===t?qi.current:t.pool)}function ji(){var e=Vi();return null===e?null:{parent:Ri._currentValue,pool:e}}var Wi=Error(s(460)),Hi=Error(s(474)),Qi=Error(s(542)),Gi={then:function(){}};function Yi(e){return"fulfilled"===(e=e.status)||"rejected"===e}function $i(){}function Xi(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then($i,$i),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw eo(e=t.reason),e;default:if("string"===typeof t.status)t.then($i,$i);else{if(null!==(e=rc)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}}),(function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":throw eo(e=t.reason),e}throw Zi=t,Wi}}var Zi=null;function Ji(){if(null===Zi)throw Error(s(459));var e=Zi;return Zi=null,e}function eo(e){if(e===Wi||e===Qi)throw Error(s(483))}var to=!1;function no(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ro(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function io(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function oo(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&nc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Nr(e),Rr(e,null,n),t}return _r(e,r,t,n),Nr(e)}function so(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ae(e,n)}}function ao(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?i=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var lo=!1;function co(){if(lo){if(null!==Fi)throw Fi}}function uo(e,t,n,r){lo=!1;var i=e.updateQueue;to=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=i.baseState;for(s=0,u=c=l=null,a=o;;){var f=-536870913&a.lane,p=f!==a.lane;if(p?(oc&f)===f:(r&f)===f){0!==f&&f===zi&&(lo=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var g=e,m=a;f=t;var v=n;switch(m.tag){case 1:if("function"===typeof(g=m.payload)){d=g.call(v,d,f);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(f="function"===typeof(g=m.payload)?g.call(v,d,f):g)||void 0===f)break e;d=h({},d,f);break e;case 2:to=!0}}null!==(f=a.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=i.callbacks)?i.callbacks=[f]:p.push(f))}else p={lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,s|=f;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(p=a).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===o&&(i.shared.lanes=0),fc|=s,e.lanes=s,e.memoizedState=d}}function ho(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function fo(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)ho(n[e],t)}var po=U(null),go=U(0);function mo(e,t){q(go,e=dc),q(po,t),dc=e|t.baseLanes}function vo(){q(go,dc),q(po,po.current)}function yo(){dc=go.current,B(po),B(go)}var wo=0,bo=null,Eo=null,So=null,ko=!1,xo=!1,Co=!1,Po=0,Ao=0,Io=null,_o=0;function To(){throw Error(s(321))}function Lo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Yn(e[n],t[n]))return!1;return!0}function Ro(e,t,n,r,i,o){return wo=o,bo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,M.H=null===e||null===e.memoizedState?Hs:Qs,Co=!1,o=n(r,i),Co=!1,xo&&(o=Mo(t,n,r,i)),No(e),o}function No(e){M.H=Ws;var t=null!==Eo&&null!==Eo.next;if(wo=0,So=Eo=bo=null,ko=!1,Ao=0,Io=null,t)throw Error(s(300));null===e||Aa||null!==(e=e.dependencies)&&xi(e)&&(Aa=!0)}function Mo(e,t,n,r){bo=e;var i=0;do{if(xo&&(Io=null),Ao=0,xo=!1,25<=i)throw Error(s(301));if(i+=1,So=Eo=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}M.H=Gs,o=t(n,r)}while(xo);return o}function Do(){var e=M.H,t=e.useState()[0];return t="function"===typeof t.then?qo(t):t,e=e.useState()[0],(null!==Eo?Eo.memoizedState:null)!==e&&(bo.flags|=1024),t}function Oo(){var e=0!==Po;return Po=0,e}function zo(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function Fo(e){if(ko){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}ko=!1}wo=0,So=Eo=bo=null,xo=!1,Ao=Po=0,Io=null}function Uo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===So?bo.memoizedState=So=e:So=So.next=e,So}function Bo(){if(null===Eo){var e=bo.alternate;e=null!==e?e.memoizedState:null}else e=Eo.next;var t=null===So?bo.memoizedState:So.next;if(null!==t)So=t,Eo=e;else{if(null===e){if(null===bo.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(Eo=e).memoizedState,baseState:Eo.baseState,baseQueue:Eo.baseQueue,queue:Eo.queue,next:null},null===So?bo.memoizedState=So=e:So=So.next=e}return So}function qo(e){var t=Ao;return Ao+=1,null===Io&&(Io=[]),e=Xi(Io,e,t),t=bo,null===(null===So?t.memoizedState:So.next)&&(t=t.alternate,M.H=null===t||null===t.memoizedState?Hs:Qs),e}function Vo(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return qo(e);if(e.$$typeof===E)return Pi(e)}throw Error(s(438,String(e)))}function Ko(e){var t=null,n=bo.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=bo.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},bo.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=I;return t.index++,n}function jo(e,t){return"function"===typeof t?t(e):t}function Wo(e){return Ho(Bo(),Eo,e)}function Ho(e,t,n){var r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=n;var i=e.baseQueue,o=r.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}t.baseQueue=i=o,r.pending=null}if(o=e.baseState,null===i)e.memoizedState=o;else{var l=a=null,c=null,u=t=i.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(oc&h)===h:(wo&h)===h){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===zi&&(d=!0);else{if((wo&f)===f){u=u.next,f===zi&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,a=o):c=c.next=h,bo.lanes|=f,fc|=f}h=u.action,Co&&n(o,h),o=u.hasEagerState?u.eagerState:n(o,h)}else f={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,a=o):c=c.next=f,bo.lanes|=h,fc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?a=o:c.next=l,!Yn(o,e.memoizedState)&&(Aa=!0,d&&null!==(n=Fi)))throw n;e.memoizedState=o,e.baseState=a,e.baseQueue=c,r.lastRenderedState=o}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Qo(e){var t=Bo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);Yn(o,t.memoizedState)||(Aa=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Go(e,t,n){var r=bo,i=Bo(),o=oi;if(o){if(void 0===n)throw Error(s(407));n=n()}else n=t();var a=!Yn((Eo||i).memoizedState,n);if(a&&(i.memoizedState=n,Aa=!0),i=i.queue,vs(2048,8,Xo.bind(null,r,i,e),[e]),i.getSnapshot!==t||a||null!==So&&1&So.memoizedState.tag){if(r.flags|=2048,ps(9,{destroy:void 0,resource:void 0},$o.bind(null,r,i,n,t),null),null===rc)throw Error(s(349));o||0!==(124&wo)||Yo(r,t,n)}return n}function Yo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=bo.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},bo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function $o(e,t,n,r){t.value=n,t.getSnapshot=r,Zo(t)&&Jo(e)}function Xo(e,t,n){return n((function(){Zo(t)&&Jo(e)}))}function Zo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Yn(e,n)}catch(r){return!0}}function Jo(e){var t=Lr(e,2);null!==t&&Oc(t,e,2)}function es(e){var t=Uo();if("function"===typeof e){var n=e;if(e=n(),Co){he(!0);try{n()}finally{he(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:e},t}function ts(e,t,n,r){return e.baseState=n,Ho(e,Eo,"function"===typeof r?r:jo)}function ns(e,t,n,r,i){if(Vs(e))throw Error(s(485));if(null!==(e=t.action)){var o={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==M.T?n(!0):o.isTransition=!1,r(o),null===(n=t.pending)?(o.next=t.pending=o,rs(t,o)):(o.next=n.next,t.pending=n.next=o)}}function rs(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var o=M.T,s={};M.T=s;try{var a=n(i,r),l=M.S;null!==l&&l(s,a),is(e,t,a)}catch(c){ss(e,t,c)}finally{M.T=o}}else try{is(e,t,o=n(i,r))}catch(u){ss(e,t,u)}}function is(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then((function(n){os(e,t,n)}),(function(n){return ss(e,t,n)})):os(e,t,n)}function os(e,t,n){t.status="fulfilled",t.value=n,as(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,rs(e,n)))}function ss(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,as(t),t=t.next}while(t!==r)}e.action=null}function as(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ls(e,t){return t}function cs(e,t){if(oi){var n=rc.formState;if(null!==n){e:{var r=bo;if(oi){if(ii){t:{for(var i=ii,o=ai;8!==i.nodeType;){if(!o){i=null;break t}if(null===(i=vd(i.nextSibling))){i=null;break t}}i="F!"===(o=i.data)||"F"===o?i:null}if(i){ii=vd(i.nextSibling),r="F!"===i.data;break e}}ci(r)}r=!1}r&&(t=n[0])}}return(n=Uo()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:t},n.queue=r,n=Us.bind(null,bo,r),r.dispatch=n,r=es(!1),o=qs.bind(null,bo,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=Uo()).queue=i,n=ns.bind(null,bo,i,o,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function us(e){return ds(Bo(),Eo,e)}function ds(e,t,n){if(t=Ho(e,t,ls)[0],e=Wo(jo)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=qo(t)}catch(s){if(s===Wi)throw Qi;throw s}else r=t;var i=(t=Bo()).queue,o=i.dispatch;return n!==t.memoizedState&&(bo.flags|=2048,ps(9,{destroy:void 0,resource:void 0},hs.bind(null,i,n),null)),[r,o,e]}function hs(e,t){e.action=t}function fs(e){var t=Bo(),n=Eo;if(null!==n)return ds(t,n,e);Bo(),t=t.memoizedState;var r=(n=Bo()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function ps(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=bo.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},bo.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function gs(){return Bo().memoizedState}function ms(e,t,n,r){var i=Uo();r=void 0===r?null:r,bo.flags|=e,i.memoizedState=ps(1|t,{destroy:void 0,resource:void 0},n,r)}function vs(e,t,n,r){var i=Bo();r=void 0===r?null:r;var o=i.memoizedState.inst;null!==Eo&&null!==r&&Lo(r,Eo.memoizedState.deps)?i.memoizedState=ps(t,o,n,r):(bo.flags|=e,i.memoizedState=ps(1|t,o,n,r))}function ys(e,t){ms(8390656,8,e,t)}function ws(e,t){vs(2048,8,e,t)}function bs(e,t){return vs(4,2,e,t)}function Es(e,t){return vs(4,4,e,t)}function Ss(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function ks(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,vs(4,4,Ss.bind(null,t,e),n)}function xs(){}function Cs(e,t){var n=Bo();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&Lo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ps(e,t){var n=Bo();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&Lo(t,r[1]))return r[0];if(r=e(),Co){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r}function As(e,t,n){return void 0===n||0!==(1073741824&wo)?e.memoizedState=t:(e.memoizedState=n,e=Dc(),bo.lanes|=e,fc|=e,n)}function Is(e,t,n,r){return Yn(n,t)?n:null!==po.current?(e=As(e,n,r),Yn(e,t)||(Aa=!0),e):0===(42&wo)?(Aa=!0,e.memoizedState=n):(e=Dc(),bo.lanes|=e,fc|=e,t)}function _s(e,t,n,r,i){var o=D.p;D.p=0!==o&&8>o?o:8;var s=M.T,a={};M.T=a,qs(e,!1,t,n);try{var l=i(),c=M.S;if(null!==c&&c(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)Bs(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then((function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)}),(function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)})),r}(l,r),Mc());else Bs(e,t,r,Mc())}catch(u){Bs(e,t,{then:function(){},status:"rejected",reason:u},Mc())}finally{D.p=o,M.T=s}}function Ts(){}function Ls(e,t,n,r){if(5!==e.tag)throw Error(s(476));var i=Rs(e).queue;_s(e,i,t,O,null===n?Ts:function(){return Ns(e),n(r)})}function Rs(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:O,baseState:O,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:O},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Ns(e){Bs(e,Rs(e).next.queue,{},Mc())}function Ms(){return Pi(Gd)}function Ds(){return Bo().memoizedState}function Os(){return Bo().memoizedState}function zs(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Mc(),r=oo(t,e=io(n),n);return null!==r&&(Oc(r,t,n),so(r,t,n)),t={cache:Ni()},void(e.payload=t)}t=t.return}}function Fs(e,t,n){var r=Mc();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Vs(e)?Ks(t,n):null!==(n=Tr(e,t,n,r))&&(Oc(n,e,r),js(n,t,r))}function Us(e,t,n){Bs(e,t,n,Mc())}function Bs(e,t,n,r){var i={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Vs(e))Ks(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(i.hasEagerState=!0,i.eagerState=a,Yn(a,s))return _r(e,t,i,0),null===rc&&Ir(),!1}catch(l){}if(null!==(n=Tr(e,t,i,r)))return Oc(n,e,r),js(n,t,r),!0}return!1}function qs(e,t,n,r){if(r={lane:2,revertLane:_u(),action:r,hasEagerState:!1,eagerState:null,next:null},Vs(e)){if(t)throw Error(s(479))}else null!==(t=Tr(e,n,r,2))&&Oc(t,e,2)}function Vs(e){var t=e.alternate;return e===bo||null!==t&&t===bo}function Ks(e,t){xo=ko=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function js(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Ae(e,n)}}var Ws={readContext:Pi,use:Vo,useCallback:To,useContext:To,useEffect:To,useImperativeHandle:To,useLayoutEffect:To,useInsertionEffect:To,useMemo:To,useReducer:To,useRef:To,useState:To,useDebugValue:To,useDeferredValue:To,useTransition:To,useSyncExternalStore:To,useId:To,useHostTransitionStatus:To,useFormState:To,useActionState:To,useOptimistic:To,useMemoCache:To,useCacheRefresh:To},Hs={readContext:Pi,use:Vo,useCallback:function(e,t){return Uo().memoizedState=[e,void 0===t?null:t],e},useContext:Pi,useEffect:ys,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,ms(4194308,4,Ss.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ms(4194308,4,e,t)},useInsertionEffect:function(e,t){ms(4,2,e,t)},useMemo:function(e,t){var n=Uo();t=void 0===t?null:t;var r=e();if(Co){he(!0);try{e()}finally{he(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Uo();if(void 0!==n){var i=n(t);if(Co){he(!0);try{n(t)}finally{he(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=Fs.bind(null,bo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Uo().memoizedState=e},useState:function(e){var t=(e=es(e)).queue,n=Us.bind(null,bo,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:xs,useDeferredValue:function(e,t){return As(Uo(),e,t)},useTransition:function(){var e=es(!1);return e=_s.bind(null,bo,e.queue,!0,!1),Uo().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=bo,i=Uo();if(oi){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===rc)throw Error(s(349));0!==(124&oc)||Yo(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,ys(Xo.bind(null,r,o,e),[e]),r.flags|=2048,ps(9,{destroy:void 0,resource:void 0},$o.bind(null,r,o,n,t),null),n},useId:function(){var e=Uo(),t=rc.identifierPrefix;if(oi){var n=Zr;t="\xab"+t+"R"+(n=(Xr&~(1<<32-fe(Xr)-1)).toString(32)+n),0<(n=Po++)&&(t+="H"+n.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(n=_o++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Ms,useFormState:cs,useActionState:cs,useOptimistic:function(e){var t=Uo();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=qs.bind(null,bo,!0,n),n.dispatch=t,[e,t]},useMemoCache:Ko,useCacheRefresh:function(){return Uo().memoizedState=zs.bind(null,bo)}},Qs={readContext:Pi,use:Vo,useCallback:Cs,useContext:Pi,useEffect:ws,useImperativeHandle:ks,useInsertionEffect:bs,useLayoutEffect:Es,useMemo:Ps,useReducer:Wo,useRef:gs,useState:function(){return Wo(jo)},useDebugValue:xs,useDeferredValue:function(e,t){return Is(Bo(),Eo.memoizedState,e,t)},useTransition:function(){var e=Wo(jo)[0],t=Bo().memoizedState;return["boolean"===typeof e?e:qo(e),t]},useSyncExternalStore:Go,useId:Ds,useHostTransitionStatus:Ms,useFormState:us,useActionState:us,useOptimistic:function(e,t){return ts(Bo(),0,e,t)},useMemoCache:Ko,useCacheRefresh:Os},Gs={readContext:Pi,use:Vo,useCallback:Cs,useContext:Pi,useEffect:ws,useImperativeHandle:ks,useInsertionEffect:bs,useLayoutEffect:Es,useMemo:Ps,useReducer:Qo,useRef:gs,useState:function(){return Qo(jo)},useDebugValue:xs,useDeferredValue:function(e,t){var n=Bo();return null===Eo?As(n,e,t):Is(n,Eo.memoizedState,e,t)},useTransition:function(){var e=Qo(jo)[0],t=Bo().memoizedState;return["boolean"===typeof e?e:qo(e),t]},useSyncExternalStore:Go,useId:Ds,useHostTransitionStatus:Ms,useFormState:fs,useActionState:fs,useOptimistic:function(e,t){var n=Bo();return null!==Eo?ts(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:Ko,useCacheRefresh:Os},Ys=null,$s=0;function Xs(e){var t=$s;return $s+=1,null===Ys&&(Ys=[]),Xi(Ys,e,t)}function Zs(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Js(e,t){if(t.$$typeof===f)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ea(e){return(0,e._init)(e._payload)}function ta(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Fr(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Vr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var o=n.type;return o===m?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===P&&ea(o)===t.type)?(Zs(t=i(t,n.props),n),t.return=e,t):(Zs(t=Br(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Kr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=qr(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Vr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case p:return Zs(n=Br(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Kr(t,e.mode,n)).return=e,t;case P:return h(e,t=(0,t._init)(t._payload),n)}if(N(t)||T(t))return(t=qr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,Xs(t),n);if(t.$$typeof===E)return h(e,Ai(e,t),n);Js(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case p:return n.key===i?c(e,t,n,r):null;case g:return n.key===i?u(e,t,n,r):null;case P:return f(e,t,n=(i=n._init)(n._payload),r)}if(N(n)||T(n))return null!==i?null:d(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,Xs(n),r);if(n.$$typeof===E)return f(e,t,Ai(e,n),r);Js(e,n)}return null}function v(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case p:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case g:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case P:return v(e,t,n,r=(0,r._init)(r._payload),i)}if(N(r)||T(r))return d(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return v(e,t,n,Xs(r),i);if(r.$$typeof===E)return v(e,t,n,Ai(t,r),i);Js(t,r)}return null}function y(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===m&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case p:e:{for(var w=u.key;null!==c;){if(c.key===w){if((w=u.type)===m){if(7===c.tag){n(l,c.sibling),(d=i(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===w||"object"===typeof w&&null!==w&&w.$$typeof===P&&ea(w)===c.type){n(l,c.sibling),Zs(d=i(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===m?((d=qr(u.props.children,l.mode,d,u.key)).return=l,l=d):(Zs(d=Br(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return a(l);case g:e:{for(w=u.key;null!==c;){if(c.key===w){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=i(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Kr(u,l.mode,d)).return=l,l=d}return a(l);case P:return y(l,c,u=(w=u._init)(u._payload),d)}if(N(u))return function(i,s,a,l){for(var c=null,u=null,d=s,p=s=0,g=null;null!==d&&p<a.length;p++){d.index>p?(g=d,d=null):g=d.sibling;var m=f(i,d,a[p],l);if(null===m){null===d&&(d=g);break}e&&d&&null===m.alternate&&t(i,d),s=o(m,s,p),null===u?c=m:u.sibling=m,u=m,d=g}if(p===a.length)return n(i,d),oi&&Jr(i,p),c;if(null===d){for(;p<a.length;p++)null!==(d=h(i,a[p],l))&&(s=o(d,s,p),null===u?c=d:u.sibling=d,u=d);return oi&&Jr(i,p),c}for(d=r(d);p<a.length;p++)null!==(g=v(d,i,p,a[p],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?p:g.key),s=o(g,s,p),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(i,e)})),oi&&Jr(i,p),c}(l,c,u,d);if(T(u)){if("function"!==typeof(w=T(u)))throw Error(s(150));return function(i,a,l,c){if(null==l)throw Error(s(151));for(var u=null,d=null,p=a,g=a=0,m=null,y=l.next();null!==p&&!y.done;g++,y=l.next()){p.index>g?(m=p,p=null):m=p.sibling;var w=f(i,p,y.value,c);if(null===w){null===p&&(p=m);break}e&&p&&null===w.alternate&&t(i,p),a=o(w,a,g),null===d?u=w:d.sibling=w,d=w,p=m}if(y.done)return n(i,p),oi&&Jr(i,g),u;if(null===p){for(;!y.done;g++,y=l.next())null!==(y=h(i,y.value,c))&&(a=o(y,a,g),null===d?u=y:d.sibling=y,d=y);return oi&&Jr(i,g),u}for(p=r(p);!y.done;g++,y=l.next())null!==(y=v(p,i,g,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?g:y.key),a=o(y,a,g),null===d?u=y:d.sibling=y,d=y);return e&&p.forEach((function(e){return t(i,e)})),oi&&Jr(i,g),u}(l,c,u=w.call(u),d)}if("function"===typeof u.then)return y(l,c,Xs(u),d);if(u.$$typeof===E)return y(l,c,Ai(l,u),d);Js(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=i(c,u)).return=l,l=d):(n(l,c),(d=Vr(u,l.mode,d)).return=l,l=d),a(l)):n(l,c)}return function(e,t,n,r){try{$s=0;var i=y(e,t,n,r);return Ys=null,i}catch(s){if(s===Wi||s===Qi)throw s;var o=Or(29,s,null,e.mode);return o.lanes=r,o.return=e,o}}}var na=ta(!0),ra=ta(!1),ia=U(null),oa=null;function sa(e){var t=e.alternate;q(ua,1&ua.current),q(ia,e),null===oa&&(null===t||null!==po.current||null!==t.memoizedState)&&(oa=e)}function aa(e){if(22===e.tag){if(q(ua,ua.current),q(ia,e),null===oa){var t=e.alternate;null!==t&&null!==t.memoizedState&&(oa=e)}}else la()}function la(){q(ua,ua.current),q(ia,ia.current)}function ca(e){B(ia),oa===e&&(oa=null),B(ua)}var ua=U(0);function da(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||md(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ha(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:h({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fa={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Mc(),i=io(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=oo(e,i,r))&&(Oc(t,e,r),so(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Mc(),i=io(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=oo(e,i,r))&&(Oc(t,e,r),so(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Mc(),r=io(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=oo(e,r,n))&&(Oc(t,e,n),so(t,e,n))}};function pa(e,t,n,r,i,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!$n(n,r)||!$n(i,o))}function ga(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&fa.enqueueReplaceState(t,t.state,null)}function ma(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=h({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}var va="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function ya(e){va(e)}function wa(e){console.error(e)}function ba(e){va(e)}function Ea(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout((function(){throw n}))}}function Sa(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout((function(){throw r}))}}function ka(e,t,n){return(n=io(n)).tag=3,n.payload={element:null},n.callback=function(){Ea(e,t)},n}function xa(e){return(e=io(e)).tag=3,e}function Ca(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var o=r.value;e.payload=function(){return i(o)},e.callback=function(){Sa(t,n,r)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){Sa(t,n,r),"function"!==typeof i&&(null===xc?xc=new Set([this]):xc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Pa=Error(s(461)),Aa=!1;function Ia(e,t,n,r){t.child=null===e?ra(t,null,n,r):na(t,e.child,n,r)}function _a(e,t,n,r,i){n=n.render;var o=t.ref;if("ref"in r){var s={};for(var a in r)"ref"!==a&&(s[a]=r[a])}else s=r;return Ci(t),r=Ro(e,t,n,s,o,i),a=Oo(),null===e||Aa?(oi&&a&&ti(t),t.flags|=1,Ia(e,t,r,i),t.child):(zo(e,t,i),Ya(e,t,i))}function Ta(e,t,n,r,i){if(null===e){var o=n.type;return"function"!==typeof o||zr(o)||void 0!==o.defaultProps||null!==n.compare?((e=Br(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,La(e,t,o,r,i))}if(o=e.child,!$a(e,i)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:$n)(s,r)&&e.ref===t.ref)return Ya(e,t,i)}return t.flags|=1,(e=Fr(o,r)).ref=t.ref,e.return=t,t.child=e}function La(e,t,n,r,i){if(null!==e){var o=e.memoizedProps;if($n(o,r)&&e.ref===t.ref){if(Aa=!1,t.pendingProps=r=o,!$a(e,i))return t.lanes=e.lanes,Ya(e,t,i);0!==(131072&e.flags)&&(Aa=!0)}}return Da(e,t,n,r,i)}function Ra(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0!==(128&t.flags)){if(r=null!==o?o.baseLanes|n:n,null!==e){for(i=t.child=e.child,o=0;null!==i;)o=o|i.lanes|i.childLanes,i=i.sibling;t.childLanes=o&~r}else t.childLanes=0,t.child=null;return Na(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,Na(e,t,null!==o?o.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ki(0,null!==o?o.cachePool:null),null!==o?mo(t,o):vo(),aa(t)}else null!==o?(Ki(0,o.cachePool),mo(t,o),la(),t.memoizedState=null):(null!==e&&Ki(0,null),vo(),la());return Ia(e,t,i,n),t.child}function Na(e,t,n,r){var i=Vi();return i=null===i?null:{parent:Ri._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Ki(0,null),vo(),aa(t),null!==e&&ki(e,t,r,!0),null}function Ma(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Da(e,t,n,r,i){return Ci(t),n=Ro(e,t,n,r,void 0,i),r=Oo(),null===e||Aa?(oi&&r&&ti(t),t.flags|=1,Ia(e,t,n,i),t.child):(zo(e,t,i),Ya(e,t,i))}function Oa(e,t,n,r,i,o){return Ci(t),t.updateQueue=null,n=Mo(t,r,n,i),No(e),r=Oo(),null===e||Aa?(oi&&r&&ti(t),t.flags|=1,Ia(e,t,n,o),t.child):(zo(e,t,o),Ya(e,t,o))}function za(e,t,n,r,i){if(Ci(t),null===t.stateNode){var o=Mr,s=n.contextType;"object"===typeof s&&null!==s&&(o=Pi(s)),o=new n(r,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=fa,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=r,o.state=t.memoizedState,o.refs={},no(t),s=n.contextType,o.context="object"===typeof s&&null!==s?Pi(s):Mr,o.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(ha(t,n,s,r),o.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(s=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),s!==o.state&&fa.enqueueReplaceState(o,o.state,null),uo(t,r,o,i),co(),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){o=t.stateNode;var a=t.memoizedProps,l=ma(n,a);o.props=l;var c=o.context,u=n.contextType;s=Mr,"object"===typeof u&&null!==u&&(s=Pi(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a||c!==s)&&ga(t,o,r,s),to=!1;var h=t.memoizedState;o.state=h,uo(t,r,o,i),co(),c=t.memoizedState,a||h!==c||to?("function"===typeof d&&(ha(t,n,d,r),c=t.memoizedState),(l=to||pa(t,n,l,r,h,c,s))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=s,r=l):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ro(e,t),u=ma(n,s=t.memoizedProps),o.props=u,d=t.pendingProps,h=o.context,c=n.contextType,l=Mr,"object"===typeof c&&null!==c&&(l=Pi(c)),(c="function"===typeof(a=n.getDerivedStateFromProps)||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==d||h!==l)&&ga(t,o,r,l),to=!1,h=t.memoizedState,o.state=h,uo(t,r,o,i),co();var f=t.memoizedState;s!==d||h!==f||to||null!==e&&null!==e.dependencies&&xi(e.dependencies)?("function"===typeof a&&(ha(t,n,a,r),f=t.memoizedState),(u=to||pa(t,n,u,r,h,f,l)||null!==e&&null!==e.dependencies&&xi(e.dependencies))?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),o.props=r,o.state=f,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return o=r,Ma(e,t),r=0!==(128&t.flags),o||r?(o=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&r?(t.child=na(t,e.child,null,i),t.child=na(t,null,n,i)):Ia(e,t,n,i),t.memoizedState=o.state,e=t.child):e=Ya(e,t,i),e}function Fa(e,t,n,r){return fi(),t.flags|=256,Ia(e,t,n,r),t.child}var Ua={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ba(e){return{baseLanes:e,cachePool:ji()}}function qa(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=mc),e}function Va(e,t,n){var r,i=t.pendingProps,o=!1,a=0!==(128&t.flags);if((r=a)||(r=(null===e||null!==e.memoizedState)&&0!==(2&ua.current)),r&&(o=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(oi){if(o?sa(t):la(),oi){var l,c=ii;if(l=c){e:{for(l=c,c=ai;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=vd(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==$r?{id:Xr,overflow:Zr}:null,retryLane:536870912,hydrationErrors:null},(l=Or(18,null,null,0)).stateNode=c,l.return=t,t.child=l,ri=t,ii=null,l=!0):l=!1}l||ci(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return md(c)?t.lanes=32:t.lanes=536870912,null;ca(t)}return c=i.children,i=i.fallback,o?(la(),c=ja({mode:"hidden",children:c},o=t.mode),i=qr(i,o,n,null),c.return=t,i.return=t,c.sibling=i,t.child=c,(o=t.child).memoizedState=Ba(n),o.childLanes=qa(e,r,n),t.memoizedState=Ua,i):(sa(t),Ka(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(a)256&t.flags?(sa(t),t.flags&=-257,t=Wa(e,t,n)):null!==t.memoizedState?(la(),t.child=e.child,t.flags|=128,t=null):(la(),o=i.fallback,c=t.mode,i=ja({mode:"visible",children:i.children},c),(o=qr(o,c,n,null)).flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,na(t,e.child,null,n),(i=t.child).memoizedState=Ba(n),i.childLanes=qa(e,r,n),t.memoizedState=Ua,t=o);else if(sa(t),md(c)){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(s(419))).stack="",i.digest=r,gi({value:i,source:null,stack:null}),t=Wa(e,t,n)}else if(Aa||ki(e,t,n,!1),r=0!==(n&e.childLanes),Aa||r){if(null!==(r=rc)&&(0!==(i=0!==((i=0!==(42&(i=n&-n))?1:Ie(i))&(r.suspendedLanes|n))?0:i)&&i!==l.retryLane))throw l.retryLane=i,Lr(e,i),Oc(r,e,i),Pa;"$?"===c.data||Qc(),t=Wa(e,t,n)}else"$?"===c.data?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,ii=vd(c.nextSibling),ri=t,oi=!0,si=null,ai=!1,null!==e&&(Gr[Yr++]=Xr,Gr[Yr++]=Zr,Gr[Yr++]=$r,Xr=e.id,Zr=e.overflow,$r=t),(t=Ka(t,i.children)).flags|=4096);return t}return o?(la(),o=i.fallback,c=t.mode,u=(l=e.child).sibling,(i=Fr(l,{mode:"hidden",children:i.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?o=Fr(u,o):(o=qr(o,c,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,null===(c=e.child.memoizedState)?c=Ba(n):(null!==(l=c.cachePool)?(u=Ri._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=ji(),c={baseLanes:c.baseLanes|n,cachePool:l}),o.memoizedState=c,o.childLanes=qa(e,r,n),t.memoizedState=Ua,i):(sa(t),e=(n=e.child).sibling,(n=Fr(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Ka(e,t){return(t=ja({mode:"visible",children:t},e.mode)).return=e,e.child=t}function ja(e,t){return(e=Or(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Wa(e,t,n){return na(t,e.child,null,n),(e=Ka(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ha(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ei(e.return,t,n)}function Qa(e,t,n,r,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function Ga(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Ia(e,t,r.children,n),0!==(2&(r=ua.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ha(e,n,t);else if(19===e.tag)Ha(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(q(ua,r),i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===da(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Qa(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===da(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Qa(t,!0,n,null,o);break;case"together":Qa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ya(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),fc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(ki(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Fr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Fr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function $a(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!xi(e))}function Xa(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Aa=!0;else{if(!$a(e,n)&&0===(128&t.flags))return Aa=!1,function(e,t,n){switch(t.tag){case 3:H(t,t.stateNode.containerInfo),wi(0,Ri,e.memoizedState.cache),fi();break;case 27:case 5:G(t);break;case 4:H(t,t.stateNode.containerInfo);break;case 10:wi(0,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(sa(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Va(e,t,n):(sa(t),null!==(e=Ya(e,t,n))?e.sibling:null);sa(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(ki(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return Ga(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),q(ua,ua.current),r)break;return null;case 22:case 23:return t.lanes=0,Ra(e,t,n);case 24:wi(0,Ri,e.memoizedState.cache)}return Ya(e,t,n)}(e,t,n);Aa=0!==(131072&e.flags)}else Aa=!1,oi&&0!==(1048576&t.flags)&&ei(t,Qr,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,i=r._init;if(r=i(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((i=r.$$typeof)===S){t.tag=11,t=_a(null,t,r,e,n);break e}if(i===C){t.tag=14,t=Ta(null,t,r,e,n);break e}}throw t=R(r)||r,Error(s(306,t,""))}zr(r)?(e=ma(r,e),t.tag=1,t=za(null,t,r,e,n)):(t.tag=0,t=Da(null,t,r,e,n))}return t;case 0:return Da(e,t,t.type,t.pendingProps,n);case 1:return za(e,t,r=t.type,i=ma(r,t.pendingProps),n);case 3:e:{if(H(t,t.stateNode.containerInfo),null===e)throw Error(s(387));r=t.pendingProps;var o=t.memoizedState;i=o.element,ro(e,t),uo(t,r,null,n);var a=t.memoizedState;if(r=a.cache,wi(0,Ri,r),r!==o.cache&&Si(t,[Ri],n,!0),co(),r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Fa(e,t,r,n);break e}if(r!==i){gi(i=xr(Error(s(424)),t)),t=Fa(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ii=vd(e.firstChild),ri=t,oi=!0,si=null,ai=!0,n=ra(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===i){t=Ya(e,t,n);break e}Ia(e,t,r,n)}t=t.child}return t;case 26:return Ma(e,t),null===e?(n=Id(t.type,null,t.pendingProps,null))?t.memoizedState=n:oi||(n=t.type,e=t.pendingProps,(r=rd(j.current).createElement(n))[Re]=t,r[Ne]=e,ed(r,n,e),We(r),t.stateNode=r):t.memoizedState=Id(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return G(t),null===e&&oi&&(r=t.stateNode=bd(t.type,t.pendingProps,j.current),ri=t,ai=!0,i=ii,fd(t.type)?(yd=i,ii=vd(r.firstChild)):ii=i),Ia(e,t,t.pendingProps.children,n),Ma(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&oi&&((i=r=ii)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ue])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===o)return e}if(null===(e=vd(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,ai))?(t.stateNode=r,ri=t,ii=vd(r.firstChild),ai=!1,i=!0):i=!1),i||ci(t)),G(t),i=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,r=o.children,sd(i,o)?r=null:null!==a&&sd(i,a)&&(t.flags|=32),null!==t.memoizedState&&(i=Ro(e,t,Do,null,null,n),Gd._currentValue=i),Ma(e,t),Ia(e,t,r,n),t.child;case 6:return null===e&&oi&&((e=n=ii)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=vd(e.nextSibling)))return null}return e}(n,t.pendingProps,ai))?(t.stateNode=n,ri=t,ii=null,e=!0):e=!1),e||ci(t)),null;case 13:return Va(e,t,n);case 4:return H(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=na(t,null,r,n):Ia(e,t,r,n),t.child;case 11:return _a(e,t,t.type,t.pendingProps,n);case 7:return Ia(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ia(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,wi(0,t.type,r.value),Ia(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Ci(t),r=r(i=Pi(i)),t.flags|=1,Ia(e,t,r,n),t.child;case 14:return Ta(e,t,t.type,t.pendingProps,n);case 15:return La(e,t,t.type,t.pendingProps,n);case 19:return Ga(e,t,n);case 31:return r=t.pendingProps,n=t.mode,r={mode:r.mode,children:r.children},null===e?((n=ja(r,n)).ref=t.ref,t.child=n,n.return=t,t=n):((n=Fr(e.child,r)).ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return Ra(e,t,n);case 24:return Ci(t),r=Pi(Ri),null===e?(null===(i=Vi())&&(i=rc,o=Ni(),i.pooledCache=o,o.refCount++,null!==o&&(i.pooledCacheLanes|=n),i=o),t.memoizedState={parent:r,cache:i},no(t),wi(0,Ri,i)):(0!==(e.lanes&n)&&(ro(e,t),uo(t,null,null,n),co()),i=e.memoizedState,o=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),wi(0,Ri,r)):(r=o.cache,wi(0,Ri,r),r!==i.cache&&Si(t,[Ri],n,!0))),Ia(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function Za(e){e.flags|=4}function Ja(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!qd(t)){if(null!==(t=ia.current)&&((4194048&oc)===oc?null!==oa:(62914560&oc)!==oc&&0===(536870912&oc)||t!==oa))throw Zi=Gi,Hi;e.flags|=8192}}function el(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?ke():536870912,e.lanes|=t,vc|=t)}function tl(e,t){if(!oi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function nl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function rl(e,t,n){var r=t.pendingProps;switch(ni(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return nl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),bi(Ri),Q(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(hi(t)?Za(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,pi())),nl(t),null;case 26:return n=t.memoizedState,null===e?(Za(t),null!==n?(nl(t),Ja(t,n)):(nl(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Za(t),nl(t),Ja(t,n)):(nl(t),t.flags&=-16777217):(e.memoizedProps!==r&&Za(t),nl(t),t.flags&=-16777217),null;case 27:Y(t),n=j.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Za(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return nl(t),null}e=V.current,hi(t)?ui(t):(e=bd(i,r,n),t.stateNode=e,Za(t))}return nl(t),null;case 5:if(Y(t),n=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Za(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return nl(t),null}if(e=V.current,hi(t))ui(t);else{switch(i=rd(j.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?i.createElement("select",{is:r.is}):i.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?i.createElement(n,{is:r.is}):i.createElement(n)}}e[Re]=t,e[Ne]=r;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(ed(e,n,r),n){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Za(t)}}return nl(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Za(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=j.current,hi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=ri))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Re]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||$u(e.nodeValue,n)))||ci(t)}else(e=rd(e).createTextNode(r))[Re]=t,t.stateNode=e}return nl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[Re]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;nl(t),i=!1}else i=pi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(ca(t),t):(ca(t),null)}if(ca(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool);var o=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(o=r.memoizedState.cachePool.pool),o!==i&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),el(t,t.updateQueue),nl(t),null;case 4:return Q(),null===e&&Bu(t.stateNode.containerInfo),nl(t),null;case 10:return bi(t.type),nl(t),null;case 19:if(B(ua),null===(i=t.memoizedState))return nl(t),null;if(r=0!==(128&t.flags),null===(o=i.rendering))if(r)tl(i,!1);else{if(0!==hc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=da(e))){for(t.flags|=128,tl(i,!1),e=o.updateQueue,t.updateQueue=e,el(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Ur(n,e),n=n.sibling;return q(ua,1&ua.current|2),t.child}e=e.sibling}null!==i.tail&&te()>Sc&&(t.flags|=128,r=!0,tl(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=da(o))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,el(t,e),tl(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!oi)return nl(t),null}else 2*te()-i.renderingStartTime>Sc&&536870912!==n&&(t.flags|=128,r=!0,tl(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=i.last)?e.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=te(),t.sibling=null,e=ua.current,q(ua,r?1&e|2:1&e),t):(nl(t),null);case 22:case 23:return ca(t),yo(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(nl(t),6&t.subtreeFlags&&(t.flags|=8192)):nl(t),null!==(n=t.updateQueue)&&el(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&B(qi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),bi(Ri),nl(t),null;case 25:case 30:return null}throw Error(s(156,t.tag))}function il(e,t){switch(ni(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return bi(Ri),Q(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Y(t),null;case 13:if(ca(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(ua),null;case 4:return Q(),null;case 10:return bi(t.type),null;case 22:case 23:return ca(t),yo(),null!==e&&B(qi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return bi(Ri),null;default:return null}}function ol(e,t){switch(ni(t),t.tag){case 3:bi(Ri),Q();break;case 26:case 27:case 5:Y(t);break;case 4:Q();break;case 13:ca(t);break;case 19:B(ua);break;case 10:bi(t.type);break;case 22:case 23:ca(t),yo(),null!==e&&B(qi);break;case 24:bi(Ri)}}function sl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var o=n.create,s=n.inst;r=o(),s.destroy=r}n=n.next}while(n!==i)}}catch(a){uu(t,t.return,a)}}function al(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var o=i.next;r=o;do{if((r.tag&e)===e){var s=r.inst,a=s.destroy;if(void 0!==a){s.destroy=void 0,i=t;var l=n,c=a;try{c()}catch(u){uu(i,l,u)}}}r=r.next}while(r!==o)}}catch(u){uu(t,t.return,u)}}function ll(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{fo(t,n)}catch(r){uu(e,e.return,r)}}}function cl(e,t,n){n.props=ma(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){uu(e,t,r)}}function ul(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(i){uu(e,t,i)}}function dl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(i){uu(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(o){uu(e,t,o)}else n.current=null}function hl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(i){uu(e,e.return,i)}}function fl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,o=null,a=null,l=null,c=null,u=null,d=null;for(p in n){var h=n[p];if(n.hasOwnProperty(p)&&null!=h)switch(p){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(p)||Zu(e,t,p,null,r,h)}}for(var f in r){var p=r[f];if(h=n[f],r.hasOwnProperty(f)&&(null!=p||null!=h))switch(f){case"type":o=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":d=p;break;case"value":a=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(s(137,t));break;default:p!==h&&Zu(e,t,f,p,r,h)}}return void mt(e,a,l,c,u,d,o,i);case"select":for(o in p=a=l=f=null,n)if(c=n[o],n.hasOwnProperty(o)&&null!=c)switch(o){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(o)||Zu(e,t,o,null,r,c)}for(i in r)if(o=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=o||null!=c))switch(i){case"value":f=o;break;case"defaultValue":l=o;break;case"multiple":a=o;default:o!==c&&Zu(e,t,i,o,r,c)}return t=l,n=a,r=p,void(null!=f?wt(e,!!n,f,!1):!!r!==!!n&&(null!=t?wt(e,!!n,t,!0):wt(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Zu(e,t,l,null,r,i)}for(a in r)if(i=r[a],o=n[a],r.hasOwnProperty(a)&&(null!=i||null!=o))switch(a){case"value":f=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(s(91));break;default:i!==o&&Zu(e,t,a,i,r,o)}return void bt(e,f,p);case"option":for(var g in n)if(f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g))if("selected"===g)e.selected=!1;else Zu(e,t,g,null,r,f);for(c in r)if(f=r[c],p=n[c],r.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Zu(e,t,c,f,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in n)f=n[m],n.hasOwnProperty(m)&&null!=f&&!r.hasOwnProperty(m)&&Zu(e,t,m,null,r,f);for(u in r)if(f=r[u],p=n[u],r.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(s(137,t));break;default:Zu(e,t,u,f,r,p)}return;default:if(Pt(t)){for(var v in n)f=n[v],n.hasOwnProperty(v)&&void 0!==f&&!r.hasOwnProperty(v)&&Ju(e,t,v,void 0,r,f);for(d in r)f=r[d],p=n[d],!r.hasOwnProperty(d)||f===p||void 0===f&&void 0===p||Ju(e,t,d,f,r,p);return}}for(var y in n)f=n[y],n.hasOwnProperty(y)&&null!=f&&!r.hasOwnProperty(y)&&Zu(e,t,y,null,r,f);for(h in r)f=r[h],p=n[h],!r.hasOwnProperty(h)||f===p||null==f&&null==p||Zu(e,t,h,f,r,p)}(r,e.type,n,t),r[Ne]=t}catch(i){uu(e,e.return,i)}}function pl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&fd(e.type)||4===e.tag}function gl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||pl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&fd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ml(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Xu));else if(4!==r&&(27===r&&fd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(ml(e,t,n),e=e.sibling;null!==e;)ml(e,t,n),e=e.sibling}function vl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&fd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(vl(e,t,n),e=e.sibling;null!==e;)vl(e,t,n),e=e.sibling}function yl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);ed(t,r,n),t[Re]=e,t[Ne]=n}catch(o){uu(e,e.return,o)}}var wl=!1,bl=!1,El=!1,Sl="function"===typeof WeakSet?WeakSet:Set,kl=null;function xl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:zl(e,n),4&r&&sl(5,n);break;case 1:if(zl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(s){uu(n,n.return,s)}else{var i=ma(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(a){uu(n,n.return,a)}}64&r&&ll(n),512&r&&ul(n,n.return);break;case 3:if(zl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{fo(e,t)}catch(s){uu(n,n.return,s)}}break;case 27:null===t&&4&r&&yl(n);case 26:case 5:zl(e,n),null===t&&4&r&&hl(n),512&r&&ul(n,n.return);break;case 12:zl(e,n);break;case 13:zl(e,n),4&r&&Tl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$?"!==e.data||"complete"===n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=pu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||wl)){t=null!==t&&null!==t.memoizedState||bl,i=wl;var o=bl;wl=r,(bl=t)&&!o?Ul(e,n,0!==(8772&n.subtreeFlags)):zl(e,n),wl=i,bl=o}break;case 30:break;default:zl(e,n)}}function Cl(e){var t=e.alternate;null!==t&&(e.alternate=null,Cl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Be(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Pl=null,Al=!1;function Il(e,t,n){for(n=n.child;null!==n;)_l(e,t,n),n=n.sibling}function _l(e,t,n){if(de&&"function"===typeof de.onCommitFiberUnmount)try{de.onCommitFiberUnmount(ue,n)}catch(o){}switch(n.tag){case 26:bl||dl(n,t),Il(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:bl||dl(n,t);var r=Pl,i=Al;fd(n.type)&&(Pl=n.stateNode,Al=!1),Il(e,t,n),Ed(n.stateNode),Pl=r,Al=i;break;case 5:bl||dl(n,t);case 6:if(r=Pl,i=Al,Pl=null,Il(e,t,n),Al=i,null!==(Pl=r))if(Al)try{(9===Pl.nodeType?Pl.body:"HTML"===Pl.nodeName?Pl.ownerDocument.body:Pl).removeChild(n.stateNode)}catch(s){uu(n,t,s)}else try{Pl.removeChild(n.stateNode)}catch(s){uu(n,t,s)}break;case 18:null!==Pl&&(Al?(pd(9===(e=Pl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Ah(e)):pd(Pl,n.stateNode));break;case 4:r=Pl,i=Al,Pl=n.stateNode.containerInfo,Al=!0,Il(e,t,n),Pl=r,Al=i;break;case 0:case 11:case 14:case 15:bl||al(2,n,t),bl||al(4,n,t),Il(e,t,n);break;case 1:bl||(dl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&cl(n,t,r)),Il(e,t,n);break;case 21:Il(e,t,n);break;case 22:bl=(r=bl)||null!==n.memoizedState,Il(e,t,n),bl=r;break;default:Il(e,t,n)}}function Tl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Ah(e)}catch(n){uu(t,t.return,n)}}function Ll(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Sl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Sl),t;default:throw Error(s(435,e.tag))}}(e);t.forEach((function(t){var r=gu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}function Rl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:if(fd(l.type)){Pl=l.stateNode,Al=!1;break e}break;case 5:Pl=l.stateNode,Al=!1;break e;case 3:case 4:Pl=l.stateNode.containerInfo,Al=!0;break e}l=l.return}if(null===Pl)throw Error(s(160));_l(o,a,i),Pl=null,Al=!1,null!==(o=i.alternate)&&(o.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Ml(t,e),t=t.sibling}var Nl=null;function Ml(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Rl(t,e),Dl(e),4&r&&(al(3,e,e.return),sl(3,e),al(5,e,e.return));break;case 1:Rl(t,e),Dl(e),512&r&&(bl||null===n||dl(n,n.return)),64&r&&wl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Nl;if(Rl(t,e),Dl(e),512&r&&(bl||null===n||dl(n,n.return)),4&r){var o=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(o=i.getElementsByTagName("title")[0])||o[Ue]||o[Re]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=i.createElement(r),i.head.insertBefore(o,i.querySelector("head > title"))),ed(o,r,n),o[Re]=e,We(o),r=o;break e;case"link":var a=Ud("link","href",i).get(r+(n.href||""));if(a)for(var l=0;l<a.length;l++)if((o=a[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){a.splice(l,1);break t}ed(o=i.createElement(r),r,n),i.head.appendChild(o);break;case"meta":if(a=Ud("meta","content",i).get(r+(n.content||"")))for(l=0;l<a.length;l++)if((o=a[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){a.splice(l,1);break t}ed(o=i.createElement(r),r,n),i.head.appendChild(o);break;default:throw Error(s(468,r))}o[Re]=e,We(o),r=o}e.stateNode=r}else Bd(i,e.type,e.stateNode);else e.stateNode=Md(i,r,e.memoizedProps);else o!==r?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===r?Bd(i,e.type,e.stateNode):Md(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&fl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Rl(t,e),Dl(e),512&r&&(bl||null===n||dl(n,n.return)),null!==n&&4&r&&fl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Rl(t,e),Dl(e),512&r&&(bl||null===n||dl(n,n.return)),32&e.flags){i=e.stateNode;try{St(i,"")}catch(p){uu(e,e.return,p)}}4&r&&null!=e.stateNode&&fl(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(El=!0);break;case 6:if(Rl(t,e),Dl(e),4&r){if(null===e.stateNode)throw Error(s(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(p){uu(e,e.return,p)}}break;case 3:if(Fd=null,i=Nl,Nl=xd(t.containerInfo),Rl(t,e),Nl=i,Dl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ah(t.containerInfo)}catch(p){uu(e,e.return,p)}El&&(El=!1,Ol(e));break;case 4:r=Nl,Nl=xd(e.stateNode.containerInfo),Rl(t,e),Dl(e),Nl=r;break;case 12:default:Rl(t,e),Dl(e);break;case 13:Rl(t,e),Dl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Ec=te()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Ll(e,r)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=wl,d=bl;if(wl=u||i,bl=d||c,Rl(t,e),bl=d,wl=u,Dl(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||wl||bl||Fl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(o=c.stateNode,i)"function"===typeof(a=o.style).setProperty?a.setProperty("display","none","important"):a.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,f=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(p){uu(c,c.return,p)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(p){uu(c,c.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Ll(e,n))));break;case 19:Rl(t,e),Dl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Ll(e,r)));case 30:case 21:}}function Dl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(pl(r)){n=r;break}r=r.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var i=n.stateNode;vl(e,gl(e),i);break;case 5:var o=n.stateNode;32&n.flags&&(St(o,""),n.flags&=-33),vl(e,gl(e),o);break;case 3:case 4:var a=n.stateNode.containerInfo;ml(e,gl(e),a);break;default:throw Error(s(161))}}catch(l){uu(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ol(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ol(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function zl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)xl(e,t.alternate,t),t=t.sibling}function Fl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:al(4,t,t.return),Fl(t);break;case 1:dl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&cl(t,t.return,n),Fl(t);break;case 27:Ed(t.stateNode);case 26:case 5:dl(t,t.return),Fl(t);break;case 22:null===t.memoizedState&&Fl(t);break;default:Fl(t)}e=e.sibling}}function Ul(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,o=t,s=o.flags;switch(o.tag){case 0:case 11:case 15:Ul(i,o,n),sl(4,o);break;case 1:if(Ul(i,o,n),"function"===typeof(i=(r=o).stateNode).componentDidMount)try{i.componentDidMount()}catch(c){uu(r,r.return,c)}if(null!==(i=(r=o).updateQueue)){var a=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)ho(l[i],a)}catch(c){uu(r,r.return,c)}}n&&64&s&&ll(o),ul(o,o.return);break;case 27:yl(o);case 26:case 5:Ul(i,o,n),n&&null===r&&4&s&&hl(o),ul(o,o.return);break;case 12:Ul(i,o,n);break;case 13:Ul(i,o,n),n&&4&s&&Tl(i,o);break;case 22:null===o.memoizedState&&Ul(i,o,n),ul(o,o.return);break;case 30:break;default:Ul(i,o,n)}t=t.sibling}}function Bl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Mi(n))}function ql(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Mi(e))}function Vl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Kl(e,t,n,r),t=t.sibling}function Kl(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Vl(e,t,n,r),2048&i&&sl(9,t);break;case 1:case 13:default:Vl(e,t,n,r);break;case 3:Vl(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Mi(e)));break;case 12:if(2048&i){Vl(e,t,n,r),e=t.stateNode;try{var o=t.memoizedProps,s=o.id,a=o.onPostCommit;"function"===typeof a&&a(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){uu(t,t.return,l)}}else Vl(e,t,n,r);break;case 23:break;case 22:o=t.stateNode,s=t.alternate,null!==t.memoizedState?2&o._visibility?Vl(e,t,n,r):Wl(e,t):2&o._visibility?Vl(e,t,n,r):(o._visibility|=2,jl(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&i&&Bl(s,t);break;case 24:Vl(e,t,n,r),2048&i&&ql(t.alternate,t)}}function jl(e,t,n,r,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var o=e,s=t,a=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:jl(o,s,a,l,i),sl(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?jl(o,s,a,l,i):Wl(o,s):(u._visibility|=2,jl(o,s,a,l,i)),i&&2048&c&&Bl(s.alternate,s);break;case 24:jl(o,s,a,l,i),i&&2048&c&&ql(s.alternate,s);break;default:jl(o,s,a,l,i)}t=t.sibling}}function Wl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:Wl(n,r),2048&i&&Bl(r.alternate,r);break;case 24:Wl(n,r),2048&i&&ql(r.alternate,r);break;default:Wl(n,r)}t=t.sibling}}var Hl=8192;function Ql(e){if(e.subtreeFlags&Hl)for(e=e.child;null!==e;)Gl(e),e=e.sibling}function Gl(e){switch(e.tag){case 26:Ql(e),e.flags&Hl&&null!==e.memoizedState&&function(e,t,n){if(null===Vd)throw Error(s(475));var r=Vd;if("stylesheet"===t.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var i=_d(n.href),o=e.querySelector(Td(i));if(o)return null!==(e=o._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=jd.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=o,void We(o);o=e.ownerDocument||e,n=Ld(n),(i=Sd.get(i))&&Od(n,i),We(o=o.createElement("link"));var a=o;a._p=new Promise((function(e,t){a.onload=e,a.onerror=t})),ed(o,"link",n),t.instance=o}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=jd.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(Nl,e.memoizedState,e.memoizedProps);break;case 5:default:Ql(e);break;case 3:case 4:var t=Nl;Nl=xd(e.stateNode.containerInfo),Ql(e),Nl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Hl,Hl=16777216,Ql(e),Hl=t):Ql(e))}}function Yl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function $l(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];kl=r,Jl(r,e)}Yl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Xl(e),e=e.sibling}function Xl(e){switch(e.tag){case 0:case 11:case 15:$l(e),2048&e.flags&&al(9,e,e.return);break;case 3:case 12:default:$l(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Zl(e)):$l(e)}}function Zl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];kl=r,Jl(r,e)}Yl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:al(8,t,t.return),Zl(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,Zl(t));break;default:Zl(t)}e=e.sibling}}function Jl(e,t){for(;null!==kl;){var n=kl;switch(n.tag){case 0:case 11:case 15:al(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Mi(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,kl=r;else e:for(n=e;null!==kl;){var i=(r=kl).sibling,o=r.return;if(Cl(r),r===n){kl=null;break e}if(null!==i){i.return=o,kl=i;break e}kl=o}}}var ec={getCacheForType:function(e){var t=Pi(Ri),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},tc="function"===typeof WeakMap?WeakMap:Map,nc=0,rc=null,ic=null,oc=0,sc=0,ac=null,lc=!1,cc=!1,uc=!1,dc=0,hc=0,fc=0,pc=0,gc=0,mc=0,vc=0,yc=null,wc=null,bc=!1,Ec=0,Sc=1/0,kc=null,xc=null,Cc=0,Pc=null,Ac=null,Ic=0,_c=0,Tc=null,Lc=null,Rc=0,Nc=null;function Mc(){if(0!==(2&nc)&&0!==oc)return oc&-oc;if(null!==M.T){return 0!==zi?zi:_u()}return Te()}function Dc(){0===mc&&(mc=0===(536870912&oc)||oi?Se():536870912);var e=ia.current;return null!==e&&(e.flags|=32),mc}function Oc(e,t,n){(e!==rc||2!==sc&&9!==sc)&&null===e.cancelPendingCommit||(Kc(e,0),Bc(e,oc,mc,!1)),Ce(e,n),0!==(2&nc)&&e===rc||(e===rc&&(0===(2&nc)&&(pc|=n),4===hc&&Bc(e,oc,mc,!1)),Su(e))}function zc(e,t,n){if(0!==(6&nc))throw Error(s(327));for(var r=!n&&0===(124&t)&&0===(t&e.expiredLanes)||be(e,t),i=r?function(e,t){var n=nc;nc|=2;var r=Wc(),i=Hc();rc!==e||oc!==t?(kc=null,Sc=te()+500,Kc(e,t)):cc=be(e,t);e:for(;;)try{if(0!==sc&&null!==ic){t=ic;var o=ac;t:switch(sc){case 1:sc=0,ac=null,Jc(e,t,o,1);break;case 2:case 9:if(Yi(o)){sc=0,ac=null,Zc(t);break}t=function(){2!==sc&&9!==sc||rc!==e||(sc=7),Su(e)},o.then(t,t);break e;case 3:sc=7;break e;case 4:sc=5;break e;case 7:Yi(o)?(sc=0,ac=null,Zc(t)):(sc=0,ac=null,Jc(e,t,o,7));break;case 5:var a=null;switch(ic.tag){case 26:a=ic.memoizedState;case 5:case 27:var l=ic;if(!a||qd(a)){sc=0,ac=null;var c=l.sibling;if(null!==c)ic=c;else{var u=l.return;null!==u?(ic=u,eu(u)):ic=null}break t}}sc=0,ac=null,Jc(e,t,o,5);break;case 6:sc=0,ac=null,Jc(e,t,o,6);break;case 8:Vc(),hc=6;break e;default:throw Error(s(462))}}$c();break}catch(d){jc(e,d)}return yi=vi=null,M.H=r,M.A=i,nc=n,null!==ic?0:(rc=null,oc=0,Ir(),hc)}(e,t):Gc(e,t,!0),o=r;;){if(0===i){cc&&!r&&Bc(e,t,0,!1);break}if(n=e.current.alternate,!o||Uc(n)){if(2===i){if(o=t,e.errorRecoveryDisabledLanes&o)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;i=yc;var c=l.current.memoizedState.isDehydrated;if(c&&(Kc(l,a).flags|=256),2!==(a=Gc(l,a,!1))){if(uc&&!c){l.errorRecoveryDisabledLanes|=o,pc|=o,i=4;break e}o=wc,wc=i,null!==o&&(null===wc?wc=o:wc.push.apply(wc,o))}i=a}if(o=!1,2!==i)continue}}if(1===i){Kc(e,0),Bc(e,t,0,!0);break}e:{switch(r=e,o=i){case 0:case 1:throw Error(s(345));case 4:if((4194048&t)!==t)break;case 6:Bc(r,t,mc,!lc);break e;case 2:wc=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&t)===t&&10<(i=Ec+300-te())){if(Bc(r,t,mc,!lc),0!==we(r,0,!0))break e;r.timeoutHandle=ld(Fc.bind(null,r,n,wc,kc,bc,t,mc,pc,vc,lc,o,2,-0,0),i)}else Fc(r,n,wc,kc,bc,t,mc,pc,vc,lc,o,0,-0,0)}break}i=Gc(e,t,!1),o=!1}Su(e)}function Fc(e,t,n,r,i,o,a,l,c,u,d,h,f,p){if(e.timeoutHandle=-1,(8192&(h=t.subtreeFlags)||16785408===(16785408&h))&&(Vd={stylesheets:null,count:0,unsuspend:Kd},Gl(t),null!==(h=function(){if(null===Vd)throw Error(s(475));var e=Vd;return e.stylesheets&&0===e.count&&Hd(e,e.stylesheets),0<e.count?function(t){var n=setTimeout((function(){if(e.stylesheets&&Hd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}())))return e.cancelPendingCommit=h(nu.bind(null,e,t,o,n,r,i,a,l,c,d,1,f,p)),void Bc(e,o,a,!u);nu(e,t,o,n,r,i,a,l,c)}function Uc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!Yn(o(),i))return!1}catch(s){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bc(e,t,n,r){t&=~gc,t&=~pc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var o=31-fe(i),s=1<<o;r[o]=-1,i&=~s}0!==n&&Pe(e,n,t)}function qc(){return 0!==(6&nc)||(ku(0,!1),!1)}function Vc(){if(null!==ic){if(0===sc)var e=ic.return;else yi=vi=null,Fo(e=ic),Ys=null,$s=0,e=ic;for(;null!==e;)ol(e.alternate,e),e=e.return;ic=null}}function Kc(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,cd(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Vc(),rc=e,ic=n=Fr(e.current,null),oc=t,sc=0,ac=null,lc=!1,cc=be(e,t),uc=!1,vc=mc=gc=pc=fc=hc=0,wc=yc=null,bc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-fe(r),o=1<<i;t|=e[i],r&=~o}return dc=t,Ir(),n}function jc(e,t){bo=null,M.H=Ws,t===Wi||t===Qi?(t=Ji(),sc=3):t===Hi?(t=Ji(),sc=4):sc=t===Pa?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,ac=t,null===ic&&(hc=1,Ea(e,xr(t,e.current)))}function Wc(){var e=M.H;return M.H=Ws,null===e?Ws:e}function Hc(){var e=M.A;return M.A=ec,e}function Qc(){hc=4,lc||(4194048&oc)!==oc&&null!==ia.current||(cc=!0),0===(134217727&fc)&&0===(134217727&pc)||null===rc||Bc(rc,oc,mc,!1)}function Gc(e,t,n){var r=nc;nc|=2;var i=Wc(),o=Hc();rc===e&&oc===t||(kc=null,Kc(e,t)),t=!1;var s=hc;e:for(;;)try{if(0!==sc&&null!==ic){var a=ic,l=ac;switch(sc){case 8:Vc(),s=6;break e;case 3:case 2:case 9:case 6:null===ia.current&&(t=!0);var c=sc;if(sc=0,ac=null,Jc(e,a,l,c),n&&cc){s=0;break e}break;default:c=sc,sc=0,ac=null,Jc(e,a,l,c)}}Yc(),s=hc;break}catch(u){jc(e,u)}return t&&e.shellSuspendCounter++,yi=vi=null,nc=r,M.H=i,M.A=o,null===ic&&(rc=null,oc=0,Ir()),s}function Yc(){for(;null!==ic;)Xc(ic)}function $c(){for(;null!==ic&&!J();)Xc(ic)}function Xc(e){var t=Xa(e.alternate,e,dc);e.memoizedProps=e.pendingProps,null===t?eu(e):ic=t}function Zc(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Oa(n,t,t.pendingProps,t.type,void 0,oc);break;case 11:t=Oa(n,t,t.pendingProps,t.type.render,t.ref,oc);break;case 5:Fo(t);default:ol(n,t),t=Xa(n,t=ic=Ur(t,dc),dc)}e.memoizedProps=e.pendingProps,null===t?eu(e):ic=t}function Jc(e,t,n,r){yi=vi=null,Fo(t),Ys=null,$s=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&ki(t,n,i,!0),null!==(n=ia.current)){switch(n.tag){case 13:return null===oa?Qc():null===n.alternate&&0===hc&&(hc=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===Gi?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),du(e,r,i)),!1;case 22:return n.flags|=65536,r===Gi?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),du(e,r,i)),!1}throw Error(s(435,n.tag))}return du(e,r,i),Qc(),!1}if(oi)return null!==(t=ia.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==li&&gi(xr(e=Error(s(422),{cause:r}),n))):(r!==li&&gi(xr(t=Error(s(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=xr(r,n),ao(e,i=ka(e.stateNode,r,i)),4!==hc&&(hc=2)),!1;var o=Error(s(520),{cause:r});if(o=xr(o,n),null===yc?yc=[o]:yc.push(o),4!==hc&&(hc=2),null===t)return!0;r=xr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,ao(n,e=ka(n.stateNode,r,e)),!1;case 1:if(t=n.type,o=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==o&&"function"===typeof o.componentDidCatch&&(null===xc||!xc.has(o))))return n.flags|=65536,i&=-i,n.lanes|=i,Ca(i=xa(i),e,n,r),ao(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,oc))return hc=1,Ea(e,xr(n,e.current)),void(ic=null)}catch(o){if(null!==i)throw ic=i,o;return hc=1,Ea(e,xr(n,e.current)),void(ic=null)}32768&t.flags?(oi||1===r?e=!0:cc||0!==(536870912&oc)?e=!1:(lc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=ia.current)&&13===r.tag&&(r.flags|=16384))),tu(t,e)):eu(t)}function eu(e){var t=e;do{if(0!==(32768&t.flags))return void tu(t,lc);e=t.return;var n=rl(t.alternate,t,dc);if(null!==n)return void(ic=n);if(null!==(t=t.sibling))return void(ic=t);ic=t=e}while(null!==t);0===hc&&(hc=5)}function tu(e,t){do{var n=il(e.alternate,e);if(null!==n)return n.flags&=32767,void(ic=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(ic=e);ic=e=n}while(null!==e);hc=6,ic=null}function nu(e,t,n,r,i,o,a,l,c){e.cancelPendingCommit=null;do{au()}while(0!==Cc);if(0!==(6&nc))throw Error(s(327));if(null!==t){if(t===e.current)throw Error(s(177));if(o=t.lanes|t.childLanes,function(e,t,n,r,i,o){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-fe(n),d=1<<u;a[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var f=h[u];null!==f&&(f.lane&=-536870913)}n&=~d}0!==r&&Pe(e,r,0),0!==o&&0===i&&0!==e.tag&&(e.suspendedLanes|=o&~(s&~t))}(e,n,o|=Ar,a,l,c),e===rc&&(ic=rc=null,oc=0),Ac=t,Pc=e,Ic=n,_c=o,Tc=i,Lc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,X(oe,(function(){return lu(),null}))):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=M.T,M.T=null,i=D.p,D.p=2,a=nc,nc|=4;try{!function(e,t){if(e=e.containerInfo,td=nh,tr(e=er(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(m){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=a+i),h!==o||0!==r&&3!==h.nodeType||(c=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=a),f===o&&++d===r&&(c=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nd={focusedElem:e,selectionRange:n},nh=!1,kl=t;null!==kl;)if(e=(t=kl).child,0!==(1024&t.subtreeFlags)&&null!==e)e.return=t,kl=e;else for(;null!==kl;){switch(o=(t=kl).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==o){e=void 0,n=t,i=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var g=ma(n.type,i,(n.elementType,n.type));e=r.getSnapshotBeforeUpdate(g,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){uu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))gd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":gd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,kl=e;break}kl=t.return}}(e,t)}finally{nc=a,D.p=i,M.T=r}}Cc=1,ru(),iu(),ou()}}function ru(){if(1===Cc){Cc=0;var e=Pc,t=Ac,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=M.T,M.T=null;var r=D.p;D.p=2;var i=nc;nc|=4;try{Ml(t,e);var o=nd,s=er(e.containerInfo),a=o.focusedElem,l=o.selectionRange;if(s!==a&&a&&a.ownerDocument&&Jn(a.ownerDocument.documentElement,a)){if(null!==l&&tr(a)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in a)a.selectionStart=c,a.selectionEnd=Math.min(u,a.value.length);else{var d=a.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var f=h.getSelection(),p=a.textContent.length,g=Math.min(l.start,p),m=void 0===l.end?g:Math.min(l.end,p);!f.extend&&g>m&&(s=m,m=g,g=s);var v=Zn(a,g),y=Zn(a,m);if(v&&y&&(1!==f.rangeCount||f.anchorNode!==v.node||f.anchorOffset!==v.offset||f.focusNode!==y.node||f.focusOffset!==y.offset)){var w=d.createRange();w.setStart(v.node,v.offset),f.removeAllRanges(),g>m?(f.addRange(w),f.extend(y.node,y.offset)):(w.setEnd(y.node,y.offset),f.addRange(w))}}}}for(d=[],f=a;f=f.parentNode;)1===f.nodeType&&d.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof a.focus&&a.focus(),a=0;a<d.length;a++){var b=d[a];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}nh=!!td,nd=td=null}finally{nc=i,D.p=r,M.T=n}}e.current=t,Cc=2}}function iu(){if(2===Cc){Cc=0;var e=Pc,t=Ac,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=M.T,M.T=null;var r=D.p;D.p=2;var i=nc;nc|=4;try{xl(e,t.alternate,t)}finally{nc=i,D.p=r,M.T=n}}Cc=3}}function ou(){if(4===Cc||3===Cc){Cc=0,ee();var e=Pc,t=Ac,n=Ic,r=Lc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Cc=5:(Cc=0,Ac=Pc=null,su(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(xc=null),_e(n),t=t.stateNode,de&&"function"===typeof de.onCommitFiberRoot)try{de.onCommitFiberRoot(ue,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=M.T,i=D.p,D.p=2,M.T=null;try{for(var o=e.onRecoverableError,s=0;s<r.length;s++){var a=r[s];o(a.value,{componentStack:a.stack})}}finally{M.T=t,D.p=i}}0!==(3&Ic)&&au(),Su(e),i=e.pendingLanes,0!==(4194090&n)&&0!==(42&i)?e===Nc?Rc++:(Rc=0,Nc=e):Rc=0,ku(0,!1)}}function su(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Mi(t)))}function au(e){return ru(),iu(),ou(),lu()}function lu(){if(5!==Cc)return!1;var e=Pc,t=_c;_c=0;var n=_e(Ic),r=M.T,i=D.p;try{D.p=32>n?32:n,M.T=null,n=Tc,Tc=null;var o=Pc,a=Ic;if(Cc=0,Ac=Pc=null,Ic=0,0!==(6&nc))throw Error(s(331));var l=nc;if(nc|=4,Xl(o.current),Kl(o,o.current,a,n),nc=l,ku(0,!1),de&&"function"===typeof de.onPostCommitFiberRoot)try{de.onPostCommitFiberRoot(ue,o)}catch(c){}return!0}finally{D.p=i,M.T=r,su(e,t)}}function cu(e,t,n){t=xr(n,t),null!==(e=oo(e,t=ka(e.stateNode,t,2),2))&&(Ce(e,2),Su(e))}function uu(e,t,n){if(3===e.tag)cu(e,e,n);else for(;null!==t;){if(3===t.tag){cu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===xc||!xc.has(r))){e=xr(n,e),null!==(r=oo(t,n=xa(2),2))&&(Ca(n,r,t,e),Ce(r,2),Su(r));break}}t=t.return}}function du(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new tc;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(uc=!0,i.add(n),e=hu.bind(null,e,t,n),t.then(e,e))}function hu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,rc===e&&(oc&n)===n&&(4===hc||3===hc&&(62914560&oc)===oc&&300>te()-Ec?0===(2&nc)&&Kc(e,0):gc|=n,vc===oc&&(vc=0)),Su(e)}function fu(e,t){0===t&&(t=ke()),null!==(e=Lr(e,t))&&(Ce(e,t),Su(e))}function pu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),fu(e,n)}function gu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==r&&r.delete(t),fu(e,n)}var mu=null,vu=null,yu=!1,wu=!1,bu=!1,Eu=0;function Su(e){e!==vu&&null===e.next&&(null===vu?mu=vu=e:vu=vu.next=e),wu=!0,yu||(yu=!0,dd((function(){0!==(6&nc)?X(re,xu):Cu()})))}function ku(e,t){if(!bu&&wu){bu=!0;do{for(var n=!1,r=mu;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var o=0;else{var s=r.suspendedLanes,a=r.pingedLanes;o=(1<<31-fe(42|e)+1)-1,o=201326741&(o&=i&~(s&~a))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,Iu(r,o))}else o=oc,0===(3&(o=we(r,r===rc?o:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||be(r,o)||(n=!0,Iu(r,o));r=r.next}}while(n);bu=!1}}function xu(){Cu()}function Cu(){wu=yu=!1;var e=0;0!==Eu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==ad&&(ad=e,!0);return ad=null,!1}()&&(e=Eu),Eu=0);for(var t=te(),n=null,r=mu;null!==r;){var i=r.next,o=Pu(r,t);0===o?(r.next=null,null===n?mu=i:n.next=i,null===i&&(vu=n)):(n=r,(0!==e||0!==(3&o))&&(wu=!0)),r=i}ku(e,!1)}function Pu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var s=31-fe(o),a=1<<s,l=i[s];-1===l?0!==(a&n)&&0===(a&r)||(i[s]=Ee(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}if(n=oc,n=we(e,e===(t=rc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===sc||9===sc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&Z(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||be(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&Z(r),_e(n)){case 2:case 8:n=ie;break;case 32:default:n=oe;break;case 268435456:n=ae}return r=Au.bind(null,e),n=X(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&Z(r),e.callbackPriority=2,e.callbackNode=null,2}function Au(e,t){if(0!==Cc&&5!==Cc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(au()&&e.callbackNode!==n)return null;var r=oc;return 0===(r=we(e,e===rc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(zc(e,r,t),Pu(e,te()),null!=e.callbackNode&&e.callbackNode===n?Au.bind(null,e):null)}function Iu(e,t){if(au())return null;zc(e,t,!0)}function _u(){return 0===Eu&&(Eu=Se()),Eu}function Tu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:_t(""+e)}function Lu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Ru=0;Ru<Er.length;Ru++){var Nu=Er[Ru];Sr(Nu.toLowerCase(),"on"+(Nu[0].toUpperCase()+Nu.slice(1)))}Sr(fr,"onAnimationEnd"),Sr(pr,"onAnimationIteration"),Sr(gr,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(mr,"onTransitionRun"),Sr(vr,"onTransitionStart"),Sr(yr,"onTransitionCancel"),Sr(wr,"onTransitionEnd"),Ye("onMouseEnter",["mouseout","mouseover"]),Ye("onMouseLeave",["mouseout","mouseover"]),Ye("onPointerEnter",["pointerout","pointerover"]),Ye("onPointerLeave",["pointerout","pointerover"]),Ge("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ge("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ge("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ge("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ge("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ge("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Du=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Mu));function Ou(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;o=a,i.currentTarget=c;try{o(i)}catch(u){va(u)}i.currentTarget=null,o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;o=a,i.currentTarget=c;try{o(i)}catch(u){va(u)}i.currentTarget=null,o=l}}}}function zu(e,t){var n=t[De];void 0===n&&(n=t[De]=new Set);var r=e+"__bubble";n.has(r)||(qu(t,e,2,!1),n.add(r))}function Fu(e,t,n){var r=0;t&&(r|=4),qu(n,e,r,t)}var Uu="_reactListening"+Math.random().toString(36).slice(2);function Bu(e){if(!e[Uu]){e[Uu]=!0,He.forEach((function(t){"selectionchange"!==t&&(Du.has(t)||Fu(t,!1,e),Fu(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Uu]||(t[Uu]=!0,Fu("selectionchange",!1,t))}}function qu(e,t,n,r){switch(ch(t)){case 2:var i=rh;break;case 8:i=ih;break;default:i=oh}n=i.bind(null,t,n,e),i=void 0,!Ut||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Vu(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===i)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&s.stateNode.containerInfo===i)return;s=s.return}for(;null!==a;){if(null===(s=qe(a)))return;if(5===(c=s.tag)||6===c||26===c||27===c){r=o=s;continue e}a=a.parentNode}}r=r.return}Ot((function(){var r=o,i=Lt(n),s=[];e:{var a=br.get(e);if(void 0!==a){var c=Jt,u=e;switch(e){case"keypress":if(0===Wt(n))break e;case"keydown":case"keyup":c=gn;break;case"focusin":u="focus",c=sn;break;case"focusout":u="blur",c=sn;break;case"beforeblur":case"afterblur":c=sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=rn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=on;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=vn;break;case fr:case pr:case gr:c=an;break;case wr:c=yn;break;case"scroll":case"scrollend":c=tn;break;case"wheel":c=wn;break;case"copy":case"cut":case"paste":c=ln;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=mn;break;case"toggle":case"beforetoggle":c=bn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),f=d?null!==a?a+"Capture":null:a;d=[];for(var p,g=r;null!==g;){var m=g;if(p=m.stateNode,5!==(m=m.tag)&&26!==m&&27!==m||null===p||null===f||null!=(m=zt(g,f))&&d.push(Ku(g,m,p)),h)break;g=g.return}0<d.length&&(a=new c(a,u,null,n,i),s.push({event:a,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Tt||!(u=n.relatedTarget||n.fromElement)||!qe(u)&&!u[Me])&&(c||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?qe(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=rn,m="onMouseLeave",f="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(d=mn,m="onPointerLeave",f="onPointerEnter",g="pointer"),h=null==c?a:Ke(c),p=null==u?a:Ke(u),(a=new d(m,g+"leave",c,n,i)).target=h,a.relatedTarget=p,m=null,qe(i)===r&&((d=new d(f,g+"enter",u,n,i)).target=p,d.relatedTarget=h,m=d),h=m,c&&u)e:{for(f=u,g=0,p=d=c;p;p=Wu(p))g++;for(p=0,m=f;m;m=Wu(m))p++;for(;0<g-p;)d=Wu(d),g--;for(;0<p-g;)f=Wu(f),p--;for(;g--;){if(d===f||null!==f&&d===f.alternate)break e;d=Wu(d),f=Wu(f)}d=null}else d=null;null!==c&&Hu(s,a,c,d,!1),null!==u&&null!==h&&Hu(s,h,u,d,!0)}if("select"===(c=(a=r?Ke(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var v=Fn;else if(Rn(a))if(Un)v=Gn;else{v=Hn;var y=Wn}else!(c=a.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?r&&Pt(r.elementType)&&(v=Fn):v=Qn;switch(v&&(v=v(e,r))?Nn(s,v,n,i):(y&&y(e,a,r),"focusout"===e&&r&&"number"===a.type&&null!=r.memoizedProps.value&&yt(a,"number",a.value)),y=r?Ke(r):window,e){case"focusin":(Rn(y)||"true"===y.contentEditable)&&(rr=y,ir=r,or=null);break;case"focusout":or=ir=rr=null;break;case"mousedown":sr=!0;break;case"contextmenu":case"mouseup":case"dragend":sr=!1,ar(s,n,i);break;case"selectionchange":if(nr)break;case"keydown":case"keyup":ar(s,n,i)}var w;if(Sn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Tn?In(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Cn&&"ko"!==n.locale&&(Tn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Tn&&(w=jt()):(Vt="value"in(qt=i)?qt.value:qt.textContent,Tn=!0)),0<(y=ju(r,b)).length&&(b=new cn(b,e,null,n,i),s.push({event:b,listeners:y}),w?b.data=w:null!==(w=_n(n))&&(b.data=w))),(w=xn?function(e,t){switch(e){case"compositionend":return _n(t);case"keypress":return 32!==t.which?null:(An=!0,Pn);case"textInput":return(e=t.data)===Pn&&An?null:e;default:return null}}(e,n):function(e,t){if(Tn)return"compositionend"===e||!Sn&&In(e,t)?(e=jt(),Kt=Vt=qt=null,Tn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Cn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(b=ju(r,"onBeforeInput")).length&&(y=new cn("onBeforeInput","beforeinput",null,n,i),s.push({event:y,listeners:b}),y.data=w)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var o=Tu((i[Ne]||null).action),s=r.submitter;s&&null!==(t=(t=s[Ne]||null)?Tu(t.formAction):s.getAttribute("formAction"))&&(o=t,s=null);var a=new Jt("action","action",null,r,i);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Eu){var e=s?Lu(i,s):new FormData(i);Ls(n,{pending:!0,data:e,method:i.method,action:o},null,e)}}else"function"===typeof o&&(a.preventDefault(),e=s?Lu(i,s):new FormData(i),Ls(n,{pending:!0,data:e,method:i.method,action:o},o,e))},currentTarget:i}]})}}(s,e,r,n,i)}Ou(s,t)}))}function Ku(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ju(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===o||(null!=(i=zt(e,n))&&r.unshift(Ku(e,i,o)),null!=(i=zt(e,t))&&r.push(Ku(e,i,o))),3===e.tag)return r;e=e.return}return[]}function Wu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Hu(e,t,n,r,i){for(var o=t._reactName,s=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===r)break;5!==a&&26!==a&&27!==a||null===c||(l=c,i?null!=(c=zt(n,o))&&s.unshift(Ku(n,c,l)):i||null!=(c=zt(n,o))&&s.push(Ku(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Qu=/\r\n?/g,Gu=/\u0000|\uFFFD/g;function Yu(e){return("string"===typeof e?e:""+e).replace(Qu,"\n").replace(Gu,"")}function $u(e,t){return t=Yu(t),Yu(e)===t}function Xu(){}function Zu(e,t,n,r,i,o){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||St(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&St(e,""+r);break;case"className":nt(e,"class",r);break;case"tabIndex":nt(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,n,r);break;case"style":Ct(e,r,o);break;case"data":if("object"!==t){nt(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=_t(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof o&&("formAction"===n?("input"!==t&&Zu(e,t,"name",i.name,i,null),Zu(e,t,"formEncType",i.formEncType,i,null),Zu(e,t,"formMethod",i.formMethod,i,null),Zu(e,t,"formTarget",i.formTarget,i,null)):(Zu(e,t,"encType",i.encType,i,null),Zu(e,t,"method",i.method,i,null),Zu(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=_t(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Xu);break;case"onScroll":null!=r&&zu("scroll",e);break;case"onScrollEnd":null!=r&&zu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=_t(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":zu("beforetoggle",e),zu("toggle",e),tt(e,"popover",r);break;case"xlinkActuate":rt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":rt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":rt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":rt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":rt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":rt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":rt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":rt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":rt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":tt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&tt(e,n=At.get(n)||n,r)}}function Ju(e,t,n,r,i,o){switch(n){case"style":Ct(e,r,o);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"children":"string"===typeof r?St(e,r):("number"===typeof r||"bigint"===typeof r)&&St(e,""+r);break;case"onScroll":null!=r&&zu("scroll",e);break;case"onScrollEnd":null!=r&&zu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Xu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Qe.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(o=null!=(o=e[Ne]||null)?o[n]:null)&&e.removeEventListener(t,o,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):tt(e,n,r):("function"!==typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function ed(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zu("error",e),zu("load",e);var r,i=!1,o=!1;for(r in n)if(n.hasOwnProperty(r)){var a=n[r];if(null!=a)switch(r){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Zu(e,t,r,a,n,null)}}return o&&Zu(e,t,"srcSet",n.srcSet,n,null),void(i&&Zu(e,t,"src",n.src,n,null));case"input":zu("invalid",e);var l=r=a=o=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var d=n[i];if(null!=d)switch(i){case"name":o=d;break;case"type":a=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(s(137,t));break;default:Zu(e,t,i,d,n,null)}}return vt(e,r,l,c,u,a,o,!1),void dt(e);case"select":for(o in zu("invalid",e),i=a=r=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":r=l;break;case"defaultValue":a=l;break;case"multiple":i=l;default:Zu(e,t,o,l,n,null)}return t=r,n=a,e.multiple=!!i,void(null!=t?wt(e,!!i,t,!1):null!=n&&wt(e,!!i,n,!0));case"textarea":for(a in zu("invalid",e),r=o=i=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":i=l;break;case"defaultValue":o=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:Zu(e,t,a,l,n,null)}return Et(e,i,o,r),void dt(e);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else Zu(e,t,c,i,n,null);return;case"dialog":zu("beforetoggle",e),zu("toggle",e),zu("cancel",e),zu("close",e);break;case"iframe":case"object":zu("load",e);break;case"video":case"audio":for(i=0;i<Mu.length;i++)zu(Mu[i],e);break;case"image":zu("error",e),zu("load",e);break;case"details":zu("toggle",e);break;case"embed":case"source":case"link":zu("error",e),zu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Zu(e,t,u,i,n,null)}return;default:if(Pt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(i=n[d])&&Ju(e,t,d,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&Zu(e,t,l,i,n,null))}var td=null,nd=null;function rd(e){return 9===e.nodeType?e:e.ownerDocument}function id(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function od(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function sd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ad=null;var ld="function"===typeof setTimeout?setTimeout:void 0,cd="function"===typeof clearTimeout?clearTimeout:void 0,ud="function"===typeof Promise?Promise:void 0,dd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ud?function(e){return ud.resolve(null).then(e).catch(hd)}:ld;function hd(e){setTimeout((function(){throw e}))}function fd(e){return"head"===e}function pd(e,t){var n=t,r=0,i=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0<r&&8>r){n=r;var s=e.ownerDocument;if(1&n&&Ed(s.documentElement),2&n&&Ed(s.body),4&n)for(Ed(n=s.head),s=n.firstChild;s;){var a=s.nextSibling,l=s.nodeName;s[Ue]||"SCRIPT"===l||"STYLE"===l||"LINK"===l&&"stylesheet"===s.rel.toLowerCase()||n.removeChild(s),s=a}}if(0===i)return e.removeChild(o),void Ah(t);i--}else"$"===n||"$?"===n||"$!"===n?i++:r=n.charCodeAt(0)-48;else r=0;n=o}while(n);Ah(t)}function gd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":gd(n),Be(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function md(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function vd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var yd=null;function wd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}function bd(e,t,n){switch(t=rd(n),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}function Ed(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Be(e)}var Sd=new Map,kd=new Set;function xd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Cd=D.d;D.d={f:function(){var e=Cd.f(),t=qc();return e||t},r:function(e){var t=Ve(e);null!==t&&5===t.tag&&"form"===t.type?Ns(t):Cd.r(e)},D:function(e){Cd.D(e),Ad("dns-prefetch",e,null)},C:function(e,t){Cd.C(e,t),Ad("preconnect",e,t)},L:function(e,t,n){Cd.L(e,t,n);var r=Pd;if(r&&e&&t){var i='link[rel="preload"][as="'+gt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+gt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+gt(n.imageSizes)+'"]')):i+='[href="'+gt(e)+'"]';var o=i;switch(t){case"style":o=_d(e);break;case"script":o=Rd(e)}Sd.has(o)||(e=h({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Sd.set(o,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Td(o))||"script"===t&&r.querySelector(Nd(o))||(ed(t=r.createElement("link"),"link",e),We(t),r.head.appendChild(t)))}},m:function(e,t){Cd.m(e,t);var n=Pd;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+gt(r)+'"][href="'+gt(e)+'"]',o=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=Rd(e)}if(!Sd.has(o)&&(e=h({rel:"modulepreload",href:e},t),Sd.set(o,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Nd(o)))return}ed(r=n.createElement("link"),"link",e),We(r),n.head.appendChild(r)}}},X:function(e,t){Cd.X(e,t);var n=Pd;if(n&&e){var r=je(n).hoistableScripts,i=Rd(e),o=r.get(i);o||((o=n.querySelector(Nd(i)))||(e=h({src:e,async:!0},t),(t=Sd.get(i))&&zd(e,t),We(o=n.createElement("script")),ed(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}},S:function(e,t,n){Cd.S(e,t,n);var r=Pd;if(r&&e){var i=je(r).hoistableStyles,o=_d(e);t=t||"default";var s=i.get(o);if(!s){var a={loading:0,preload:null};if(s=r.querySelector(Td(o)))a.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Sd.get(o))&&Od(e,n);var l=s=r.createElement("link");We(l),ed(l,"link",e),l._p=new Promise((function(e,t){l.onload=e,l.onerror=t})),l.addEventListener("load",(function(){a.loading|=1})),l.addEventListener("error",(function(){a.loading|=2})),a.loading|=4,Dd(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:a},i.set(o,s)}}},M:function(e,t){Cd.M(e,t);var n=Pd;if(n&&e){var r=je(n).hoistableScripts,i=Rd(e),o=r.get(i);o||((o=n.querySelector(Nd(i)))||(e=h({src:e,async:!0,type:"module"},t),(t=Sd.get(i))&&zd(e,t),We(o=n.createElement("script")),ed(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(i,o))}}};var Pd="undefined"===typeof document?null:document;function Ad(e,t,n){var r=Pd;if(r&&"string"===typeof t&&t){var i=gt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),kd.has(i)||(kd.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(ed(t=r.createElement("link"),"link",e),We(t),r.head.appendChild(t)))}}function Id(e,t,n,r){var i,o,a,l,c=(c=j.current)?xd(c):null;if(!c)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=_d(n.href),(r=(n=je(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=_d(n.href);var u=je(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Td(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Sd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Sd.set(e,n),u||(i=c,o=e,a=n,l=d.state,i.querySelector('link[rel="preload"][as="style"]['+o+"]")?l.loading=1:(o=i.createElement("link"),l.preload=o,o.addEventListener("load",(function(){return l.loading|=1})),o.addEventListener("error",(function(){return l.loading|=2})),ed(o,"link",a),We(o),i.head.appendChild(o))))),t&&null===r)throw Error(s(528,""));return d}if(t&&null!==r)throw Error(s(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Rd(n),(r=(n=je(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function _d(e){return'href="'+gt(e)+'"'}function Td(e){return'link[rel="stylesheet"]['+e+"]"}function Ld(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Rd(e){return'[src="'+gt(e)+'"]'}function Nd(e){return"script[async]"+e}function Md(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+gt(n.href)+'"]');if(r)return t.instance=r,We(r),r;var i=h({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return We(r=(e.ownerDocument||e).createElement("style")),ed(r,"style",i),Dd(r,n.precedence,e),t.instance=r;case"stylesheet":i=_d(n.href);var o=e.querySelector(Td(i));if(o)return t.state.loading|=4,t.instance=o,We(o),o;r=Ld(n),(i=Sd.get(i))&&Od(r,i),We(o=(e.ownerDocument||e).createElement("link"));var a=o;return a._p=new Promise((function(e,t){a.onload=e,a.onerror=t})),ed(o,"link",r),t.state.loading|=4,Dd(o,n.precedence,e),t.instance=o;case"script":return o=Rd(n.src),(i=e.querySelector(Nd(o)))?(t.instance=i,We(i),i):(r=n,(i=Sd.get(o))&&zd(r=h({},n),i),We(i=(e=e.ownerDocument||e).createElement("script")),ed(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Dd(r,n.precedence,e));return t.instance}function Dd(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,o=i,s=0;s<r.length;s++){var a=r[s];if(a.dataset.precedence===t)o=a;else if(o!==i)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Od(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function zd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Fd=null;function Ud(e,t,n){if(null===Fd){var r=new Map,i=Fd=new Map;i.set(n,r)}else(r=(i=Fd).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var o=n[i];if(!(o[Ue]||o[Re]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var s=o.getAttribute(t)||"";s=e+s;var a=r.get(s);a?a.push(o):r.set(s,[o])}}return r}function Bd(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function qd(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var Vd=null;function Kd(){}function jd(){if(this.count--,0===this.count)if(this.stylesheets)Hd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Wd=null;function Hd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Wd=new Map,t.forEach(Qd,e),Wd=null,jd.call(e))}function Qd(e,t){if(!(4&t.state.loading)){var n=Wd.get(e);if(n)var r=n.get(null);else{n=new Map,Wd.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<i.length;o++){var s=i[o];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(i=t.instance).getAttribute("data-precedence"),(o=n.get(s)||r)===r&&n.set(null,i),n.set(s,i),this.count++,r=jd.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),o?o.parentNode.insertBefore(i,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var Gd={$$typeof:E,Provider:null,Consumer:null,_currentValue:O,_currentValue2:O,_threadCount:0};function Yd(e,t,n,r,i,o,s,a){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xe(0),this.hiddenUpdates=xe(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function $d(e,t,n,r,i,o,s,a,l,c,u,d){return e=new Yd(e,t,n,s,a,l,c,d),t=1,!0===o&&(t|=24),o=Or(3,null,null,t),e.current=o,o.stateNode=e,(t=Ni()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:r,isDehydrated:n,cache:t},no(o),e}function Xd(e){return e?e=Mr:Mr}function Zd(e,t,n,r,i,o){i=Xd(i),null===r.context?r.context=i:r.pendingContext=i,(r=io(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(r.callback=o),null!==(n=oo(e,r,t))&&(Oc(n,0,t),so(n,e,t))}function Jd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function eh(e,t){Jd(e,t),(e=e.alternate)&&Jd(e,t)}function th(e){if(13===e.tag){var t=Lr(e,67108864);null!==t&&Oc(t,0,67108864),eh(e,67108864)}}var nh=!0;function rh(e,t,n,r){var i=M.T;M.T=null;var o=D.p;try{D.p=2,oh(e,t,n,r)}finally{D.p=o,M.T=i}}function ih(e,t,n,r){var i=M.T;M.T=null;var o=D.p;try{D.p=8,oh(e,t,n,r)}finally{D.p=o,M.T=i}}function oh(e,t,n,r){if(nh){var i=sh(r);if(null===i)Vu(e,t,r,ah,n),yh(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return dh=wh(dh,e,t,n,r,i),!0;case"dragenter":return hh=wh(hh,e,t,n,r,i),!0;case"mouseover":return fh=wh(fh,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return ph.set(o,wh(ph.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,gh.set(o,wh(gh.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(yh(e,r),4&t&&-1<vh.indexOf(e)){for(;null!==i;){var o=Ve(i);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var s=ye(o.pendingLanes);if(0!==s){var a=o;for(a.pendingLanes|=2,a.entangledLanes|=2;s;){var l=1<<31-fe(s);a.entanglements[1]|=l,s&=~l}Su(o),0===(6&nc)&&(Sc=te()+500,ku(0,!1))}}break;case 13:null!==(a=Lr(o,2))&&Oc(a,0,2),qc(),eh(o,2)}if(null===(o=sh(r))&&Vu(e,t,r,ah,n),o===i)break;i=o}null!==i&&r.stopPropagation()}else Vu(e,t,r,null,n)}}function sh(e){return lh(e=Lt(e))}var ah=null;function lh(e){if(ah=null,null!==(e=qe(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return ah=e,null}function ch(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case re:return 2;case ie:return 8;case oe:case se:return 32;case ae:return 268435456;default:return 32}default:return 32}}var uh=!1,dh=null,hh=null,fh=null,ph=new Map,gh=new Map,mh=[],vh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yh(e,t){switch(e){case"focusin":case"focusout":dh=null;break;case"dragenter":case"dragleave":hh=null;break;case"mouseover":case"mouseout":fh=null;break;case"pointerover":case"pointerout":ph.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gh.delete(t.pointerId)}}function wh(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=Ve(t))&&th(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function bh(e){var t=qe(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void function(e,t){var n=D.p;try{return D.p=e,t()}finally{D.p=n}}(e.priority,(function(){if(13===n.tag){var e=Mc();e=Ie(e);var t=Lr(n,e);null!==t&&Oc(t,0,e),eh(n,e)}}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Eh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=sh(e.nativeEvent);if(null!==n)return null!==(t=Ve(n))&&th(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Tt=r,n.target.dispatchEvent(r),Tt=null,t.shift()}return!0}function Sh(e,t,n){Eh(e)&&n.delete(t)}function kh(){uh=!1,null!==dh&&Eh(dh)&&(dh=null),null!==hh&&Eh(hh)&&(hh=null),null!==fh&&Eh(fh)&&(fh=null),ph.forEach(Sh),gh.forEach(Sh)}function xh(e,t){e.blockedOn===t&&(e.blockedOn=null,uh||(uh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,kh)))}var Ch=null;function Ph(e){Ch!==e&&(Ch=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,(function(){Ch===e&&(Ch=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===lh(r||n))continue;break}var o=Ve(n);null!==o&&(e.splice(t,3),t-=3,Ls(o,{pending:!0,data:i,method:n.method,action:r},r,i))}})))}function Ah(e){function t(t){return xh(t,e)}null!==dh&&xh(dh,e),null!==hh&&xh(hh,e),null!==fh&&xh(fh,e),ph.forEach(t),gh.forEach(t);for(var n=0;n<mh.length;n++){var r=mh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<mh.length&&null===(n=mh[0]).blockedOn;)bh(n),null===n.blockedOn&&mh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],o=n[r+1],s=i[Ne]||null;if("function"===typeof o)s||Ph(n);else if(s){var a=null;if(o&&o.hasAttribute("formAction")){if(i=o,s=o[Ne]||null)a=s.formAction;else if(null!==lh(i))continue}else a=s.action;"function"===typeof a?n[r+1]=a:(n.splice(r,3),r-=3),Ph(n)}}}function Ih(e){this._internalRoot=e}function _h(e){this._internalRoot=e}_h.prototype.render=Ih.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Zd(t.current,Mc(),e,t,null,null)},_h.prototype.unmount=Ih.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Zd(e.current,2,null,e,null,null),qc(),t[Me]=null}},_h.prototype.unstable_scheduleHydration=function(e){if(e){var t=Te();e={blockedOn:null,target:e,priority:t};for(var n=0;n<mh.length&&0!==t&&t<mh[n].priority;n++);mh.splice(n,0,e),0===n&&bh(e)}};var Th=i.version;if("19.1.0"!==Th)throw Error(s(527,Th,"19.1.0"));D.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return u(i),e;if(o===r)return u(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,c=i.child;c;){if(c===n){a=!0,n=i,r=o;break}if(c===r){a=!0,r=i,n=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===n){a=!0,n=o,r=i;break}if(c===r){a=!0,r=o,n=i;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Lh={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.1.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rh.isDisabled&&Rh.supportsFiber)try{ue=Rh.inject(Lh),de=Rh}catch(Mh){}}t.createRoot=function(e,t){if(!a(e))throw Error(s(299));var n=!1,r="",i=ya,o=wa,l=ba;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=$d(e,1,!1,null,0,n,r,i,o,l,0,null),e[Me]=t.current,Bu(e),new Ih(t)},t.hydrateRoot=function(e,t,n){if(!a(e))throw Error(s(299));var r=!1,i="",o=ya,l=wa,c=ba,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(u=n.formState)),(t=$d(e,1,!0,t,0,r,i,o,l,c,0,u)).context=Xd(null),n=t.current,(i=io(r=Ie(r=Mc()))).callback=null,oo(n,i,r),n=r,t.current.lanes=n,Ce(t,n),Su(t),e[Me]=t.current,Bu(e),new _h(t)},t.version="19.1.0"},20:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;const t={value:e,done:!1};if(this.pullQueue.length){const e=this.pullQueue.shift();e&&e.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),void 0!==this.highWaterMark&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn("EventIterator queue reached ".concat(this.pushQueue.length," items")))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{const t=Promise.reject(e);t.catch((()=>{})),this.pushQueue.push(t)}}remove(){Promise.resolve().then((()=>{this.removeCallback&&this.removeCallback()}))}[Symbol.asyncIterator](){return{next:e=>{const t=this.pushQueue.shift();return t?(void 0!==this.lowWaterMark&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise(((e,t)=>{this.pullQueue.push({resolve:e,reject:t})}))},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}class r{constructor(e){let{highWaterMark:t=100,lowWaterMark:r=1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=new n;i.highWaterMark=t,i.lowWaterMark=r,i.removeCallback=e({push:e=>i.push(e),stop:()=>i.stop(),fail:e=>i.fail(e),on:(e,t)=>{i.eventHandlers[e]=t}})||(()=>{}),this[Symbol.asyncIterator]=()=>i[Symbol.asyncIterator](),Object.freeze(this)}}t.EventIterator=r,t.default=r},43:(e,t,n)=>{"use strict";e.exports=n(288)},101:e=>{e.exports=function(e){if(!e)throw Error("hashlru must have a max value, of type number, greater than 0");var t=0,n=Object.create(null),r=Object.create(null);function i(i,o){n[i]=o,++t>=e&&(t=0,r=n,n=Object.create(null))}return{has:function(e){return void 0!==n[e]||void 0!==r[e]},remove:function(e){void 0!==n[e]&&(n[e]=void 0),void 0!==r[e]&&(r[e]=void 0)},get:function(e){var t=n[e];return void 0!==t?t:void 0!==(t=r[e])?(i(e,t),t):void 0},set:function(e,t){void 0!==n[e]?n[e]=t:i(e,t)},clear:function(){n=Object.create(null),r=Object.create(null)}}}},288:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function w(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=w.prototype=new y;b.constructor=w,g(b,v.prototype),b.isPureReactComponent=!0;var E=Array.isArray,S={H:null,A:null,T:null,S:null,V:null},k=Object.prototype.hasOwnProperty;function x(e,t,r,i,o,s){return r=s.ref,{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:s}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var P=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(){}function _(e,t,i,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case h:return _((u=e._init)(e._payload),t,i,o,s)}}if(u)return s=s(e),u=""===o?"."+A(e,0):o,E(s)?(i="",null!=u&&(i=u.replace(P,"$&/")+"/"),_(s,t,i,"",(function(e){return e}))):null!=s&&(C(s)&&(l=s,c=i+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(P,"$&/")+"/")+u,s=x(l.type,c,void 0,0,0,l.props)),t.push(s)),1;u=0;var d,p=""===o?".":o+":";if(E(e))for(var g=0;g<e.length;g++)u+=_(o=e[g],t,i,a=p+A(o,g),s);else if("function"===typeof(g=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=g.call(e),g=0;!(o=e.next()).done;)u+=_(o=o.value,t,i,a=p+A(o,g++),s);else if("object"===a){if("function"===typeof e.then)return _(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(I,I):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,o,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function T(e,t,n){if(null==e)return e;var r=[],i=0;return _(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function L(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function N(){}t.Children={map:T,forEach:function(e,t,n){T(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return T(e,(function(){t++})),t},toArray:function(e){return T(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=w,t.StrictMode=o,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key;if(null!=t)for(o in void 0!==t.ref&&void 0,void 0!==t.key&&(i=""+t.key),t)!k.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(r[o]=t[o]);var o=arguments.length-2;if(1===o)r.children=n;else if(1<o){for(var s=Array(o),a=0;a<o;a++)s[a]=arguments[a+2];r.children=s}return x(e.type,i,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,n){var r,i={},o=null;if(null!=t)for(r in void 0!==t.key&&(o=""+t.key),t)k.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var a=Array(s),l=0;l<s;l++)a[l]=arguments[l+2];i.children=a}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return x(e,o,void 0,0,0,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:L}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,n={};S.T=n;try{var r=e(),i=S.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(N,R)}catch(o){R(o)}finally{S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,n){return S.H.useActionState(e,t,n)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t,n){var r=S.H;if("function"===typeof n)throw Error("useEffect CRUD overload is not enabled in this build of React.");return r.useEffect(e,t)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,n){return S.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return S.H.useReducer(e,t,n)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return S.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return S.H.useTransition()},t.version="19.1.0"},302:(e,t,n)=>{e.exports=n(944)},364:function(e,t){(function(){var e,n,r,i,o,s,a,l;l=function(e){return[(e&255<<24)>>>24,(e&255<<16)>>>16,(65280&e)>>>8,255&e].join(".")},a=function(e){var t,r,i,o,s,a;for(t=[],i=o=0;o<=3&&0!==e.length;i=++o){if(i>0){if("."!==e[0])throw new Error("Invalid IP");e=e.substring(1)}s=(a=n(e))[0],r=a[1],e=e.substring(r),t.push(s)}if(0!==e.length)throw new Error("Invalid IP");switch(t.length){case 1:if(t[0]>4294967295)throw new Error("Invalid IP");return t[0]>>>0;case 2:if(t[0]>255||t[1]>16777215)throw new Error("Invalid IP");return(t[0]<<24|t[1])>>>0;case 3:if(t[0]>255||t[1]>255||t[2]>65535)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2])>>>0;case 4:if(t[0]>255||t[1]>255||t[2]>255||t[3]>255)throw new Error("Invalid IP");return(t[0]<<24|t[1]<<16|t[2]<<8|t[3])>>>0;default:throw new Error("Invalid IP")}},i=(r=function(e){return e.charCodeAt(0)})("0"),s=r("a"),o=r("A"),n=function(e){var t,n,a,l,c;for(l=0,t=10,n="9",a=0,e.length>1&&"0"===e[a]&&("x"===e[a+1]||"X"===e[a+1]?(a+=2,t=16):"0"<=e[a+1]&&e[a+1]<="9"&&(a++,t=8,n="7")),c=a;a<e.length;){if("0"<=e[a]&&e[a]<=n)l=l*t+(r(e[a])-i)>>>0;else{if(16!==t)break;if("a"<=e[a]&&e[a]<="f")l=l*t+(10+r(e[a])-s)>>>0;else{if(!("A"<=e[a]&&e[a]<="F"))break;l=l*t+(10+r(e[a])-o)>>>0}}if(l>4294967295)throw new Error("too large");a++}if(a===c)throw new Error("empty octet");return[l,a]},e=function(){function e(e,t){var n,r,i;if("string"!==typeof e)throw new Error("Missing `net' parameter");if(t||(i=e.split("/",2),e=i[0],t=i[1]),t||(t=32),"string"===typeof t&&t.indexOf(".")>-1){try{this.maskLong=a(t)}catch(o){throw new Error("Invalid mask: "+t)}for(n=r=32;r>=0;n=--r)if(this.maskLong===4294967295<<32-n>>>0){this.bitmask=n;break}}else{if(!t&&0!==t)throw new Error("Invalid mask: empty");this.bitmask=parseInt(t,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0)}try{this.netLong=(a(e)&this.maskLong)>>>0}catch(o){throw new Error("Invalid net address: "+e)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+t);this.size=Math.pow(2,32-this.bitmask),this.base=l(this.netLong),this.mask=l(this.maskLong),this.hostmask=l(~this.maskLong),this.first=this.bitmask<=30?l(this.netLong+1):this.base,this.last=this.bitmask<=30?l(this.netLong+this.size-2):l(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?l(this.netLong+this.size-1):void 0}return e.prototype.contains=function(t){return"string"===typeof t&&(t.indexOf("/")>0||4!==t.split(".").length)&&(t=new e(t)),t instanceof e?this.contains(t.base)&&this.contains(t.broadcast||t.last):(a(t)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},e.prototype.next=function(t){return null==t&&(t=1),new e(l(this.netLong+this.size*t),this.mask)},e.prototype.forEach=function(e){var t,n,r;for(r=a(this.first),n=a(this.last),t=0;r<=n;)e(l(r),r,t),t++,r++},e.prototype.toString=function(){return this.base+"/"+this.bitmask},e}(),t.ip2long=a,t.long2ip=l,t.Netmask=e}).call(this)},391:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},465:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,s){if("function"!==typeof r)throw new TypeError("The listener must be a function");var a=new i(r,o||e,s),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,s=new Array(o);i<o;i++)s[i]=r[i].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,i,o,s){var a=n?n+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,o),!0;case 6:return u.fn.call(u.context,t,r,i,o,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,f=u.length;for(c=0;c<f;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,r);break;case 4:u[c].fn.call(u[c].context,t,r,i);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||r&&a.context!==r||s(this,o);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||i&&!a[l].once||r&&a[l].context!==r)&&c.push(a[l]);c.length?this._events[o]=1===c.length?c[0]:c:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},579:(e,t,n)=>{"use strict";e.exports=n(799)},605:(e,t,n)=>{"use strict";const r=n(20);t.PP=r.EventIterator,r.EventIterator},672:(e,t,n)=>{"use strict";var r=n(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var s={d:{f:o,r:function(){throw Error(i(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=s.p;try{if(l.T=null,s.p=2,e)return e()}finally{l.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,o="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:o}):"script"===n&&s.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:o,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.1.0"},790:e=>{function t(e,t){"boolean"===typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1)}var r=this;return this._timer=setTimeout((function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout((function(){r._operationTimeoutCb(r._attempts)}),r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)}),n),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,r=0;r<this._errors.length;r++){var i=this._errors[r],o=i.message,s=(e[o]||0)+1;e[o]=s,s>=n&&(t=i,n=s)}return t}},799:(e,t)=>{"use strict";var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function i(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var o in r={},t)"key"!==o&&(r[o]=t[o]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=i,t.jsxs=i},853:(e,t,n)=>{"use strict";e.exports=n(896)},896:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<o(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,n))c<i&&0>o(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>o(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,g=!1,m=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,w="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function E(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(m=!1,E(e),!g)if(null!==r(c))g=!0,x||(x=!0,k());else{var t=r(u);null!==t&&R(S,t.startTime-e)}}var k,x=!1,C=-1,P=5,A=-1;function I(){return!!v||!(t.unstable_now()-A<P)}function _(){if(v=!1,x){var e=t.unstable_now();A=e;var n=!0;try{e:{g=!1,m&&(m=!1,w(C),C=-1),p=!0;var o=f;try{t:{for(E(e),h=r(c);null!==h&&!(h.expirationTime>e&&I());){var s=h.callback;if("function"===typeof s){h.callback=null,f=h.priorityLevel;var a=s(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){h.callback=a,E(e),n=!0;break t}h===r(c)&&i(c),E(e)}else i(c);h=r(c)}if(null!==h)n=!0;else{var l=r(u);null!==l&&R(S,l.startTime-e),n=!1}}break e}finally{h=null,f=o,p=!1}n=void 0}}finally{n?k():x=!1}}}if("function"===typeof b)k=function(){b(_)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,L=T.port2;T.port1.onmessage=_,k=function(){L.postMessage(null)}}else k=function(){y(_,0)};function R(e,n){C=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,n(u,e),null===r(c)&&e===r(u)&&(m?(w(C),C=-1):m=!0,R(S,o-s))):(e.sortIndex=a,n(c,e),g||p||(g=!0,x||(x=!0,k()))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},944:(e,t,n)=>{var r=n(790);t.operation=function(e){var n=t.timeouts(e);return new r(n,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var r=[],i=0;i<t.retries;i++)r.push(this.createTimeout(i,t));return e&&e.forever&&!r.length&&r.push(this.createTimeout(i,t)),r.sort((function(e,t){return e-t})),r},t.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,r=Math.round(n*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return r=Math.min(r,t.maxTimeout)},t.wrap=function(e,n,r){if(n instanceof Array&&(r=n,n=null),!r)for(var i in r=[],e)"function"===typeof e[i]&&r.push(i);for(var o=0;o<r.length;o++){var s=r[o],a=e[s];e[s]=function(r){var i=t.operation(n),o=Array.prototype.slice.call(arguments,1),s=o.pop();o.push((function(e){i.retry(e)||(e&&(arguments[0]=i.mainError()),s.apply(this,arguments))})),i.attempt((function(){r.apply(e,o)}))}.bind(e,a),e[s].options=n}}},950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".1e45fcff.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="jabs-libp2p:";n.l=(r,i,o,s)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==o)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+o){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+o),a.src=r),e[r]=[i];var h=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/hh_platform_public/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var o=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=o);var s=n.p+n.u(t),a=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,i[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,o,s=r[0],a=r[1],l=r[2],c=0;if(s.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);c<s.length;c++)o=s[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=self.webpackChunkjabs_libp2p=self.webpackChunkjabs_libp2p||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};n.r(e),n.d(e,{base10:()=>ye});var t={};n.r(t),n.d(t,{base16:()=>we,base16upper:()=>be});var r={};n.r(r),n.d(r,{base2:()=>Ee});var i={};n.r(i),n.d(i,{base256emoji:()=>Ce});var o={};n.r(o),n.d(o,{base32:()=>Pe,base32hex:()=>Te,base32hexpad:()=>Re,base32hexpadupper:()=>Ne,base32hexupper:()=>Le,base32pad:()=>Ie,base32padupper:()=>_e,base32upper:()=>Ae,base32z:()=>Me});var s={};n.r(s),n.d(s,{base36:()=>De,base36upper:()=>Oe});var a={};n.r(a),n.d(a,{base58btc:()=>ze,base58flickr:()=>Fe});var l={};n.r(l),n.d(l,{base64:()=>Ue,base64pad:()=>Be,base64url:()=>qe,base64urlpad:()=>Ve});var c={};n.r(c),n.d(c,{base8:()=>Ke});var u={};n.r(u),n.d(u,{identity:()=>je});var d={};n.r(d),n.d(d,{code:()=>Ge,decode:()=>$e,encode:()=>Ye,name:()=>Qe});var h={};n.r(h),n.d(h,{code:()=>Ze,decode:()=>et,encode:()=>Je,name:()=>Xe});var f={};n.r(f),n.d(f,{identity:()=>Ct});var p={};n.r(p),n.d(p,{sha256:()=>_t,sha512:()=>Tt});var g=n(43),m=n(391);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function y(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==v(t)?t:t+""}function w(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class S extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted"),this.name="AbortError"}}w(S,"name","AbortError");class k extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected Peer"),this.name="UnexpectedPeerError"}}w(k,"name","UnexpectedPeerError");class x extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),this.name="InvalidCryptoExchangeError"}}w(x,"name","InvalidCryptoExchangeError");class C extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid parameters"),this.name="InvalidParametersError"}}w(C,"name","InvalidParametersError");class P extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid public key"),this.name="InvalidPublicKeyError"}}w(P,"name","InvalidPublicKeyError");class A extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid private key"),this.name="InvalidPrivateKeyError"}}w(A,"name","InvalidPrivateKeyError");class I extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unsupported operation"),this.name="UnsupportedOperationError"}}w(I,"name","UnsupportedOperationError");class _ extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The connection is closing"),this.name="ConnectionClosingError"}}w(_,"name","ConnectionClosingError");class T extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The connection is closed"),this.name="ConnectionClosedError"}}w(T,"name","ConnectionClosedError");class L extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Connection failed"),this.name="ConnectionFailedError"}}w(L,"name","ConnectionFailedError");class R extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The muxer is closed"),this.name="MuxerClosedError"}}w(R,"name","MuxerClosedError");class N extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The stream has been reset"),this.name="StreamResetError"}}w(N,"name","StreamResetError");class M extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The stream is in an invalid state"),this.name="StreamStateError"}}w(M,"name","StreamStateError");class D extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Not found"),this.name="NotFoundError"}}w(D,"name","NotFoundError");class O extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid PeerID"),this.name="InvalidPeerIdError"}}w(O,"name","InvalidPeerIdError");class z extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid multiaddr"),this.name="InvalidMultiaddrError"}}w(z,"name","InvalidMultiaddrError");class F extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid CID"),this.name="InvalidCIDError"}}w(F,"name","InvalidCIDError");class U extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid Multihash"),this.name="InvalidMultihashError"}}w(U,"name","InvalidMultihashError");class B extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unsupported protocol error"),this.name="UnsupportedProtocolError"}}w(B,"name","UnsupportedProtocolError");class q extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid message"),this.name="InvalidMessageError"}}w(q,"name","InvalidMessageError");class V extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Protocol error"),this.name="ProtocolError"}}w(V,"name","ProtocolError");class K extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Timed out"),this.name="TimeoutError"}}w(K,"name","TimeoutError");class j extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Not started"),this.name="NotStartedError"}}w(j,"name","NotStartedError");class W extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Already started"),this.name="AlreadyStartedError"}}w(W,"name","AlreadyStartedError");class H extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Dial error"),this.name="DialError"}}w(H,"name","DialError");class Q extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Listen error"),this.name="ListenError"}}w(Q,"name","ListenError");class G extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Limited connection"),this.name="LimitedConnectionError"}}w(G,"name","LimitedConnectionError");class Y extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Too many inbound protocol streams"),this.name="TooManyInboundProtocolStreamsError"}}w(Y,"name","TooManyInboundProtocolStreamsError");class $ extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Too many outbound protocol streams"),this.name="TooManyOutboundProtocolStreamsError"}}w($,"name","TooManyOutboundProtocolStreamsError");class X extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unsupported key type"),this.name="UnsupportedKeyTypeError"}}w(X,"name","UnsupportedKeyTypeError");class Z extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Not implemented"),this.name="NotImplementedError"}}function J(){return new Uint8Array(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)}function ee(){return new Uint8Array(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)}function te(e,t){null==t&&(t=e.reduce(((e,t)=>e+t.length),0));const n=ee(t);let r=0;for(const i of e)n.set(i,r),r+=i.length;return n}function ne(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}w(Z,"name","NotImplementedError");const re=Symbol.for("@achingbrain/uint8arraylist");function ie(e,t){if(null==t||t<0)throw new RangeError("index is out of bounds");let n=0;for(const r of e){const e=n+r.byteLength;if(t<e)return{buf:r,index:t-n};n=e}throw new RangeError("index is out of bounds")}function oe(e){return Boolean(null===e||void 0===e?void 0:e[re])}class se{constructor(){w(this,"bufs",void 0),w(this,"length",void 0),w(this,re,!0),this.bufs=[],this.length=0;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.appendAll(t)}appendAll(e){let t=0;for(const n of e)if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.push(n);else{if(!oe(n))throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.push(...n.bufs)}this.length+=t}prepend(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.prependAll(t)}prependAll(e){let t=0;for(const n of e.reverse())if(n instanceof Uint8Array)t+=n.byteLength,this.bufs.unshift(n);else{if(!oe(n))throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");t+=n.byteLength,this.bufs.unshift(...n.bufs)}this.length+=t}get(e){const t=ie(this.bufs,e);return t.buf[t.index]}set(e,t){const n=ie(this.bufs,e);n.buf[n.index]=t}write(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(t+n,e[n]);else{if(!oe(e))throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList");for(let n=0;n<e.length;n++)this.set(t+n,e.get(n))}}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength)return this.bufs=[],void(this.length=0);for(;this.bufs.length>0;){if(!(e>=this.bufs[0].byteLength)){this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift()}}}slice(e,t){const{bufs:n,length:r}=this._subList(e,t);return te(n,r)}subarray(e,t){const{bufs:n,length:r}=this._subList(e,t);return 1===n.length?n[0]:te(n,r)}sublist(e,t){const{bufs:n,length:r}=this._subList(e,t),i=new se;return i.length=r,i.bufs=[...n],i}_subList(e,t){if(e=null!==e&&void 0!==e?e:0,t=null!==t&&void 0!==t?t:this.length,e<0&&(e=this.length+e),t<0&&(t=this.length+t),e<0||t>this.length)throw new RangeError("index is out of bounds");if(e===t)return{bufs:[],length:0};if(0===e&&t===this.length)return{bufs:this.bufs,length:this.length};const n=[];let r=0;for(let i=0;i<this.bufs.length;i++){const o=this.bufs[i],s=r,a=s+o.byteLength;if(r=a,e>=a)continue;const l=e>=s&&e<a,c=t>s&&t<=a;if(l&&c){if(e===s&&t===a){n.push(o);break}const r=e-s;n.push(o.subarray(r,r+(t-e)));break}if(l){if(0===e){n.push(o);continue}n.push(o.subarray(e-s))}else{if(c){if(t===a){n.push(o);break}n.push(o.subarray(0,t-s));break}n.push(o)}}return{bufs:n,length:t-e}}indexOf(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!oe(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const n=e instanceof Uint8Array?e:e.subarray();if(t=Number(null!==t&&void 0!==t?t:0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;const r=n.byteLength;if(0===r)throw new TypeError("search must be at least 1 byte long");const i=new Int32Array(256);for(let c=0;c<256;c++)i[c]=-1;for(let c=0;c<r;c++)i[n[c]]=c;const o=i,s=this.byteLength-n.byteLength,a=n.byteLength-1;let l;for(let c=t;c<=s;c+=l){l=0;for(let e=a;e>=0;e--){const t=this.get(c+e);if(n[e]!==t){l=Math.max(1,e-o[t]);break}}if(0===l)return c}return-1}getInt8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt8(0)}setInt8(e,t){const n=ee(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,t),this.write(n,e)}getInt16(e,t){const n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,t)}setInt16(e,t,n){const r=J(2);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt16(0,t,n),this.write(r,e)}getInt32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,t)}setInt32(e,t,n){const r=J(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setInt32(0,t,n),this.write(r,e)}getBigInt64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,t)}setBigInt64(e,t,n){const r=J(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setBigInt64(0,t,n),this.write(r,e)}getUint8(e){const t=this.subarray(e,e+1);return new DataView(t.buffer,t.byteOffset,t.byteLength).getUint8(0)}setUint8(e,t){const n=ee(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,t),this.write(n,e)}getUint16(e,t){const n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,t)}setUint16(e,t,n){const r=J(2);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint16(0,t,n),this.write(r,e)}getUint32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,t)}setUint32(e,t,n){const r=J(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setUint32(0,t,n),this.write(r,e)}getBigUint64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,t)}setBigUint64(e,t,n){const r=J(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setBigUint64(0,t,n),this.write(r,e)}getFloat32(e,t){const n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,t)}setFloat32(e,t,n){const r=J(4);new DataView(r.buffer,r.byteOffset,r.byteLength).setFloat32(0,t,n),this.write(r,e)}getFloat64(e,t){const n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,t)}setFloat64(e,t,n){const r=J(8);new DataView(r.buffer,r.byteOffset,r.byteLength).setFloat64(0,t,n),this.write(r,e)}equals(e){if(null==e)return!1;if(!(e instanceof se))return!1;if(e.bufs.length!==this.bufs.length)return!1;for(let t=0;t<this.bufs.length;t++)if(!ne(this.bufs[t],e.bufs[t]))return!1;return!0}static fromUint8Arrays(e,t){const n=new se;return n.bufs=e,null==t&&(t=e.reduce(((e,t)=>e+t.byteLength),0)),n.length=t,n}}new Uint8Array(0);function ae(e){if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}var le=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),s=o.charCodeAt(0);if(255!==n[s])throw new TypeError(o+" is ambiguous");n[s]=i}var a=e.length,l=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var r=0,i=0;e[t]===l;)r++,t++;for(var o=(e.length-t)*c+1>>>0,s=new Uint8Array(o);e[t];){var u=n[e.charCodeAt(t)];if(255===u)return;for(var d=0,h=o-1;(0!==u||d<i)&&-1!==h;h--,d++)u+=a*s[h]>>>0,s[h]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=d,t++}if(" "!==e[t]){for(var f=o-i;f!==o&&0===s[f];)f++;for(var p=new Uint8Array(r+(o-f)),g=r;f!==o;)p[g++]=s[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,o=t.length;i!==o&&0===t[i];)i++,n++;for(var s=(o-i)*u+1>>>0,c=new Uint8Array(s);i!==o;){for(var d=t[i],h=0,f=s-1;(0!==d||h<r)&&-1!==f;f--,h++)d+=256*c[f]>>>0,c[f]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");r=h,i++}for(var p=s-r;p!==s&&0===c[p];)p++;for(var g=l.repeat(n);p<s;++p)g+=e.charAt(c[p]);return g},decodeUnsafe:d,decode:function(e){var n=d(e);if(n)return n;throw new Error("Non-".concat(t," character"))}}};const ce=le;class ue{constructor(e,t,n){w(this,"name",void 0),w(this,"prefix",void 0),w(this,"baseEncode",void 0),this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return"".concat(this.prefix).concat(this.baseEncode(e));throw Error("Unknown type, must be binary type")}}class de{constructor(e,t,n){w(this,"name",void 0),w(this,"prefix",void 0),w(this,"baseDecode",void 0),w(this,"prefixCodePoint",void 0),this.name=e,this.prefix=t;const r=t.codePointAt(0);if(void 0===r)throw new Error("Invalid prefix character");this.prefixCodePoint=r,this.baseDecode=n}decode(e){if("string"===typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error("Unable to decode multibase string ".concat(JSON.stringify(e),", ").concat(this.name," decoder only supports inputs prefixed with ").concat(this.prefix));return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return fe(this,e)}}class he{constructor(e){w(this,"decoders",void 0),this.decoders=e}or(e){return fe(this,e)}decode(e){const t=e[0],n=this.decoders[t];if(null!=n)return n.decode(e);throw RangeError("Unable to decode multibase string ".concat(JSON.stringify(e),", only inputs prefixed with ").concat(Object.keys(this.decoders)," are supported"))}}function fe(e,t){var n,r;return new he(E(E({},null!==(n=e.decoders)&&void 0!==n?n:{[e.prefix]:e}),null!==(r=t.decoders)&&void 0!==r?r:{[t.prefix]:t}))}class pe{constructor(e,t,n,r){w(this,"name",void 0),w(this,"prefix",void 0),w(this,"baseEncode",void 0),w(this,"baseDecode",void 0),w(this,"encoder",void 0),w(this,"decoder",void 0),this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=r,this.encoder=new ue(e,t,n),this.decoder=new de(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function ge(e){let{name:t,prefix:n,encode:r,decode:i}=e;return new pe(t,n,r,i)}function me(e){let{name:t,prefix:n,alphabet:r}=e;const{encode:i,decode:o}=ce(r,t);return ge({prefix:n,name:t,encode:i,decode:e=>ae(o(e))})}function ve(e){let{name:t,prefix:n,bitsPerChar:r,alphabet:i}=e;const o=function(e){const t={};for(let n=0;n<e.length;++n)t[e[n]]=n;return t}(i);return ge({prefix:n,name:t,encode:e=>function(e,t,n){const r="="===t[t.length-1],i=(1<<n)-1;let o="",s=0,a=0;for(let l=0;l<e.length;++l)for(a=a<<8|e[l],s+=8;s>n;)s-=n,o+=t[i&a>>s];if(0!==s&&(o+=t[i&a<<n-s]),r)for(;0!==(o.length*n&7);)o+="=";return o}(e,i,r),decode:e=>function(e,t,n,r){let i=e.length;for(;"="===e[i-1];)--i;const o=new Uint8Array(i*n/8|0);let s=0,a=0,l=0;for(let c=0;c<i;++c){const i=t[e[c]];if(void 0===i)throw new SyntaxError("Non-".concat(r," character"));a=a<<n|i,s+=n,s>=8&&(s-=8,o[l++]=255&a>>s)}if(s>=n||0!==(255&a<<8-s))throw new SyntaxError("Unexpected end of data");return o}(e,o,r,t)})}const ye=me({prefix:"9",name:"base10",alphabet:"0123456789"}),we=ve({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),be=ve({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Ee=ve({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Se=Array.from("\ud83d\ude80\ud83e\ude90\u2604\ud83d\udef0\ud83c\udf0c\ud83c\udf11\ud83c\udf12\ud83c\udf13\ud83c\udf14\ud83c\udf15\ud83c\udf16\ud83c\udf17\ud83c\udf18\ud83c\udf0d\ud83c\udf0f\ud83c\udf0e\ud83d\udc09\u2600\ud83d\udcbb\ud83d\udda5\ud83d\udcbe\ud83d\udcbf\ud83d\ude02\u2764\ud83d\ude0d\ud83e\udd23\ud83d\ude0a\ud83d\ude4f\ud83d\udc95\ud83d\ude2d\ud83d\ude18\ud83d\udc4d\ud83d\ude05\ud83d\udc4f\ud83d\ude01\ud83d\udd25\ud83e\udd70\ud83d\udc94\ud83d\udc96\ud83d\udc99\ud83d\ude22\ud83e\udd14\ud83d\ude06\ud83d\ude44\ud83d\udcaa\ud83d\ude09\u263a\ud83d\udc4c\ud83e\udd17\ud83d\udc9c\ud83d\ude14\ud83d\ude0e\ud83d\ude07\ud83c\udf39\ud83e\udd26\ud83c\udf89\ud83d\udc9e\u270c\u2728\ud83e\udd37\ud83d\ude31\ud83d\ude0c\ud83c\udf38\ud83d\ude4c\ud83d\ude0b\ud83d\udc97\ud83d\udc9a\ud83d\ude0f\ud83d\udc9b\ud83d\ude42\ud83d\udc93\ud83e\udd29\ud83d\ude04\ud83d\ude00\ud83d\udda4\ud83d\ude03\ud83d\udcaf\ud83d\ude48\ud83d\udc47\ud83c\udfb6\ud83d\ude12\ud83e\udd2d\u2763\ud83d\ude1c\ud83d\udc8b\ud83d\udc40\ud83d\ude2a\ud83d\ude11\ud83d\udca5\ud83d\ude4b\ud83d\ude1e\ud83d\ude29\ud83d\ude21\ud83e\udd2a\ud83d\udc4a\ud83e\udd73\ud83d\ude25\ud83e\udd24\ud83d\udc49\ud83d\udc83\ud83d\ude33\u270b\ud83d\ude1a\ud83d\ude1d\ud83d\ude34\ud83c\udf1f\ud83d\ude2c\ud83d\ude43\ud83c\udf40\ud83c\udf37\ud83d\ude3b\ud83d\ude13\u2b50\u2705\ud83e\udd7a\ud83c\udf08\ud83d\ude08\ud83e\udd18\ud83d\udca6\u2714\ud83d\ude23\ud83c\udfc3\ud83d\udc90\u2639\ud83c\udf8a\ud83d\udc98\ud83d\ude20\u261d\ud83d\ude15\ud83c\udf3a\ud83c\udf82\ud83c\udf3b\ud83d\ude10\ud83d\udd95\ud83d\udc9d\ud83d\ude4a\ud83d\ude39\ud83d\udde3\ud83d\udcab\ud83d\udc80\ud83d\udc51\ud83c\udfb5\ud83e\udd1e\ud83d\ude1b\ud83d\udd34\ud83d\ude24\ud83c\udf3c\ud83d\ude2b\u26bd\ud83e\udd19\u2615\ud83c\udfc6\ud83e\udd2b\ud83d\udc48\ud83d\ude2e\ud83d\ude46\ud83c\udf7b\ud83c\udf43\ud83d\udc36\ud83d\udc81\ud83d\ude32\ud83c\udf3f\ud83e\udde1\ud83c\udf81\u26a1\ud83c\udf1e\ud83c\udf88\u274c\u270a\ud83d\udc4b\ud83d\ude30\ud83e\udd28\ud83d\ude36\ud83e\udd1d\ud83d\udeb6\ud83d\udcb0\ud83c\udf53\ud83d\udca2\ud83e\udd1f\ud83d\ude41\ud83d\udea8\ud83d\udca8\ud83e\udd2c\u2708\ud83c\udf80\ud83c\udf7a\ud83e\udd13\ud83d\ude19\ud83d\udc9f\ud83c\udf31\ud83d\ude16\ud83d\udc76\ud83e\udd74\u25b6\u27a1\u2753\ud83d\udc8e\ud83d\udcb8\u2b07\ud83d\ude28\ud83c\udf1a\ud83e\udd8b\ud83d\ude37\ud83d\udd7a\u26a0\ud83d\ude45\ud83d\ude1f\ud83d\ude35\ud83d\udc4e\ud83e\udd32\ud83e\udd20\ud83e\udd27\ud83d\udccc\ud83d\udd35\ud83d\udc85\ud83e\uddd0\ud83d\udc3e\ud83c\udf52\ud83d\ude17\ud83e\udd11\ud83c\udf0a\ud83e\udd2f\ud83d\udc37\u260e\ud83d\udca7\ud83d\ude2f\ud83d\udc86\ud83d\udc46\ud83c\udfa4\ud83d\ude47\ud83c\udf51\u2744\ud83c\udf34\ud83d\udca3\ud83d\udc38\ud83d\udc8c\ud83d\udccd\ud83e\udd40\ud83e\udd22\ud83d\udc45\ud83d\udca1\ud83d\udca9\ud83d\udc50\ud83d\udcf8\ud83d\udc7b\ud83e\udd10\ud83e\udd2e\ud83c\udfbc\ud83e\udd75\ud83d\udea9\ud83c\udf4e\ud83c\udf4a\ud83d\udc7c\ud83d\udc8d\ud83d\udce3\ud83e\udd42"),ke=Se.reduce(((e,t,n)=>(e[n]=t,e)),[]),xe=Se.reduce(((e,t,n)=>{const r=t.codePointAt(0);if(null==r)throw new Error("Invalid character: ".concat(t));return e[r]=n,e}),[]);const Ce=ge({prefix:"\ud83d\ude80",name:"base256emoji",encode:function(e){return e.reduce(((e,t)=>e+=ke[t]),"")},decode:function(e){const t=[];for(const n of e){const e=n.codePointAt(0);if(null==e)throw new Error("Invalid character: ".concat(n));const r=xe[e];if(null==r)throw new Error("Non-base256emoji character: ".concat(n));t.push(r)}return new Uint8Array(t)}}),Pe=ve({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ae=ve({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ie=ve({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),_e=ve({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Te=ve({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Le=ve({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Re=ve({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Ne=ve({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Me=ve({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),De=me({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Oe=me({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),ze=me({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Fe=me({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Ue=ve({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Be=ve({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),qe=ve({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ve=ve({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Ke=ve({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),je=ge({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>function(e){return(new TextEncoder).encode(e)}(e)}),We=new TextEncoder,He=new TextDecoder,Qe="json",Ge=512;function Ye(e){return We.encode(JSON.stringify(e))}function $e(e){return JSON.parse(He.decode(e))}const Xe="raw",Ze=85;function Je(e){return ae(e)}function et(e){return ae(e)}var tt=function e(t,n,r){n=n||[];var i=r=r||0;for(;t>=it;)n[r++]=255&t|nt,t/=128;for(;t&rt;)n[r++]=255&t|nt,t>>>=7;return n[r]=0|t,e.bytes=r-i+1,n},nt=128,rt=-128,it=Math.pow(2,31);var ot=function e(t,n){var r,i=0,o=0,s=n=n||0,a=t.length;do{if(s>=a)throw e.bytes=0,new RangeError("Could not decode varint");r=t[s++],i+=o<28?(r&at)<<o:(r&at)*Math.pow(2,o),o+=7}while(r>=st);return e.bytes=s-n,i},st=128,at=127;var lt=Math.pow(2,7),ct=Math.pow(2,14),ut=Math.pow(2,21),dt=Math.pow(2,28),ht=Math.pow(2,35),ft=Math.pow(2,42),pt=Math.pow(2,49),gt=Math.pow(2,56),mt=Math.pow(2,63);const vt={encode:tt,decode:ot,encodingLength:function(e){return e<lt?1:e<ct?2:e<ut?3:e<dt?4:e<ht?5:e<ft?6:e<pt?7:e<gt?8:e<mt?9:10}};function yt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return[vt.decode(e,t),vt.decode.bytes]}function wt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return vt.encode(e,t,n),t}function bt(e){return vt.encodingLength(e)}function Et(e,t){const n=t.byteLength,r=bt(e),i=r+bt(n),o=new Uint8Array(i+n);return wt(e,o,0),wt(n,o,r),o.set(t,i),new kt(e,n,t,o)}function St(e){const t=ae(e),[n,r]=yt(t),[i,o]=yt(t.subarray(r)),s=t.subarray(r+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new kt(n,i,s,t)}class kt{constructor(e,t,n,r){w(this,"code",void 0),w(this,"size",void 0),w(this,"digest",void 0),w(this,"bytes",void 0),this.code=e,this.size=t,this.digest=n,this.bytes=r}}const xt=ae;const Ct={code:0,name:"identity",encode:xt,digest:function(e){return Et(0,xt(e))}};function Pt(e){let{name:t,code:n,encode:r}=e;return new At(t,n,r)}class At{constructor(e,t,n){w(this,"name",void 0),w(this,"code",void 0),w(this,"encode",void 0),this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Et(this.code,t):t.then((e=>Et(this.code,e)))}throw Error("Unknown type, must be binary type")}}function It(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}const _t=Pt({name:"sha2-256",code:18,encode:It("SHA-256")}),Tt=Pt({name:"sha2-512",code:19,encode:It("SHA-512")});function Lt(e,t){const{bytes:n,version:r}=e;return 0===r?function(e,t,n){const{prefix:r}=n;if(r!==ze.prefix)throw Error("Cannot string encode V0 in ".concat(n.name," encoding"));const i=t.get(r);if(null==i){const i=n.encode(e).slice(1);return t.set(r,i),i}return i}(n,Nt(e),null!==t&&void 0!==t?t:ze.encoder):function(e,t,n){const{prefix:r}=n,i=t.get(r);if(null==i){const i=n.encode(e);return t.set(r,i),i}return i}(n,Nt(e),null!==t&&void 0!==t?t:Pe.encoder)}const Rt=new WeakMap;function Nt(e){const t=Rt.get(e);if(null==t){const t=new Map;return Rt.set(e,t),t}return t}class Mt{constructor(e,t,n,r){w(this,"code",void 0),w(this,"version",void 0),w(this,"multihash",void 0),w(this,"bytes",void 0),w(this,"/",void 0),w(this,Symbol.toStringTag,"CID"),this.code=t,this.version=e,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:t}=this;if(e!==Dt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Ot)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Mt.createV0(t)}default:throw Error("Can not convert CID version ".concat(this.version," to version 0. This is a bug please report"))}}toV1(){switch(this.version){case 0:{const{code:e,digest:t}=this.multihash,n=Et(e,t);return Mt.createV1(this.code,n)}case 1:return this;default:throw Error("Can not convert CID version ".concat(this.version," to version 1. This is a bug please report"))}}equals(e){return Mt.equals(this,e)}static equals(e,t){const n=t;return null!=n&&e.code===n.code&&e.version===n.version&&function(e,t){if(e===t)return!0;{const n=t;return e.code===n.code&&e.size===n.size&&n.bytes instanceof Uint8Array&&function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}(e.bytes,n.bytes)}}(e.multihash,n.multihash)}toString(e){return Lt(this,e)}toJSON(){return{"/":Lt(this)}}link(){return this}[Symbol.for("nodejs.util.inspect.custom")](){return"CID(".concat(this.toString(),")")}static asCID(e){if(null==e)return null;const t=e;if(t instanceof Mt)return t;if(null!=t["/"]&&t["/"]===t.bytes||t.asCID===t){const{version:e,code:n,multihash:r,bytes:i}=t;return new Mt(e,n,r,null!==i&&void 0!==i?i:zt(e,n,r.bytes))}if(!0===t[Ft]){const{version:e,multihash:n,code:r}=t,i=St(n);return Mt.create(e,r,i)}return null}static create(e,t,n){if("number"!==typeof t)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:if(t!==Dt)throw new Error("Version 0 CID must use dag-pb (code: ".concat(Dt,") block encoding"));return new Mt(e,t,n,n.bytes);case 1:{const r=zt(e,t,n.bytes);return new Mt(e,t,n,r)}default:throw new Error("Invalid version")}}static createV0(e){return Mt.create(0,Dt,e)}static createV1(e,t){return Mt.create(1,e,t)}static decode(e){const[t,n]=Mt.decodeFirst(e);if(0!==n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){const t=Mt.inspectBytes(e),n=t.size-t.multihashSize,r=ae(e.subarray(n,n+t.multihashSize));if(r.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=r.subarray(t.multihashSize-t.digestSize),o=new kt(t.multihashCode,t.digestSize,i,r);return[0===t.version?Mt.createV0(o):Mt.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0;const n=()=>{const[n,r]=yt(e.subarray(t));return t+=r,n};let r=n(),i=Dt;if(18===r?(r=0,t=0):i=n(),0!==r&&1!==r)throw new RangeError("Invalid CID version ".concat(r));const o=t,s=n(),a=n(),l=t+a;return{version:r,codec:i,multihashCode:s,digestSize:a,multihashSize:l-o,size:l}}static parse(e,t){const[n,r]=function(e,t){switch(e[0]){case"Q":{const n=null!==t&&void 0!==t?t:ze;return[ze.prefix,n.decode("".concat(ze.prefix).concat(e))]}case ze.prefix:{const n=null!==t&&void 0!==t?t:ze;return[ze.prefix,n.decode(e)]}case Pe.prefix:{const n=null!==t&&void 0!==t?t:Pe;return[Pe.prefix,n.decode(e)]}case De.prefix:{const n=null!==t&&void 0!==t?t:De;return[De.prefix,n.decode(e)]}default:if(null==t)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}(e,t),i=Mt.decode(r);if(0===i.version&&"Q"!==e[0])throw Error("Version 0 CID string must not include multibase prefix");return Nt(i).set(n,e),i}}const Dt=112,Ot=18;function zt(e,t,n){const r=bt(e),i=r+bt(t),o=new Uint8Array(i+n.byteLength);return wt(e,o,0),wt(t,o,r),o.set(n,i),o}const Ft=Symbol.for("@ipld/js-cid/CID"),Ut=E(E(E(E(E(E(E(E(E(E({},u),r),c),e),t),o),s),a),l),i);E(E({},p),f);function Bt(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const qt=Bt("utf8","u",(e=>"u"+new TextDecoder("utf8").decode(e)),(e=>(new TextEncoder).encode(e.substring(1)))),Vt=Bt("ascii","a",(e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}),(e=>{const t=ee((e=e.substring(1)).length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t})),Kt=E({utf8:qt,"utf-8":qt,hex:Ut.base16,latin1:Vt,ascii:Vt,binary:Vt},Ut);function jt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=Kt[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return n.decoder.decode("".concat(n.prefix).concat(e))}function Wt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";const n=Kt[t];if(null==n)throw new Error('Unsupported encoding "'.concat(t,'"'));return n.encoder.encode(e).substring(1)}const Ht=parseInt("11111",2),Qt=parseInt("10000000",2),Gt=parseInt("01111111",2),Yt={0:Zt,1:Zt,2:function(e,t){const n=Xt(e,t),r=t.offset,i=t.offset+n,o=[];for(let s=r;s<i;s++)s===r&&0===e[s]||o.push(e[s]);return t.offset+=n,Uint8Array.from(o)},3:function(e,t){const n=Xt(e,t),r=e[t.offset];t.offset++;const i=e.subarray(t.offset,t.offset+n-1);if(t.offset+=n,0!==r)throw new Error("Unused bits in bit string is unimplemented");return i},4:function(e,t){const n=Xt(e,t),r=e.subarray(t.offset,t.offset+n);return t.offset+=n,r},5:function(e,t){return t.offset++,null},6:function(e,t){const n=Xt(e,t),r=t.offset+n,i=e[t.offset];t.offset++;let o=0,s=0;i<40?(o=0,s=i):i<80?(o=1,s=i-40):(o=2,s=i-80);let a="".concat(o,".").concat(s),l=[];for(;t.offset<r;){const n=e[t.offset];if(t.offset++,l.push(127&n),n<128){l.reverse();let e=0;for(let t=0;t<l.length;t++)e+=l[t]<<7*t;a+=".".concat(e),l=[]}}return a},16:Zt,22:Zt,48:Zt};function $t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{offset:0};const n=e[t.offset]&Ht;if(t.offset++,null!=Yt[n])return Yt[n](e,t);throw new Error("No decoder for tag "+n)}function Xt(e,t){let n=0;if((e[t.offset]&Qt)===Qt){const r=e[t.offset]&Gt;let i="0x";t.offset++;for(let n=0;n<r;n++,t.offset++)i+=e[t.offset].toString(16).padStart(2,"0");n=parseInt(i,16)}else n=e[t.offset],t.offset++;return n}function Zt(e,t){Xt(e,t);const n=[];for(;!(t.offset>=e.byteLength);){const r=$t(e,t);if(null===r)break;n.push(r)}return n}function Jt(e){if(e.byteLength<128)return Uint8Array.from([e.byteLength]);const t=function(e){let t=e.toString(16);t.length%2===1&&(t="0"+t);const n=new se;for(let r=0;r<t.length;r+=2)n.append(Uint8Array.from([parseInt("".concat(t[r]).concat(t[r+1]),16)]));return n}(e.byteLength);return new se(Uint8Array.from([t.byteLength|Qt]),t)}function en(e){const t=new se;return 128===(128&e.subarray()[0])&&t.append(Uint8Array.from([0])),t.append(e),new se(Uint8Array.from([2]),Jt(t),t)}function tn(e){const t=Uint8Array.from([0]),n=new se(t,e);return new se(Uint8Array.from([3]),Jt(n),n)}function nn(e){return new se(Uint8Array.from([4]),Jt(e),e)}function rn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:48;const n=new se;for(const r of e)n.append(r);return new se(Uint8Array.from([t]),Jt(n),n)}class on{constructor(e){w(this,"type","ECDSA"),w(this,"jwk",void 0),w(this,"_raw",void 0),this.jwk=e}get raw(){return null==this._raw&&(this._raw=function(e){var t,n;return rn([en(Uint8Array.from([1])),rn([yn(e.crv)],160),rn([tn(new se(Uint8Array.from([4]),jt(null!==(t=e.x)&&void 0!==t?t:"","base64url"),jt(null!==(n=e.y)&&void 0!==n?n:"","base64url")))],161)]).subarray()}(this.jwk)),this._raw}toMultihash(){return Ct.digest(Qs(this))}toCID(){return Mt.createV1(114,this.toMultihash())}toString(){return ze.encode(this.toMultihash().bytes).substring(1)}equals(e){return null!=e&&e.raw instanceof Uint8Array&&ne(this.raw,e.raw)}async verify(e,t){return async function(e,t,n){var r;const i=await crypto.subtle.importKey("jwk",e,{name:"ECDSA",namedCurve:null!==(r=e.crv)&&void 0!==r?r:"P-256"},!1,["verify"]);return crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},i,t,n.subarray())}(this.jwk,t,e)}}class sn{constructor(e){w(this,"type","ECDSA"),w(this,"jwk",void 0),w(this,"publicKey",void 0),w(this,"_raw",void 0),this.jwk=e,this.publicKey=new on({crv:e.crv,ext:e.ext,key_ops:["verify"],kty:"EC",x:e.x,y:e.y})}get raw(){return null==this._raw&&(this._raw=function(e){var t,n,r;return rn([en(Uint8Array.from([1])),nn(jt(null!==(t=e.d)&&void 0!==t?t:"","base64url")),rn([yn(e.crv)],160),rn([tn(new se(Uint8Array.from([4]),jt(null!==(n=e.x)&&void 0!==n?n:"","base64url"),jt(null!==(r=e.y)&&void 0!==r?r:"","base64url")))],161)]).subarray()}(this.jwk)),this._raw}equals(e){return null!=e&&e.raw instanceof Uint8Array&&ne(this.raw,e.raw)}async sign(e){return async function(e,t){var n;const r=await crypto.subtle.importKey("jwk",e,{name:"ECDSA",namedCurve:null!==(n=e.crv)&&void 0!==n?n:"P-256"},!1,["sign"]),i=await crypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},r,t.subarray());return new Uint8Array(i,0,i.byteLength)}(this.jwk,e)}}const an=Uint8Array.from([6,8,42,134,72,206,61,3,1,7]),ln=Uint8Array.from([6,5,43,129,4,0,34]),cn=Uint8Array.from([6,5,43,129,4,0,35]),un={ext:!0,kty:"EC",crv:"P-256"},dn={ext:!0,kty:"EC",crv:"P-384"},hn={ext:!0,kty:"EC",crv:"P-521"},fn=32,pn=48,gn=66;function mn(e){return function(e){const t=e[1],n=Wt(t,"base64url"),r=e[2][1][0],i=1;let o,s;if(t.byteLength===fn)return o=Wt(r.subarray(i,i+fn),"base64url"),s=Wt(r.subarray(i+fn),"base64url"),new sn(E(E({},un),{},{key_ops:["sign"],d:n,x:o,y:s}));if(t.byteLength===pn)return o=Wt(r.subarray(i,i+pn),"base64url"),s=Wt(r.subarray(i+pn),"base64url"),new sn(E(E({},dn),{},{key_ops:["sign"],d:n,x:o,y:s}));if(t.byteLength===gn)return o=Wt(r.subarray(i,i+gn),"base64url"),s=Wt(r.subarray(i+gn),"base64url"),new sn(E(E({},hn),{},{key_ops:["sign"],d:n,x:o,y:s}));throw new C("Private key length was wrong length, got ".concat(t.byteLength,", expected 32, 48 or 66"))}($t(e))}function vn(e){return function(e){const t=e[1][1][0],n=1;let r,i;if(65===t.byteLength)return r=Wt(t.subarray(n,n+fn),"base64url"),i=Wt(t.subarray(n+fn),"base64url"),new on(E(E({},un),{},{key_ops:["verify"],x:r,y:i}));if(97===t.byteLength)return r=Wt(t.subarray(n,n+pn),"base64url"),i=Wt(t.subarray(n+pn),"base64url"),new on(E(E({},dn),{},{key_ops:["verify"],x:r,y:i}));if(133===t.byteLength)return r=Wt(t.subarray(n,n+gn),"base64url"),i=Wt(t.subarray(n+gn),"base64url"),new on(E(E({},hn),{},{key_ops:["verify"],x:r,y:i}));throw new C("coordinates were wrong length, got ".concat(t.byteLength,", expected 65, 97 or 133"))}($t(e))}function yn(e){if("P-256"===e)return an;if("P-384"===e)return ln;if("P-521"===e)return cn;throw new C("Invalid curve ".concat(e))}async function wn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"P-256";const t=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"P-256";const t=await crypto.subtle.generateKey({name:"ECDSA",namedCurve:e},!0,["sign","verify"]);return{publicKey:await crypto.subtle.exportKey("jwk",t.publicKey),privateKey:await crypto.subtle.exportKey("jwk",t.privateKey)}}(e);return new sn(t.privateKey)}const bn="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function En(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Sn(e){if(!((t=e)instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name))throw new Error("Uint8Array expected");for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(r.length>0&&!r.includes(e.length))throw new Error("Uint8Array expected of length "+r+", got length="+e.length)}function kn(e){if("function"!==typeof e||"function"!==typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");En(e.outputLen),En(e.blockLen)}function xn(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Cn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;r++)t[r].fill(0)}function Pn(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function An(e,t){return e<<32-t|e>>>t}function In(e){if("string"!==typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function _n(e){return"string"===typeof e&&(e=In(e)),Sn(e),e}class Tn{}function Ln(e){const t=t=>e().update(_n(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Rn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(bn&&"function"===typeof bn.getRandomValues)return bn.getRandomValues(new Uint8Array(e));if(bn&&"function"===typeof bn.randomBytes)return Uint8Array.from(bn.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function Nn(e,t,n){return e&t^e&n^t&n}class Mn extends Tn{constructor(e,t,n,r){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.buffer=new Uint8Array(e),this.view=Pn(this.buffer)}update(e){xn(this),Sn(e=_n(e));const{view:t,buffer:n,blockLen:r}=this,i=e.length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=Pn(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){xn(this),function(e,t){Sn(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,Cn(this.buffer.subarray(o)),this.padOffset>r-o&&(this.process(n,0),o=0);for(let u=o;u<r;u++)t[u]=0;!function(e,t,n,r){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),l=r?4:0,c=r?0:4;e.setUint32(t+l,s,r),e.setUint32(t+c,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=Pn(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=a/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)s.setUint32(4*u,c[u],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.destroyed=o,e.finished=i,e.length=r,e.pos=s,r%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const Dn=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),On=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),zn=BigInt(2**32-1),Fn=BigInt(32);function Un(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&zn),l:Number(e>>Fn&zn)}:{h:0|Number(e>>Fn&zn),l:0|Number(e&zn)}}function Bn(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let o=0;o<n;o++){const{h:n,l:s}=Un(e[o],t);[r[o],i[o]]=[n,s]}return[r,i]}const qn=(e,t,n)=>e>>>n,Vn=(e,t,n)=>e<<32-n|t>>>n,Kn=(e,t,n)=>e>>>n|t<<32-n,jn=(e,t,n)=>e<<32-n|t>>>n,Wn=(e,t,n)=>e<<64-n|t>>>n-32,Hn=(e,t,n)=>e>>>n-32|t<<64-n;function Qn(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}}const Gn=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Yn=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,$n=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Xn=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,Zn=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),Jn=(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,er=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),tr=new Uint32Array(64);class nr extends Mn{constructor(){super(64,arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,8,!1),this.A=0|Dn[0],this.B=0|Dn[1],this.C=0|Dn[2],this.D=0|Dn[3],this.E=0|Dn[4],this.F=0|Dn[5],this.G=0|Dn[6],this.H=0|Dn[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[e,t,n,r,i,o,s,a]}set(e,t,n,r,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let d=0;d<16;d++,t+=4)tr[d]=e.getUint32(t,!1);for(let d=16;d<64;d++){const e=tr[d-15],t=tr[d-2],n=An(e,7)^An(e,18)^e>>>3,r=An(t,17)^An(t,19)^t>>>10;tr[d]=r+tr[d-7]+n+tr[d-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:l,H:c}=this;for(let d=0;d<64;d++){const e=c+(An(s,6)^An(s,11)^An(s,25))+((u=s)&a^~u&l)+er[d]+tr[d]|0,t=(An(n,2)^An(n,13)^An(n,22))+Nn(n,r,i)|0;c=l,l=a,a=s,s=o+e|0,o=i,i=r,r=n,n=e+t|0}var u;n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,r,i,o,s,a,l,c)}roundClean(){Cn(tr)}destroy(){this.set(0,0,0,0,0,0,0,0),Cn(this.buffer)}}const rr=(()=>Bn(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),ir=(()=>rr[0])(),or=(()=>rr[1])(),sr=new Uint32Array(80),ar=new Uint32Array(80);class lr extends Mn{constructor(){super(128,arguments.length>0&&void 0!==arguments[0]?arguments[0]:64,16,!1),this.Ah=0|On[0],this.Al=0|On[1],this.Bh=0|On[2],this.Bl=0|On[3],this.Ch=0|On[4],this.Cl=0|On[5],this.Dh=0|On[6],this.Dl=0|On[7],this.Eh=0|On[8],this.El=0|On[9],this.Fh=0|On[10],this.Fl=0|On[11],this.Gh=0|On[12],this.Gl=0|On[13],this.Hh=0|On[14],this.Hl=0|On[15]}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:l,El:c,Fh:u,Fl:d,Gh:h,Gl:f,Hh:p,Hl:g}=this;return[e,t,n,r,i,o,s,a,l,c,u,d,h,f,p,g]}set(e,t,n,r,i,o,s,a,l,c,u,d,h,f,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|l,this.El=0|c,this.Fh=0|u,this.Fl=0|d,this.Gh=0|h,this.Gl=0|f,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let y=0;y<16;y++,t+=4)sr[y]=e.getUint32(t),ar[y]=e.getUint32(t+=4);for(let y=16;y<80;y++){const e=0|sr[y-15],t=0|ar[y-15],n=Kn(e,t,1)^Kn(e,t,8)^qn(e,0,7),r=jn(e,t,1)^jn(e,t,8)^Vn(e,t,7),i=0|sr[y-2],o=0|ar[y-2],s=Kn(i,o,19)^Wn(i,o,61)^qn(i,0,6),a=jn(i,o,19)^Hn(i,o,61)^Vn(i,o,6),l=$n(r,a,ar[y-7],ar[y-16]),c=Xn(l,n,s,sr[y-7],sr[y-16]);sr[y]=0|c,ar[y]=0|l}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:l,Dl:c,Eh:u,El:d,Fh:h,Fl:f,Gh:p,Gl:g,Hh:m,Hl:v}=this;for(let y=0;y<80;y++){const e=Kn(u,d,14)^Kn(u,d,18)^Wn(u,d,41),t=jn(u,d,14)^jn(u,d,18)^Hn(u,d,41),w=u&h^~u&p,b=Zn(v,t,d&f^~d&g,or[y],ar[y]),E=Jn(b,m,e,w,ir[y],sr[y]),S=0|b,k=Kn(n,r,28)^Wn(n,r,34)^Wn(n,r,39),x=jn(n,r,28)^Hn(n,r,34)^Hn(n,r,39),C=n&i^n&s^i&s,P=r&o^r&a^o&a;m=0|p,v=0|g,p=0|h,g=0|f,h=0|u,f=0|d,({h:u,l:d}=Qn(0|l,0|c,0|E,0|S)),l=0|s,c=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const A=Gn(S,x,P);n=Yn(A,E,k,C),r=0|A}({h:n,l:r}=Qn(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=Qn(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=Qn(0|this.Ch,0|this.Cl,0|s,0|a)),({h:l,l:c}=Qn(0|this.Dh,0|this.Dl,0|l,0|c)),({h:u,l:d}=Qn(0|this.Eh,0|this.El,0|u,0|d)),({h:h,l:f}=Qn(0|this.Fh,0|this.Fl,0|h,0|f)),({h:p,l:g}=Qn(0|this.Gh,0|this.Gl,0|p,0|g)),({h:m,l:v}=Qn(0|this.Hh,0|this.Hl,0|m,0|v)),this.set(n,r,i,o,s,a,l,c,u,d,h,f,p,g,m,v)}roundClean(){Cn(sr,ar)}destroy(){Cn(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const cr=Ln((()=>new nr)),ur=Ln((()=>new lr)),dr=BigInt(0),hr=BigInt(1);function fr(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function pr(e){if(!fr(e))throw new Error("Uint8Array expected")}function gr(e,t){if("boolean"!==typeof t)throw new Error(e+" boolean expected, got "+t)}function mr(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function vr(e){if("string"!==typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?dr:BigInt("0x"+e)}const yr="function"===typeof Uint8Array.from([]).toHex&&"function"===typeof Uint8Array.fromHex,wr=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function br(e){if(pr(e),yr)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=wr[e[n]];return t}const Er=48,Sr=57,kr=65,xr=70,Cr=97,Pr=102;function Ar(e){return e>=Er&&e<=Sr?e-Er:e>=kr&&e<=xr?e-(kr-10):e>=Cr&&e<=Pr?e-(Cr-10):void 0}function Ir(e){if("string"!==typeof e)throw new Error("hex string expected, got "+typeof e);if(yr)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let i=0,o=0;i<n;i++,o+=2){const t=Ar(e.charCodeAt(o)),n=Ar(e.charCodeAt(o+1));if(void 0===t||void 0===n){const t=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+o)}r[i]=16*t+n}return r}function _r(e){return vr(br(e))}function Tr(e){return pr(e),vr(br(Uint8Array.from(e).reverse()))}function Lr(e,t){return Ir(e.toString(16).padStart(2*t,"0"))}function Rr(e,t){return Lr(e,t).reverse()}function Nr(e,t,n){let r;if("string"===typeof t)try{r=Ir(t)}catch(o){throw new Error(e+" must be hex string or Uint8Array, cause: "+o)}else{if(!fr(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}const i=r.length;if("number"===typeof n&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}function Mr(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];pr(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,r=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,r),r+=e.length}return t}const Dr=e=>"bigint"===typeof e&&dr<=e;function Or(e,t,n){return Dr(e)&&Dr(t)&&Dr(n)&&t<=e&&e<n}function zr(e,t,n,r){if(!Or(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}const Fr=e=>(hr<<BigInt(e))-hr,Ur=e=>new Uint8Array(e),Br=e=>Uint8Array.from(e);const qr={bigint:e=>"bigint"===typeof e,function:e=>"function"===typeof e,boolean:e=>"boolean"===typeof e,string:e=>"string"===typeof e,stringOrUint8Array:e=>"string"===typeof e||fr(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"===typeof e&&Number.isSafeInteger(e.outputLen)};function Vr(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(t,n,r)=>{const i=qr[n];if("function"!==typeof i)throw new Error("invalid validator function");const o=e[t];if((!r||void 0!==o)&&!i(o,e))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+o)};for(const[i,o]of Object.entries(t))r(i,o,!1);for(const[i,o]of Object.entries(n))r(i,o,!0);return e}function Kr(e){const t=new WeakMap;return function(n){const r=t.get(n);if(void 0!==r)return r;for(var i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];const a=e(n,...o);return t.set(n,a),a}}const jr=BigInt(0),Wr=BigInt(1),Hr=BigInt(2),Qr=BigInt(3),Gr=BigInt(4),Yr=BigInt(5),$r=BigInt(8);function Xr(e,t){const n=e%t;return n>=jr?n:t+n}function Zr(e,t,n){let r=e;for(;t-- >jr;)r*=r,r%=n;return r}function Jr(e,t){if(e===jr)throw new Error("invert: expected non-zero number");if(t<=jr)throw new Error("invert: expected positive modulus, got "+t);let n=Xr(e,t),r=t,i=jr,o=Wr,s=Wr,a=jr;for(;n!==jr;){const e=r/n,t=r%n,l=i-s*e,c=o-a*e;r=n,n=t,i=s,o=a,s=l,a=c}if(r!==Wr)throw new Error("invert: does not exist");return Xr(i,t)}function ei(e,t){const n=(e.ORDER+Wr)/Gr,r=e.pow(t,n);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}function ti(e,t){const n=(e.ORDER-Yr)/$r,r=e.mul(t,Hr),i=e.pow(r,n),o=e.mul(t,i),s=e.mul(e.mul(o,Hr),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function ni(e){return e%Gr===Qr?ei:e%$r===Yr?ti:function(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-Wr,n=0;for(;t%Hr===jr;)t/=Hr,n++;let r=Hr;const i=li(e);for(;1===si(i,r);)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===n)return ei;let o=i.pow(r,t);const s=(t+Wr)/Hr;return function(e,r){if(e.is0(r))return r;if(1!==si(e,r))throw new Error("Cannot find square root");let i=n,a=e.mul(e.ONE,o),l=e.pow(r,t),c=e.pow(r,s);for(;!e.eql(l,e.ONE);){if(e.is0(l))return e.ZERO;let t=1,n=e.sqr(l);for(;!e.eql(n,e.ONE);)if(t++,n=e.sqr(n),t===i)throw new Error("Cannot find square root");const r=Wr<<BigInt(i-t-1),o=e.pow(a,r);i=t,a=e.sqr(o),l=e.mul(l,a),c=e.mul(c,o)}return c}}(e)}const ri=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ii(e,t,n){if(n<jr)throw new Error("invalid exponent, negatives unsupported");if(n===jr)return e.ONE;if(n===Wr)return t;let r=e.ONE,i=t;for(;n>jr;)n&Wr&&(r=e.mul(r,i)),i=e.sqr(i),n>>=Wr;return r}function oi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce(((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n))),e.ONE),o=e.inv(i);return t.reduceRight(((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n))),o),r}function si(e,t){const n=(e.ORDER-Wr)/Hr,r=e.pow(t,n),i=e.eql(r,e.ONE),o=e.eql(r,e.ZERO),s=e.eql(r,e.neg(e.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function ai(e,t){void 0!==t&&En(t);const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function li(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e<=jr)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:o}=ai(e,t);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s;const a=Object.freeze({ORDER:e,isLE:n,BITS:i,BYTES:o,MASK:Fr(i),ZERO:jr,ONE:Wr,create:t=>Xr(t,e),isValid:t=>{if("bigint"!==typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return jr<=t&&t<e},is0:e=>e===jr,isOdd:e=>(e&Wr)===Wr,neg:t=>Xr(-t,e),eql:(e,t)=>e===t,sqr:t=>Xr(t*t,e),add:(t,n)=>Xr(t+n,e),sub:(t,n)=>Xr(t-n,e),mul:(t,n)=>Xr(t*n,e),pow:(e,t)=>ii(a,e,t),div:(t,n)=>Xr(t*Jr(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>Jr(t,e),sqrt:r.sqrt||(t=>(s||(s=ni(e)),s(a,t))),toBytes:e=>n?Rr(e,o):Lr(e,o),fromBytes:e=>{if(e.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return n?Tr(e):_r(e)},invertBatch:e=>oi(a,e),cmov:(e,t,n)=>n?t:e});return Object.freeze(a)}function ci(e){if("bigint"!==typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function ui(e){const t=ci(e);return t+Math.ceil(t/2)}const di=BigInt(0),hi=BigInt(1);function fi(e,t){const n=t.negate();return e?n:t}function pi(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function gi(e,t){pi(e,t);const n=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:Fr(e),maxNumber:n,shiftBy:BigInt(e)}}function mi(e,t,n){const{windowSize:r,mask:i,maxNumber:o,shiftBy:s}=n;let a=Number(e&i),l=e>>s;a>r&&(a-=o,l+=hi);const c=t*r;return{nextN:l,offset:c+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:t%2!==0,offsetF:c}}function vi(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)}))}function yi(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)}))}const wi=new WeakMap,bi=new WeakMap;function Ei(e){return bi.get(e)||1}function Si(e,t){return{constTimeNegate:fi,hasPrecomputes:e=>1!==Ei(e),unsafeLadder(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.ZERO,i=t;for(;n>di;)n&hi&&(r=r.add(i)),i=i.double(),n>>=hi;return r},precomputeWindow(e,n){const{windows:r,windowSize:i}=gi(n,t),o=[];let s=e,a=s;for(let t=0;t<r;t++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(n,r,i){let o=e.ZERO,s=e.BASE;const a=gi(n,t);for(let e=0;e<a.windows;e++){const{nextN:t,offset:n,isZero:l,isNeg:c,isNegF:u,offsetF:d}=mi(i,e,a);i=t,l?s=s.add(fi(u,r[d])):o=o.add(fi(c,r[n]))}return{p:o,f:s}},wNAFUnsafe(n,r,i){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.ZERO;const s=gi(n,t);for(let e=0;e<s.windows&&i!==di;e++){const{nextN:t,offset:n,isZero:a,isNeg:l}=mi(i,e,s);if(i=t,!a){const e=r[n];o=o.add(l?e.negate():e)}}return o},getPrecomputes(e,t,n){let r=wi.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&wi.set(t,n(r))),r},wNAFCached(e,t,n){const r=Ei(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)},wNAFCachedUnsafe(e,t,n,r){const i=Ei(e);return 1===i?this.unsafeLadder(e,t,r):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,r)},setWindowSize(e,n){pi(n,t),bi.set(e,n),wi.delete(e)}}}function ki(e,t,n,r){vi(n,e),yi(r,t);const i=n.length,o=r.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,a=function(e){let t;for(t=0;e>dr;e>>=hr,t+=1);return t}(BigInt(i));let l=1;a>12?l=a-3:a>4?l=a-2:a>0&&(l=2);const c=Fr(l),u=new Array(Number(c)+1).fill(s);let d=s;for(let h=Math.floor((t.BITS-1)/l)*l;h>=0;h-=l){u.fill(s);for(let t=0;t<o;t++){const e=r[t],i=Number(e>>BigInt(h)&c);u[i]=u[i].add(n[t])}let e=s;for(let t=u.length-1,n=s;t>0;t--)n=n.add(u[t]),e=e.add(n);if(d=d.add(e),0!==h)for(let t=0;t<l;t++)d=d.double()}return d}function xi(e){return function(e){const t=ri.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});Vr(e,t)}(e.Fp),Vr(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze(E(E(E({},ai(e.n,e.nBitLength)),e),{p:e.Fp.ORDER}))}const Ci=BigInt(0),Pi=BigInt(1),Ai=BigInt(2),Ii=BigInt(8),_i={zip215:!0};function Ti(e){const t=function(e){const t=xi(e);return Vr(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze(E({},t))}(e),{Fp:n,n:r,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:l}=t,c=Ai<<BigInt(8*a)-Pi,u=n.create,d=li(t.n,t.nBitLength);if(!function(e,r){const i=n.sqr(e),o=n.sqr(r),s=n.add(n.mul(t.a,i),o),a=n.add(n.ONE,n.mul(t.d,n.mul(i,o)));return n.eql(s,a)}(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const h=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:n.sqrt(e*n.inv(t))}}catch(r){return{isValid:!1,value:Ci}}}),f=t.adjustScalarBytes||(e=>e),p=t.domain||((e,t,n)=>{if(gr("phflag",n),t.length||n)throw new Error("Contexts/pre-hash are not supported");return e});function g(e,t){zr("coordinate "+e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2]?Pi:Ci,c)}function m(e){if(!(e instanceof w))throw new Error("ExtendedPoint expected")}const v=Kr(((e,t)=>{const{ex:r,ey:i,ez:o}=e,s=e.is0();null==t&&(t=s?Ii:n.inv(o));const a=u(r*t),l=u(i*t),c=u(o*t);if(s)return{x:Ci,y:Pi};if(c!==Pi)throw new Error("invZ was invalid");return{x:a,y:l}})),y=Kr((e=>{const{a:n,d:r}=t;if(e.is0())throw new Error("bad point: ZERO");const{ex:i,ey:o,ez:s,et:a}=e,l=u(i*i),c=u(o*o),d=u(s*s),h=u(d*d),f=u(l*n);if(u(d*u(f+c))!==u(h+u(r*u(l*c))))throw new Error("bad point: equation left != right (1)");if(u(i*o)!==u(s*a))throw new Error("bad point: equation left != right (2)");return!0}));class w{constructor(e,t,n,r){g("x",e),g("y",t),g("z",n,!0),g("t",r),this.ex=e,this.ey=t,this.ez=n,this.et=r,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw new Error("extended point not allowed");const{x:t,y:n}=e||{};return g("x",t),g("y",n),new w(t,n,Pi,u(t*n))}static normalizeZ(e){const t=oi(n,e.map((e=>e.ez)));return e.map(((e,n)=>e.toAffine(t[n]))).map(w.fromAffine)}static msm(e,t){return ki(w,d,e,t)}_setWindowSize(e){k.setWindowSize(this,e)}assertValidity(){y(this)}equals(e){m(e);const{ex:t,ey:n,ez:r}=this,{ex:i,ey:o,ez:s}=e,a=u(t*s),l=u(i*r),c=u(n*s),d=u(o*r);return a===l&&c===d}is0(){return this.equals(w.ZERO)}negate(){return new w(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:e}=t,{ex:n,ey:r,ez:i}=this,o=u(n*n),s=u(r*r),a=u(Ai*u(i*i)),l=u(e*o),c=n+r,d=u(u(c*c)-o-s),h=l+s,f=h-a,p=l-s,g=u(d*f),m=u(h*p),v=u(d*p),y=u(f*h);return new w(g,m,y,v)}add(e){m(e);const{a:n,d:r}=t,{ex:i,ey:o,ez:s,et:a}=this,{ex:l,ey:c,ez:d,et:h}=e,f=u(i*l),p=u(o*c),g=u(a*r*h),v=u(s*d),y=u((i+o)*(l+c)-f-p),b=v-g,E=v+g,S=u(p-n*f),k=u(y*b),x=u(E*S),C=u(y*S),P=u(b*E);return new w(k,x,P,C)}subtract(e){return this.add(e.negate())}wNAF(e){return k.wNAFCached(this,e,w.normalizeZ)}multiply(e){const t=e;zr("scalar",t,Pi,r);const{p:n,f:i}=this.wNAF(t);return w.normalizeZ([n,i])[0]}multiplyUnsafe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.ZERO;const n=e;return zr("scalar",n,Ci,r),n===Ci?S:this.is0()||n===Pi?this:k.wNAFCachedUnsafe(this,n,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return k.unsafeLadder(this,r).is0()}toAffine(e){return v(this,e)}clearCofactor(){const{h:e}=t;return e===Pi?this:this.multiplyUnsafe(e)}static fromHex(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{d:i,a:o}=t,s=n.BYTES;e=Nr("pointHex",e,s),gr("zip215",r);const a=e.slice(),l=e[s-1];a[s-1]=-129&l;const d=Tr(a),f=r?c:n.ORDER;zr("pointHex.y",d,Ci,f);const p=u(d*d),g=u(p-Pi),m=u(i*p-o);let{isValid:v,value:y}=h(g,m);if(!v)throw new Error("Point.fromHex: invalid y coordinate");const b=(y&Pi)===Pi,E=0!==(128&l);if(!r&&y===Ci&&E)throw new Error("Point.fromHex: x=0 and x_0=1");return E!==b&&(y=u(-y)),w.fromAffine({x:y,y:d})}static fromPrivateKey(e){const{scalar:t}=P(e);return b.multiply(t)}toRawBytes(){const{x:e,y:t}=this.toAffine(),r=Rr(t,n.BYTES);return r[r.length-1]|=e&Pi?128:0,r}toHex(){return br(this.toRawBytes())}}w.BASE=new w(t.Gx,t.Gy,Pi,u(t.Gx*t.Gy)),w.ZERO=new w(Ci,Pi,Pi,Ci);const{BASE:b,ZERO:S}=w,k=Si(w,8*a);function x(e){return Xr(e,r)}function C(e){return x(Tr(e))}function P(e){const t=n.BYTES;e=Nr("private key",e,t);const r=Nr("hashed private key",o(e),2*t),i=f(r.slice(0,t));return{head:i,prefix:r.slice(t,2*t),scalar:C(i)}}function A(e){const{head:t,prefix:n,scalar:r}=P(e),i=b.multiply(r),o=i.toRawBytes();return{head:t,prefix:n,scalar:r,point:i,pointBytes:o}}function I(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Uint8Array.of();for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=Mr(...n);return C(o(p(s,Nr("context",e),!!i)))}const _=_i;b._setWindowSize(8);const T={getExtendedPublicKey:A,randomPrivateKey:()=>s(n.BYTES),precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};return{CURVE:t,getPublicKey:function(e){return A(e).pointBytes},sign:function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=Nr("message",e),i&&(e=i(e));const{prefix:s,scalar:a,pointBytes:l}=A(t),c=I(o.context,s,e),u=b.multiply(c).toRawBytes(),d=x(c+I(o.context,u,l,e)*a);return zr("signature.s",d,Ci,r),Nr("result",Mr(u,Rr(d,n.BYTES)),2*n.BYTES)},verify:function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:_;const{context:s,zip215:a}=o,l=n.BYTES;e=Nr("signature",e,2*l),t=Nr("message",t),r=Nr("publicKey",r,l),void 0!==a&&gr("zip215",a),i&&(t=i(t));const c=Tr(e.slice(l,2*l));let u,d,h;try{u=w.fromHex(r,a),d=w.fromHex(e.slice(0,l),a),h=b.multiplyUnsafe(c)}catch(p){return!1}if(!a&&u.isSmallOrder())return!1;const f=I(s,d.toRawBytes(),u.toRawBytes(),t);return d.add(u.multiplyUnsafe(f)).subtract(h).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:T}}const Li=BigInt(0),Ri=BigInt(1),Ni=BigInt(2);function Mi(e){const t=(Vr(n=e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze(E({},n)));var n;const{P:r,type:i,adjustScalarBytes:o,powPminus2:s}=t,a="x25519"===i;if(!a&&"x448"!==i)throw new Error("invalid type");const l=a?255:448,c=a?32:56,u=a?BigInt(9):BigInt(5),d=a?BigInt(121665):BigInt(39081),h=a?Ni**BigInt(254):Ni**BigInt(447),f=a?BigInt(8)*Ni**BigInt(251)-Ri:BigInt(4)*Ni**BigInt(445)-Ri,p=h+f+Ri,g=e=>Xr(e,r),m=v(u);function v(e){return Rr(g(e),c)}function y(e,t){const n=function(e,t){zr("u",e,Li,r),zr("scalar",t,h,p);const n=t,i=e;let o=Ri,a=Li,c=e,u=Ri,f=Li;for(let r=BigInt(l-1);r>=Li;r--){const e=n>>r&Ri;f^=e,({x_2:o,x_3:c}=b(f,o,c)),({x_2:a,x_3:u}=b(f,a,u)),f=e;const t=o+a,s=g(t*t),l=o-a,h=g(l*l),p=s-h,m=c+u,v=g((c-u)*t),y=g(m*l),w=v+y,E=v-y;c=g(w*w),u=g(i*g(E*E)),o=g(s*h),a=g(p*(s+g(d*p)))}({x_2:o,x_3:c}=b(f,o,c)),({x_2:a,x_3:u}=b(f,a,u));const m=s(a);return g(o*m)}(function(e){const t=Nr("u coordinate",e,c);return a&&(t[31]&=127),g(Tr(t))}(t),function(e){return Tr(o(Nr("scalar",e,c)))}(e));if(n===Li)throw new Error("invalid private or public key received");return v(n)}function w(e){return y(e,m)}function b(e,t,n){const r=g(e*(t-n));return{x_2:t=g(t-r),x_3:n=g(n+r)}}return{scalarMult:y,scalarMultBase:w,getSharedSecret:(e,t)=>y(e,t),getPublicKey:e=>w(e),utils:{randomPrivateKey:()=>t.randomBytes(c)},GuBytes:m.slice()}}const Di=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Oi=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),zi=(BigInt(0),BigInt(1)),Fi=BigInt(2),Ui=BigInt(3),Bi=BigInt(5),qi=BigInt(8);function Vi(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),o=Di,s=e*e%o*e%o,a=Zr(s,Fi,o)*s%o,l=Zr(a,zi,o)*e%o,c=Zr(l,Bi,o)*l%o,u=Zr(c,t,o)*c%o,d=Zr(u,n,o)*u%o,h=Zr(d,r,o)*d%o,f=Zr(h,i,o)*h%o,p=Zr(f,i,o)*h%o,g=Zr(p,t,o)*c%o;return{pow_p_5_8:Zr(g,Fi,o)*e%o,b2:s}}function Ki(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function ji(e,t){const n=Di,r=Xr(t*t*t,n),i=Xr(r*r*t,n);let o=Xr(e*r*Vi(e*i).pow_p_5_8,n);const s=Xr(t*o*o,n),a=o,l=Xr(o*Oi,n),c=s===e,u=s===Xr(-e,n),d=s===Xr(-e*Oi,n);return c&&(o=a),(u||d)&&(o=l),((e,t)=>(Xr(e,t)&Wr)===Wr)(o,n)&&(o=Xr(-o,n)),{isValid:c||u,value:o}}const Wi=(()=>li(Di,void 0,!0))(),Hi=(()=>({a:Wi.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Wi,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:qi,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:ur,randomBytes:Rn,adjustScalarBytes:Ki,uvRatio:ji}))(),Qi=(()=>Ti(Hi))();const Gi=(()=>Mi({P:Di,type:"x25519",powPminus2:e=>{const t=Di,{pow_p_5_8:n,b2:r}=Vi(e);return Xr(Zr(n,Ui,t)*r,t)},adjustScalarBytes:Ki,randomBytes:Rn}))();const Yi=64;function $i(e,t){const n=new Uint8Array(Yi);for(let r=0;r<32;r++)n[r]=e[r],n[32+r]=t[r];return n}class Xi{constructor(e){w(this,"type","Ed25519"),w(this,"raw",void 0),this.raw=to(e,32)}toMultihash(){return Ct.digest(Qs(this))}toCID(){return Mt.createV1(114,this.toMultihash())}toString(){return ze.encode(this.toMultihash().bytes).substring(1)}equals(e){return null!=e&&e.raw instanceof Uint8Array&&ne(this.raw,e.raw)}verify(e,t){return function(e,t,n){return Qi.verify(t,n instanceof Uint8Array?n:n.subarray(),e)}(this.raw,t,e)}}class Zi{constructor(e,t){w(this,"type","Ed25519"),w(this,"raw",void 0),w(this,"publicKey",void 0),this.raw=to(e,Yi),this.publicKey=new Xi(t)}equals(e){return null!=e&&e.raw instanceof Uint8Array&&ne(this.raw,e.raw)}sign(e){return function(e,t){const n=e.subarray(0,32);return Qi.sign(t instanceof Uint8Array?t:t.subarray(),n)}(this.raw,e)}}function Ji(e){return e=to(e,32),new Xi(e)}async function eo(){const{privateKey:e,publicKey:t}=function(){const e=Qi.utils.randomPrivateKey(),t=Qi.getPublicKey(e);return{privateKey:$i(e,t),publicKey:t}}();return new Zi(e,t)}function to(e,t){if((e=Uint8Array.from(null!==e&&void 0!==e?e:[])).length!==t)throw new C("Key must be a Uint8Array of length ".concat(t,", got ").concat(e.length));return e}const no=Math.pow(2,7),ro=Math.pow(2,14),io=Math.pow(2,21),oo=Math.pow(2,28),so=Math.pow(2,35),ao=Math.pow(2,42),lo=Math.pow(2,49),co=128,uo=127;function ho(e){if(e<no)return 1;if(e<ro)return 2;if(e<io)return 3;if(e<oo)return 4;if(e<so)return 5;if(e<ao)return 6;if(e<lo)return 7;if(null!=Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function fo(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(ho(e)){case 8:t[n++]=255&e|co,e/=128;case 7:t[n++]=255&e|co,e/=128;case 6:t[n++]=255&e|co,e/=128;case 5:t[n++]=255&e|co,e/=128;case 4:t[n++]=255&e|co,e>>>=7;case 3:t[n++]=255&e|co,e>>>=7;case 2:t[n++]=255&e|co,e>>>=7;case 1:t[n++]=255&e,e>>>=7;break;default:throw new Error("unreachable")}return t}function po(e,t){let n=e[t],r=0;if(r+=n&uo,n<co)return r;if(n=e[t+1],r+=(n&uo)<<7,n<co)return r;if(n=e[t+2],r+=(n&uo)<<14,n<co)return r;if(n=e[t+3],r+=(n&uo)<<21,n<co)return r;if(n=e[t+4],r+=(n&uo)*oo,n<co)return r;if(n=e[t+5],r+=(n&uo)*so,n<co)return r;if(n=e[t+6],r+=(n&uo)*ao,n<co)return r;if(n=e[t+7],r+=(n&uo)*lo,n<co)return r;throw new RangeError("Could not decode varint")}function go(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null==t&&(t=ee(ho(e))),t instanceof Uint8Array?fo(e,t,n):function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;switch(ho(e)){case 8:t.set(n++,255&e|co),e/=128;case 7:t.set(n++,255&e|co),e/=128;case 6:t.set(n++,255&e|co),e/=128;case 5:t.set(n++,255&e|co),e/=128;case 4:t.set(n++,255&e|co),e>>>=7;case 3:t.set(n++,255&e|co),e>>>=7;case 2:t.set(n++,255&e|co),e>>>=7;case 1:t.set(n++,255&e),e>>>=7;break;default:throw new Error("unreachable")}return t}(e,t,n)}function mo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e instanceof Uint8Array?po(e,t):function(e,t){let n=e.get(t),r=0;if(r+=n&uo,n<co)return r;if(n=e.get(t+1),r+=(n&uo)<<7,n<co)return r;if(n=e.get(t+2),r+=(n&uo)<<14,n<co)return r;if(n=e.get(t+3),r+=(n&uo)<<21,n<co)return r;if(n=e.get(t+4),r+=(n&uo)*oo,n<co)return r;if(n=e.get(t+5),r+=(n&uo)*so,n<co)return r;if(n=e.get(t+6),r+=(n&uo)*ao,n<co)return r;if(n=e.get(t+7),r+=(n&uo)*lo,n<co)return r;throw new RangeError("Could not decode varint")}(e,t)}const vo=new Float32Array([-0]),yo=new Uint8Array(vo.buffer);function wo(e,t,n){vo[0]=e,t[n]=yo[0],t[n+1]=yo[1],t[n+2]=yo[2],t[n+3]=yo[3]}const bo=new Float64Array([-0]),Eo=new Uint8Array(bo.buffer);function So(e,t,n){bo[0]=e,t[n]=Eo[0],t[n+1]=Eo[1],t[n+2]=Eo[2],t[n+3]=Eo[3],t[n+4]=Eo[4],t[n+5]=Eo[5],t[n+6]=Eo[6],t[n+7]=Eo[7]}const ko=BigInt(Number.MAX_SAFE_INTEGER),xo=BigInt(Number.MIN_SAFE_INTEGER);class Co{constructor(e,t){w(this,"lo",void 0),w(this,"hi",void 0),this.lo=0|e,this.hi=0|t}toNumber(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.hi>>>31>0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(e+4294967296*t)}return this.lo+4294967296*this.hi}toBigInt(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){const e=1+~this.lo>>>0;let t=~this.hi>>>0;return 0===e&&(t=t+1>>>0),-(BigInt(e)+(BigInt(t)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.toBigInt(e).toString()}zzEncode(){const e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){const e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){const e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}static fromBigInt(e){if(0n===e)return Po;if(e<ko&&e>xo)return this.fromNumber(Number(e));const t=e<0n;t&&(e=-e);let n=e>>32n,r=e-(n<<32n);return t&&(n=0n|~n,r=0n|~r,++r>Ao&&(r=0n,++n>Ao&&(n=0n))),new Co(Number(r),Number(n))}static fromNumber(e){if(0===e)return Po;const t=e<0;t&&(e=-e);let n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new Co(n,r)}static from(e){return"number"===typeof e?Co.fromNumber(e):"bigint"===typeof e?Co.fromBigInt(e):"string"===typeof e?Co.fromBigInt(BigInt(e)):null!=e.low||null!=e.high?new Co(e.low>>>0,e.high>>>0):Po}}const Po=new Co(0,0);Po.toBigInt=function(){return 0n},Po.zzEncode=Po.zzDecode=function(){return this},Po.length=function(){return 1};const Ao=4294967296n;function Io(e,t,n){const r=n;let i,o;for(let s=0;s<e.length;++s)i=e.charCodeAt(s),i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&56320===(64512&(o=e.charCodeAt(s+1)))?(i=65536+((1023&i)<<10)+(1023&o),++s,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-r}function _o(e,t){return RangeError("index out of range: ".concat(e.pos," + ").concat(null!==t&&void 0!==t?t:1," > ").concat(e.len))}function To(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}class Lo{constructor(e){w(this,"buf",void 0),w(this,"pos",void 0),w(this,"len",void 0),w(this,"_slice",Uint8Array.prototype.subarray),this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,_o(this,10);return e}int32(){return 0|this.uint32()}sint32(){const e=this.uint32();return e>>>1^-(1&e)}bool(){return 0!==this.uint32()}fixed32(){if(this.pos+4>this.len)throw _o(this,4);return To(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw _o(this,4);return 0|To(this.buf,this.pos+=4)}float(){if(this.pos+4>this.len)throw _o(this,4);const e=(t=this.buf,n=this.pos,yo[0]=t[n],yo[1]=t[n+1],yo[2]=t[n+2],yo[3]=t[n+3],vo[0]);var t,n;return this.pos+=4,e}double(){if(this.pos+8>this.len)throw _o(this,4);const e=(t=this.buf,n=this.pos,Eo[0]=t[n],Eo[1]=t[n+1],Eo[2]=t[n+2],Eo[3]=t[n+3],Eo[4]=t[n+4],Eo[5]=t[n+5],Eo[6]=t[n+6],Eo[7]=t[n+7],bo[0]);var t,n;return this.pos+=8,e}bytes(){const e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw _o(this,e);return this.pos+=e,t===n?new Uint8Array(0):this.buf.subarray(t,n)}string(){const e=this.bytes();return function(e,t,n){if(n-t<1)return"";let r;const i=[];let o,s=0;for(;t<n;)o=e[t++],o<128?i[s++]=o:o>191&&o<224?i[s++]=(31&o)<<6|63&e[t++]:o>239&&o<365?(o=((7&o)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,i[s++]=55296+(o>>10),i[s++]=56320+(1023&o)):i[s++]=(15&o)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((null!==r&&void 0!==r?r:r=[]).push(String.fromCharCode.apply(String,i)),s=0);return null!=r?(s>0&&r.push(String.fromCharCode.apply(String,i.slice(0,s))),r.join("")):String.fromCharCode.apply(String,i.slice(0,s))}(e,0,e.length)}skip(e){if("number"===typeof e){if(this.pos+e>this.len)throw _o(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw _o(this)}while(0!==(128&this.buf[this.pos++]));return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type ".concat(e," at offset ").concat(this.pos))}return this}readLongVarint(){const e=new Co(0,0);let t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw _o(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw _o(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw _o(this,8);const e=To(this.buf,this.pos+=4),t=To(this.buf,this.pos+=4);return new Co(e,t)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const e=po(this.buf,this.pos);return this.pos+=ho(e),e}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function Ro(e,t,n){const r=function(e){return new Lo(e instanceof Uint8Array?e:e.subarray())}(e);return t.decode(r,void 0,n)}class No{constructor(e,t,n){w(this,"fn",void 0),w(this,"len",void 0),w(this,"next",void 0),w(this,"val",void 0),this.fn=e,this.len=t,this.next=void 0,this.val=n}}function Mo(){}class Do{constructor(e){w(this,"head",void 0),w(this,"tail",void 0),w(this,"len",void 0),w(this,"next",void 0),this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}}const Oo=function(e){const t=null!==e&&void 0!==e?e:8192,n=t>>>1;let r,i=t;return function(e){if(e<1||e>n)return ee(e);i+e>t&&(r=ee(t),i=0);const o=r.subarray(i,i+=e);return 0!==(7&i)&&(i=1+(7|i)),o}}();class zo{constructor(){w(this,"len",void 0),w(this,"head",void 0),w(this,"tail",void 0),w(this,"states",void 0),this.len=0,this.head=new No(Mo,0,0),this.tail=this.head,this.states=null}_push(e,t,n){return this.tail=this.tail.next=new No(e,t,n),this.len+=t,this}uint32(e){return this.len+=(this.tail=this.tail.next=new Bo((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(qo,10,Co.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){const t=Co.fromBigInt(e);return this._push(qo,t.length(),t)}uint64Number(e){return this._push(fo,ho(e),e)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){const t=Co.fromBigInt(e).zzEncode();return this._push(qo,t.length(),t)}sint64Number(e){const t=Co.fromNumber(e).zzEncode();return this._push(qo,t.length(),t)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(Fo,1,e?1:0)}fixed32(e){return this._push(Vo,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){const t=Co.fromBigInt(e);return this._push(Vo,4,t.lo)._push(Vo,4,t.hi)}fixed64Number(e){const t=Co.fromNumber(e);return this._push(Vo,4,t.lo)._push(Vo,4,t.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(wo,4,e)}double(e){return this._push(So,8,e)}bytes(e){const t=e.length>>>0;return 0===t?this._push(Fo,1,0):this.uint32(t)._push(Ko,t,e)}string(e){const t=function(e){let t=0,n=0;for(let r=0;r<e.length;++r)n=e.charCodeAt(r),n<128?t+=1:n<2048?t+=2:55296===(64512&n)&&56320===(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t}(e);return 0!==t?this.uint32(t)._push(Io,t,e):this._push(Fo,1,0)}fork(){return this.states=new Do(this),this.head=this.tail=new No(Mo,0,0),this.len=0,this}reset(){return null!=this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new No(Mo,0,0),this.len=0),this}ldelim(){const e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),0!==n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this}finish(){let e=this.head.next;const t=(n=this.len,null!=globalThis.Buffer?ee(n):Oo(n));var n;let r=0;for(;null!=e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t}}function Fo(e,t,n){t[n]=255&e}function Uo(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e}class Bo extends No{constructor(e,t){super(Uo,e,t),w(this,"next",void 0),this.next=void 0}}function qo(e,t,n){for(;0!==e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function Vo(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function Ko(e,t,n){t.set(e,n)}function jo(e,t,n){t.set(e,n)}function Wo(e,t,n){e.length<40?Io(e,t,n):null!=t.utf8Write?t.utf8Write(e,n):t.set(jt(e),n)}function Ho(e,t){const n=new zo;return t.encode(e,n,{lengthDelimited:!1}),n.finish()}var Qo,Go,Yo,$o,Xo;function Zo(e,t,n,r){return{name:e,type:t,encode:n,decode:r}}function Jo(e){function t(t){if(null==e[t.toString()])throw new Error("Invalid enum value");return e[t]}return Zo("enum",Qo.VARINT,(function(e,n){const r=t(e);n.int32(r)}),(function(e){return t(e.int32())}))}function es(e,t){return Zo("message",Qo.LENGTH_DELIMITED,e,t)}null!=globalThis.Buffer&&(zo.prototype.bytes=function(e){const t=e.length>>>0;return this.uint32(t),t>0&&this._push(jo,t,e),this},zo.prototype.string=function(e){const t=globalThis.Buffer.byteLength(e);return this.uint32(t),t>0&&this._push(Wo,t,e),this}),function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"}(Qo||(Qo={}));Error;class ts extends Error{constructor(){super(...arguments),w(this,"code","ERR_MAX_LENGTH"),w(this,"name","MaxLengthError")}}class ns extends Error{constructor(){super(...arguments),w(this,"code","ERR_MAX_SIZE"),w(this,"name","MaxSizeError")}}Error;Error;!function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.secp256k1="secp256k1",e.ECDSA="ECDSA"}(Go||(Go={})),function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.secp256k1=2]="secp256k1",e[e.ECDSA=3]="ECDSA"}(Yo||(Yo={})),function(e){e.codec=()=>Jo(Yo)}(Go||(Go={})),function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Go.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=Go.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}($o||($o={})),function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.Type&&(t.uint32(8),Go.codec().encode(e.Type,t)),null!=e.Data&&(t.uint32(18),t.bytes(e.Data)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.Type=Go.codec().decode(e);break;case 2:n.Data=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(Xo||(Xo={}));const rs=cr;class is extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"An error occurred while signing a message"),this.name="SigningError"}}class os extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"An error occurred while verifying a message"),this.name="VerificationError"}}class ss extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Missing Web Crypto API"),this.name="WebCryptoMissingError"}}const as={get(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==(null===e||void 0===e?void 0:e.subtle))throw new ss("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return e}};async function ls(e){const t=await as.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),n=await async function(e){if(null==e.privateKey||null==e.publicKey)throw new C("Private and public key are required");return Promise.all([as.get().subtle.exportKey("jwk",e.privateKey),as.get().subtle.exportKey("jwk",e.publicKey)])}(t);return{privateKey:n[0],publicKey:n[1]}}class cs{constructor(e,t){w(this,"type","RSA"),w(this,"jwk",void 0),w(this,"_raw",void 0),w(this,"_multihash",void 0),this.jwk=e,this._multihash=t}get raw(){return null==this._raw&&(this._raw=gs(this.jwk)),this._raw}toMultihash(){return this._multihash}toCID(){return Mt.createV1(114,this._multihash)}toString(){return ze.encode(this.toMultihash().bytes).substring(1)}equals(e){return null!=e&&e.raw instanceof Uint8Array&&ne(this.raw,e.raw)}verify(e,t){return async function(e,t,n){const r=await as.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return as.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,t,n instanceof Uint8Array?n:n.subarray())}(this.jwk,t,e)}}class us{constructor(e,t){w(this,"type","RSA"),w(this,"jwk",void 0),w(this,"_raw",void 0),w(this,"publicKey",void 0),this.jwk=e,this.publicKey=t}get raw(){return null==this._raw&&(this._raw=function(e){if(null==e.n||null==e.e||null==e.d||null==e.p||null==e.q||null==e.dp||null==e.dq||null==e.qi)throw new C("JWK was missing components");return rn([en(Uint8Array.from([0])),en(jt(e.n,"base64url")),en(jt(e.e,"base64url")),en(jt(e.d,"base64url")),en(jt(e.p,"base64url")),en(jt(e.q,"base64url")),en(jt(e.dp,"base64url")),en(jt(e.dq,"base64url")),en(jt(e.qi,"base64url"))]).subarray()}(this.jwk)),this._raw}equals(e){return null!=e&&e.raw instanceof Uint8Array&&ne(this.raw,e.raw)}sign(e){return async function(e,t){const n=await as.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),r=await as.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,t instanceof Uint8Array?t:t.subarray());return new Uint8Array(r,0,r.byteLength)}(this.jwk,e)}}const ds=8192,hs=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function fs(e){return{n:Wt(e[1],"base64url"),e:Wt(e[2],"base64url"),d:Wt(e[3],"base64url"),p:Wt(e[4],"base64url"),q:Wt(e[5],"base64url"),dp:Wt(e[6],"base64url"),dq:Wt(e[7],"base64url"),qi:Wt(e[8],"base64url"),kty:"RSA"}}function ps(e){const t=$t(e[1],{offset:0});return{kty:"RSA",n:Wt(t[0],"base64url"),e:Wt(t[1],"base64url")}}function gs(e){if(null==e.n||null==e.e)throw new C("JWK was missing components");return rn([hs,tn(rn([en(jt(e.n,"base64url")),en(jt(e.e,"base64url"))]))]).subarray()}function ms(e){return function(e){const t=fs(e);return function(e){if(function(e){if("RSA"!==e.kty)throw new C("invalid key type");if(null==e.n)throw new C("invalid key modulus");return 8*jt(e.n,"base64url").length}(e)>ds)throw new C("Key size is too large");const t=function(e){if(null==e)throw new C("Missing key parameter");return{privateKey:e,publicKey:{kty:e.kty,n:e.n,e:e.e}}}(e),n=rs($o.encode({Type:Go.RSA,Data:gs(t.publicKey)})),r=Et(18,n);return new us(t.privateKey,new cs(t.publicKey,r))}(t)}($t(e))}function vs(e,t){if(e.byteLength>=1062)throw new P("Key size is too large");return function(e,t,n){const r=ps(e);if(null==n){n=Et(18,rs($o.encode({Type:Go.RSA,Data:t})))}return new cs(r,n)}($t(e,{offset:0}),e,t)}class ys extends Tn{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,kn(e);const n=_n(t);if(this.iHash=e.create(),"function"!==typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Cn(i)}update(e){return xn(this),this.iHash.update(e),this}digestInto(e){xn(this),Sn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ws=(e,t,n)=>new ys(e,t).update(n).digest();function bs(e){void 0!==e.lowS&&gr("lowS",e.lowS),void 0!==e.prehash&&gr("prehash",e.prehash)}ws.create=(e,t)=>new ys(e,t);class Es extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}}const Ss={Err:Es,_tlv:{encode:(e,t)=>{const{Err:n}=Ss;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&t.length)throw new n("tlv.encode: unpadded data");const r=t.length/2,i=mr(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");const o=r>127?mr(i.length/2|128):"";return mr(e)+o+i+t},decode(e,t){const{Err:n}=Ss;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const i=t[r++];let o=0;if(!!(128&i)){const e=127&i;if(!e)throw new n("tlv.decode(long): indefinite length not supported");if(e>4)throw new n("tlv.decode(long): byte length is too big");const s=t.subarray(r,r+e);if(s.length!==e)throw new n("tlv.decode: length bytes not complete");if(0===s[0])throw new n("tlv.decode(long): zero leftmost byte");for(const t of s)o=o<<8|t;if(r+=e,o<128)throw new n("tlv.decode(long): not minimal encoding")}else o=i;const s=t.subarray(r,r+o);if(s.length!==o)throw new n("tlv.decode: wrong value length");return{v:s,l:t.subarray(r+o)}}},_int:{encode(e){const{Err:t}=Ss;if(e<xs)throw new t("integer: negative integers are not allowed");let n=mr(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=Ss;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return _r(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=Ss,i=Nr("signature",e),{v:o,l:s}=r.decode(48,i);if(s.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:l}=r.decode(2,o),{v:c,l:u}=r.decode(2,l);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(c)}},hexFromSig(e){const{_tlv:t,_int:n}=Ss,r=t.encode(2,n.encode(e.r))+t.encode(2,n.encode(e.s));return t.encode(48,r)}};function ks(e,t){return br(Lr(e,t))}const xs=BigInt(0),Cs=BigInt(1),Ps=(BigInt(2),BigInt(3)),As=BigInt(4);function Is(e){const t=function(e){const t=xi(e);Vr(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:n,Fp:r,a:i}=t;if(n){if(!r.eql(i,r.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if("object"!==typeof n||"bigint"!==typeof n.beta||"function"!==typeof n.splitScalar)throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze(E({},t))}(e),{Fp:n}=t,r=li(t.n,t.nBitLength),i=t.toBytes||((e,t,r)=>{const i=t.toAffine();return Mr(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),o=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function s(e){const{a:r,b:i}=t,o=n.sqr(e),s=n.mul(o,e);return n.add(n.add(s,n.mul(e,r)),i)}function a(e,t){const r=n.sqr(t),i=s(e);return n.eql(r,i)}if(!a(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const l=n.mul(n.pow(t.a,Ps),As),c=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(l,c)))throw new Error("bad curve params: a or b");function u(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:i,n:o}=t;if(n&&"bigint"!==typeof e){if(fr(e)&&(e=br(e)),"string"!==typeof e||!n.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*r,"0")}let s;try{s="bigint"===typeof e?e:_r(Nr("private key",e,r))}catch(a){throw new Error("invalid private key, expected hex or "+r+" bytes, got "+typeof e)}return i&&(s=Xr(s,o)),zr("private key",s,Cs,o),s}function d(e){if(!(e instanceof p))throw new Error("ProjectivePoint expected")}const h=Kr(((e,t)=>{const{px:r,py:i,pz:o}=e;if(n.eql(o,n.ONE))return{x:r,y:i};const s=e.is0();null==t&&(t=s?n.ONE:n.inv(o));const a=n.mul(r,t),l=n.mul(i,t),c=n.mul(o,t);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:a,y:l}})),f=Kr((e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:r,y:i}=e.toAffine();if(!n.isValid(r)||!n.isValid(i))throw new Error("bad point: x or y not FE");if(!a(r,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class p{constructor(e,t,r){if(null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t)||n.is0(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required");this.px=e,this.py=t,this.pz=r,Object.freeze(this)}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof p)throw new Error("projective point not allowed");const i=e=>n.eql(e,n.ZERO);return i(t)&&i(r)?p.ZERO:new p(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=oi(n,e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(p.fromAffine)}static fromHex(e){const t=p.fromAffine(o(Nr("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return p.BASE.multiply(u(e))}static msm(e,t){return ki(p,r,e,t)}_setWindowSize(e){v.setWindowSize(this,e)}assertValidity(){f(this)}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){d(e);const{px:t,py:r,pz:i}=this,{px:o,py:s,pz:a}=e,l=n.eql(n.mul(t,a),n.mul(o,i)),c=n.eql(n.mul(r,a),n.mul(s,i));return l&&c}negate(){return new p(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,i=n.mul(r,Ps),{px:o,py:s,pz:a}=this;let l=n.ZERO,c=n.ZERO,u=n.ZERO,d=n.mul(o,o),h=n.mul(s,s),f=n.mul(a,a),g=n.mul(o,s);return g=n.add(g,g),u=n.mul(o,a),u=n.add(u,u),l=n.mul(e,u),c=n.mul(i,f),c=n.add(l,c),l=n.sub(h,c),c=n.add(h,c),c=n.mul(l,c),l=n.mul(g,l),u=n.mul(i,u),f=n.mul(e,f),g=n.sub(d,f),g=n.mul(e,g),g=n.add(g,u),u=n.add(d,d),d=n.add(u,d),d=n.add(d,f),d=n.mul(d,g),c=n.add(c,d),f=n.mul(s,a),f=n.add(f,f),d=n.mul(f,g),l=n.sub(l,d),u=n.mul(f,h),u=n.add(u,u),u=n.add(u,u),new p(l,c,u)}add(e){d(e);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:l}=e;let c=n.ZERO,u=n.ZERO,h=n.ZERO;const f=t.a,g=n.mul(t.b,Ps);let m=n.mul(r,s),v=n.mul(i,a),y=n.mul(o,l),w=n.add(r,i),b=n.add(s,a);w=n.mul(w,b),b=n.add(m,v),w=n.sub(w,b),b=n.add(r,o);let E=n.add(s,l);return b=n.mul(b,E),E=n.add(m,y),b=n.sub(b,E),E=n.add(i,o),c=n.add(a,l),E=n.mul(E,c),c=n.add(v,y),E=n.sub(E,c),h=n.mul(f,b),c=n.mul(g,y),h=n.add(c,h),c=n.sub(v,h),h=n.add(v,h),u=n.mul(c,h),v=n.add(m,m),v=n.add(v,m),y=n.mul(f,y),b=n.mul(g,b),v=n.add(v,y),y=n.sub(m,y),y=n.mul(f,y),b=n.add(b,y),m=n.mul(v,b),u=n.add(u,m),m=n.mul(E,b),c=n.mul(w,c),c=n.sub(c,m),m=n.mul(w,v),h=n.mul(E,h),h=n.add(h,m),new p(c,u,h)}subtract(e){return this.add(e.negate())}is0(){return this.equals(p.ZERO)}wNAF(e){return v.wNAFCached(this,e,p.normalizeZ)}multiplyUnsafe(e){const{endo:r,n:i}=t;zr("scalar",e,xs,i);const o=p.ZERO;if(e===xs)return o;if(this.is0()||e===Cs)return this;if(!r||v.hasPrecomputes(this))return v.wNAFCachedUnsafe(this,e,p.normalizeZ);let{k1neg:s,k1:a,k2neg:l,k2:c}=r.splitScalar(e),u=o,d=o,h=this;for(;a>xs||c>xs;)a&Cs&&(u=u.add(h)),c&Cs&&(d=d.add(h)),h=h.double(),a>>=Cs,c>>=Cs;return s&&(u=u.negate()),l&&(d=d.negate()),d=new p(n.mul(d.px,r.beta),d.py,d.pz),u.add(d)}multiply(e){const{endo:r,n:i}=t;let o,s;if(zr("scalar",e,Cs,i),r){const{k1neg:t,k1:i,k2neg:a,k2:l}=r.splitScalar(e);let{p:c,f:u}=this.wNAF(i),{p:d,f:h}=this.wNAF(l);c=v.constTimeNegate(t,c),d=v.constTimeNegate(a,d),d=new p(n.mul(d.px,r.beta),d.py,d.pz),o=c.add(d),s=u.add(h)}else{const{p:t,f:n}=this.wNAF(e);o=t,s=n}return p.normalizeZ([o,s])[0]}multiplyAndAddUnsafe(e,t,n){const r=p.BASE,i=(e,t)=>t!==xs&&t!==Cs&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),o=i(this,t).add(i(e,n));return o.is0()?void 0:o}toAffine(e){return h(this,e)}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===Cs)return!0;if(n)return n(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===Cs?this:n?n(p,this):this.multiplyUnsafe(t.h)}toRawBytes(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return gr("isCompressed",e),this.assertValidity(),i(p,this,e)}toHex(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return gr("isCompressed",e),br(this.toRawBytes(e))}}p.BASE=new p(t.Gx,t.Gy,n.ONE),p.ZERO=new p(n.ZERO,n.ONE,n.ZERO);const{endo:g,nBitLength:m}=t,v=Si(p,g?Math.ceil(m/2):m);return{CURVE:t,ProjectivePoint:p,normPrivateKeyToScalar:u,weierstrassEquation:s,isWithinCurveOrder:function(e){return Or(e,Cs,t.n)}}}function _s(e){const t=function(e){const t=xi(e);return Vr(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze(E({lowS:!0},t))}(e),{Fp:n,n:r,nByteLength:i,nBitLength:o}=t,s=n.BYTES+1,a=2*n.BYTES+1;function l(e){return Xr(e,r)}function c(e){return Jr(e,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:d,weierstrassEquation:h,isWithinCurveOrder:f}=Is(E(E({},t),{},{toBytes(e,t,r){const i=t.toAffine(),o=n.toBytes(i.x),s=Mr;return gr("isCompressed",r),r?s(Uint8Array.from([t.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes(e){const t=e.length,r=e[0],i=e.subarray(1);if(t!==s||2!==r&&3!==r){if(t===a&&4===r){return{x:n.fromBytes(i.subarray(0,n.BYTES)),y:n.fromBytes(i.subarray(n.BYTES,2*n.BYTES))}}throw new Error("invalid Point, expected length of "+s+", or uncompressed "+a+", got "+t)}{const e=_r(i);if(!Or(e,Cs,n.ORDER))throw new Error("Point is not on curve");const t=h(e);let s;try{s=n.sqrt(t)}catch(o){const e=o instanceof Error?": "+o.message:"";throw new Error("Point is not on curve"+e)}return 1===(1&r)!==((s&Cs)===Cs)&&(s=n.neg(s)),{x:e,y:s}}}}));function p(e){return e>r>>Cs}const g=(e,t,n)=>_r(e.slice(t,n));class m{constructor(e,t,n){zr("r",e,Cs,r),zr("s",t,Cs,r),this.r=e,this.s=t,null!=n&&(this.recovery=n),Object.freeze(this)}static fromCompact(e){const t=i;return e=Nr("compactSignature",e,2*t),new m(g(e,0,t),g(e,t,2*t))}static fromDER(e){const{r:t,s:n}=Ss.toSig(Nr("DER",e));return new m(t,n)}assertValidity(){}addRecoveryBit(e){return new m(this.r,this.s,e)}recoverPublicKey(e){const{r:r,s:i,recovery:o}=this,s=b(Nr("msgHash",e));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const a=2===o||3===o?r+t.n:r;if(a>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const d=0===(1&o)?"02":"03",h=u.fromHex(d+ks(a,n.BYTES)),f=c(a),p=l(-s*f),g=l(i*f),m=u.BASE.multiplyAndAddUnsafe(h,p,g);if(!m)throw new Error("point at infinify");return m.assertValidity(),m}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,l(-this.s),this.recovery):this}toDERRawBytes(){return Ir(this.toDERHex())}toDERHex(){return Ss.hexFromSig(this)}toCompactRawBytes(){return Ir(this.toCompactHex())}toCompactHex(){const e=i;return ks(this.r,e)+ks(this.s,e)}}const v={isValidPrivateKey(e){try{return d(e),!0}catch(t){return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const e=ui(t.n);return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.length,i=ci(t),o=ui(t);if(r<16||r<o||r>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+r);const s=Xr(n?Tr(e):_r(e),t-Wr)+Wr;return n?Rr(s,i):Lr(s,i)}(t.randomBytes(e),t.n)},precompute(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.BASE;return t._setWindowSize(e),t.multiply(BigInt(3)),t}};function y(e){if("bigint"===typeof e)return!1;if(e instanceof u)return!0;const r=Nr("key",e).length,o=n.BYTES,s=o+1,a=2*o+1;return t.allowedPrivateKeyLengths||i===s?void 0:r===s||r===a}const w=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=_r(e),n=8*e.length-o;return n>0?t>>BigInt(n):t},b=t.bits2int_modN||function(e){return l(w(e))},S=Fr(o);function k(e){return zr("num < 2^"+o,e,xs,S),Lr(e,i)}function x(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C;if(["recovered","canonical"].some((e=>e in i)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:s}=t;let{lowS:a,prehash:h,extraEntropy:g}=i;null==a&&(a=!0),e=Nr("msgHash",e),bs(i),h&&(e=Nr("prehashed msgHash",o(e)));const v=b(e),y=d(r),E=[k(y),k(v)];if(null!=g&&!1!==g){const e=!0===g?s(n.BYTES):g;E.push(Nr("extraEntropy",e))}const S=Mr(...E),x=v;return{seed:S,k2sig:function(e){const t=w(e);if(!f(t))return;const n=c(t),r=u.BASE.multiply(t).toAffine(),i=l(r.x);if(i===xs)return;const o=l(n*l(x+i*y));if(o===xs)return;let s=(r.x===i?0:2)|Number(r.y&Cs),d=o;return a&&p(o)&&(d=function(e){return p(e)?l(-e):e}(o),s^=1),new m(i,d,s)}}}const C={lowS:t.lowS,prehash:!1},P={lowS:t.lowS,prehash:!1};return u.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return u.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!0===y(e))throw new Error("first arg must be private key");if(!1===y(t))throw new Error("second arg must be public key");return u.fromHex(t).multiply(d(e)).toRawBytes(n)},sign:function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C;const{seed:i,k2sig:o}=x(e,n,r),s=t,a=function(e,t,n){if("number"!==typeof e||e<2)throw new Error("hashLen must be a number");if("number"!==typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!==typeof n)throw new Error("hmacFn must be a function");let r=Ur(e),i=Ur(e),o=0;const s=()=>{r.fill(1),i.fill(0),o=0},a=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return n(i,r,...t)},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ur(0);i=a(Br([0]),e),r=a(),0!==e.length&&(i=a(Br([1]),e),r=a())},c=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return Mr(...n)};return(e,t)=>{let n;for(s(),l(e);!(n=t(c()));)l();return s(),n}}(s.hash.outputLen,s.nByteLength,s.hmac);return a(i,o)},verify:function(e,n,r){var i;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:P;const s=e;n=Nr("msgHash",n),r=Nr("publicKey",r);const{lowS:a,prehash:d,format:h}=o;if(bs(o),"strict"in o)throw new Error("options.strict was renamed to lowS");if(void 0!==h&&"compact"!==h&&"der"!==h)throw new Error("format must be compact or der");const f="string"===typeof s||fr(s),p=!f&&!h&&"object"===typeof s&&null!==s&&"bigint"===typeof s.r&&"bigint"===typeof s.s;if(!f&&!p)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let g,v;try{if(p&&(g=new m(s.r,s.s)),f){try{"compact"!==h&&(g=m.fromDER(s))}catch(A){if(!(A instanceof Ss.Err))throw A}g||"der"===h||(g=m.fromCompact(s))}v=u.fromHex(r)}catch(I){return!1}if(!g)return!1;if(a&&g.hasHighS())return!1;d&&(n=t.hash(n));const{r:y,s:w}=g,E=b(n),S=c(w),k=l(E*S),x=l(y*S),C=null===(i=u.BASE.multiplyAndAddUnsafe(v,k,x))||void 0===i?void 0:i.toAffine();return!!C&&l(C.x)===y},ProjectivePoint:u,Signature:m,utils:v}}function Ts(e){return{hash:e,hmac:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return ws(e,t,function(){let e=0;for(let n=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];Sn(t),e+=t.length}const t=new Uint8Array(e);for(let n=0,r=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];t.set(e,r),r+=e.length}return t}(...r))},randomBytes:Rn}}const Ls=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Rs=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Ns=BigInt(0),Ms=BigInt(1),Ds=BigInt(2),Os=(e,t)=>(e+t/Ds)/t;function zs(e){const t=Ls,n=BigInt(3),r=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),l=BigInt(88),c=e*e*e%t,u=c*c*e%t,d=Zr(u,n,t)*u%t,h=Zr(d,n,t)*u%t,f=Zr(h,Ds,t)*c%t,p=Zr(f,i,t)*f%t,g=Zr(p,o,t)*p%t,m=Zr(g,a,t)*g%t,v=Zr(m,l,t)*m%t,y=Zr(v,a,t)*g%t,w=Zr(y,n,t)*u%t,b=Zr(w,s,t)*p%t,E=Zr(b,r,t)*c%t,S=Zr(E,Ds,t);if(!Fs.eql(Fs.sqr(S),e))throw new Error("Cannot find square root");return S}const Fs=li(Ls,void 0,void 0,{sqrt:zs}),Us=function(e,t){const n=t=>_s(E(E({},e),Ts(t)));return E(E({},n(t)),{},{create:n})}({a:Ns,b:BigInt(7),Fp:Fs,n:Rs,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=Rs,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Ms*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,s=BigInt("0x100000000000000000000000000000000"),a=Os(o*e,t),l=Os(-r*e,t);let c=Xr(e-a*n-l*i,t),u=Xr(-a*r-l*o,t);const d=c>s,h=u>s;if(d&&(c=t-c),h&&(u=t-u),c>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:d,k1:c,k2neg:h,k2:u}}}},cr);function Bs(e){return null!=e&&("function"===typeof e.then&&"function"===typeof e.catch&&"function"===typeof e.finally)}class qs{constructor(e){w(this,"type","secp256k1"),w(this,"raw",void 0),w(this,"_key",void 0),this._key=function(e){try{return Us.ProjectivePoint.fromHex(e),e}catch(t){throw new P(String(t))}}(e),this.raw=function(e){const t=Us.ProjectivePoint.fromHex(e).toRawBytes(!0);return t}(this._key)}toMultihash(){return Ct.digest(Qs(this))}toCID(){return Mt.createV1(114,this.toMultihash())}toString(){return ze.encode(this.toMultihash().bytes).substring(1)}equals(e){return null!=e&&e.raw instanceof Uint8Array&&ne(this.raw,e.raw)}verify(e,t){return function(e,t,n){const r=_t.digest(n instanceof Uint8Array?n:n.subarray());if(Bs(r))return r.then((n=>{let{digest:r}=n;return Us.verify(t,r,e)})).catch((e=>{throw new os(String(e))}));try{return Us.verify(t,r.digest,e)}catch(i){throw new os(String(i))}}(this._key,t,e)}}class Vs{constructor(e,t){w(this,"type","secp256k1"),w(this,"raw",void 0),w(this,"publicKey",void 0),this.raw=function(e){try{return Us.getPublicKey(e,!0),e}catch(t){throw new A(String(t))}}(e),this.publicKey=new qs(null!==t&&void 0!==t?t:function(e){try{return Us.getPublicKey(e,!0)}catch(t){throw new A(String(t))}}(e))}equals(e){return null!=e&&e.raw instanceof Uint8Array&&ne(this.raw,e.raw)}sign(e){return function(e,t){const n=_t.digest(t instanceof Uint8Array?t:t.subarray());if(Bs(n))return n.then((t=>{let{digest:n}=t;return Us.sign(n,e).toDERRawBytes()})).catch((e=>{throw new is(String(e))}));try{return Us.sign(n.digest,e).toDERRawBytes()}catch(r){throw new is(String(r))}}(this.raw,e)}}function Ks(e){return new qs(e)}async function js(){const e=Us.utils.randomPrivateKey();return new Vs(e)}async function Ws(e,t){if("Ed25519"===e)return eo();if("secp256k1"===e)return js();if("RSA"===e)return async function(e){if(e>ds)throw new C("Key size is too large");const t=await ls(e),n=Et(18,rs($o.encode({Type:Go.RSA,Data:gs(t.publicKey)})));return new us(t.privateKey,new cs(t.publicKey,n))}(function(e){if(null==e)return 2048;return parseInt(e,10)}(t));if("ECDSA"===e)return wn(function(e){if("P-256"===e||null==e)return"P-256";if("P-384"===e)return"P-384";if("P-521"===e)return"P-521";throw new C("Unsupported curve, should be P-256, P-384 or P-521")}(t));throw new X}function Hs(e,t){const{Type:n,Data:r}=$o.decode(e),i=null!==r&&void 0!==r?r:new Uint8Array;switch(n){case Go.RSA:return vs(i,t);case Go.Ed25519:return Ji(i);case Go.secp256k1:return Ks(i);case Go.ECDSA:return vn(i);default:throw new X}}function Qs(e){return $o.encode({Type:Go[e.type],Data:e.raw})}function Gs(e){var t;const n=Xo.decode(e),r=null!==(t=n.Data)&&void 0!==t?t:new Uint8Array;switch(n.Type){case Go.RSA:return ms(r);case Go.Ed25519:return function(e){if(e.length>Yi){const t=(e=to(e,96)).subarray(0,Yi),n=e.subarray(Yi,e.length);return new Zi(t,n)}const t=(e=to(e,Yi)).subarray(0,Yi),n=e.subarray(32);return new Zi(t,n)}(r);case Go.secp256k1:return new Vs(r);case Go.ECDSA:return mn(r);default:throw new X}}const Ys=Symbol.for("@libp2p/peer-id");function $s(e){return Boolean(null===e||void 0===e?void 0:e[Ys])}const Xs=Symbol.for("nodejs.util.inspect.custom");class Zs{constructor(e){w(this,"type",void 0),w(this,"multihash",void 0),w(this,"publicKey",void 0),w(this,"string",void 0),w(this,Ys,!0),this.type=e.type,this.multihash=e.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return"PeerId(".concat(this.toString(),")")}toString(){return null==this.string&&(this.string=ze.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return Mt.createV1(114,this.multihash)}toJSON(){return this.toString()}equals(e){var t;if(null==e)return!1;if(e instanceof Uint8Array)return ne(this.multihash.bytes,e);if("string"===typeof e)return this.toString()===e;if(null!=(null===e||void 0===e||null===(t=e.toMultihash())||void 0===t?void 0:t.bytes))return ne(this.multihash.bytes,e.toMultihash().bytes);throw new Error("not valid Id")}[Xs](){return"PeerId(".concat(this.toString(),")")}}class Js extends Zs{constructor(e){super(E(E({},e),{},{type:"RSA"})),w(this,"type","RSA"),w(this,"publicKey",void 0),this.publicKey=e.publicKey}}class ea extends Zs{constructor(e){super(E(E({},e),{},{type:"Ed25519"})),w(this,"type","Ed25519"),w(this,"publicKey",void 0),this.publicKey=e.publicKey}}class ta extends Zs{constructor(e){super(E(E({},e),{},{type:"secp256k1"})),w(this,"type","secp256k1"),w(this,"publicKey",void 0),this.publicKey=e.publicKey}}class na{constructor(e){w(this,"type","url"),w(this,"multihash",void 0),w(this,"publicKey",void 0),w(this,"url",void 0),w(this,Ys,!0),this.url=e.toString(),this.multihash=Ct.digest(jt(this.url))}[Xs](){return"PeerId(".concat(this.url,")")}toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return Mt.createV1(2336,this.toMultihash())}toJSON(){return this.toString()}equals(e){return null!=e&&(e instanceof Uint8Array&&(e=Wt(e)),e.toString()===this.toString())}}function ra(e,t){let n;if("1"===e.charAt(0)||"Q"===e.charAt(0))n=St(ze.decode("z".concat(e)));else{if(e.startsWith("k51qzi5uqu5")||e.startsWith("kzwfwjn5ji4")||e.startsWith("k2k4r8")||e.startsWith("bafz"))return sa(Mt.parse(e));if(null==t)throw new C('Please pass a multibase decoder for strings that do not start with "1" or "Q"');n=St(t.decode(e))}return oa(n)}function ia(e){if("Ed25519"===e.type)return new ea({multihash:e.toCID().multihash,publicKey:e});if("secp256k1"===e.type)return new ta({multihash:e.toCID().multihash,publicKey:e});if("RSA"===e.type)return new Js({multihash:e.toCID().multihash,publicKey:e});throw new X}function oa(e){if(function(e){return e.code===_t.code}(e))return new Js({multihash:e});if(function(e){return e.code===Ct.code}(e))try{const t=function(e){const{Type:t,Data:n}=$o.decode(e.digest),r=null!==n&&void 0!==n?n:new Uint8Array;switch(t){case Go.Ed25519:return Ji(r);case Go.secp256k1:return Ks(r);case Go.ECDSA:return vn(r);default:throw new X}}(e);if("Ed25519"===t.type)return new ea({multihash:e,publicKey:t});if("secp256k1"===t.type)return new ta({multihash:e,publicKey:t})}catch(t){const n=Wt(e.digest);return new na(new URL(n))}throw new U("Supplied PeerID Multihash is invalid")}function sa(e){if(null==(null===e||void 0===e?void 0:e.multihash)||null==e.version||1===e.version&&114!==e.code&&2336!==e.code)throw new F("Supplied PeerID CID is invalid");if(2336===e.code){const t=Wt(e.multihash.digest);return new na(new URL(t))}return oa(e.multihash)}const aa=Symbol.for("@libp2p/transport");var la;function ca(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}!function(e){e[e.FATAL_ALL=0]="FATAL_ALL",e[e.NO_FATAL=1]="NO_FATAL"}(la||(la={}));const{hasOwnProperty:ua}=Object.prototype,{propertyIsEnumerable:da}=Object,ha=(e,t,n)=>{Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})},fa={concatArrays:!1,ignoreUndefined:!1},pa=e=>{const t=[];for(const n in e)ua.call(e,n)&&t.push(n);if(Object.getOwnPropertySymbols){const n=Object.getOwnPropertySymbols(e);for(const r of n)da.call(e,r)&&t.push(r)}return t};function ga(e){return Array.isArray(e)?function(e){const t=e.slice(0,0);return pa(e).forEach((n=>{ha(t,n,ga(e[n]))})),t}(e):ca(e)?function(e){const t=null===Object.getPrototypeOf(e)?Object.create(null):{};return pa(e).forEach((n=>{ha(t,n,ga(e[n]))})),t}(e):e}const ma=(e,t,n,r)=>(n.forEach((n=>{"undefined"===typeof t[n]&&r.ignoreUndefined||(n in e&&e[n]!==Object.getPrototypeOf(e)?ha(e,n,ya(e[n],t[n],r)):ha(e,n,ga(t[n])))})),e),va=(e,t,n)=>{let r=e.slice(0,0),i=0;return[e,t].forEach((t=>{const o=[];for(let n=0;n<t.length;n++)ua.call(t,n)&&(o.push(String(n)),ha(r,i++,t===e?t[n]:ga(t[n])));r=ma(r,t,pa(t).filter((e=>!o.includes(e))),n)})),r};function ya(e,t,n){return n.concatArrays&&Array.isArray(e)&&Array.isArray(t)?va(e,t,n):ca(t)&&ca(e)?ma(e,t,pa(t),n):ga(t)}function wa(){const e=ya(ga(fa),undefined!==this&&this||{},fa);let t={_:{}};for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(const o of r)if(void 0!==o){if(!ca(o))throw new TypeError("`"+o+"` is not an Option Object");t=ya(t,{_:o},e)}return t._}class ba extends Event{constructor(e,t){super(e),w(this,"type",void 0),w(this,"detail",void 0),this.type=e,this.detail=t}}function Ea(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sa(e,t){Ea(e,t),t.add(e)}function ka(e,t,n){Ea(e,t),t.set(e,n)}function xa(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function Ca(e,t,n){return n(xa(e,t))}function Pa(e,t){return e.get(xa(e,t))}function Aa(e,t,n){return e.set(xa(e,t),n),n}var Ia=n(465);class _a extends Error{constructor(e){super(e),this.name="TimeoutError"}}class Ta extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const La=e=>void 0===globalThis.DOMException?new Ta(e):new DOMException(e),Ra=e=>{const t=void 0===e.reason?La("This operation was aborted."):e.reason;return t instanceof Error?t:La(t)};function Na(e,t){const{milliseconds:n,fallback:r,message:i,customTimers:o={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let s,a;const l=new Promise(((l,c)=>{if("number"!==typeof n||1!==Math.sign(n))throw new TypeError("Expected `milliseconds` to be a positive number, got `".concat(n,"`"));if(t.signal){const{signal:e}=t;e.aborted&&c(Ra(e)),a=()=>{c(Ra(e))},e.addEventListener("abort",a,{once:!0})}if(n===Number.POSITIVE_INFINITY)return void e.then(l,c);const u=new _a;s=o.setTimeout.call(void 0,(()=>{if(r)try{l(r())}catch(t){c(t)}else"function"===typeof e.cancel&&e.cancel(),!1===i?l():i instanceof Error?c(i):(u.message=null!==i&&void 0!==i?i:"Promise timed out after ".concat(n," milliseconds"),c(u))}),n),(async()=>{try{l(await e)}catch(t){c(t)}})()})).finally((()=>{l.clear(),a&&t.signal&&t.signal.removeEventListener("abort",a)}));return l.clear=()=>{o.clearTimeout.call(void 0,s),s=void 0},l}var Ma=new WeakMap;class Da{constructor(){ka(this,Ma,[])}enqueue(e,t){const n={priority:(t=E({priority:0},t)).priority,id:t.id,run:e};if(0===this.size||Pa(Ma,this)[this.size-1].priority>=t.priority)return void Pa(Ma,this).push(n);const r=function(e,t,n){let r=0,i=e.length;for(;i>0;){const o=Math.trunc(i/2);let s=r+o;n(e[s],t)<=0?(r=++s,i-=o+1):i=o}return r}(Pa(Ma,this),n,((e,t)=>t.priority-e.priority));Pa(Ma,this).splice(r,0,n)}setPriority(e,t){const n=Pa(Ma,this).findIndex((t=>t.id===e));if(-1===n)throw new ReferenceError('No promise function with the id "'.concat(e,'" exists in the queue.'));const[r]=Pa(Ma,this).splice(n,1);this.enqueue(r.run,{priority:t,id:e})}dequeue(){const e=Pa(Ma,this).shift();return null===e||void 0===e?void 0:e.run}filter(e){return Pa(Ma,this).filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return Pa(Ma,this).length}}var Oa=new WeakMap,za=new WeakMap,Fa=new WeakMap,Ua=new WeakMap,Ba=new WeakMap,qa=new WeakMap,Va=new WeakMap,Ka=new WeakMap,ja=new WeakMap,Wa=new WeakMap,Ha=new WeakMap,Qa=new WeakMap,Ga=new WeakMap,Ya=new WeakMap,$a=new WeakMap,Xa=new WeakSet;class Za extends Ia{constructor(e){var t,n,r,i;if(super(),Sa(this,Xa),ka(this,Oa,void 0),ka(this,za,void 0),ka(this,Fa,0),ka(this,Ua,void 0),ka(this,Ba,void 0),ka(this,qa,0),ka(this,Va,void 0),ka(this,Ka,void 0),ka(this,ja,void 0),ka(this,Wa,void 0),ka(this,Ha,0),ka(this,Qa,void 0),ka(this,Ga,void 0),ka(this,Ya,void 0),ka(this,$a,1n),w(this,"timeout",void 0),!("number"===typeof(e=E({carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Da},e)).intervalCap&&e.intervalCap>=1))throw new TypeError("Expected `intervalCap` to be a number from 1 and up, got `".concat(null!==(t=null===(n=e.intervalCap)||void 0===n?void 0:n.toString())&&void 0!==t?t:"","` (").concat(typeof e.intervalCap,")"));if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError("Expected `interval` to be a finite number >= 0, got `".concat(null!==(r=null===(i=e.interval)||void 0===i?void 0:i.toString())&&void 0!==r?r:"","` (").concat(typeof e.interval,")"));Aa(Oa,this,e.carryoverConcurrencyCount),Aa(za,this,e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval),Aa(Ua,this,e.intervalCap),Aa(Ba,this,e.interval),Aa(ja,this,new e.queueClass),Aa(Wa,this,e.queueClass),this.concurrency=e.concurrency,this.timeout=e.timeout,Aa(Ya,this,!0===e.throwOnTimeout),Aa(Ga,this,!1===e.autoStart)}get concurrency(){return Pa(Qa,this)}set concurrency(e){if(!("number"===typeof e&&e>=1))throw new TypeError("Expected `concurrency` to be a number from 1 and up, got `".concat(e,"` (").concat(typeof e,")"));Aa(Qa,this,e),xa(Xa,this,al).call(this)}setPriority(e,t){Pa(ja,this).setPriority(e,t)}async add(e){var t,n,r,i;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!==(i=(r=o).id)&&void 0!==i||(r.id=(Aa($a,this,(t=Pa($a,this),n=t++,t)),n).toString()),o=E({timeout:this.timeout,throwOnTimeout:Pa(Ya,this)},o),new Promise(((t,n)=>{Pa(ja,this).enqueue((async()=>{var r,i;Aa(Ha,this,(r=Pa(Ha,this),r++,r)),Aa(Fa,this,(i=Pa(Fa,this),i++,i));try{var s;null===(s=o.signal)||void 0===s||s.throwIfAborted();let n=e({signal:o.signal});o.timeout&&(n=Na(Promise.resolve(n),{milliseconds:o.timeout})),o.signal&&(n=Promise.race([n,xa(Xa,this,ll).call(this,o.signal)]));const r=await n;t(r),this.emit("completed",r)}catch(a){if(a instanceof _a&&!o.throwOnTimeout)return void t();n(a),this.emit("error",a)}finally{xa(Xa,this,tl).call(this)}}),o),this.emit("add"),xa(Xa,this,il).call(this)}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return Pa(Ga,this)?(Aa(Ga,this,!1),xa(Xa,this,al).call(this),this):this}pause(){Aa(Ga,this,!0)}clear(){Aa(ja,this,new(Pa(Wa,this)))}async onEmpty(){0!==Pa(ja,this).size&&await xa(Xa,this,cl).call(this,"empty")}async onSizeLessThan(e){Pa(ja,this).size<e||await xa(Xa,this,cl).call(this,"next",(()=>Pa(ja,this).size<e))}async onIdle(){0===Pa(Ha,this)&&0===Pa(ja,this).size||await xa(Xa,this,cl).call(this,"idle")}get size(){return Pa(ja,this).size}sizeBy(e){return Pa(ja,this).filter(e).length}get pending(){return Pa(Ha,this)}get isPaused(){return Pa(Ga,this)}}function Ja(e){return Pa(za,e)||Pa(Fa,e)<Pa(Ua,e)}function el(e){return Pa(Ha,e)<Pa(Qa,e)}function tl(){var e;Aa(Ha,this,(e=Pa(Ha,this),e--,e)),xa(Xa,this,il).call(this),this.emit("next")}function nl(){xa(Xa,this,sl).call(this),xa(Xa,this,ol).call(this),Aa(Ka,this,void 0)}function rl(e){const t=Date.now();if(void 0===Pa(Va,e)){const n=Pa(qa,e)-t;if(!(n<0))return void 0===Pa(Ka,e)&&Aa(Ka,e,setTimeout((()=>{xa(Xa,e,nl).call(e)}),n)),!0;Aa(Fa,e,Pa(Oa,e)?Pa(Ha,e):0)}return!1}function il(){if(0===Pa(ja,this).size)return Pa(Va,this)&&clearInterval(Pa(Va,this)),Aa(Va,this,void 0),this.emit("empty"),0===Pa(Ha,this)&&this.emit("idle"),!1;if(!Pa(Ga,this)){const e=!Ca(Xa,this,rl);if(Ca(Xa,this,Ja)&&Ca(Xa,this,el)){const t=Pa(ja,this).dequeue();return!!t&&(this.emit("active"),t(),e&&xa(Xa,this,ol).call(this),!0)}}return!1}function ol(){Pa(za,this)||void 0!==Pa(Va,this)||(Aa(Va,this,setInterval((()=>{xa(Xa,this,sl).call(this)}),Pa(Ba,this))),Aa(qa,this,Date.now()+Pa(Ba,this)))}function sl(){0===Pa(Fa,this)&&0===Pa(Ha,this)&&Pa(Va,this)&&(clearInterval(Pa(Va,this)),Aa(Va,this,void 0)),Aa(Fa,this,Pa(Oa,this)?Pa(Ha,this):0),xa(Xa,this,al).call(this)}function al(){for(;xa(Xa,this,il).call(this););}async function ll(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(e.reason)}),{once:!0})}))}async function cl(e,t){return new Promise((n=>{const r=()=>{t&&!t()||(this.off(e,r),n())};this.on(e,r)}))}function ul(e){const t=[ml.A];return null==e?t:Array.isArray(e)?0===e.length?t:e:[e]}function dl(e){var t,n,r,i,o,s,a,l,c,u,d,h,f,p,g;return{Status:null!==(t=e.Status)&&void 0!==t?t:0,TC:null!==(n=null!==(r=e.TC)&&void 0!==r?r:e.flag_tc)&&void 0!==n&&n,RD:null!==(i=null!==(o=e.RD)&&void 0!==o?o:e.flag_rd)&&void 0!==i&&i,RA:null!==(s=null!==(a=e.RA)&&void 0!==a?a:e.flag_ra)&&void 0!==s&&s,AD:null!==(l=null!==(c=e.AD)&&void 0!==c?c:e.flag_ad)&&void 0!==l&&l,CD:null!==(u=null!==(d=e.CD)&&void 0!==d?d:e.flag_cd)&&void 0!==u&&u,Question:(null!==(h=null!==(f=e.Question)&&void 0!==f?f:e.questions)&&void 0!==h?h:[]).map((e=>({name:e.name,type:ml[e.type]}))),Answer:(null!==(p=null!==(g=e.Answer)&&void 0!==g?g:e.answers)&&void 0!==p?p:[]).map((e=>{var t,n;return{name:e.name,type:ml[e.type],TTL:null!==(t=null!==(n=e.TTL)&&void 0!==n?n:e.ttl)&&void 0!==t?t:60,data:e.data instanceof Uint8Array?Wt(e.data):e.data}}))}}function hl(e){var t;const n=new Za({concurrency:null!==(t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).queryConcurrency)&&void 0!==t?t:4});return async function(t){var r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=new URLSearchParams;o.set("name",t),ul(i.types).forEach((e=>{o.append("type",ml[e])})),null===(r=i.onProgress)||void 0===r||r.call(i,new ba("dns:query",{detail:t}));const s=await n.add((async()=>{var t;const n=await fetch("".concat(e,"?").concat(o),{headers:{accept:"application/dns-json"},signal:null===i||void 0===i?void 0:i.signal});if(200!==n.status)throw new Error("Unexpected HTTP status: ".concat(n.status," - ").concat(n.statusText));const r=dl(await n.json());return null===(t=i.onProgress)||void 0===t||t.call(i,new ba("dns:response",{detail:r})),r}),{signal:i.signal});if(null==s)throw new Error("No DNS response received");return s}}var fl=n(101);class pl{constructor(e){w(this,"lru",void 0),this.lru=fl(e)}get(e,t){let n=!0;const r=[];for(const i of t){const t=this.getAnswers(e,i);if(0===t.length){n=!1;break}r.push(...t)}if(n)return dl({answers:r})}getAnswers(e,t){const n="".concat(e.toLowerCase(),"-").concat(t),r=this.lru.get(n);if(null!=r){const e=r.filter((e=>e.expires>Date.now())).map((e=>{let{expires:t,value:n}=e;return E(E({},n),{},{TTL:Math.round((t-Date.now())/1e3),type:ml[n.type]})}));return 0===e.length&&this.lru.remove(n),e}return[]}add(e,t){var n,r;const i="".concat(e.toLowerCase(),"-").concat(t.type),o=null!==(n=this.lru.get(i))&&void 0!==n?n:[];o.push({expires:Date.now()+1e3*(null!==(r=t.TTL)&&void 0!==r?r:60),value:t}),this.lru.set(i,o)}remove(e,t){const n="".concat(e.toLowerCase(),"-").concat(t);this.lru.remove(n)}clear(){this.lru.clear()}}class gl{constructor(e){var t,n,r;w(this,"resolvers",void 0),w(this,"cache",void 0),this.resolvers={},this.cache=(r=null!==(t=e.cacheSize)&&void 0!==t?t:1e3,new pl(r)),Object.entries(null!==(n=e.resolvers)&&void 0!==n?n:{}).forEach((e=>{let[t,n]=e;Array.isArray(n)||(n=[n]),t.endsWith(".")||(t="".concat(t,".")),this.resolvers[t]=n})),null==this.resolvers["."]&&(this.resolvers["."]=[hl("https://cloudflare-dns.com/dns-query"),hl("https://dns.google/resolve")])}async query(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=ul(n.types),i=!1!==n.cached?this.cache.get(e,r):void 0;var o;if(null!=i)return null===(o=n.onProgress)||void 0===o||o.call(n,new ba("dns:cache",{detail:i})),i;const s="".concat(e.split(".").pop(),"."),a=(null!==(t=this.resolvers[s])&&void 0!==t?t:this.resolvers["."]).sort((()=>Math.random()>.5?-1:1)),l=[];for(const h of a){var c;if(!0===(null===(c=n.signal)||void 0===c?void 0:c.aborted))break;try{const t=await h(e,E(E({},n),{},{types:r}));for(const n of t.Answer)this.cache.add(e,n);return t}catch(d){var u;l.push(d),null===(u=n.onProgress)||void 0===u||u.call(n,new ba("dns:error",{detail:d}))}}if(1===l.length)throw l[0];throw new AggregateError(l,"DNS lookup of ".concat(e," ").concat(r," failed"))}}var ml;!function(e){e[e.A=1]="A",e[e.CNAME=5]="CNAME",e[e.TXT=16]="TXT",e[e.AAAA=28]="AAAA"}(ml||(ml={}));const vl=new class{constructor(){w(this,"index",0),w(this,"input","")}new(e){return this.index=0,this.input=e,this}readAtomically(e){const t=this.index,n=e();return void 0===n&&(this.index=t),n}parseWith(e){const t=e();if(this.index===this.input.length)return t}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically((()=>{const t=this.readChar();if(t===e)return t}))}readSeparator(e,t,n){return this.readAtomically((()=>{if(!(t>0&&void 0===this.readGivenChar(e)))return n()}))}readNumber(e,t,n,r){return this.readAtomically((()=>{let i=0,o=0;const s=this.peekChar();if(void 0===s)return;const a="0"===s,l=2**(8*r)-1;for(;;){const n=this.readAtomically((()=>{const t=this.readChar();if(void 0===t)return;const n=Number.parseInt(t,e);return Number.isNaN(n)?void 0:n}));if(void 0===n)break;if(i*=e,i+=n,i>l)return;if(o+=1,void 0!==t&&o>t)return}return 0===o||!n&&a&&o>1?void 0:i}))}readIPv4Addr(){return this.readAtomically((()=>{const e=new Uint8Array(4);for(let t=0;t<e.length;t++){const n=this.readSeparator(".",t,(()=>this.readNumber(10,3,!1,1)));if(void 0===n)return;e[t]=n}return e}))}readIPv6Addr(){const e=e=>{for(let t=0;t<e.length/2;t++){const n=2*t;if(t<e.length-3){const r=this.readSeparator(":",t,(()=>this.readIPv4Addr()));if(void 0!==r)return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],[n+4,!0]}const r=this.readSeparator(":",t,(()=>this.readNumber(16,4,!0,2)));if(void 0===r)return[n,!1];e[n]=r>>8,e[n+1]=255&r}return[e.length,!1]};return this.readAtomically((()=>{const t=new Uint8Array(16),[n,r]=e(t);if(16===n)return t;if(r)return;if(void 0===this.readGivenChar(":"))return;if(void 0===this.readGivenChar(":"))return;const i=new Uint8Array(14),o=16-(n+2),[s]=e(i.subarray(0,o));return t.set(i.subarray(0,s),16-s),t}))}readIPAddr(){var e;return null!==(e=this.readIPv4Addr())&&void 0!==e?e:this.readIPv6Addr()}};function yl(e){if(!(e.length>15))return vl.new(e).parseWith((()=>vl.readIPv4Addr()))}function wl(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>45))return vl.new(e).parseWith((()=>vl.readIPv6Addr()))}function bl(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.includes("%")&&(e=e.split("%")[0]),e.length>45)return;const n=vl.new(e).parseWith((()=>vl.readIPAddr()));return n?t&&4===n.length?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,n[0],n[1],n[2],n[3]]):n:void 0}const El=4,Sl=16,kl=(parseInt("0xFFFF",16),new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]));function xl(e,t){t.length===Sl&&e.length===El&&function(e,t,n){let r=0;for(const i of e)if(!(r<t)){if(r>n)break;if(255!==i)return!1;r++}return!0}(t,0,11)&&(t=t.slice(12)),t.length===El&&e.length===Sl&&function(e,t,n,r){let i=0;for(const o of e)if(!(i<n)){if(i>r)break;if(o!==t[i])return!1;i++}return!0}(e,kl,0,11)&&(e=e.slice(12));const n=e.length;if(n!=t.length)throw new Error("Failed to mask ip");const r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=e[i]&t[i];return r}function Cl(e,t){if(t!==8*El&&t!==8*Sl)throw new Error("Invalid CIDR mask");if(e<0||e>t)throw new Error("Invalid CIDR mask");const n=t/8,r=new Uint8Array(n);for(let i=0;i<n;i++)e>=8?(r[i]=255,e-=8):(r[i]=255-(255>>e),e=0);return r}class Pl{constructor(e,t){if(null==t)({network:this.network,mask:this.mask}=function(e){const[t,n]=e.split("/");if(!t||!n)throw new Error("Failed to parse given CIDR: "+e);let r=El,i=yl(t);if(null==i&&(r=Sl,i=wl(t),null==i))throw new Error("Failed to parse given CIDR: "+e);const o=parseInt(n,10);if(Number.isNaN(o)||String(o).length!==n.length||o<0||o>8*r)throw new Error("Failed to parse given CIDR: "+e);const s=Cl(o,8*r);return{network:xl(i,s),mask:s}}(e));else{const n=bl(e);if(null==n)throw new Error("Failed to parse network");t=String(t);const r=parseInt(t,10);if(Number.isNaN(r)||String(r).length!==t.length||r<0||r>8*n.length){const e=bl(t);if(null==e)throw new Error("Failed to parse mask");this.mask=e}else this.mask=Cl(r,8*n.length);this.network=xl(n,this.mask)}}contains(e){return function(e,t){if("string"===typeof t&&(t=bl(t)),null==t)throw new Error("Invalid ip");if(t.length!==e.network.length)return!1;for(let n=0;n<t.length;n++)if((e.network[n]&e.mask[n])!==(t[n]&e.mask[n]))return!1;return!0}({network:this.network,mask:this.mask},e)}toString(){const e=function(e){let t=0;for(let[n,r]of e.entries()){if(255!==r){for(;0!=(128&r);)t++,r<<=1;if(0!=(128&r))return-1;for(let t=n+1;t<e.length;t++)if(0!=e[t])return-1;break}t+=8}return t}(this.mask),t=-1!==e?String(e):function(e){let t="0x";for(const n of e)t+=(n>>4).toString(16)+(15&n).toString(16);return t}(this.mask);return function(e){switch(e.length){case El:return e.join(".");case Sl:{const t=[];for(let n=0;n<e.length;n++)n%2===0&&t.push(e[n].toString(16).padStart(2,"0")+e[n+1].toString(16).padStart(2,"0"));return t.join(":")}default:throw new Error("Invalid ip length")}}(this.network)+"/"+t}}function Al(e){return Boolean(yl(e))}function Il(e){return Boolean(wl(e))}function _l(e){return Boolean(bl(e))}const Tl=Al,Ll=Il,Rl=function(e){let t=0;if(e=e.toString().trim(),Tl(e)){const n=new Uint8Array(t+4);return e.split(/\./g).forEach((e=>{n[t++]=255&parseInt(e,10)})),n}if(Ll(e)){const n=e.split(":",8);let r;for(r=0;r<n.length;r++){let e;Tl(n[r])&&(e=Rl(n[r]),n[r]=Wt(e.slice(0,2),"base16")),null!=e&&++r<8&&n.splice(r,0,Wt(e.slice(2,4),"base16"))}if(""===n[0])for(;n.length<8;)n.unshift("0");else if(""===n[n.length-1])for(;n.length<8;)n.push("0");else if(n.length<8){for(r=0;r<n.length&&""!==n[r];r++);const e=[r,1];for(r=9-n.length;r>0;r--)e.push("0");n.splice.apply(n,e)}const i=new Uint8Array(t+16);for(r=0;r<n.length;r++){const e=parseInt(n[r],16);i[t++]=e>>8&255,i[t++]=255&e}return i}throw new Error("invalid ip address")},Nl=-1,Ml={},Dl={};function Ol(e){if("number"===typeof e){if(null!=Dl[e])return Dl[e];throw new Error("no protocol with code: ".concat(e))}if("string"===typeof e){if(null!=Ml[e])return Ml[e];throw new Error("no protocol with name: ".concat(e))}throw new Error("invalid protocol id type: ".concat(typeof e))}[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Nl,"ip6zone"],[43,8,"ipcidr"],[53,Nl,"dns",!0],[54,Nl,"dns4",!0],[55,Nl,"dns6",!0],[56,Nl,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Nl,"unix",!1,!0],[421,Nl,"ipfs"],[421,Nl,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Nl,"garlic64"],[448,0,"tls"],[449,Nl,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,Nl,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[481,Nl,"http-path"],[777,Nl,"memory"]].forEach((e=>{const t=function(e,t,n,r,i){return{code:e,size:t,name:n,resolvable:Boolean(r),path:Boolean(i)}}(...e);Dl[t.code]=t,Ml[t.name]=t}));const zl=Ol("ip4"),Fl=Ol("ip6"),Ul=Ol("ipcidr");function Bl(e,t){switch(Ol(e).code){case 4:case 41:return function(e){const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;t=~~t,n=null!==n&&void 0!==n?n:e.length-t;const r=new DataView(e.buffer);if(4===n){const r=[];for(let i=0;i<n;i++)r.push(e[t+i]);return r.join(".")}if(16===n){const e=[];for(let i=0;i<n;i+=2)e.push(r.getUint16(t+i).toString(16));return e.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""}(e,0,e.length);if(null==t)throw new Error("ipBuff is required");if(!_l(t))throw new Error("invalid ip address");return t}(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Gl(t);case 43:return Wt(t,"base10");case 6:case 273:case 33:case 132:return Hl(t).toString();case 421:return function(e){const t=mo(e),n=e.slice(ho(t));if(n.length!==t)throw new Error("inconsistent lengths");return Wt(n,"base58btc")}(t);case 444:case 445:return Yl(t);case 466:return function(e){const t=mo(e),n=e.slice(ho(t));if(n.length!==t)throw new Error("inconsistent lengths");return"u"+Wt(n,"base64url")}(t);case 481:return globalThis.encodeURIComponent(Gl(t));default:return Wt(t,"base16")}}function ql(e,t){switch(Ol(e).code){case 4:case 41:return jl(t);case 42:case 53:case 54:case 55:case 56:case 400:case 449:case 777:return Ql(t);case 43:return jt(t,"base10");case 6:case 273:case 33:case 132:return Wl(parseInt(t,10));case 421:return function(e){let t;t="Q"===e[0]||"1"===e[0]?St(ze.decode("z".concat(e))).bytes:Mt.parse(e).multihash.bytes;const n=Uint8Array.from(go(t.length));return te([n,t],n.length+t.length)}(t);case 444:return function(e){const t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(16!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion address."));const n=Pe.decode("b"+t[0]),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=Wl(r);return te([n,i],n.length+i.length)}(t);case 445:return function(e){const t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: [\"'".concat(t.join('", "'),"'\"]' does not contain a port number"));if(56!==t[0].length)throw new Error("failed to parse onion addr: ".concat(t[0]," not a Tor onion3 address."));const n=Pe.decode("b".concat(t[0])),r=parseInt(t[1],10);if(r<1||r>65536)throw new Error("Port number is not in range(1, 65536)");const i=Wl(r);return te([n,i],n.length+i.length)}(t);case 466:return function(e){const t=Kl.decode(e),n=Uint8Array.from(go(t.length));return te([n,t],n.length+t.length)}(t);case 481:return Ql(globalThis.decodeURIComponent(t));default:return jt(t,"base16")}}const Vl=Object.values(Ut).map((e=>e.decoder)),Kl=function(){let e=Vl[0].or(Vl[1]);return Vl.slice(2).forEach((t=>e=e.or(t))),e}();function jl(e){if(!_l(e))throw new Error("invalid ip address");return Rl(e)}function Wl(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function Hl(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function Ql(e){const t=jt(e),n=Uint8Array.from(go(t.length));return te([n,t],n.length+t.length)}function Gl(e){const t=mo(e);if((e=e.slice(ho(t))).length!==t)throw new Error("inconsistent lengths");return Wt(e)}function Yl(e){const t=e.slice(0,e.length-2),n=e.slice(e.length-2),r=Wt(t,"base32"),i=Hl(n);return"".concat(r,":").concat(i)}function $l(e){const t=[],n=[];let r=null,i=0;for(;i<e.length;){const o=mo(e,i),s=ho(o),a=Ol(o),l=Jl(a,e.slice(i+s));if(0===l){t.push([o]),n.push([o]),i+=s;continue}const c=e.slice(i+s,i+s+l);if(i+=l+s,i>e.length)throw new tc("Invalid address Uint8Array: "+Wt(e,"base16"));t.push([o,c]);const u=Bl(o,c);if(n.push([o,u]),!0===a.path){r=u;break}}return{bytes:Uint8Array.from(e),string:Xl(n),tuples:t,stringTuples:n,path:r}}function Xl(e){const t=[];return e.map((e=>{const n=Ol(e[0]);return t.push(n.name),e.length>1&&null!=e[1]&&t.push(e[1]),null})),ec(t.join("/"))}function Zl(e){return te(e.map((e=>{const t=Ol(e[0]);let n=Uint8Array.from(go(t.code));return e.length>1&&null!=e[1]&&(n=te([n,e[1]])),n})))}function Jl(e,t){if(e.size>0)return e.size/8;if(0===e.size)return 0;{const e=mo(t instanceof Uint8Array?t:Uint8Array.from(t));return e+ho(e)}}function ec(e){return"/"+e.trim().split("/").filter((e=>e)).join("/")}class tc extends Error{constructor(e){super("Error parsing address: ".concat(e)),w(this,"name","ParseError")}}w(tc,"name","ParseError");const nc=Symbol.for("nodejs.util.inspect.custom"),rc=Symbol.for("@multiformats/js-multiaddr/multiaddr"),ic=[Ol("dns").code,Ol("dns4").code,Ol("dns6").code,Ol("dnsaddr").code];class oc extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"No available resolver"),this.name="NoAvailableResolverError"}}var sc=new WeakMap,ac=new WeakMap,lc=new WeakMap,cc=new WeakMap;class uc{constructor(e){let t;if(w(this,"bytes",void 0),ka(this,sc,void 0),ka(this,ac,void 0),ka(this,lc,void 0),ka(this,cc,void 0),w(this,rc,!0),null==e&&(e=""),e instanceof Uint8Array)t=$l(e);else if("string"===typeof e){if(e.length>0&&"/"!==e.charAt(0))throw new Error('multiaddr "'.concat(e,'" must start with a "/"'));t=function(e){const t=[],n=[];let r=null;const i=(e=ec(e)).split("/").slice(1);if(1===i.length&&""===i[0])return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let o=0;o<i.length;o++){const s=Ol(i[o]);if(0===s.size){t.push([s.code]),n.push([s.code]);continue}if(o++,o>=i.length)throw new tc("invalid address: "+e);if(!0===s.path){r=ec(i.slice(o).join("/")),t.push([s.code,ql(s.code,r)]),n.push([s.code,r]);break}const a=ql(s.code,i[o]);t.push([s.code,a]),n.push([s.code,Bl(s.code,a)])}return{string:Xl(n),bytes:Zl(t),tuples:t,stringTuples:n,path:r}}(e)}else{if(!hc(e))throw new Error("addr must be a string, Buffer, or another Multiaddr");t=$l(e.bytes)}this.bytes=t.bytes,Aa(sc,this,t.string),Aa(ac,this,t.tuples),Aa(lc,this,t.stringTuples),Aa(cc,this,t.path)}toString(){return Pa(sc,this)}toJSON(){return this.toString()}toOptions(){let e,t,n,r,i="";const o=Ol("tcp"),s=Ol("udp"),a=Ol("ip4"),l=Ol("ip6"),c=Ol("dns6"),u=Ol("ip6zone");for(const[d,h]of this.stringTuples())d===u.code&&(i="%".concat(null!==h&&void 0!==h?h:"")),ic.includes(d)&&(t="tcp"===o.name?"tcp":"udp",r=443,n="".concat(null!==h&&void 0!==h?h:"").concat(i),e=d===c.code?6:4),d!==o.code&&d!==s.code||(t="tcp"===Ol(d).name?"tcp":"udp",r=parseInt(null!==h&&void 0!==h?h:"")),d!==a.code&&d!==l.code||(t="tcp"===Ol(d).name?"tcp":"udp",n="".concat(null!==h&&void 0!==h?h:"").concat(i),e=d===l.code?6:4);if(null==e||null==t||null==n||null==r)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:t,port:r}}protos(){return Pa(ac,this).map((e=>{let[t]=e;return Object.assign({},Ol(t))}))}protoCodes(){return Pa(ac,this).map((e=>{let[t]=e;return t}))}protoNames(){return Pa(ac,this).map((e=>{let[t]=e;return Ol(t).name}))}tuples(){return Pa(ac,this).map((e=>{let[t,n]=e;return null==n?[t]:[t,n]}))}stringTuples(){return Pa(lc,this).map((e=>{let[t,n]=e;return null==n?[t]:[t,n]}))}encapsulate(e){return e=new uc(e),new uc(this.toString()+e.toString())}decapsulate(e){const t=e.toString(),n=this.toString(),r=n.lastIndexOf(t);if(r<0)throw new Error("Address ".concat(this.toString()," does not contain subaddress: ").concat(e.toString()));return new uc(n.slice(0,r))}decapsulateCode(e){const t=this.tuples();for(let n=t.length-1;n>=0;n--)if(t[n][0]===e)return new uc(Zl(t.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach((t=>{let[n,r]=t;n===Ml.p2p.code&&e.push([n,r]),n===Ml["p2p-circuit"].code&&(e=[])}));const t=e.pop();if(null!=(null===t||void 0===t?void 0:t[1])){const e=t[1];return"Q"===e[0]||"1"===e[0]?Wt(ze.decode("z".concat(e)),"base58btc"):Wt(Mt.parse(e).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){return Pa(cc,this)}equals(e){return ne(this.bytes,e.bytes)}async resolve(e){const t=this.protos().find((e=>e.resolvable));if(null==t)return[this];const n=dc.get(t.name);if(null==n)throw new oc("no available resolver for ".concat(t.name));return(await n(this,e)).map((e=>fc(e)))}nodeAddress(){const e=this.toOptions();if("tcp"!==e.transport&&"udp"!==e.transport)throw new Error('multiaddr must have a valid format - no protocol with name: "'.concat(e.transport,'". Must have a valid transport protocol: "{tcp, udp}"'));return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const t=(null!==e&&void 0!==e?e:this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))}[nc](){return"Multiaddr(".concat(Pa(sc,this),")")}}const dc=new Map;function hc(e){return Boolean(null===e||void 0===e?void 0:e[rc])}function fc(e){return new uc(e)}const{code:pc}=Ol("dnsaddr");class gc extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Max recursive depth reached"),this.name="RecursionLimitError"}}const mc=async function(e){var t,n,r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=null!==(t=i.maxRecursiveDepth)&&void 0!==t?t:32;if(0===o)throw new gc("Max recursive depth reached");const[,s]=null!==(n=e.stringTuples().find((e=>{let[t]=e;return t===pc})))&&void 0!==n?n:[],a=null!==(r=null===i||void 0===i?void 0:i.dns)&&void 0!==r?r:function(){return new gl(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}(),l=await a.query("_dnsaddr.".concat(s),{signal:null===i||void 0===i?void 0:i.signal,types:[ml.TXT]}),c=e.getPeerId(),u=[];for(const d of l.Answer){const e=d.data.replace(/["']/g,"").trim().split("=")[1];if(null==e)continue;if(null!=c&&!e.includes(c))continue;const t=fc(e);if(e.startsWith("/dnsaddr")){const e=await t.resolve(E(E({},i),{},{maxRecursiveDepth:o-1}));u.push(...e.map((e=>e.toString())))}else u.push(t.toString())}return u},vc={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:e=>e},connectionManager:{resolvers:{dnsaddr:mc}},transportManager:{faultTolerance:la.FATAL_ALL}};var yc=new WeakMap;class wc extends EventTarget{constructor(){super(),ka(this,yc,new Map)}listenerCount(e){const t=Pa(yc,this).get(e);return null==t?0:t.length}addEventListener(e,t,n){var r;super.addEventListener(e,t,n);let i=Pa(yc,this).get(e);null==i&&(i=[],Pa(yc,this).set(e,i)),i.push({callback:t,once:null!==(r=!0!==n&&!1!==n&&(null===n||void 0===n?void 0:n.once))&&void 0!==r&&r})}removeEventListener(e,t,n){super.removeEventListener(e.toString(),null!==t&&void 0!==t?t:null,n);let r=Pa(yc,this).get(e);null!=r&&(r=r.filter((e=>{let{callback:n}=e;return n!==t})),Pa(yc,this).set(e,r))}dispatchEvent(e){const t=super.dispatchEvent(e);let n=Pa(yc,this).get(e.type);return null==n||(n=n.filter((e=>{let{once:t}=e;return!t})),Pa(yc,this).set(e.type,n)),t}safeDispatchEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.dispatchEvent(new CustomEvent(e,t))}}const bc=Symbol.for("@libp2p/content-routing"),Ec=Symbol.for("@libp2p/peer-routing"),Sc=Symbol.for("@libp2p/peer-discovery"),kc=1e3,xc=60*kc,Cc=60*xc,Pc=24*Cc,Ac=7*Pc,Ic=365.25*Pc;const _c=function(e,t){try{if("string"===typeof e&&e.length>0)return function(e){if((e=String(e)).length>100)throw new Error("Value exceeds the maximum length of 100 characters.");const t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return NaN;const n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*Ic;case"weeks":case"week":case"w":return n*Ac;case"days":case"day":case"d":return n*Pc;case"hours":case"hour":case"hrs":case"hr":case"h":return n*Cc;case"minutes":case"minute":case"mins":case"min":case"m":return n*xc;case"seconds":case"second":case"secs":case"sec":case"s":return n*kc;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:throw new Error("The unit ".concat(r," was matched, but no matching case exists."))}}(e);if("number"===typeof e&&isFinite(e))return null!==t&&void 0!==t&&t.long?function(e){const t=Math.abs(e);if(t>=Pc)return Tc(e,t,Pc,"day");if(t>=Cc)return Tc(e,t,Cc,"hour");if(t>=xc)return Tc(e,t,xc,"minute");if(t>=kc)return Tc(e,t,kc,"second");return"".concat(e," ms")}(e):function(e){const t=Math.abs(e);if(t>=Pc)return"".concat(Math.round(e/Pc),"d");if(t>=Cc)return"".concat(Math.round(e/Cc),"h");if(t>=xc)return"".concat(Math.round(e/xc),"m");if(t>=kc)return"".concat(Math.round(e/kc),"s");return"".concat(e,"ms")}(e);throw new Error("Value is not a string or number.")}catch(n){const t=function(e){return"object"===typeof e&&null!==e&&"message"in e}(n)?"".concat(n.message,". value=").concat(JSON.stringify(e)):"An unknown error has occured.";throw new Error(t)}};function Tc(e,t,n,r){const i=t>=1.5*n;return"".concat(Math.round(e/n)," ").concat(r).concat(i?"s":"")}var Lc,Rc;const Nc=function(){try{return localStorage}catch(e){}}();const Mc=null!==(Lc=null!==(Rc=console.debug)&&void 0!==Rc?Rc:console.log)&&void 0!==Lc?Lc:()=>{};const Dc=function(e){function t(e){let r,i,o,s=null;function a(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(!a.enabled)return;const o=a,s=Number(new Date),l=s-(r||s);o.diff=l,o.prev=r,o.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");let c=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,((e,r)=>{if("%%"===e)return"%";c++;const i=t.formatters[r];if("function"===typeof i){const t=n[c];e=i.call(o,t),n.splice(c,1),c--}return e})),t.formatArgs.call(o,n);(o.log||t.log).apply(o,n)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{s=e}}),"function"===typeof t.init&&t.init(a),a}function n(e,n){const r=t(this.namespace+("undefined"===typeof n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){var t;return e instanceof Error?null!==(t=e.stack)&&void 0!==t?t:e.message:e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"===typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=_c,t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.setupFormatters(t.formatters),t.enable(t.load()),t}({formatArgs:function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+_c(this.diff),!this.useColors)return;const t="color: "+this.color;e.splice(1,0,t,"color: inherit");let n=0,r=0;e[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(r=n))})),e.splice(r,0,t)},save:function(e){try{e?null===Nc||void 0===Nc||Nc.setItem("debug",e):null===Nc||void 0===Nc||Nc.removeItem("debug")}catch(t){}},load:function(){let e;try{e=null===Nc||void 0===Nc?void 0:Nc.getItem("debug")}catch(t){}return!e&&"undefined"!==typeof globalThis.process&&"env"in globalThis.process&&(e=globalThis.process.env.DEBUG),e},useColors:function(){var e,t,n,r;return!("undefined"===typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"===typeof navigator||null==(null===(e=navigator.userAgent)||void 0===e?void 0:e.toLowerCase().match(/(edge|trident)\/(\d+)/)))&&("undefined"!==typeof document&&(null===(t=document.documentElement)||void 0===t||null===(t=t.style)||void 0===t?void 0:t.WebkitAppearance)||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&null!=(null===(n=navigator.userAgent)||void 0===n?void 0:n.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&(null===(r=navigator.userAgent)||void 0===r?void 0:r.toLowerCase().match(/applewebkit\/(\d+)/)))},setupFormatters:function(e){e.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},colors:["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],storage:Nc,log:Mc}),Oc=Dc;function zc(){return{forComponent:e=>Fc(e)}}function Fc(e){let t=function(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}("".concat(e,":trace"));return Oc.enabled("".concat(e,":trace"))&&null!=Oc.names.map((e=>e.toString())).find((e=>e.includes(":trace")))&&(t=Oc("".concat(e,":trace"))),Object.assign(Oc(e),{error:Oc("".concat(e,":error")),trace:t})}function Uc(e){if(null!=e&&0!==(e=e.trim()).length)return e}function Bc(e,t){const n={[Symbol.iterator]:()=>n,next:()=>{const n=e.next(),r=n.value;if(!0===n.done||null==r){return{done:!0,value:void 0}}return{done:!1,value:t(r)}}};return n}function qc(e){return oa(St(ze.decode("z".concat(e))))}Oc.formatters.b=e=>null==e?"undefined":ze.baseEncode(e),Oc.formatters.t=e=>null==e?"undefined":Pe.baseEncode(e),Oc.formatters.m=e=>null==e?"undefined":Ue.baseEncode(e),Oc.formatters.p=e=>null==e?"undefined":e.toString(),Oc.formatters.c=e=>null==e?"undefined":e.toString(),Oc.formatters.k=e=>null==e?"undefined":e.toString(),Oc.formatters.a=e=>null==e?"undefined":e.toString(),Oc.formatters.e=e=>{var t,n;return null==e?"undefined":null!==(t=null!==(n=Uc(e.stack))&&void 0!==n?n:Uc(e.message))&&void 0!==t?t:e.toString()};class Vc{constructor(e){if(w(this,"set",void 0),this.set=new Set,null!=e)for(const t of e)this.set.add(t.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return Bc(this.set.entries(),(e=>{const t=qc(e[0]);return[t,t]}))}forEach(e){this.set.forEach((t=>{const n=qc(t);e(n,n,this)}))}has(e){return this.set.has(e.toString())}values(){return Bc(this.set.values(),(e=>qc(e)))}intersection(e){const t=new Vc;for(const n of e)this.has(n)&&t.add(n);return t}difference(e){const t=new Vc;for(const n of this)e.has(n)||t.add(n);return t}union(e){const t=new Vc;for(const n of e)t.add(n);for(const n of this)t.add(n);return t}}function Kc(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new jc(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function jc(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return jc=function(e){this.s=e,this.n=e.next},jc.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new jc(e)}var Wc,Hc;!function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.publicKey&&e.publicKey.byteLength>0&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.payloadType&&e.payloadType.byteLength>0&&(t.uint32(18),t.bytes(e.payloadType)),null!=e.payload&&e.payload.byteLength>0&&(t.uint32(26),t.bytes(e.payload)),null!=e.signature&&e.signature.byteLength>0&&(t.uint32(42),t.bytes(e.signature)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={publicKey:J(0),payloadType:J(0),payload:J(0),signature:J(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.publicKey=e.bytes();break;case 2:n.payloadType=e.bytes();break;case 3:n.payload=e.bytes();break;case 5:n.signature=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(Wc||(Wc={}));class Qc extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid signature"),this.name="InvalidSignatureError"}}class Gc{constructor(e){w(this,"publicKey",void 0),w(this,"payloadType",void 0),w(this,"payload",void 0),w(this,"signature",void 0),w(this,"marshaled",void 0);const{publicKey:t,payloadType:n,payload:r,signature:i}=e;this.publicKey=t,this.payloadType=n,this.payload=r,this.signature=i}marshal(){return null==this.marshaled&&(this.marshaled=Wc.encode({publicKey:Qs(this.publicKey),payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return null!=e&&ne(this.marshal(),e.marshal())}async validate(e){const t=Yc(e,this.payloadType,this.payload);return this.publicKey.verify(t.subarray(),this.signature)}}Hc=Gc,w(Gc,"createFromProtobuf",(async e=>{const t=Wc.decode(e),n=Hs(t.publicKey);return new Hc({publicKey:n,payloadType:t.payloadType,payload:t.payload,signature:t.signature})})),w(Gc,"seal",(async(e,t)=>{if(null==t)throw new Error("Missing private key");const n=e.domain,r=e.codec,i=e.marshal(),o=Yc(n,r,i),s=await t.sign(o.subarray());return new Hc({publicKey:t.publicKey,payloadType:r,payload:i,signature:s})})),w(Gc,"openAndCertify",(async(e,t)=>{const n=await Hc.createFromProtobuf(e);if(!await n.validate(t))throw new Qc("Envelope signature is not valid for the given domain");return n}));const Yc=(e,t,n)=>{const r=jt(e),i=go(r.byteLength),o=go(t.length),s=go(n.length);return new se(i,r,o,t,s,n)};const $c=Uint8Array.from([3,1]);var Xc,Zc;!function(e){let t,n;!function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={multiaddr:J(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();if(t>>>3===1)n.multiaddr=e.bytes();else e.skipType(7&t)}return n}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(t=e.AddressInfo||(e.AddressInfo={})),e.codec=()=>(null==n&&(n=es((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.peerId&&t.peerId.byteLength>0&&(n.uint32(10),n.bytes(t.peerId)),null!=t.seq&&0n!==t.seq&&(n.uint32(16),n.uint64(t.seq)),null!=t.addresses)for(const i of t.addresses)n.uint32(26),e.AddressInfo.codec().encode(i,n);!1!==r.lengthDelimited&&n.ldelim()}),(function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={peerId:J(0),seq:0n,addresses:[]},o=null==n?t.len:t.pos+n;for(;t.pos<o;){const n=t.uint32();switch(n>>>3){case 1:i.peerId=t.bytes();break;case 2:i.seq=t.uint64();break;case 3:var s,a;if(null!=(null===(s=r.limits)||void 0===s?void 0:s.addresses)&&i.addresses.length===r.limits.addresses)throw new ts('Decode error - map field "addresses" had too many elements');i.addresses.push(e.AddressInfo.codec().decode(t,t.uint32(),{limits:null===(a=r.limits)||void 0===a?void 0:a.addresses$}));break;default:t.skipType(7&n)}}return i}))),n),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(Xc||(Xc={}));class Jc{constructor(e){w(this,"peerId",void 0),w(this,"multiaddrs",void 0),w(this,"seqNumber",void 0),w(this,"domain",Jc.DOMAIN),w(this,"codec",Jc.CODEC),w(this,"marshaled",void 0);const{peerId:t,multiaddrs:n,seqNumber:r}=e;this.peerId=t,this.multiaddrs=null!==n&&void 0!==n?n:[],this.seqNumber=null!==r&&void 0!==r?r:BigInt(Date.now())}marshal(){return null==this.marshaled&&(this.marshaled=Xc.encode({peerId:this.peerId.toMultihash().bytes,seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map((e=>({multiaddr:e.bytes})))})),this.marshaled}equals(e){return e instanceof Jc&&(!!this.peerId.equals(e.peerId)&&(this.seqNumber===e.seqNumber&&!!function(e,t){const n=(e,t)=>e.toString().localeCompare(t.toString());return e.length===t.length&&(t.sort(n),e.sort(n).every(((e,n)=>t[n].equals(e))))}(this.multiaddrs,e.multiaddrs)))}}Zc=Jc,w(Jc,"createFromProtobuf",(e=>{var t;const n=Xc.decode(e),r=oa(St(n.peerId)),i=(null!==(t=n.addresses)&&void 0!==t?t:[]).map((e=>fc(e.multiaddr))),o=n.seq;return new Zc({peerId:r,multiaddrs:i,seqNumber:o})})),w(Jc,"DOMAIN","libp2p-peer-record"),w(Jc,"CODEC",$c);const eu=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{const t=[];var n,r=!1,i=!1;try{for(var o,s=Kc(e);r=!(o=await s.next()).done;r=!1){const e=o.value;t.push(e)}}catch(a){i=!0,n=a}finally{try{r&&null!=s.return&&await s.return()}finally{if(i)throw n}}return t})();const t=[];for(const n of e)t.push(n);return t};function tu(e,t){this.v=e,this.k=t}function nu(e){return new tu(e,0)}function ru(e){return function(){return new iu(e.apply(this,arguments))}}function iu(e){var t,n;function r(t,n){try{var o=e[t](n),s=o.value,a=s instanceof tu;Promise.resolve(a?s.v:s).then((function(n){if(a){var l="return"===t?"return":"next";if(!s.k||n.done)return r(l,n);n=e[l](n).value}i(o.done?"return":"normal",n)}),(function(e){r("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise((function(o,s){var a={key:e,arg:i,resolve:o,reject:s,next:null};n?n=n.next=a:(t=n=a,r(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}iu.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},iu.prototype.next=function(e){return this._invoke("next",e)},iu.prototype.throw=function(e){return this._invoke("throw",e)},iu.prototype.return=function(e){return this._invoke("return",e)};const ou={},su=e=>{e.addEventListener("message",(t=>{su.dispatchEvent("message",e,t)})),null!=e.port&&e.port.addEventListener("message",(t=>{su.dispatchEvent("message",e,t)}))};su.addEventListener=(e,t)=>{null==ou[e]&&(ou[e]=[]),ou[e].push(t)},su.removeEventListener=(e,t)=>{null!=ou[e]&&(ou[e]=ou[e].filter((e=>e===t)))},su.dispatchEvent=function(e,t,n){null!=ou[e]&&ou[e].forEach((e=>e(t,n)))};const au=su,lu="lock:worker:request-read",cu="lock:worker:release-read",uu="lock:master:grant-read",du="lock:worker:request-write",hu="lock:worker:release-write",fu="lock:master:grant-write",pu=(e,t,n,r,i)=>(o,s)=>{if(s.data.type!==n)return;const a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:a.name,handler:async()=>{o.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise((e=>{const t=n=>{if(null==(null===n||void 0===n?void 0:n.data))return;const i=n.data.type,s=(n.data.name,n.data.identifier);i===r&&s===a.identifier&&(o.removeEventListener("message",t),e())};o.addEventListener("message",t)}))}}}))},gu=(e,t,n,r)=>async()=>{const i=Math.random().toString().substring(2);return globalThis.postMessage({type:t,identifier:i,name:e}),new Promise((t=>{const o=s=>{if(null==(null===s||void 0===s?void 0:s.data))return;const a=s.data.type,l=s.data.identifier;a===n&&l===i&&(globalThis.removeEventListener("message",o),t((()=>{globalThis.postMessage({type:r,identifier:i,name:e})})))};globalThis.addEventListener("message",o)}))},mu={singleProcess:!1},vu={};let yu;async function wu(e,t){let n;const r=new Promise((e=>{n=e}));return e.add((async()=>Na((async()=>{await new Promise((e=>{n((()=>{e()}))}))})(),{milliseconds:t.timeout}))),r}const bu={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function Eu(e){const t=Object.assign({},bu,e);return null==yu&&(yu=(e=>{if(e=Object.assign({},mu,e),Boolean(globalThis.document)||e.singleProcess){const e=new EventTarget;return au.addEventListener("message",pu(e,"requestReadLock",lu,cu,uu)),au.addEventListener("message",pu(e,"requestWriteLock",du,hu,fu)),e}return{isWorker:!0,readLock:e=>gu(e,lu,uu,cu),writeLock:e=>gu(e,du,fu,hu)}})(t),!0!==yu.isWorker&&(yu.addEventListener("requestReadLock",(e=>{null!=vu[e.data.name]&&vu[e.data.name].readLock().then((async t=>e.data.handler().finally((()=>{t()}))))})),yu.addEventListener("requestWriteLock",(async e=>{null!=vu[e.data.name]&&vu[e.data.name].writeLock().then((async t=>e.data.handler().finally((()=>{t()}))))})))),null==vu[t.name]&&(vu[t.name]=((e,t)=>{if(!0===yu.isWorker)return{readLock:yu.readLock(e,t),writeLock:yu.writeLock(e,t)};const n=new Za({concurrency:1});let r;return{async readLock(){if(null!=r)return wu(r,t);r=new Za({concurrency:t.concurrency,autoStart:!1});const e=r,i=wu(r,t);return n.add((async()=>{e.start(),await e.onIdle().then((()=>{r===e&&(r=null)}))})),i},writeLock:async()=>(r=null,wu(n,t))}})(t.name,t)),vu[t.name]}var Su,ku,xu;function Cu(e,t){if(null!=e.publicKey||null==t.publicKey)return e;let n;if("RSA"===e.type){n=St(ze.decode("z".concat(e)))}return ia(Hs(t.publicKey,n))}function Pu(e,t,n){return Au(e,Su.decode(t),n)}function Au(e,t,n){var r;const i=new Map,o=BigInt(Date.now());for(const[s,a]of t.tags.entries())null!=a.expiry&&a.expiry<o||i.set(s,a);return E(E({},t),{},{id:Cu(e,t),addresses:t.addresses.filter((e=>{let{observed:t}=e;return null!=t&&t>Date.now()-n})).map((e=>{let{multiaddr:t,isCertified:n}=e;return{multiaddr:fc(t),isCertified:null!==n&&void 0!==n&&n}})),metadata:t.metadata,peerRecordEnvelope:null!==(r=t.peerRecordEnvelope)&&void 0!==r?r:void 0,tags:i})}function Iu(e,t){return u=e.addresses,d=t.addresses,Tu(u,d,((e,t)=>e.isCertified===t.isCertified&&!!ne(e.multiaddr,t.multiaddr)))&&(l=e.protocols,c=t.protocols,Tu(l,c,((e,t)=>e===t)))&&(s=e.publicKey,a=t.publicKey,_u(s,a))&&(i=e.peerRecordEnvelope,o=t.peerRecordEnvelope,_u(i,o))&&(n=e.metadata,r=t.metadata,Lu(n,r,((e,t)=>ne(e,t))))&&function(e,t){return Lu(e,t,((e,t)=>e.value===t.value&&e.expiry===t.expiry))}(e.tags,t.tags);var n,r,i,o,s,a,l,c,u,d}function _u(e,t){return null==e&&null==t||null!=e&&null!=t&&ne(e,t)}function Tu(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!n(e[r],t[r]))return!1;return!0}function Lu(e,t,n){if(e.size!==t.size)return!1;for(const[r,i]of e.entries()){const e=t.get(r);if(null==e)return!1;if(!n(i,e))return!1}return!0}!function(e){let t,n,r;!function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={key:"",value:J(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.string();break;case 2:n.value=e.bytes();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(t=e.Peer$metadataEntry||(e.Peer$metadataEntry={})),function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&""!==e.key&&(t.uint32(10),t.string(e.key)),null!=e.value&&(t.uint32(18),xu.codec().encode(e.value,t)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={key:""},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:r.key=e.string();break;case 2:var o;r.value=xu.codec().decode(e,e.uint32(),{limits:null===(o=n.limits)||void 0===o?void 0:o.value});break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(n=e.Peer$tagsEntry||(e.Peer$tagsEntry={})),e.codec=()=>(null==r&&(r=es((function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==r.lengthDelimited&&n.fork(),null!=t.addresses)for(const e of t.addresses)n.uint32(10),ku.codec().encode(e,n);if(null!=t.protocols)for(const e of t.protocols)n.uint32(18),n.string(e);if(null!=t.publicKey&&(n.uint32(34),n.bytes(t.publicKey)),null!=t.peerRecordEnvelope&&(n.uint32(42),n.bytes(t.peerRecordEnvelope)),null!=t.metadata&&0!==t.metadata.size)for(const[i,o]of t.metadata.entries())n.uint32(50),e.Peer$metadataEntry.codec().encode({key:i,value:o},n);if(null!=t.tags&&0!==t.tags.size)for(const[i,o]of t.tags.entries())n.uint32(58),e.Peer$tagsEntry.codec().encode({key:i,value:o},n);null!=t.updated&&(n.uint32(64),n.uint64Number(t.updated)),!1!==r.lengthDelimited&&n.ldelim()}),(function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i={addresses:[],protocols:[],metadata:new Map,tags:new Map},o=null==n?t.len:t.pos+n;for(;t.pos<o;){const n=t.uint32();switch(n>>>3){case 1:var s,a;if(null!=(null===(s=r.limits)||void 0===s?void 0:s.addresses)&&i.addresses.length===r.limits.addresses)throw new ts('Decode error - map field "addresses" had too many elements');i.addresses.push(ku.codec().decode(t,t.uint32(),{limits:null===(a=r.limits)||void 0===a?void 0:a.addresses$}));break;case 2:var l;if(null!=(null===(l=r.limits)||void 0===l?void 0:l.protocols)&&i.protocols.length===r.limits.protocols)throw new ts('Decode error - map field "protocols" had too many elements');i.protocols.push(t.string());break;case 4:i.publicKey=t.bytes();break;case 5:i.peerRecordEnvelope=t.bytes();break;case 6:{var c;if(null!=(null===(c=r.limits)||void 0===c?void 0:c.metadata)&&i.metadata.size===r.limits.metadata)throw new ns('Decode error - map field "metadata" had too many elements');const n=e.Peer$metadataEntry.codec().decode(t,t.uint32());i.metadata.set(n.key,n.value);break}case 7:{var u,d;if(null!=(null===(u=r.limits)||void 0===u?void 0:u.tags)&&i.tags.size===r.limits.tags)throw new ns('Decode error - map field "tags" had too many elements');const n=e.Peer$tagsEntry.codec().decode(t,t.uint32(),{limits:{value:null===(d=r.limits)||void 0===d?void 0:d.tags$value}});i.tags.set(n.key,n.value);break}case 8:i.updated=t.uint64Number();break;default:t.skipType(7&n)}}return i}))),r),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(Su||(Su={})),function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.multiaddr&&e.multiaddr.byteLength>0&&(t.uint32(10),t.bytes(e.multiaddr)),null!=e.isCertified&&(t.uint32(16),t.bool(e.isCertified)),null!=e.observed&&(t.uint32(24),t.uint64Number(e.observed)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={multiaddr:J(0)},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.multiaddr=e.bytes();break;case 2:n.isCertified=e.bool();break;case 3:n.observed=e.uint64Number();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(ku||(ku={})),function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.value&&0!==e.value&&(t.uint32(8),t.uint32(e.value)),null!=e.expiry&&(t.uint32(16),t.uint64(e.expiry)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={value:0},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.value=e.uint32();break;case 2:n.expiry=e.uint64();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(xu||(xu={}));const Ru="/",Nu=(new TextEncoder).encode(Ru),Mu=Nu[0];class Du{constructor(e,t){if(w(this,"_buf",void 0),"string"===typeof e)this._buf=jt(e);else{if(!(e instanceof Uint8Array))throw new Error("Invalid key, should be String of Uint8Array");this._buf=e}if(null==t&&(t=!0),t&&this.clean(),0===this._buf.byteLength||this._buf[0]!==Mu)throw new Error("Invalid key")}toString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utf8";return Wt(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return"Key(".concat(this.toString(),")")}static withNamespaces(e){return new Du(e.join(Ru))}static random(){return new Du(Math.random().toString().substring(2))}static asKey(e){return e instanceof Uint8Array||"string"===typeof e?new Du(e):"function"===typeof e.uint8Array?new Du(e.uint8Array()):null}clean(){if(null!=this._buf&&0!==this._buf.byteLength||(this._buf=Nu),this._buf[0]!==Mu){const e=new Uint8Array(this._buf.byteLength+1);e.fill(Mu,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Mu;)this._buf=this._buf.subarray(0,-1)}less(e){const t=this.list(),n=e.list();for(let r=0;r<t.length;r++){if(n.length<r+1)return!1;const e=t[r],i=n[r];if(e<i)return!0;if(e>i)return!1}return t.length<n.length}reverse(){return Du.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Ru).slice(1)}type(){return function(e){const t=e.split(":");if(t.length<2)return"";return t.slice(0,-1).join(":")}(this.baseNamespace())}name(){return function(e){const t=e.split(":");return t[t.length-1]}(this.baseNamespace())}instance(e){return new Du(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Ru)||(e+=Ru),e+=this.type(),new Du(e)}parent(){const e=this.list();return 1===e.length?new Du(Ru):new Du(e.slice(0,-1).join(Ru))}child(e){return this.toString()===Ru?e:e.toString()===Ru?this:new Du(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()!==this.toString()&&e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()!==this.toString()&&this.toString().startsWith(e.toString())}isTopLevel(){return 1===this.list().length}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Du.withNamespaces([...this.namespaces(),...(r=t.map((e=>e.namespaces())),[].concat(...r))]);var r}}const Ou="/peers/";function zu(e){if(!$s(e)||null==e.type)throw new C("Invalid PeerId");const t=e.toCID().toString();return new Du("".concat(Ou).concat(t))}async function Fu(e,t,n,r){const i=new Map;for(const s of n){var o;if(null==s)continue;if(s.multiaddr instanceof Uint8Array&&(s.multiaddr=fc(s.multiaddr)),!hc(s.multiaddr))throw new C("Multiaddr was invalid");if(!await t(e,s.multiaddr))continue;const n=null!==(o=s.isCertified)&&void 0!==o&&o,r=s.multiaddr.toString(),a=i.get(r);null!=a?s.isCertified=a.isCertified||n:i.set(r,{multiaddr:s.multiaddr,isCertified:n})}return[...i.values()].sort(((e,t)=>e.multiaddr.toString().localeCompare(t.multiaddr.toString()))).map((t=>{let{isCertified:n,multiaddr:r}=t;const i=r.getPeerId();return e.equals(i)&&(r=r.decapsulate(fc("/p2p/".concat(e)))),{isCertified:n,multiaddr:r.bytes}}))}async function Uu(e,t,n,r){var i,o,s,a,l,c,u;if(null==t)throw new C("Invalid PeerData");if(null!=t.publicKey&&null!=e.publicKey&&!t.publicKey.equals(e.publicKey))throw new C("publicKey bytes do not match peer id publicKey bytes");const d=null===(i=r.existingPeer)||void 0===i?void 0:i.peer;if(null!=d&&!e.equals(d.id))throw new C("peer id did not match existing peer id");let h,f=null!==(o=null===d||void 0===d?void 0:d.addresses)&&void 0!==o?o:[],p=new Set(null!==(s=null===d||void 0===d?void 0:d.protocols)&&void 0!==s?s:[]),g=null!==(a=null===d||void 0===d?void 0:d.metadata)&&void 0!==a?a:new Map,m=null!==(l=null===d||void 0===d?void 0:d.tags)&&void 0!==l?l:new Map,v=null===d||void 0===d?void 0:d.peerRecordEnvelope;if("patch"===n){if(null==t.multiaddrs&&null==t.addresses||(f=[],null!=t.multiaddrs&&f.push(...t.multiaddrs.map((e=>({isCertified:!1,multiaddr:e})))),null!=t.addresses&&f.push(...t.addresses)),null!=t.protocols&&(p=new Set(t.protocols)),null!=t.metadata){g=Bu(t.metadata instanceof Map?[...t.metadata.entries()]:Object.entries(t.metadata),{validate:qu})}if(null!=t.tags){m=Bu(t.tags instanceof Map?[...t.tags.entries()]:Object.entries(t.tags),{validate:Vu,map:Ku})}null!=t.peerRecordEnvelope&&(v=t.peerRecordEnvelope)}if("merge"===n){if(null!=t.multiaddrs&&f.push(...t.multiaddrs.map((e=>({isCertified:!1,multiaddr:e})))),null!=t.addresses&&f.push(...t.addresses),null!=t.protocols&&(p=new Set([...p,...t.protocols])),null!=t.metadata){const e=t.metadata instanceof Map?[...t.metadata.entries()]:Object.entries(t.metadata);for(const[t,n]of e)null==n?g.delete(t):g.set(t,n);g=Bu([...g.entries()],{validate:qu})}if(null!=t.tags){const e=t.tags instanceof Map?[...t.tags.entries()]:Object.entries(t.tags),n=new Map(m);for(const[t,r]of e)null==r?n.delete(t):n.set(t,r);m=Bu([...n.entries()],{validate:Vu,map:Ku})}null!=t.peerRecordEnvelope&&(v=t.peerRecordEnvelope)}null!=(null===d||void 0===d?void 0:d.id.publicKey)?h=Qs(d.id.publicKey):null!=t.publicKey?h=Qs(t.publicKey):null!=e.publicKey&&(h=Qs(e.publicKey));const y={addresses:await Fu(e,null!==(c=r.addressFilter)&&void 0!==c?c:async()=>!0,f,null===(u=r.existingPeer)||void 0===u||u.peerPB.addresses),protocols:[...p.values()].sort(((e,t)=>e.localeCompare(t))),metadata:g,tags:m,publicKey:h,peerRecordEnvelope:v};return y.addresses.forEach((e=>{var t,n;e.observed=null!==(t=null===(n=r.existingPeer)||void 0===n||null===(n=n.peerPB.addresses)||void 0===n||null===(n=n.find((e=>ne(e.multiaddr,e.multiaddr))))||void 0===n?void 0:n.observed)&&void 0!==t?t:Date.now()})),"RSA"!==e.type&&delete y.publicKey,y}function Bu(e,t){const n=new Map;for(const[o,s]of e)null!=s&&t.validate(o,s);for(const[o,s]of e.sort(((e,t)=>{let[n]=e,[r]=t;return n.localeCompare(r)}))){var r,i;if(null!=s)n.set(o,null!==(r=null===(i=t.map)||void 0===i?void 0:i.call(t,o,s))&&void 0!==r?r:s)}return n}function qu(e,t){if("string"!==typeof e)throw new C("Metadata key must be a string");if(!(t instanceof Uint8Array))throw new C("Metadata value must be a Uint8Array")}function Vu(e,t){if("string"!==typeof e)throw new C("Tag name must be a string");if(null!=t.value){if(parseInt("".concat(t.value),10)!==t.value)throw new C("Tag value must be an integer");if(t.value<0||t.value>100)throw new C("Tag value must be between 0-100")}if(null!=t.ttl){if(parseInt("".concat(t.ttl),10)!==t.ttl)throw new C("Tag ttl must be an integer");if(t.ttl<0)throw new C("Tag ttl must be between greater than 0")}}function Ku(e,t){var n;let r;return null!=t.expiry&&(r=t.expiry),null!=t.ttl&&(r=BigInt(Date.now()+Number(t.ttl))),{value:null!==(n=t.value)&&void 0!==n?n:0,expiry:r}}function ju(e){const t=e.toString().split("/")[2];return sa(Mt.parse(t,Pe))}function Wu(e,t,n){return Pu(ju(e),t,n)}var Hu=new WeakSet;class Qu{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Sa(this,Hu),w(this,"peerId",void 0),w(this,"datastore",void 0),w(this,"lock",void 0),w(this,"addressFilter",void 0),w(this,"log",void 0),w(this,"maxAddressAge",void 0),w(this,"maxPeerAge",void 0),this.log=e.logger.forComponent("libp2p:peer-store"),this.peerId=e.peerId,this.datastore=e.datastore,this.addressFilter=r.addressFilter,this.lock=Eu({name:"peer-store",singleProcess:!0}),this.maxAddressAge=null!==(t=r.maxAddressAge)&&void 0!==t?t:36e5,this.maxPeerAge=null!==(n=r.maxPeerAge)&&void 0!==n?n:216e5}async has(e){try{return await this.load(e),!0}catch(t){if("NotFoundError"!==t.name)throw t}return!1}async delete(e){this.peerId.equals(e)||await this.datastore.delete(zu(e))}async load(e){const t=zu(e),n=await this.datastore.get(t),r=Su.decode(n);if(xa(Hu,this,$u).call(this,e,r))throw await this.datastore.delete(t),new D;return Au(e,r,this.peerId.equals(e)?1/0:this.maxAddressAge)}async save(e,t){const n=await xa(Hu,this,Gu).call(this,e),r=await Uu(e,t,"patch",{addressFilter:this.addressFilter});return xa(Hu,this,Yu).call(this,e,r,n)}async patch(e,t){const n=await xa(Hu,this,Gu).call(this,e),r=await Uu(e,t,"patch",{addressFilter:this.addressFilter,existingPeer:n});return xa(Hu,this,Yu).call(this,e,r,n)}async merge(e,t){const n=await xa(Hu,this,Gu).call(this,e),r=await Uu(e,t,"merge",{addressFilter:this.addressFilter,existingPeer:n});return xa(Hu,this,Yu).call(this,e,r,n)}all(e){var t=this;return ru((function*(){var n,r=!1,i=!1;try{for(var o,s=Kc(t.datastore.query(function(e,t){var n,r;return{prefix:Ou,filters:(null!==(n=e.filters)&&void 0!==n?n:[]).map((e=>n=>{let{key:r,value:i}=n;return e(Wu(r,i,t))})),orders:(null!==(r=e.orders)&&void 0!==r?r:[]).map((e=>(n,r)=>e(Wu(n.key,n.value,t),Wu(r.key,r.value,t))))}}(null!==e&&void 0!==e?e:{},t.maxAddressAge)));r=!(o=yield nu(s.next())).done;r=!1){const{key:e,value:n}=o.value;{const r=ju(e);if(r.equals(t.peerId))continue;const i=Su.decode(n);if(xa(Hu,t,$u).call(t,r,i)){yield nu(t.datastore.delete(e));continue}yield Au(r,i,t.peerId.equals(r)?1/0:t.maxAddressAge)}}}catch(a){i=!0,n=a}finally{try{r&&null!=s.return&&(yield nu(s.return()))}finally{if(i)throw n}}}))()}}async function Gu(e){try{const t=zu(e),n=await this.datastore.get(t),r=Su.decode(n);if(xa(Hu,this,$u).call(this,e,r))throw await this.datastore.delete(t),new D;return{peerPB:r,peer:Pu(e,n,this.maxAddressAge)}}catch(t){"NotFoundError"!==t.name&&this.log.error("invalid peer data found in peer store - %e",t)}}async function Yu(e,t,n){t.updated=Date.now();const r=Su.encode(t);return await this.datastore.put(zu(e),r),{peer:Pu(e,r,this.maxAddressAge),previous:null===n||void 0===n?void 0:n.peer,updated:null==n||!Iu(t,n.peerPB)}}function $u(e,t){if(null==t.updated)return!0;if(this.peerId.equals(e))return!1;const n=t.updated<Date.now()-this.maxPeerAge,r=Date.now()-this.maxAddressAge,i=t.addresses.filter((e=>null!=e.observed&&e.observed>r));return n&&0===i.length}var Xu=new WeakSet;class Zu{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Sa(this,Xu),w(this,"store",void 0),w(this,"events",void 0),w(this,"peerId",void 0),w(this,"log",void 0),w(this,Symbol.toStringTag,"@libp2p/peer-store"),this.log=e.logger.forComponent("libp2p:peer-store"),this.events=e.events,this.peerId=e.peerId,this.store=new Qu(e,t)}async forEach(e,t){this.log.trace("forEach await read lock");const n=await this.store.lock.readLock();this.log.trace("forEach got read lock");try{var r,i=!1,o=!1;try{for(var s,a=Kc(this.store.all(t));i=!(s=await a.next()).done;i=!1){e(s.value)}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&await a.return()}finally{if(o)throw r}}}finally{this.log.trace("forEach release read lock"),n()}}async all(e){this.log.trace("all await read lock");const t=await this.store.lock.readLock();this.log.trace("all got read lock");try{return await eu(this.store.all(e))}finally{this.log.trace("all release read lock"),t()}}async delete(e){this.log.trace("delete await write lock");const t=await this.store.lock.writeLock();this.log.trace("delete got write lock");try{await this.store.delete(e)}finally{this.log.trace("delete release write lock"),t()}}async has(e){this.log.trace("has await read lock");const t=await this.store.lock.readLock();this.log.trace("has got read lock");try{return await this.store.has(e)}finally{this.log.trace("has release read lock"),t()}}async get(e){this.log.trace("get await read lock");const t=await this.store.lock.readLock();this.log.trace("get got read lock");try{return await this.store.load(e)}finally{this.log.trace("get release read lock"),t()}}async getInfo(e){const t=await this.get(e);return{id:t.id,multiaddrs:t.addresses.map((e=>{let{multiaddr:t}=e;return t}))}}async save(e,t){this.log.trace("save await write lock");const n=await this.store.lock.writeLock();this.log.trace("save got write lock");try{const n=await this.store.save(e,t);return xa(Xu,this,Ju).call(this,e,n),n.peer}finally{this.log.trace("save release write lock"),n()}}async patch(e,t){this.log.trace("patch await write lock");const n=await this.store.lock.writeLock();this.log.trace("patch got write lock");try{const n=await this.store.patch(e,t);return xa(Xu,this,Ju).call(this,e,n),n.peer}finally{this.log.trace("patch release write lock"),n()}}async merge(e,t){this.log.trace("merge await write lock");const n=await this.store.lock.writeLock();this.log.trace("merge got write lock");try{const n=await this.store.merge(e,t);return xa(Xu,this,Ju).call(this,e,n),n.peer}finally{this.log.trace("merge release write lock"),n()}}async consumePeerRecord(e,t){var n;const r=await Gc.openAndCertify(e,Jc.DOMAIN),i=sa(r.publicKey.toCID());if(!1===(null===t||void 0===t?void 0:t.equals(i)))return this.log("envelope peer id was not the expected peer id - expected: %p received: %p",t,i),!1;const o=Jc.createFromProtobuf(r.payload);let s;try{s=await this.get(i)}catch(a){if("NotFoundError"!==a.name)throw a}if(null!=(null===(n=s)||void 0===n?void 0:n.peerRecordEnvelope)){const e=await Gc.createFromProtobuf(s.peerRecordEnvelope),t=Jc.createFromProtobuf(e.payload);if(t.seqNumber>=o.seqNumber)return this.log("sequence number was lower or equal to existing sequence number - stored: %d received: %d",t.seqNumber,o.seqNumber),!1}return await this.patch(o.peerId,{peerRecordEnvelope:e,addresses:o.multiaddrs.map((e=>({isCertified:!0,multiaddr:e})))}),!0}}function Ju(e,t){t.updated&&(this.peerId.equals(e)?this.events.safeDispatchEvent("self:peer:update",{detail:t}):this.events.safeDispatchEvent("peer:update",{detail:t}))}class ed extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Open failed"),w(this,"name",ed.name),w(this,"code",ed.code)}}w(ed,"name","OpenFailedError"),w(ed,"code","ERR_OPEN_FAILED");class td extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Close failed"),w(this,"name",td.name),w(this,"code",td.code)}}w(td,"name","CloseFailedError"),w(td,"code","ERR_CLOSE_FAILED");class nd extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Put failed"),w(this,"name",nd.name),w(this,"code",nd.code)}}w(nd,"name","PutFailedError"),w(nd,"code","ERR_PUT_FAILED");class rd extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Get failed"),w(this,"name",rd.name),w(this,"code",rd.code)}}w(rd,"name","GetFailedError"),w(rd,"code","ERR_GET_FAILED");class id extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Delete failed"),w(this,"name",id.name),w(this,"code",id.code)}}w(id,"name","DeleteFailedError"),w(id,"code","ERR_DELETE_FAILED");class od extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Has failed"),w(this,"name",od.name),w(this,"code",od.code)}}w(od,"name","HasFailedError"),w(od,"code","ERR_HAS_FAILED");class sd extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Not Found"),w(this,"name",sd.name),w(this,"code",sd.code)}}w(sd,"name","NotFoundError"),w(sd,"code","ERR_NOT_FOUND");class ad extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Aborted"),w(this,"name",ad.name),w(this,"code",ad.code)}}w(ad,"name","AbortError"),w(ad,"code","ERR_ABORTED");const ld=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{var t,n=!1,r=!1;try{for(var i,o=Kc(e);n=!(i=await o.next()).done;n=!1){i.value}}catch(s){r=!0,t=s}finally{try{n&&null!=o.return&&await o.return()}finally{if(r)throw t}}})();for(const t of e);};const cd=function(e){const[t,n]=null!=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>t.next(),push:e=>{r.push(e)},next:()=>r.length>0?{done:!1,value:r.shift()}:t.next(),[n](){return this}}};const ud=function(e,t){let n=0;if(null!=e[Symbol.asyncIterator])return ru((function*(){var r,i=!1,o=!1;try{for(var s,a=Kc(e);i=!(s=yield nu(a.next())).done;i=!1){const e=s.value;(yield nu(t(e,n++)))&&(yield e)}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}))();const r=cd(e),{value:i,done:o}=r.next();if(!0===o)return function*(){}();const s=t(i,n++);if("function"===typeof s.then)return ru((function*(){(yield nu(s))&&(yield i);var e,o=!1,a=!1;try{for(var l,c=Kc(r);o=!(l=yield nu(c.next())).done;o=!1){const e=l.value;(yield nu(t(e,n++)))&&(yield e)}}catch(u){a=!0,e=u}finally{try{o&&null!=c.return&&(yield nu(c.return()))}finally{if(a)throw e}}}))();const a=t;return function*(){!0===s&&(yield i);for(const e of r)a(e,n++)&&(yield e)}()};function dd(e){var t={},n=!1;function r(t,r){return n=!0,r=new Promise((function(n){n(e[t](r))})),{done:!1,value:new tu(r,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):r("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return r("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):r("return",e)}),t}const hd=function(e,t){return null!=e[Symbol.asyncIterator]?ru((function*(){const n=yield nu(eu(e));yield*dd(Kc(n.sort(t)))}))():function*(){const n=eu(e);yield*n.sort(t)}()};const fd=function(e,t){return null!=e[Symbol.asyncIterator]?ru((function*(){let n=0;if(!(t<1)){var r,i=!1,o=!1;try{for(var s,a=Kc(e);i=!(s=yield nu(a.next())).done;i=!1){const e=s.value;if(yield e,n++,n===t)return}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}}))():function*(){let n=0;if(!(t<1))for(const r of e)if(yield r,n++,n===t)return}()};class pd{put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}putMany(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var r,i=!1,o=!1;try{for(var s,a=Kc(e);i=!(s=yield nu(a.next())).done;i=!1){const{key:e,value:r}=s.value;yield nu(t.put(e,r,n)),yield e}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}()})).apply(this,arguments)}getMany(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var r,i=!1,o=!1;try{for(var s,a=Kc(e);i=!(s=yield nu(a.next())).done;i=!1){const e=s.value;yield{key:e,value:yield nu(t.get(e,n))}}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}()})).apply(this,arguments)}deleteMany(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var r,i=!1,o=!1;try{for(var s,a=Kc(e);i=!(s=yield nu(a.next())).done;i=!1){const e=s.value;yield nu(t.delete(e,n)),yield e}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}()})).apply(this,arguments)}batch(){let e=[],t=[];return{put(t,n){e.push({key:t,value:n})},delete(e){t.push(e)},commit:async n=>{await ld(this.putMany(e,n)),e=[],await ld(this.deleteMany(t,n)),t=[]}}}_all(e,t){return ru((function*(){throw new Error("._all is not implemented")}))()}_allKeys(e,t){return ru((function*(){throw new Error("._allKeys is not implemented")}))()}query(e,t){let n=this._all(e,t);if(null!=e.prefix){const t=e.prefix;n=ud(n,(e=>e.key.toString().startsWith(t)))}if(Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>ud(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>hd(e,t)),n)),null!=e.offset){let t=0;const r=e.offset;n=ud(n,(()=>t++>=r))}return null!=e.limit&&(n=fd(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(null!=e.prefix){const t=e.prefix;n=ud(n,(e=>e.toString().startsWith(t)))}if(Array.isArray(e.filters)&&(n=e.filters.reduce(((e,t)=>ud(e,t)),n)),Array.isArray(e.orders)&&(n=e.orders.reduce(((e,t)=>hd(e,t)),n)),null!=e.offset){const t=e.offset;let r=0;n=ud(n,(()=>r++>=t))}return null!=e.limit&&(n=fd(n,e.limit)),n}}class gd extends pd{constructor(){super(),w(this,"data",void 0),this.data=new Map}put(e,t){return this.data.set(e.toString(),t),e}get(e){const t=this.data.get(e.toString());if(null==t)throw new sd;return t}has(e){return this.data.has(e.toString())}delete(e){this.data.delete(e.toString())}*_all(){for(const[e,t]of this.data.entries())yield{key:new Du(e),value:t}}*_allKeys(){for(const e of this.data.keys())yield new Du(e)}}function md(e,t){let n;const r=function(){clearTimeout(n),n=setTimeout((function(){n=void 0,e()}),t)};return r.start=()=>{},r.stop=()=>{clearTimeout(n)},r}class vd{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;if(w(this,"fp",void 0),w(this,"h",void 0),w(this,"seed",void 0),r>64)throw new TypeError("Invalid Fingerprint Size");const i=t.hashV(e,n),o=J(r);for(let s=0;s<o.length;s++)o[s]=i[s];0===o.length&&(o[0]=7),this.fp=o,this.h=t,this.seed=n}hash(){return this.h.hash(this.fp,this.seed)}equals(e){return(null===e||void 0===e?void 0:e.fp)instanceof Uint8Array&&ne(this.fp,e.fp)}}function yd(e,t){return Math.floor(Math.random()*(t-e))+e}class wd{constructor(e){w(this,"contents",void 0),this.contents=new Array(e).fill(null)}has(e){if(!(e instanceof vd))throw new TypeError("Invalid Fingerprint");return this.contents.some((t=>e.equals(t)))}add(e){if(!(e instanceof vd))throw new TypeError("Invalid Fingerprint");for(let t=0;t<this.contents.length;t++)if(null==this.contents[t])return this.contents[t]=e,!0;return!0}swap(e){if(!(e instanceof vd))throw new TypeError("Invalid Fingerprint");const t=yd(0,this.contents.length-1),n=this.contents[t];return this.contents[t]=e,n}remove(e){if(!(e instanceof vd))throw new TypeError("Invalid Fingerprint");const t=this.contents.findIndex((t=>e.equals(t)));return t>-1&&(this.contents[t]=null,!0)}}const bd={32:16777619n,64:1099511628211n,128:309485009821345068724781371n,256:374144419156711147060143317175368453031918731002211n,512:35835915874844867368919076489095108449946327955754392558399825615420669938882575126094039892345713852759n,1024:5016456510113118655434598811035278955030765345404790744303017523831112055108147451509157692220295382716162651878526895249385292291816524375083746691371804094271873160484737966720260389217684476157468082573n},Ed={32:2166136261n,64:14695981039346656037n,128:144066263297769815596495629667062367629n,256:100029257958052580907070968620625704837092796014241193945225284501741471925557n,512:9659303129496669498009435400716310466090418745672637896108374329434462657994582932197716438449813051892206539805784495328239340083876191928701583869517785n,1024:14197795064947621068722070641403218320880622795441933960878474914617582723252296732303717722150864096521202355549365628174669108571814760471015076148029755969804077320157692458563003215304957150157403644460363550505412711285966361610267868082893823963790439336411086884584107735010676915n},Sd=new globalThis.TextEncoder;function kd(e){let{size:t=32,utf8Buffer:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!bd[t])throw new Error("The `size` option must be one of 32, 64, 128, 256, 512, or 1024");if("string"===typeof e){if(n)return function(e,t,n){if(0===n.length)throw new Error("The `utf8Buffer` option must have a length greater than zero");const r=bd[t];let i=Ed[t],o=e;for(;o.length>0;){const e=Sd.encodeInto(o,n);o=o.slice(e.read);for(let o=0;o<e.written;o++)i^=BigInt(n[o]),i=BigInt.asUintN(t,i*r)}return i}(e,t,n);e=Sd.encode(e)}return function(e,t){const n=bd[t];let r=Ed[t];for(let i=0;i<e.length;i++)r^=BigInt(e[i]),r=BigInt.asUintN(t,r*n);return r}(e,t)}const xd={hash:e=>Number(kd(e,{size:32})),hashV:(e,t)=>function(e){let t=e.toString(16);t.length%2===1&&(t="0".concat(t));return jt(t,"base16")}(xd.hash(e,t))};class Cd{constructor(e){var t,n,r,i;w(this,"bucketSize",void 0),w(this,"filterSize",void 0),w(this,"fingerprintSize",void 0),w(this,"buckets",void 0),w(this,"count",void 0),w(this,"hash",void 0),w(this,"seed",void 0),this.filterSize=e.filterSize,this.bucketSize=null!==(t=e.bucketSize)&&void 0!==t?t:4,this.fingerprintSize=null!==(n=e.fingerprintSize)&&void 0!==n?n:2,this.count=0,this.buckets=[],this.hash=null!==(r=e.hash)&&void 0!==r?r:xd,this.seed=null!==(i=e.seed)&&void 0!==i?i:yd(0,Math.pow(2,10))}add(e){"string"===typeof e&&(e=jt(e));const t=new vd(e,this.hash,this.seed,this.fingerprintSize),n=this.hash.hash(e,this.seed)%this.filterSize,r=(n^t.hash())%this.filterSize;if(null==this.buckets[n]&&(this.buckets[n]=new wd(this.bucketSize)),null==this.buckets[r]&&(this.buckets[r]=new wd(this.bucketSize)),this.buckets[n].add(t)||this.buckets[r].add(t))return this.count++,!0;const i=[n,r];let o=i[yd(0,i.length-1)];null==this.buckets[o]&&(this.buckets[o]=new wd(this.bucketSize));for(let s=0;s<500;s++){const e=this.buckets[o].swap(t);if(null!=e&&(o=(o^e.hash())%this.filterSize,null==this.buckets[o]&&(this.buckets[o]=new wd(this.bucketSize)),this.buckets[o].add(e)))return this.count++,!0}return!1}has(e){var t,n,r,i;"string"===typeof e&&(e=jt(e));const o=new vd(e,this.hash,this.seed,this.fingerprintSize),s=this.hash.hash(e,this.seed)%this.filterSize,a=null!==(t=null===(n=this.buckets[s])||void 0===n?void 0:n.has(o))&&void 0!==t&&t;if(a)return a;const l=(s^o.hash())%this.filterSize;return null!==(r=null===(i=this.buckets[l])||void 0===i?void 0:i.has(o))&&void 0!==r&&r}remove(e){var t,n,r,i;"string"===typeof e&&(e=jt(e));const o=new vd(e,this.hash,this.seed,this.fingerprintSize),s=this.hash.hash(e,this.seed)%this.filterSize,a=null!==(t=null===(n=this.buckets[s])||void 0===n?void 0:n.remove(o))&&void 0!==t&&t;if(a)return this.count--,a;const l=(s^o.hash())%this.filterSize,c=null!==(r=null===(i=this.buckets[l])||void 0===i?void 0:i.remove(o))&&void 0!==r&&r;return c&&this.count--,c}get reliable(){return Math.floor(this.count/this.filterSize*100)<=90}}const Pd={1:.5,2:.84,4:.95,8:.98};function Ad(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.001;const n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001;return e>.002?2:e>1e-5?4:8}(t),r=Pd[n];return{filterSize:Math.round(e/r),bucketSize:n,fingerprintSize:Math.min(Math.ceil(Math.log2(1/t)+Math.log2(2*n)),64)}}class Id{constructor(e){var t,n,r,i,o,s;w(this,"filterSize",void 0),w(this,"bucketSize",void 0),w(this,"fingerprintSize",void 0),w(this,"scale",void 0),w(this,"filterSeries",void 0),w(this,"hash",void 0),w(this,"seed",void 0),this.bucketSize=null!==(t=e.bucketSize)&&void 0!==t?t:4,this.filterSize=null!==(n=e.filterSize)&&void 0!==n?n:(1<<18)/this.bucketSize,this.fingerprintSize=null!==(r=e.fingerprintSize)&&void 0!==r?r:2,this.scale=null!==(i=e.scale)&&void 0!==i?i:2,this.hash=null!==(o=e.hash)&&void 0!==o?o:xd,this.seed=null!==(s=e.seed)&&void 0!==s?s:yd(0,Math.pow(2,10)),this.filterSeries=[new Cd({filterSize:this.filterSize,bucketSize:this.bucketSize,fingerprintSize:this.fingerprintSize,hash:this.hash,seed:this.seed})]}add(e){if("string"===typeof e&&(e=jt(e)),this.has(e))return!0;let t=this.filterSeries.find((e=>e.reliable));if(null==t){const e=this.filterSize*Math.pow(this.scale,this.filterSeries.length);t=new Cd({filterSize:e,bucketSize:this.bucketSize,fingerprintSize:this.fingerprintSize,hash:this.hash,seed:this.seed}),this.filterSeries.push(t)}return t.add(e)}has(e){"string"===typeof e&&(e=jt(e));for(let t=0;t<this.filterSeries.length;t++)if(this.filterSeries[t].has(e))return!0;return!1}remove(e){"string"===typeof e&&(e=jt(e));for(let t=0;t<this.filterSeries.length;t++)if(this.filterSeries[t].remove(e))return!0;return!1}get count(){return this.filterSeries.reduce(((e,t)=>e+t.count),0)}}function _d(e){let t=arguments.length>2?arguments[2]:void 0;return new Id(E(E({},Ad(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:.001)),null!==t&&void 0!==t?t:{}))}var Td=n(364);const Ld=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"].map((e=>new Td.Netmask(e)));function Rd(e){for(const t of Ld)if(t.contains(e))return!0;return!1}function Nd(e){return Al(e)?Rd(e):/^::ffff:([0-9a-fA-F]{1,4}):([0-9a-fA-F]{1,4})$/.test(e)?function(e){const t=e.split(":");if(t.length<2)return!1;const n=t[t.length-1].padStart(4,"0"),r=t[t.length-2].padStart(4,"0");return Rd("".concat(parseInt(r.substring(0,2),16),".").concat(parseInt(r.substring(2),16),".").concat(parseInt(n.substring(0,2),16),".").concat(parseInt(n.substring(2),16)))}(e):function(e){return/^::ffff:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)}(e)?function(e){const t=e.split(":");return Rd(t[t.length-1])}(e):Il(e)?function(e){return/^::$/.test(e)||/^::1$/.test(e)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(e)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(e)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(e)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(e)||/^ff([0-9a-fA-F]{2,2}):/i.test(e)}(e):void 0}const Md=e=>({match:t=>!(t.length<1)&&(!!e(t[0])&&t.slice(1)),pattern:"fn"}),Dd=e=>({match:t=>Md((t=>t===e)).match(t),pattern:e}),Od=()=>({match:e=>Md((e=>"string"===typeof e)).match(e),pattern:"{string}"}),zd=()=>({match:e=>Md((e=>!isNaN(parseInt(e)))).match(e),pattern:"{number}"}),Fd=()=>({match:e=>{if(e.length<2)return!1;if("p2p"!==e[0]&&"ipfs"!==e[0])return!1;if(!e[1].startsWith("Q")&&!e[1].startsWith("1"))return!1;try{ze.decode("z".concat(e[1]))}catch(t){return!1}return e.slice(2)},pattern:"/p2p/{peerid}"}),Ud=()=>({match:e=>{if(e.length<2)return!1;if("certhash"!==e[0])return!1;try{qe.decode(e[1])}catch(t){return!1}return e.slice(2)},pattern:"/certhash/{certhash}"}),Bd=e=>({match:t=>{const n=e.match(t);return!1===n?t:n},pattern:"optional(".concat(e.pattern,")")}),qd=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{match:e=>{let n;for(const r of t){const t=r.match(e);!1!==t&&((null==n||t.length<n.length)&&(n=t))}return null!=n&&n},pattern:"or(".concat(t.map((e=>e.pattern)).join(", "),")")}},Vd=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{match:e=>{for(const n of t){const t=n.match(e);if(!1===t)return!1;e=t}return e},pattern:"and(".concat(t.map((e=>e.pattern)).join(", "),")")}};function Kd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(e){let n=(e=>e.toString().split("/").slice(1))(e);for(const r of t){const e=r.match(n);if(!1===e)return!1;n=e}return n}return{matchers:t,matches:function(e){return!1!==r(e)},exactMatch:function(e){const t=r(e);return!1!==t&&0===t.length}}}const jd=Kd(Fd()),Wd=Vd(Dd("dns4"),Od()),Hd=Vd(Dd("dns6"),Od()),Qd=Vd(Dd("dnsaddr"),Od()),Gd=Vd(Dd("dns"),Od()),Yd=(Kd(Wd,Bd(Fd())),Kd(Hd,Bd(Fd())),Kd(Qd,Bd(Fd())),Kd(qd(Gd,Qd,Wd,Hd),Bd(Fd())),Vd(Dd("ip4"),Md(Al))),$d=Vd(Dd("ip6"),Md(Il)),Xd=qd(Yd,$d),Zd=qd(Xd,Gd,Wd,Hd,Qd),Jd=Kd(qd(Xd,Vd(qd(Gd,Qd,Wd,Hd),Bd(Fd())))),eh=Kd(Yd),th=Kd($d),nh=(Kd(Xd),Vd(Zd,Dd("tcp"),zd())),rh=Vd(Zd,Dd("udp"),zd()),ih=Kd(Vd(nh,Bd(Fd()))),oh=(Kd(rh),Vd(rh,Dd("quic"),Bd(Fd()))),sh=Vd(rh,Dd("quic-v1"),Bd(Fd())),ah=qd(oh,sh),lh=(Kd(oh),Kd(sh)),ch=qd(Zd,nh,rh,oh,sh),uh=qd(Vd(ch,Dd("ws"),Bd(Fd()))),dh=Kd(uh),hh=qd(Vd(ch,Dd("wss"),Bd(Fd())),Vd(ch,Dd("tls"),Bd(Vd(Dd("sni"),Od())),Dd("ws"),Bd(Fd()))),fh=Kd(hh),ph=Vd(rh,Dd("webrtc-direct"),Bd(Ud()),Bd(Ud()),Bd(Fd())),gh=Kd(ph),mh=Vd(sh,Dd("webtransport"),Bd(Ud()),Bd(Ud()),Bd(Fd())),vh=Kd(mh),yh=qd(uh,hh,Vd(nh,Bd(Fd())),Vd(ah,Bd(Fd())),Vd(Zd,Bd(Fd())),ph,mh,Fd()),wh=(Kd(yh),Kd(Vd(yh,Dd("p2p-circuit"),Fd()))),bh=Kd(qd(Vd(yh,Dd("p2p-circuit"),Dd("webrtc"),Bd(Fd())),Vd(yh,Dd("webrtc"),Bd(Fd())),Vd(Dd("webrtc"),Bd(Fd())))),Eh=(Kd(qd(Vd(Zd,Dd("tcp"),zd(),Dd("http"),Bd(Fd())),Vd(Zd,Dd("http"),Bd(Fd())))),Kd(qd(Vd(Zd,Dd("tcp"),qd(Vd(Dd("443"),Dd("http")),Vd(zd(),Dd("https")),Vd(zd(),Dd("tls"),Dd("http"))),Bd(Fd())),Vd(Zd,Dd("tls"),Dd("http"),Bd(Fd())),Vd(Zd,Dd("https"),Bd(Fd())))),Kd(qd(Vd(Dd("memory"),Od(),Bd(Fd())))),864e13);class Sh{constructor(e){w(this,"log",void 0),w(this,"mappings",void 0),this.log=e.logger.forComponent("libp2p:address-manager:dns-mappings"),this.mappings=new Map}has(e){const t=this.findHost(e);for(const n of this.mappings.values())if(n.domain===t)return!0;return!1}add(e,t){t.forEach((t=>{this.log("add DNS mapping %s to %s",t,e);const n=!0===Nd(t);this.mappings.set(t,{domain:e,verified:n,expires:n?Eh-Date.now():0,lastVerified:n?Eh-Date.now():void 0})}))}remove(e){const t=this.findHost(e);let n=!1;for(const[r,i]of this.mappings.entries())i.domain===t&&(this.log("removing %s to %s DNS mapping %e",r,i.domain,new Error("where")),this.mappings.delete(r),n=n||i.verified);return n}getAll(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n].multiaddr.stringTuples(),i=r[0][1];if(null!=i)for(const[o,s]of this.mappings.entries()){if(i!==o)continue;this.maybeAddSNITuple(r,s.domain)&&(e.splice(n,1),n--,t.push({multiaddr:fc("/".concat(r.map((e=>[Ol(e[0]).name,e[1]].join("/"))).join("/"))),verified:s.verified,type:"dns-mapping",expires:s.expires,lastVerified:s.lastVerified}))}}return t}maybeAddSNITuple(e,t){for(let r=0;r<e.length;r++){var n;if(448===e[r][0]&&449!==(null===(n=e[r+1])||void 0===n?void 0:n[0]))return e.splice(r+1,0,[449,t]),!0}return!1}confirm(e,t){const n=this.findHost(e);let r=!1;for(const[i,o]of this.mappings.entries())o.domain===n&&(this.log("marking %s to %s DNS mapping as verified",i,o.domain),r=o.verified,o.verified=!0,o.expires=Date.now()+t,o.lastVerified=Date.now());return r}unconfirm(e,t){const n=this.findHost(e);let r=!1;for(const[i,o]of this.mappings.entries())o.domain===n&&(this.log("removing verification of %s to %s DNS mapping",i,o.domain),r=r||o.verified,o.verified=!1,o.expires=Date.now()+t);return r}findHost(e){for(const t of e.stringTuples()){if(449===t[0])return t[1];if(53===t[0]||54===t[0]||55===t[0]||56===t[0])return t[1]}}}class kh{constructor(e){w(this,"log",void 0),w(this,"mappings",void 0),this.log=e.logger.forComponent("libp2p:address-manager:ip-mappings"),this.mappings=new Map}has(e){const t=e.stringTuples();for(const n of this.mappings.values())for(const e of n)if(e.externalIp===t[0][1])return!0;return!1}add(e,t,n){var r;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"tcp";const s="".concat(e,"-").concat(t,"-").concat(o),a=null!==(r=this.mappings.get(s))&&void 0!==r?r:[],l={internalIp:e,internalPort:t,externalIp:n,externalPort:i,externalFamily:Al(n)?4:6,protocol:o,verified:!1,expires:0};a.push(l),this.mappings.set(s,a)}remove(e){var t,n;const r=e.stringTuples(),i=null!==(t=r[0][1])&&void 0!==t?t:"",o=6===r[1][0]?"tcp":"udp",s=parseInt(null!==(n=r[1][1])&&void 0!==n?n:"0");let a=!1;for(const[l,c]of this.mappings.entries()){for(let e=0;e<c.length;e++){const t=c[e];t.externalIp===i&&t.externalPort===s&&t.protocol===o&&(this.log("removing %s:%s to %s:%s %s IP mapping",t.externalIp,t.externalPort,i,s,o),a=a||t.verified,c.splice(e,1),e--)}0===c.length&&this.mappings.delete(l)}return a}getAll(e){const t=[];for(const{multiaddr:n}of e){const e=n.stringTuples();let r;if(4!==e[0][0]&&41!==e[0][0]||6!==e[1][0]?4!==e[0][0]&&41!==e[0][0]||273!==e[1][0]||(r="".concat(e[0][1],"-").concat(e[1][1],"-udp")):r="".concat(e[0][1],"-").concat(e[1][1],"-tcp"),null==r)continue;const i=this.mappings.get(r);if(null!=i)for(const n of i)e[0][0]=4===n.externalFamily?4:41,e[0][1]=n.externalIp,e[1][1]="".concat(n.externalPort),t.push({multiaddr:fc("/".concat(e.map((e=>[Ol(e[0]).name,e[1]].join("/"))).join("/"))),verified:n.verified,type:"ip-mapping",expires:n.expires,lastVerified:n.lastVerified})}return t}confirm(e,t){const n=e.stringTuples()[0][1];let r=!1;for(const i of this.mappings.values())for(const e of i)e.externalIp===n&&(this.log("marking %s to %s IP mapping as verified",e.internalIp,e.externalIp),r=e.verified,e.verified=!0,e.expires=Date.now()+t,e.lastVerified=Date.now());return r}unconfirm(e,t){var n,r;const i=e.stringTuples(),o=null!==(n=i[0][1])&&void 0!==n?n:"",s=6===i[1][0]?"tcp":"udp",a=parseInt(null!==(r=i[1][1])&&void 0!==r?r:"0");let l=!1;for(const c of this.mappings.values())for(let e=0;e<c.length;e++){const n=c[e];n.externalIp===o&&n.externalPort===a&&n.protocol===s&&(this.log("removing verification of %s:%s to %s:%s %s IP mapping",n.externalIp,n.externalPort,o,a,s),l=l||n.verified,n.verified=!1,n.expires=Date.now()+t)}return l}}function xh(e){try{const[[t]]=e.stringTuples();return 4===t||41===t}catch(t){}return!1}function Ch(e){try{var t;if(!xh(e))return!1;const[[,n]]=e.stringTuples();return null!=n&&(null!==(t=Nd(n))&&void 0!==t&&t)}catch(n){}return!0}const Ph=10;class Ah{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"log",void 0),w(this,"addresses",void 0),w(this,"maxObservedAddresses",void 0),this.log=e.logger.forComponent("libp2p:address-manager:observed-addresses"),this.addresses=new Map,this.maxObservedAddresses=null!==(t=n.maxObservedAddresses)&&void 0!==t?t:Ph}has(e){return this.addresses.has(e.toString())}removePrefixed(e){for(const t of this.addresses.keys())t.toString().startsWith(e)&&this.addresses.delete(t)}add(e){this.addresses.size!==this.maxObservedAddresses&&(Ch(e)||function(e){try{const[[t,n]]=e.stringTuples();if(null==n)return!1;if(4===t)return n.startsWith("169.254.");if(41===t)return n.toLowerCase().startsWith("fe80")}catch(t){}return!1}(e)||(this.log("adding observed address %a",e),this.addresses.set(e.toString(),{verified:!1,expires:0})))}getAll(){return Array.from(this.addresses).map((e=>{let[t,n]=e;return{multiaddr:fc(t),verified:n.verified,type:"observed",expires:n.expires,lastVerified:n.lastVerified}}))}remove(e){var t,n;const r=null!==(t=null===(n=this.addresses.get(e.toString()))||void 0===n?void 0:n.verified)&&void 0!==t&&t;return this.log("removing observed address %a",e),this.addresses.delete(e.toString()),r}confirm(e,t){var n;const r=e.toString(),i=null!==(n=this.addresses.get(r))&&void 0!==n?n:{verified:!1,expires:Date.now()+t,lastVerified:Date.now()},o=i.verified;return i.verified=!0,i.expires=Date.now()+t,i.lastVerified=Date.now(),this.log("marking observed address %a as verified",r),this.addresses.set(r,i),o}}const Ih=[4,41,53,54,55,56];function _h(e){try{const[[t]]=e.stringTuples();return Ih.includes(t)}catch(t){}return!1}const Th=10;class Lh{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"log",void 0),w(this,"addresses",void 0),w(this,"maxObservedAddresses",void 0),this.log=e.logger.forComponent("libp2p:address-manager:observed-addresses"),this.addresses=new Map,this.maxObservedAddresses=null!==(t=n.maxObservedAddresses)&&void 0!==t?t:Th}get(e,t){if(Ch(e))return{multiaddr:e,verified:!0,type:"transport",expires:Date.now()+t,lastVerified:Date.now()};const n=this.toKey(e);let r=this.addresses.get(n);return null==r&&(r={verified:!_h(e),expires:0},this.addresses.set(n,r)),{multiaddr:e,verified:r.verified,type:"transport",expires:r.expires,lastVerified:r.lastVerified}}has(e){const t=this.toKey(e);return this.addresses.has(t)}remove(e){var t,n;const r=this.toKey(e),i=null!==(t=null===(n=this.addresses.get(r))||void 0===n?void 0:n.verified)&&void 0!==t&&t;return this.log("removing observed address %a",e),this.addresses.delete(r),i}confirm(e,t){var n;const r=this.toKey(e),i=null!==(n=this.addresses.get(r))&&void 0!==n?n:{verified:!1,expires:0,lastVerified:0},o=i.verified;return i.verified=!0,i.expires=Date.now()+t,i.lastVerified=Date.now(),this.addresses.set(r,i),o}unconfirm(e,t){var n;const r=this.toKey(e),i=null!==(n=this.addresses.get(r))&&void 0!==n?n:{verified:!1,expires:0},o=i.verified;return i.verified=!1,i.expires=Date.now()+t,this.addresses.set(r,i),o}toKey(e){if(_h(e)){const t=e.toOptions();return"".concat(t.host,"-").concat(t.port,"-").concat(t.transport)}return e.toString()}}const Rh={maxObservedAddresses:10,addressVerificationTTL:6e5,addressVerificationRetry:3e5},Nh=e=>e;function Mh(e,t){const n=e.getPeerId();if(null!=n){ra(n).equals(t)&&(e=e.decapsulate(fc("/p2p/".concat(t.toString()))))}return e}class Dh{constructor(e){var t,n,r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"log",void 0),w(this,"components",void 0),w(this,"listen",void 0),w(this,"announce",void 0),w(this,"appendAnnounce",void 0),w(this,"announceFilter",void 0),w(this,"observed",void 0),w(this,"dnsMappings",void 0),w(this,"ipMappings",void 0),w(this,"transportAddresses",void 0),w(this,"observedAddressFilter",void 0),w(this,"addressVerificationTTL",void 0),w(this,"addressVerificationRetry",void 0),w(this,Symbol.toStringTag,"@libp2p/address-manager");const{listen:o=[],announce:s=[],appendAnnounce:a=[]}=i;this.components=e,this.log=e.logger.forComponent("libp2p:address-manager"),this.listen=o.map((e=>e.toString())),this.announce=new Set(s.map((e=>e.toString()))),this.appendAnnounce=new Set(a.map((e=>e.toString()))),this.observed=new Ah(e,i),this.dnsMappings=new Sh(e,i),this.ipMappings=new kh(e,i),this.transportAddresses=new Lh(e,i),this.announceFilter=null!==(t=i.announceFilter)&&void 0!==t?t:Nh,this.observedAddressFilter=_d(1024),this.addressVerificationTTL=null!==(n=i.addressVerificationTTL)&&void 0!==n?n:Rh.addressVerificationTTL,this.addressVerificationRetry=null!==(r=i.addressVerificationRetry)&&void 0!==r?r:Rh.addressVerificationRetry,this._updatePeerStoreAddresses=md(this._updatePeerStoreAddresses.bind(this),1e3),e.events.addEventListener("transport:listening",(()=>{this._updatePeerStoreAddresses()})),e.events.addEventListener("transport:close",(()=>{this._updatePeerStoreAddresses()}))}_updatePeerStoreAddresses(){const e=this.getAddresses().map((e=>e.getPeerId()===this.components.peerId.toString()?e.decapsulate("/p2p/".concat(this.components.peerId.toString())):e));this.components.peerStore.patch(this.components.peerId,{multiaddrs:e}).catch((e=>{this.log.error("error updating addresses",e)}))}getListenAddrs(){return Array.from(this.listen).map((e=>fc(e)))}getAnnounceAddrs(){return Array.from(this.announce).map((e=>fc(e)))}getAppendAnnounceAddrs(){return Array.from(this.appendAnnounce).map((e=>fc(e)))}getObservedAddrs(){return this.observed.getAll().map((e=>e.multiaddr))}addObservedAddr(e){const t=e.stringTuples(),n="".concat(t[0][1],":").concat(t[1][1]);this.observedAddressFilter.has(n)||(this.observedAddressFilter.add(n),e=Mh(e,this.components.peerId),this.ipMappings.has(e)||this.dnsMappings.has(e)||this.observed.add(e))}confirmObservedAddr(e,t){e=Mh(e,this.components.peerId);let n=!0;if("transport"===(null===t||void 0===t?void 0:t.type)||this.transportAddresses.has(e)){var r;!this.transportAddresses.confirm(e,null!==(r=null===t||void 0===t?void 0:t.ttl)&&void 0!==r?r:this.addressVerificationTTL)&&n&&(n=!1)}if("dns-mapping"===(null===t||void 0===t?void 0:t.type)||this.dnsMappings.has(e)){var i;!this.dnsMappings.confirm(e,null!==(i=null===t||void 0===t?void 0:t.ttl)&&void 0!==i?i:this.addressVerificationTTL)&&n&&(n=!1)}if("ip-mapping"===(null===t||void 0===t?void 0:t.type)||this.ipMappings.has(e)){var o;!this.ipMappings.confirm(e,null!==(o=null===t||void 0===t?void 0:t.ttl)&&void 0!==o?o:this.addressVerificationTTL)&&n&&(n=!1)}if("observed"===(null===t||void 0===t?void 0:t.type)||this.observed.has(e))if(this.maybeUpgradeToIPMapping(e)){var s;this.ipMappings.confirm(e,null!==(s=null===t||void 0===t?void 0:t.ttl)&&void 0!==s?s:this.addressVerificationTTL),n=!1}else{var a;!this.observed.confirm(e,null!==(a=null===t||void 0===t?void 0:t.ttl)&&void 0!==a?a:this.addressVerificationTTL)&&n&&(n=!1)}n||this._updatePeerStoreAddresses()}removeObservedAddr(e,t){e=Mh(e,this.components.peerId);let n=!1;if(this.observed.has(e)){!this.observed.remove(e)&&n&&(n=!1)}if(this.transportAddresses.has(e)){var r;!this.transportAddresses.unconfirm(e,null!==(r=null===t||void 0===t?void 0:t.ttl)&&void 0!==r?r:this.addressVerificationRetry)&&n&&(n=!1)}if(this.dnsMappings.has(e)){var i;!this.dnsMappings.unconfirm(e,null!==(i=null===t||void 0===t?void 0:t.ttl)&&void 0!==i?i:this.addressVerificationRetry)&&n&&(n=!1)}if(this.ipMappings.has(e)){var o;!this.ipMappings.unconfirm(e,null!==(o=null===t||void 0===t?void 0:t.ttl)&&void 0!==o?o:this.addressVerificationRetry)&&n&&(n=!1)}n&&this._updatePeerStoreAddresses()}getAddresses(){const e=new Set,t=this.getAddressesWithMetadata().filter((t=>{if(!t.verified)return!1;const n=t.multiaddr.toString();return!e.has(n)&&(e.add(n),!0)})).map((e=>e.multiaddr));return this.announceFilter(t.map((e=>{var t;const n=fc(e);return!0===(null===(t=n.protos().pop())||void 0===t?void 0:t.path)||n.getPeerId()===this.components.peerId.toString()?n:n.encapsulate("/p2p/".concat(this.components.peerId.toString()))})))}getAddressesWithMetadata(){const e=this.getAnnounceAddrs();if(e.length>0)return this.components.transportManager.getListeners().forEach((t=>{t.updateAnnounceAddrs(e)})),e.map((e=>({multiaddr:e,verified:!0,type:"announce",expires:Date.now()+this.addressVerificationTTL,lastVerified:Date.now()})));let t=[];t=t.concat(this.components.transportManager.getAddrs().map((e=>this.transportAddresses.get(e,this.addressVerificationTTL))));const n=this.getAppendAnnounceAddrs();return n.length>0&&(this.components.transportManager.getListeners().forEach((e=>{e.updateAnnounceAddrs(n)})),t=t.concat(n.map((e=>({multiaddr:e,verified:!0,type:"announce",expires:Date.now()+this.addressVerificationTTL,lastVerified:Date.now()}))))),t=t.concat(this.observed.getAll()),t=t.concat(this.ipMappings.getAll(t)),t=t.concat(this.dnsMappings.getAll(t)),t}addDNSMapping(e,t){this.dnsMappings.add(e,t)}removeDNSMapping(e){this.dnsMappings.remove(fc("/dns/".concat(e)))&&this._updatePeerStoreAddresses()}addPublicAddressMapping(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"tcp";this.ipMappings.add(e,t,n,r,i),this.observed.removePrefixed("/ip".concat(Al(n)?4:6,"/").concat(n,"/").concat(i,"/").concat(r))}removePublicAddressMapping(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"tcp";this.ipMappings.remove(fc("/ip".concat(Al(n)?4:6,"/").concat(n,"/").concat(i,"/").concat(r)))&&this._updatePeerStoreAddresses()}maybeUpgradeToIPMapping(e){if(this.ipMappings.has(e))return!1;const t=e.toOptions();if(6===t.family||"127.0.0.1"===t.host||!0===Nd(t.host))return!1;const n=this.components.transportManager.getListeners(),r=[e=>dh.exactMatch(e)||fh.exactMatch(e),e=>ih.exactMatch(e),e=>lh.exactMatch(e)];for(const i of r){if(!i(e))continue;const r=n.filter((e=>e.getAddrs().filter((e=>4===e.toOptions().family&&i(e))).length>0));if(1!==r.length)continue;const o=r[0].getAddrs().filter((e=>"127.0.0.1"!==e.toOptions().host)).pop();if(null==o)continue;const s=o.toOptions();return this.observed.remove(e),this.ipMappings.add(s.host,s.port,t.host,t.port,t.transport),!0}return!1}}function Oh(e){return null!=e&&"function"===typeof e.start&&"function"===typeof e.stop}async function zh(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)Oh(i)&&e.push(i);await Promise.all(e.map((async e=>{null!=e.beforeStart&&await e.beforeStart()}))),await Promise.all(e.map((async e=>{await e.start()}))),await Promise.all(e.map((async e=>{null!=e.afterStart&&await e.afterStart()})))}async function Fh(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)Oh(i)&&e.push(i);await Promise.all(e.map((async e=>{null!=e.beforeStop&&await e.beforeStop()}))),await Promise.all(e.map((async e=>{await e.stop()}))),await Promise.all(e.map((async e=>{null!=e.afterStop&&await e.afterStop()})))}const Uh=Symbol.for("@libp2p/service-capabilities"),Bh=Symbol.for("@libp2p/service-dependencies");var qh;!function(e){e.NOT_STARTED_YET="The libp2p node is not started yet",e.NOT_FOUND="Not found"}(qh||(qh={}));class Vh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Missing service"),this.name="MissingServiceError"}}class Kh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unmet service dependencies"),this.name="UnmetServiceDependenciesError"}}class jh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"No content routers available"),this.name="NoContentRoutersError"}}class Wh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"No peer routers available"),this.name="NoPeerRoutersError"}}class Hh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Should not try to find self"),this.name="QueriedForSelfError"}}class Qh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unhandled protocol error"),this.name="UnhandledProtocolError"}}class Gh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Duplicate protocol handler error"),this.name="DuplicateProtocolHandlerError"}}class Yh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Dial denied error"),this.name="DialDeniedError"}}class $h extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"No transport was configured to listen on this address"),this.name="UnsupportedListenAddressError"}}class Xh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Configured listen addresses could not be listened on"),this.name="UnsupportedListenAddressesError"}}class Zh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"No valid addresses"),this.name="NoValidAddressesError"}}class Jh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Connection intercepted"),this.name="ConnectionInterceptedError"}}class ef extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Connection denied"),this.name="ConnectionDeniedError"}}class tf extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Stream is not multiplexed"),this.name="MuxerUnavailableError"}}class nf extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Encryption failed"),this.name="EncryptionFailedError"}}class rf extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Transport unavailable"),this.name="TransportUnavailableError"}}class of{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};w(this,"components",{}),w(this,"_started",!1),this.components={};for(const[t,n]of Object.entries(e))this.components[t]=n;null==this.components.logger&&(this.components.logger=zc())}isStarted(){return this._started}async _invokeStartableMethod(e){await Promise.all(Object.values(this.components).filter((e=>Oh(e))).map((async t=>{var n;await(null===(n=t[e])||void 0===n?void 0:n.call(t))})))}async beforeStart(){await this._invokeStartableMethod("beforeStart")}async start(){await this._invokeStartableMethod("start"),this._started=!0}async afterStart(){await this._invokeStartableMethod("afterStart")}async beforeStop(){await this._invokeStartableMethod("beforeStop")}async stop(){await this._invokeStartableMethod("stop"),this._started=!1}async afterStop(){await this._invokeStartableMethod("afterStop")}}const sf=["metrics","connectionProtector","dns"],af=["components","isStarted","beforeStart","start","afterStart","beforeStop","stop","afterStop","then","_invokeStartableMethod"];function lf(e){return Array.isArray(null===e||void 0===e?void 0:e[Uh])?e[Uh]:[]}function cf(e){return Array.isArray(null===e||void 0===e?void 0:e[Bh])?e[Bh]:[]}function uf(e){var t,n;return null!==(t=null!==(n=null===e||void 0===e?void 0:e[Symbol.toStringTag])&&void 0!==n?n:null===e||void 0===e?void 0:e.toString())&&void 0!==t?t:"unknown"}function df(){return E({denyDialPeer:async()=>!1,denyDialMultiaddr:async e=>{if(dh.matches(e))return!1;const t=e.stringTuples();return(4===t[0][0]||41===t[0][0])&&Boolean(Nd("".concat(t[0][1])))},denyInboundConnection:async()=>!1,denyOutboundConnection:async()=>!1,denyInboundEncryptedConnection:async()=>!1,denyOutboundEncryptedConnection:async()=>!1,denyInboundUpgradedConnection:async()=>!1,denyOutboundUpgradedConnection:async()=>!1,filterMultiaddrForPeer:async()=>!0},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}class hf{constructor(e){if(w(this,"map",void 0),this.map=new Map,null!=e)for(const[t,n]of e.entries())this.map.set(t.toString(),{key:t,value:n})}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){return this.map.delete(e.toString())}entries(){return Bc(this.map.entries(),(e=>[e[1].key,e[1].value]))}forEach(e){this.map.forEach(((t,n)=>{e(t.value,t.key,this)}))}get(e){var t;return null===(t=this.map.get(e.toString()))||void 0===t?void 0:t.value}has(e){return this.map.has(e.toString())}set(e,t){this.map.set(e.toString(),{key:e,value:t})}keys(){return Bc(this.map.values(),(e=>e.key))}values(){return Bc(this.map.values(),(e=>e.value))}get size(){return this.map.size}}const ff=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},pf=new WeakMap;const gf=function(){let{clearTimeout:e,setTimeout:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(n){let r,i,o,{value:s,signal:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==a&&void 0!==a&&a.aborted)return Promise.reject(ff());const l=null!==e&&void 0!==e?e:clearTimeout,c=()=>{l(r),o(ff())},u=new Promise(((e,l)=>{i=()=>{a&&a.removeEventListener("abort",c),e(s)},o=l,r=(null!==t&&void 0!==t?t:setTimeout)(i,n)}));return a&&a.addEventListener("abort",c,{once:!0}),pf.set(u,(()=>{l(r),r=null,i()})),u}}(),mf=gf;class vf extends Error{constructor(){let e=arguments.length>1?arguments[1]:void 0;super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Rate limit exceeded"),w(this,"remainingPoints",void 0),w(this,"msBeforeNext",void 0),w(this,"consumedPoints",void 0),w(this,"isFirstInDuration",void 0),this.name="RateLimitError",this.remainingPoints=e.remainingPoints,this.msBeforeNext=e.msBeforeNext,this.consumedPoints=e.consumedPoints,this.isFirstInDuration=e.isFirstInDuration}}class yf extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The queue was full"),this.name="QueueFullError"}}w(yf,"name","QueueFullError");class wf{constructor(){var e,t,n,r,i,o;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};w(this,"memoryStorage",void 0),w(this,"points",void 0),w(this,"duration",void 0),w(this,"blockDuration",void 0),w(this,"execEvenly",void 0),w(this,"execEvenlyMinDelayMs",void 0),w(this,"keyPrefix",void 0),this.points=null!==(e=s.points)&&void 0!==e?e:4,this.duration=null!==(t=s.duration)&&void 0!==t?t:1,this.blockDuration=null!==(n=s.blockDuration)&&void 0!==n?n:0,this.execEvenly=null!==(r=s.execEvenly)&&void 0!==r&&r,this.execEvenlyMinDelayMs=null!==(i=s.execEvenlyMinDelayMs)&&void 0!==i?i:1e3*this.duration/this.points,this.keyPrefix=null!==(o=s.keyPrefix)&&void 0!==o?o:"rlflx",this.memoryStorage=new bf}async consume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getKey(e),i=this._getKeySecDuration(n);let o=this.memoryStorage.incrby(r,t,i);if(o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o.consumedPoints>this.points)throw this.blockDuration>0&&o.consumedPoints<=this.points+t&&(o=this.memoryStorage.set(r,o.consumedPoints,this.blockDuration)),new vf("Rate limit exceeded",o);if(this.execEvenly&&o.msBeforeNext>0&&!o.isFirstInDuration){let e=Math.ceil(o.msBeforeNext/(o.remainingPoints+2));e<this.execEvenlyMinDelayMs&&(e=o.consumedPoints*this.execEvenlyMinDelayMs),await mf(e)}return o}penalty(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getKey(e),i=this._getKeySecDuration(n),o=this.memoryStorage.incrby(r,t,i);return o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o}reward(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=this.getKey(e),i=this._getKeySecDuration(n),o=this.memoryStorage.incrby(r,-t,i);return o.remainingPoints=Math.max(this.points-o.consumedPoints,0),o}block(e,t){const n=1e3*t,r=this.points+1;return this.memoryStorage.set(this.getKey(e),r,t),{remainingPoints:0,msBeforeNext:0===n?-1:n,consumedPoints:r,isFirstInDuration:!1}}set(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=1e3*(n>=0?n:this.duration);return this.memoryStorage.set(this.getKey(e),t,n),{remainingPoints:0,msBeforeNext:0===r?-1:r,consumedPoints:t,isFirstInDuration:!1}}get(e){const t=this.memoryStorage.get(this.getKey(e));return null!=t&&(t.remainingPoints=Math.max(this.points-t.consumedPoints,0)),t}delete(e){this.memoryStorage.delete(this.getKey(e))}_getKeySecDuration(e){return null!=(null===e||void 0===e?void 0:e.customDuration)&&e.customDuration>=0?e.customDuration:this.duration}getKey(e){return this.keyPrefix.length>0?"".concat(this.keyPrefix,":").concat(e):e}parseKey(e){return e.substring(this.keyPrefix.length)}}class bf{constructor(){w(this,"storage",void 0),this.storage=new Map}incrby(e,t,n){const r=this.storage.get(e);if(null!=r){const i=null!=r.expiresAt?r.expiresAt.getTime()-(new Date).getTime():-1;return null==r.expiresAt||i>0?(r.value+=t,{remainingPoints:0,msBeforeNext:i,consumedPoints:r.value,isFirstInDuration:!1}):this.set(e,t,n)}return this.set(e,t,n)}set(e,t,n){const r=1e3*n,i=this.storage.get(e);null!=i&&clearTimeout(i.timeoutId);const o={value:t,expiresAt:r>0?new Date(Date.now()+r):void 0};return this.storage.set(e,o),r>0&&(o.timeoutId=setTimeout((()=>{this.storage.delete(e)}),r),null!=o.timeoutId.unref&&o.timeoutId.unref()),{remainingPoints:0,msBeforeNext:0===r?-1:r,consumedPoints:o.value,isFirstInDuration:!0}}get(e){const t=this.storage.get(e);if(null!=t){return{remainingPoints:0,msBeforeNext:null!=t.expiresAt?t.expiresAt.getTime()-(new Date).getTime():-1,consumedPoints:t.value,isFirstInDuration:!1}}}delete(e){const t=this.storage.get(e);return null!=t&&(null!=t.timeoutId&&clearTimeout(t.timeoutId),this.storage.delete(e),!0)}}function Ef(e){if($s(e))return{peerId:e,multiaddrs:[]};let t,n=Array.isArray(e)?e:[e];if(n.length>0){const e=n[0].getPeerId();t=null==e?void 0:ra(e),n.forEach((e=>{if(!hc(e))throw new z("Invalid multiaddr");const n=e.getPeerId();if(null==n){if(null!=t)throw new C("Multiaddrs must all have the same peer id or have no peer id")}else{var r;const e=ra(n);if(!0!==(null===(r=t)||void 0===r?void 0:r.equals(e)))throw new C("Multiaddrs must all have the same peer id or have no peer id")}}))}return n=n.filter((e=>!jd.exactMatch(e))),{peerId:t,multiaddrs:n}}const Sf=["/ipfs/id/1.0.0","/ipfs/id/push/1.0.0","/libp2p/autonat/1.0.0","/libp2p/dcutr"];function kf(e){try{let t;if(t="string"===typeof e?fc(e):e,!t.protoNames().includes("ipcidr")){const e=t.protoNames().includes("ip6")?"/ipcidr/128":"/ipcidr/32";t=t.encapsulate(e)}return function(e){let t,n;if(e.stringTuples().forEach((e=>{let[r,i]=e;r!==zl.code&&r!==Fl.code||(n=i),r===Ul.code&&(t=i)})),null==t||null==n)throw new Error("Invalid multiaddr");return new Pl(n,t)}(t)}catch(t){throw new Error("Can't convert to IpNet, Invalid multiaddr format: ".concat(e))}}const xf=100;class Cf{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"maxConnections",void 0),w(this,"connectionManager",void 0),w(this,"peerStore",void 0),w(this,"allow",void 0),w(this,"events",void 0),w(this,"log",void 0),this.maxConnections=null!==(t=r.maxConnections)&&void 0!==t?t:xf,this.allow=(null!==(n=r.allow)&&void 0!==n?n:[]).map((e=>kf(e))),this.connectionManager=e.connectionManager,this.peerStore=e.peerStore,this.events=e.events,this.log=e.logger.forComponent("libp2p:connection-manager:connection-pruner"),this.maybePruneConnections=this.maybePruneConnections.bind(this)}start(){this.events.addEventListener("connection:open",this.maybePruneConnections)}stop(){this.events.removeEventListener("connection:open",this.maybePruneConnections)}maybePruneConnections(){this._maybePruneConnections().catch((e=>{this.log.error("error while pruning connections %e",e)}))}async _maybePruneConnections(){const e=this.connectionManager.getConnections(),t=e.length;if(this.log("checking max connections limit %d/%d",t,this.maxConnections),t<=this.maxConnections)return;const n=new hf;for(const a of e){const e=a.remotePeer;if(!n.has(e)){n.set(e,0);try{const t=await this.peerStore.get(e);n.set(e,[...t.tags.values()].reduce(((e,t)=>e+t.value),0))}catch(s){"NotFoundError"!==s.name&&this.log.error("error loading peer tags",s)}}}const r=this.sortConnections(e,n),i=Math.max(t-this.maxConnections,0),o=[];for(const a of r){this.log("too many connections open - closing a connection to %p",a.remotePeer);if(this.allow.some((e=>e.contains(a.remoteAddr.nodeAddress().address)))||o.push(a),o.length===i)break}await Promise.all(o.map((async e=>{await async function(e,t){var n,r,i;const o=null!==(n=null===e||void 0===e||null===(r=e.streams)||void 0===r?void 0:r.map((e=>e.protocol)))&&void 0!==n?n:[],a=null!==(i=null===t||void 0===t?void 0:t.closableProtocols)&&void 0!==i?i:Sf;if(!(o.filter((e=>null!=e&&!a.includes(e))).length>0))try{await(null===e||void 0===e?void 0:e.close(t))}catch(s){null===e||void 0===e||e.abort(s)}}(e,{signal:AbortSignal.timeout(1e3)})}))),this.events.safeDispatchEvent("connection:prune",{detail:o})}sortConnections(e,t){return e.sort(((e,t)=>{const n=e.timeline.open,r=t.timeline.open;return n<r?1:n>r?-1:0})).sort(((e,t)=>"outbound"===e.direction&&"inbound"===t.direction?1:"inbound"===e.direction&&"outbound"===t.direction?-1:0)).sort(((e,t)=>e.streams.length>t.streams.length?1:e.streams.length<t.streams.length?-1:0)).sort(((e,n)=>{var r,i;const o=null!==(r=t.get(e.remotePeer))&&void 0!==r?r:0,s=null!==(i=t.get(n.remotePeer))&&void 0!==i?i:0;return o>s?1:o<s?-1:0}))}}const Pf="last-dial-failure",Af="last-dial-success";function If(){const e={};return e.promise=new Promise(((t,n)=>{e.resolve=t,e.reject=n})),e}class _f{constructor(e){if(w(this,"buffer",void 0),w(this,"mask",void 0),w(this,"top",void 0),w(this,"btm",void 0),w(this,"next",void 0),!(e>0)||0!==(e-1&e))throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return void 0===this.buffer[this.top]&&(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){const e=this.buffer[this.btm];if(void 0!==e)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return void 0===this.buffer[this.btm]}}class Tf{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};w(this,"size",void 0),w(this,"hwm",void 0),w(this,"head",void 0),w(this,"tail",void 0),this.hwm=null!==(e=t.splitLimit)&&void 0!==e?e:16,this.head=new _f(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return null!=(null===e||void 0===e?void 0:e.byteLength)?e.byteLength:1}push(e){if(null!=(null===e||void 0===e?void 0:e.value)&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){const t=this.head;this.head=t.next=new _f(2*this.head.buffer.length),this.head.push(e)}}shift(){var e;let t=this.tail.shift();if(void 0===t&&null!=this.tail.next){const e=this.tail.next;this.tail.next=null,this.tail=e,t=this.tail.shift()}return null!=(null===(e=t)||void 0===e?void 0:e.value)&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}}class Lf extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),w(this,"type",void 0),w(this,"code",void 0),this.type="aborted",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}function Rf(){return Nf((e=>{const t=e.shift();if(null==t)return{done:!0};if(null!=t.error)throw t.error;return{done:!0===t.done,value:t.value}}),arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function Nf(e,t){let n,r,i,o=(t=null!==t&&void 0!==t?t:{}).onEnd,s=new Tf,a=If();const l=e=>null!=r?r(e):(s.push(e),n),c=e=>{var r;if(i)return n;if(!0!==(null===(r=t)||void 0===r?void 0:r.objectMode)&&null==(null===e||void 0===e?void 0:e.byteLength))throw new Error("objectMode was not true but tried to push non-Uint8Array value");return l({done:!1,value:e})},u=e=>i?n:(i=!0,null!=e?(e=>(s=new Tf,null!=r?r({error:e}):(s.push({error:e}),n)))(e):l({done:!0}));if(n={[Symbol.asyncIterator](){return this},next:async()=>{try{return s.isEmpty()?i?{done:!0}:await new Promise(((t,i)=>{r=o=>{r=null,s.push(o);try{t(e(s))}catch(a){i(a)}return n}})):e(s)}finally{s.isEmpty()&&queueMicrotask((()=>{a.resolve(),a=If()}))}},return:()=>(s=new Tf,u(),{done:!0}),throw:e=>(u(e),{done:!0}),push:c,end:u,get readableLength(){return s.size},onEmpty:async e=>{const t=null===e||void 0===e?void 0:e.signal;if(null===t||void 0===t||t.throwIfAborted(),s.isEmpty())return;let n,r;null!=t&&(n=new Promise(((e,n)=>{r=()=>{n(new Lf)},t.addEventListener("abort",r)})));try{await Promise.race([a.promise,n])}finally{null!=r&&null!=t&&(null===t||void 0===t||t.removeEventListener("abort",r))}}},null==o)return n;const d=n;return n={[Symbol.asyncIterator](){return this},next:()=>d.next(),throw:e=>(d.throw(e),null!=o&&(o(e),o=void 0),{done:!0}),return:()=>(d.return(),null!=o&&(o(),o=void 0),{done:!0}),push:c,end:e=>(d.end(e),null!=o&&(o(e),o=void 0),n),get readableLength(){return d.readableLength},onEmpty:e=>d.onEmpty(e)},n}class Mf extends Error{constructor(e,t){super(null!==e&&void 0!==e?e:"The operation was aborted"),w(this,"type",void 0),w(this,"code",void 0),this.type="aborted",this.name="AbortError",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}async function Df(e,t,n,r){const i=new Mf(null===r||void 0===r?void 0:r.errorMessage,null===r||void 0===r?void 0:r.errorCode);return!0===(null===n||void 0===n?void 0:n.aborted)?Promise.reject(i):new Promise(((o,s)=>{function a(){null===n||void 0===n||n.removeEventListener("abort",u),e.removeEventListener(t,l),null!=(null===r||void 0===r?void 0:r.errorEvent)&&e.removeEventListener(r.errorEvent,c)}const l=e=>{try{var t;if(!1===(null===r||void 0===r||null===(t=r.filter)||void 0===t?void 0:t.call(r,e)))return}catch(n){return a(),void s(n)}a(),o(e)},c=e=>{a(),s(e.detail)},u=()=>{a(),s(i)};null===n||void 0===n||n.addEventListener("abort",u),e.addEventListener(t,l),null!=(null===r||void 0===r?void 0:r.errorEvent)&&e.addEventListener(r.errorEvent,c)}))}class Of extends Error{constructor(e,t,n){super(null!==e&&void 0!==e?e:"The operation was aborted"),w(this,"type",void 0),w(this,"code",void 0),this.type="aborted",this.name=null!==n&&void 0!==n?n:"AbortError",this.code=null!==t&&void 0!==t?t:"ABORT_ERR"}}async function zf(e,t,n){if(null==t)return e;if(t.aborted)return e.catch((()=>{})),Promise.reject(new Of(null===n||void 0===n?void 0:n.errorMessage,null===n||void 0===n?void 0:n.errorCode,null===n||void 0===n?void 0:n.errorName));let r;const i=new Of(null===n||void 0===n?void 0:n.errorMessage,null===n||void 0===n?void 0:n.errorCode,null===n||void 0===n?void 0:n.errorName);try{return await Promise.race([e,new Promise(((e,n)=>{r=()=>{n(i)},t.addEventListener("abort",r)}))])}finally{null!=r&&t.removeEventListener("abort",r)}}class Ff{constructor(e){var t;w(this,"deferred",void 0),w(this,"signal",void 0),this.signal=e,this.deferred=If(),this.onAbort=this.onAbort.bind(this),null===(t=this.signal)||void 0===t||t.addEventListener("abort",this.onAbort)}onAbort(){var e,t;this.deferred.reject(null!==(e=null===(t=this.signal)||void 0===t?void 0:t.reason)&&void 0!==e?e:new S)}cleanup(){var e;null===(e=this.signal)||void 0===e||e.removeEventListener("abort",this.onAbort)}}class Uf{constructor(e,t){w(this,"id",void 0),w(this,"fn",void 0),w(this,"options",void 0),w(this,"recipients",void 0),w(this,"status",void 0),w(this,"timeline",void 0),w(this,"controller",void 0),this.id="".concat(parseInt(String(1e9*Math.random()),10).toString()).concat(Date.now()),this.status="queued",this.fn=e,this.options=t,this.recipients=[],this.timeline={created:Date.now()},this.controller=new AbortController,this.controller.signal,this.onAbort=this.onAbort.bind(this)}abort(e){this.controller.abort(e)}onAbort(){this.recipients.reduce(((e,t)=>{var n;return e&&!0===(null===(n=t.signal)||void 0===n?void 0:n.aborted)}),!0)&&(this.controller.abort(new S),this.cleanup())}async join(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=new Ff(t.signal);return this.recipients.push(n),null===(e=t.signal)||void 0===e||e.addEventListener("abort",this.onAbort),n.deferred.promise}async run(){this.status="running",this.timeline.started=Date.now();try{var e;this.controller.signal.throwIfAborted();const t=await zf(this.fn(E(E({},null!==(e=this.options)&&void 0!==e?e:{}),{},{signal:this.controller.signal})),this.controller.signal);this.recipients.forEach((e=>{e.deferred.resolve(t)})),this.status="complete"}catch(t){this.recipients.forEach((e=>{e.deferred.reject(t)})),this.status="errored"}finally{this.timeline.finished=Date.now(),this.cleanup()}}cleanup(){this.recipients.forEach((e=>{var t;e.cleanup(),null===(t=e.signal)||void 0===t||t.removeEventListener("abort",this.onAbort)}))}}class Bf extends wc{constructor(){var e,t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var r;(super(),w(this,"concurrency",void 0),w(this,"maxSize",void 0),w(this,"queue",void 0),w(this,"pending",void 0),w(this,"sort",void 0),this.concurrency=null!==(e=n.concurrency)&&void 0!==e?e:Number.POSITIVE_INFINITY,this.maxSize=null!==(t=n.maxSize)&&void 0!==t?t:Number.POSITIVE_INFINITY,this.pending=0,null!=n.metricName)&&(null===(r=n.metrics)||void 0===r||r.registerMetricGroup(n.metricName,{calculate:()=>({size:this.queue.length,running:this.pending,queued:this.queue.length-this.pending})}));this.sort=n.sort,this.queue=[],this.emitEmpty=md(this.emitEmpty.bind(this),1),this.emitIdle=md(this.emitIdle.bind(this),1)}emitEmpty(){0===this.size&&this.safeDispatchEvent("empty")}emitIdle(){0===this.running&&this.safeDispatchEvent("idle")}tryToStartAnother(){if(0===this.size)return this.emitEmpty(),0===this.running&&this.emitIdle(),!1;if(this.pending<this.concurrency){let e;for(const t of this.queue)if("queued"===t.status){e=t;break}return null!=e&&(this.safeDispatchEvent("active"),this.pending++,e.run().finally((()=>{for(let t=0;t<this.queue.length;t++)if(this.queue[t]===e){this.queue.splice(t,1);break}this.pending--,this.tryToStartAnother(),this.safeDispatchEvent("next")})),!0)}return!1}enqueue(e){this.queue.push(e),null!=this.sort&&this.queue.sort(this.sort)}async add(e,t){var n;if(null===t||void 0===t||null===(n=t.signal)||void 0===n||n.throwIfAborted(),this.size===this.maxSize)throw new yf;const r=new Uf(e,t);return this.enqueue(r),this.safeDispatchEvent("add"),this.tryToStartAnother(),r.join(t).then((e=>(this.safeDispatchEvent("completed",{detail:e}),this.safeDispatchEvent("success",{detail:{job:r,result:e}}),e))).catch((e=>{if("queued"===r.status)for(let t=0;t<this.queue.length;t++)if(this.queue[t]===r){this.queue.splice(t,1);break}throw this.safeDispatchEvent("error",{detail:e}),this.safeDispatchEvent("failure",{detail:{job:r,error:e}}),e}))}clear(){this.queue.splice(0,this.queue.length)}abort(){this.queue.forEach((e=>{e.abort(new S)})),this.clear()}async onEmpty(e){0!==this.size&&await Df(this,"empty",null===e||void 0===e?void 0:e.signal)}async onSizeLessThan(e,t){this.size<e||await Df(this,"next",null===t||void 0===t?void 0:t.signal,{filter:()=>this.size<e})}async onIdle(e){0===this.pending&&0===this.size||await Df(this,"idle",null===e||void 0===e?void 0:e.signal)}get size(){return this.queue.length}get queued(){return this.queue.length-this.pending}get running(){return this.pending}toGenerator(e){var t=this;return ru((function*(){var n,r;null===e||void 0===e||null===(n=e.signal)||void 0===n||n.throwIfAborted();const i=Rf({objectMode:!0}),o=e=>{null!=e?t.abort():t.clear(),i.end(e)},s=e=>{null!=e.detail&&i.push(e.detail)},a=e=>{o(e.detail)},l=()=>{o()},c=()=>{o(new S("Queue aborted"))};t.addEventListener("completed",s),t.addEventListener("error",a),t.addEventListener("idle",l),null===e||void 0===e||null===(r=e.signal)||void 0===r||r.addEventListener("abort",c);try{yield*dd(Kc(i))}finally{var u;t.removeEventListener("completed",s),t.removeEventListener("error",a),t.removeEventListener("idle",l),null===e||void 0===e||null===(u=e.signal)||void 0===u||u.removeEventListener("abort",c),o()}}))()}}class qf extends Bf{constructor(){super(E(E({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),{},{sort:(e,t)=>e.options.priority>t.options.priority?-1:e.options.priority<t.options.priority?1:0}))}}function Vf(e){const t=new globalThis.AbortController;function n(){t.abort();for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)}for(const i of e){if(!0===(null===i||void 0===i?void 0:i.aborted)){n();break}null!=(null===i||void 0===i?void 0:i.addEventListener)&&i.addEventListener("abort",n)}const r=t.signal;return r.clear=function(){for(const t of e)null!=(null===t||void 0===t?void 0:t.removeEventListener)&&t.removeEventListener("abort",n)},r}function Kf(e){if(!xh(e))return!1;const{address:t}=e.nodeAddress();return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(n=t)||/^::1$/.test(n);var n}function jf(e,t){const n=ih.exactMatch(e.multiaddr),r=ih.exactMatch(t.multiaddr);if(n&&!r)return-1;if(!n&&r)return 1;const i=fh.exactMatch(e.multiaddr),o=fh.exactMatch(t.multiaddr);if(i&&!o)return-1;if(!i&&o)return 1;const s=dh.exactMatch(e.multiaddr),a=dh.exactMatch(t.multiaddr);if(s&&!a)return-1;if(!s&&a)return 1;const l=bh.exactMatch(e.multiaddr),c=bh.exactMatch(t.multiaddr);if(l&&!c)return-1;if(!l&&c)return 1;const u=gh.exactMatch(e.multiaddr),d=gh.exactMatch(t.multiaddr);if(u&&!d)return-1;if(!u&&d)return 1;const h=vh.exactMatch(e.multiaddr),f=vh.exactMatch(t.multiaddr);return h&&!f?-1:!h&&f?1:0}function Wf(e,t){const n=Kf(e.multiaddr),r=Kf(t.multiaddr);return n&&!r?1:!n&&r?-1:0}function Hf(e,t){const n=Ch(e.multiaddr),r=Ch(t.multiaddr);return n&&!r?1:!n&&r?-1:0}function Qf(e,t){return e.isCertified&&!t.isCertified?-1:!e.isCertified&&t.isCertified?1:0}function Gf(e,t){const n=wh.exactMatch(e.multiaddr),r=wh.exactMatch(t.multiaddr);return n&&!r?1:!n&&r?-1:0}const Yf=50,$f=500,Xf=25,Zf=1e4;class Jf{constructor(e){var t,n,r,i,o;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"queue",void 0),w(this,"components",void 0),w(this,"addressSorter",void 0),w(this,"maxPeerAddrsToDial",void 0),w(this,"maxDialQueueLength",void 0),w(this,"dialTimeout",void 0),w(this,"shutDownController",void 0),w(this,"connections",void 0),w(this,"log",void 0),this.addressSorter=s.addressSorter,this.maxPeerAddrsToDial=null!==(t=s.maxPeerAddrsToDial)&&void 0!==t?t:Xf,this.maxDialQueueLength=null!==(n=s.maxDialQueueLength)&&void 0!==n?n:$f,this.dialTimeout=null!==(r=s.dialTimeout)&&void 0!==r?r:Zf,this.connections=null!==(i=s.connections)&&void 0!==i?i:new hf,this.log=e.logger.forComponent("libp2p:connection-manager:dial-queue"),this.components=e,this.shutDownController=new AbortController,this.shutDownController.signal;for(const[l,c]of Object.entries(null!==(a=s.resolvers)&&void 0!==a?a:{})){var a;dc.set(l,c)}this.queue=new qf({concurrency:null!==(o=s.maxParallelDials)&&void 0!==o?o:Yf,metricName:"libp2p_dial_queue",metrics:e.metrics}),this.queue.addEventListener("error",(e=>{var t;(null===(t=e.detail)||void 0===t?void 0:t.name)!==S.name&&this.log.error("error in dial queue - %e",e.detail)}))}start(){this.shutDownController=new AbortController,this.shutDownController.signal}stop(){this.shutDownController.abort(),this.queue.abort()}async dial(e){var t,n,r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{peerId:o,multiaddrs:s}=Ef(e),a=Array.from(this.connections.values()).flat().find((e=>!0!==i.force&&(!!e.remotePeer.equals(o)||s.find((t=>t.equals(e.remoteAddr))))));var l;if("open"===(null===a||void 0===a?void 0:a.status))return this.log("already connected to %a",a.remoteAddr),null===(l=i.onProgress)||void 0===l||l.call(i,new ba("dial-queue:already-connected")),a;const c=this.queue.queue.find((e=>{if(!0===(null===o||void 0===o?void 0:o.equals(e.options.peerId)))return!0;const t=e.options.multiaddrs;if(null==t)return!1;for(const n of s)if(t.has(n.toString()))return!0;return!1}));if(null!=c){var u;this.log("joining existing dial target for %p",o);for(const e of s)c.options.multiaddrs.add(e.toString());return null===(u=i.onProgress)||void 0===u||u.call(i,new ba("dial-queue:already-in-dial-queue")),c.join(i)}if(this.queue.size>=this.maxDialQueueLength)throw new H("Dial queue is full");return this.log("creating dial target for %p",o,s.map((e=>e.toString()))),null===(t=i.onProgress)||void 0===t||t.call(i,new ba("dial-queue:add-to-dial-queue")),this.queue.add((async e=>{var t;null===(t=e.onProgress)||void 0===t||t.call(e,new ba("dial-queue:start-dial"));const n=Vf([this.shutDownController.signal,e.signal]);try{return await this.dialPeer(e,n)}finally{n.clear()}}),{peerId:o,priority:null!==(n=i.priority)&&void 0!==n?n:up,multiaddrs:new Set(s.map((e=>e.toString()))),signal:null!==(r=i.signal)&&void 0!==r?r:AbortSignal.timeout(this.dialTimeout),onProgress:i.onProgress})}async dialPeer(e,t){const n=e.peerId,r=e.multiaddrs,i=new Set;let o=0===e.multiaddrs.size,s=0,a=0;const l=[];for(this.log("starting dial to %p",n);o||r.size>0;){var c;a++,o=!1;const d=[],h=new Set(e.multiaddrs);r.clear(),this.log("calculating addrs to dial %p from %s",n,[...h]);const f=await this.calculateMultiaddrs(n,h,E(E({},e),{},{signal:t}));for(const e of f)i.has(e.multiaddr.toString())?this.log.trace("skipping previously failed multiaddr %a while dialing %p",e.multiaddr,n):d.push(e);this.log("%s dial to %p with %s",1===a?"starting":"continuing",n,d.map((e=>e.multiaddr.toString()))),null===e||void 0===e||null===(c=e.onProgress)||void 0===c||c.call(e,new ba("dial-queue:calculated-addresses",d));for(const r of d){if(s===this.maxPeerAddrsToDial)throw this.log("dialed maxPeerAddrsToDial (%d) addresses for %p, not trying any others",s,e.peerId),new H("Peer had more than maxPeerAddrsToDial");s++;try{const i=await this.components.transportManager.dial(r.multiaddr,E(E({},e),{},{signal:t}));this.log("dial to %a succeeded",r.multiaddr);try{await this.components.peerStore.merge(i.remotePeer,{multiaddrs:[i.remoteAddr],metadata:{[Af]:jt(Date.now().toString())}})}catch(u){this.log.error("could not update last dial failure key for %p",n,u)}return i}catch(u){if(this.log.error("dial failed to %a",r.multiaddr,u),i.add(r.multiaddr.toString()),null!=n)try{await this.components.peerStore.merge(n,{metadata:{[Pf]:jt(Date.now().toString())}})}catch(u){this.log.error("could not update last dial failure key for %p",n,u)}if(t.aborted)throw new K(u.message);l.push(u)}}}if(1===l.length)throw l[0];throw new AggregateError(l,"All multiaddr dials failed")}async calculateMultiaddrs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[...t].map((e=>({multiaddr:fc(e),isCertified:!1})));if(null!=e){var i,o;if(this.components.peerId.equals(e))throw new H("Tried to dial self");if(!0===await(null===(i=(o=this.components.connectionGater).denyDialPeer)||void 0===i?void 0:i.call(o,e)))throw new Yh("The dial request is blocked by gater.allowDialPeer");if(0===r.length){this.log("loading multiaddrs for %p",e);try{const t=await this.components.peerStore.get(e);r.push(...t.addresses),this.log("loaded multiaddrs for %p",e,r.map((e=>{let{multiaddr:t}=e;return t.toString()})))}catch(h){if("NotFoundError"!==h.name)throw h}}if(0===r.length){this.log("looking up multiaddrs for %p in the peer routing",e);try{const t=await this.components.peerRouting.findPeer(e,n);this.log("found multiaddrs for %p in the peer routing",e,r.map((e=>{let{multiaddr:t}=e;return t.toString()}))),r.push(...t.multiaddrs.map((e=>({multiaddr:e,isCertified:!1}))))}catch(h){"NoPeerRoutersError"===h.name?this.log("no peer routers configured",e):this.log.error("looking up multiaddrs for %p in the peer routing failed - %e",e,h)}}}let s=(await Promise.all(r.map((async e=>{const t=await async function(e,t){let n=!1;for(const i of dc.keys())if(n=e.protoNames().includes(i),n)break;if(!n)return[e];const r=await e.resolve(t);return t.log("resolved %s to",e,r.map((e=>e.toString()))),r}(e.multiaddr,E(E({dns:this.components.dns},n),{},{log:this.log}));return 1===t.length&&t[0].equals(e.multiaddr)?e:t.map((e=>({multiaddr:e,isCertified:!1})))})))).flat();if(null!=e){const t="/p2p/".concat(e.toString());s=s.map((e=>{const n=e.multiaddr.protos().pop();return!0===(null===n||void 0===n?void 0:n.path)?e:null==e.multiaddr.getPeerId()?{multiaddr:e.multiaddr.encapsulate(t),isCertified:e.isCertified}:e}))}const a=s.filter((t=>{if(null==this.components.transportManager.dialTransportForMultiaddr(t.multiaddr))return!1;const n=t.multiaddr.getPeerId();return null==e||null==n||e.equals(n)})),l=new Map;for(const f of a){const e=f.multiaddr.toString(),t=l.get(e);null==t?l.set(e,f):t.isCertified=t.isCertified||f.isCertified||!1}const c=[...l.values()];if(0===c.length)throw new Zh("The dial request has no valid addresses");const u=[];for(const f of c)null!=this.components.connectionGater.denyDialMultiaddr&&await this.components.connectionGater.denyDialMultiaddr(f.multiaddr)||u.push(f);const d=null==this.addressSorter?u.sort(jf).sort(Qf).sort(Gf).sort(Hf).sort(Wf):u.sort(this.addressSorter);if(0===d.length)throw new Yh("The connection gater denied all addresses in the dial request");return this.log.trace("addresses for %p before filtering",null!==e&&void 0!==e?e:"unknown peer",s.map((e=>{let{multiaddr:t}=e;return t.toString()}))),this.log.trace("addresses for %p after filtering",null!==e&&void 0!==e?e:"unknown peer",d.map((e=>{let{multiaddr:t}=e;return t.toString()}))),d}async isDialable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Array.isArray(e)||(e=[e]);try{const n=await this.calculateMultiaddrs(void 0,new Set(e.map((e=>e.toString()))),t);return!1!==t.runOnLimitedConnection||null!=n.find((e=>!wh.matches(e.multiaddr)))}catch(n){this.log.trace("error calculating if multiaddr(s) were dialable",n)}return!1}}const ep="keep-alive";class tp extends Bf{has(e){return null!=this.find(e)}find(e){return this.queue.find((t=>e.equals(t.options.peerId)))}}var np=n(302);const rp=Object.prototype.toString,ip=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function op(e){var t;return!(!e||(t=e,"[object Error]"!==rp.call(t))||"TypeError"!==e.name||"string"!==typeof e.message)&&("Load failed"===e.message?void 0===e.stack:ip.has(e.message))}class sp extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,({message:e}=e)):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const ap=(e,t,n)=>{const r=n.retries-(t-1);return e.attemptNumber=t,e.retriesLeft=r,e};class lp{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"log",void 0),w(this,"queue",void 0),w(this,"started",void 0),w(this,"peerStore",void 0),w(this,"retries",void 0),w(this,"retryInterval",void 0),w(this,"backoffFactor",void 0),w(this,"connectionManager",void 0),w(this,"events",void 0),this.log=e.logger.forComponent("libp2p:reconnect-queue"),this.peerStore=e.peerStore,this.connectionManager=e.connectionManager,this.queue=new tp({concurrency:null!==(t=r.maxParallelReconnects)&&void 0!==t?t:5,metricName:"libp2p_reconnect_queue",metrics:e.metrics}),this.started=!1,this.retries=null!==(n=r.retries)&&void 0!==n?n:5,this.backoffFactor=r.backoffFactor,this.retryInterval=r.retryInterval,this.events=e.events,e.events.addEventListener("peer:disconnect",(e=>{this.maybeReconnect(e.detail).catch((t=>{this.log.error("failed to maybe reconnect to %p - %e",e.detail,t)}))}))}async maybeReconnect(e){if(!this.started)return;const t=await this.peerStore.get(e);cp(t)&&(this.queue.has(e)||this.queue.add((async t=>{await async function(e,t){return new Promise(((n,r)=>{var i,o,s,a,l,c;null!==(o=(i=t=E({},t)).onFailedAttempt)&&void 0!==o||(i.onFailedAttempt=()=>{}),null!==(a=(s=t).shouldRetry)&&void 0!==a||(s.shouldRetry=()=>!0),null!==(c=(l=t).retries)&&void 0!==c||(l.retries=10);const u=np.operation(t),d=()=>{var e;u.stop(),r(null===(e=t.signal)||void 0===e?void 0:e.reason)};t.signal&&!t.signal.aborted&&t.signal.addEventListener("abort",d,{once:!0});const h=()=>{var e;null===(e=t.signal)||void 0===e||e.removeEventListener("abort",d),u.stop()};u.attempt((async i=>{try{const t=await e(i);h(),n(t)}catch(o){try{if(!(o instanceof Error))throw new TypeError('Non-error was thrown: "'.concat(o,'". You should only throw errors.'));if(o instanceof sp)throw o.originalError;if(o instanceof TypeError&&!op(o))throw o;if(ap(o,i,t),await t.shouldRetry(o)||(u.stop(),r(o)),await t.onFailedAttempt(o),!u.retry(o))throw u.mainError()}catch(s){ap(s,i,t),h(),r(s)}}}))}))}((async n=>{if(this.started)try{await this.connectionManager.openConnection(e,{signal:null===t||void 0===t?void 0:t.signal})}catch(r){throw this.log("reconnecting to %p attempt %d of %d failed - %e",e,n,this.retries,r),r}}),{signal:null===t||void 0===t?void 0:t.signal,retries:this.retries,factor:this.backoffFactor,minTimeout:this.retryInterval})}),{peerId:e}).catch((async n=>{this.log.error("failed to reconnect to %p - %e",e,n);const r={};[...t.tags.keys()].forEach((e=>{e.startsWith(ep)&&(r[e]=void 0)})),await this.peerStore.merge(e,{tags:r}),this.events.safeDispatchEvent("peer:reconnect-failure",{detail:e})})).catch((async t=>{this.log.error("failed to remove keep-alive tag from %p - %e",e,t)})))}start(){this.started=!0}async afterStart(){Promise.resolve().then((async()=>{const e=await this.peerStore.all({filters:[e=>cp(e)]});await Promise.all(e.map((async e=>{await this.connectionManager.openConnection(e.id).catch((e=>{this.log.error(e)}))})))})).catch((e=>{this.log.error(e)}))}stop(){this.started=!1,this.queue.abort()}}function cp(e){for(const t of e.tags.keys())if(t.startsWith(ep))return!0;return!1}const up=50,dp=100,hp=5,fp=10;class pp{constructor(e){var t,n,r,i,o,s,a,l,c,u,d;let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(w(this,"started",void 0),w(this,"connections",void 0),w(this,"allow",void 0),w(this,"deny",void 0),w(this,"maxIncomingPendingConnections",void 0),w(this,"incomingPendingConnections",void 0),w(this,"outboundPendingConnections",void 0),w(this,"maxConnections",void 0),w(this,"dialQueue",void 0),w(this,"reconnectQueue",void 0),w(this,"connectionPruner",void 0),w(this,"inboundConnectionRateLimiter",void 0),w(this,"peerStore",void 0),w(this,"metrics",void 0),w(this,"events",void 0),w(this,"log",void 0),w(this,"peerId",void 0),w(this,Symbol.toStringTag,"@libp2p/connection-manager"),this.maxConnections=null!==(t=h.maxConnections)&&void 0!==t?t:dp,this.maxConnections<1)throw new C("Connection Manager maxConnections must be greater than 0");this.connections=new hf,this.started=!1,this.peerId=e.peerId,this.peerStore=e.peerStore,this.metrics=e.metrics,this.events=e.events,this.log=e.logger.forComponent("libp2p:connection-manager"),this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.allow=(null!==(n=h.allow)&&void 0!==n?n:[]).map((e=>kf(e))),this.deny=(null!==(r=h.deny)&&void 0!==r?r:[]).map((e=>kf(e))),this.incomingPendingConnections=0,this.maxIncomingPendingConnections=null!==(i=h.maxIncomingPendingConnections)&&void 0!==i?i:fp,this.outboundPendingConnections=0,this.inboundConnectionRateLimiter=new wf({points:null!==(o=h.inboundConnectionThreshold)&&void 0!==o?o:hp,duration:1}),this.connectionPruner=new Cf({connectionManager:this,peerStore:e.peerStore,events:e.events,logger:e.logger},{maxConnections:this.maxConnections,allow:null===(s=h.allow)||void 0===s?void 0:s.map((e=>fc(e)))}),this.dialQueue=new Jf(e,{addressSorter:h.addressSorter,maxParallelDials:null!==(a=h.maxParallelDials)&&void 0!==a?a:50,maxDialQueueLength:null!==(l=h.maxDialQueueLength)&&void 0!==l?l:500,maxPeerAddrsToDial:null!==(c=h.maxPeerAddrsToDial)&&void 0!==c?c:25,dialTimeout:null!==(u=h.dialTimeout)&&void 0!==u?u:1e4,resolvers:null!==(d=h.resolvers)&&void 0!==d?d:{dnsaddr:mc},connections:this.connections}),this.reconnectQueue=new lp({events:e.events,peerStore:e.peerStore,logger:e.logger,connectionManager:this},{retries:h.reconnectRetries,retryInterval:h.reconnectRetryInterval,backoffFactor:h.reconnectBackoffFactor,maxParallelReconnects:h.maxParallelReconnects})}async start(){var e,t,n;null===(e=this.metrics)||void 0===e||e.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{const e={inbound:0,"inbound pending":this.incomingPendingConnections,outbound:0,"outbound pending":this.outboundPendingConnections};for(const t of this.connections.values())for(const n of t)e[n.direction]++;return e}}),null===(t=this.metrics)||void 0===t||t.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{const e={};for(const r of this.connections.values())for(const i of r)for(const r of i.streams){var t,n;const i="".concat(r.direction," ").concat(null!==(t=r.protocol)&&void 0!==t?t:"unnegotiated");e[i]=(null!==(n=e[i])&&void 0!==n?n:0)+1}return e}}),null===(n=this.metrics)||void 0===n||n.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{const e={};for(const o of this.connections.values())for(const i of o){const o={};for(const e of i.streams){var t,n;const r="".concat(e.direction," ").concat(null!==(t=e.protocol)&&void 0!==t?t:"unnegotiated");o[r]=(null!==(n=o[r])&&void 0!==n?n:0)+1}for(const[t,n]of Object.entries(o)){var r;e[t]=null!==(r=e[t])&&void 0!==r?r:[],e[t].push(n)}}const i={};for(let[o,s]of Object.entries(e)){s=s.sort(((e,t)=>e-t));const e=Math.floor(.9*s.length);i[o]=s[e]}return i}}),this.events.addEventListener("connection:open",this.onConnect),this.events.addEventListener("connection:close",this.onDisconnect),await zh(this.dialQueue,this.reconnectQueue,this.connectionPruner),this.started=!0,this.log("started")}async stop(){this.events.removeEventListener("connection:open",this.onConnect),this.events.removeEventListener("connection:close",this.onDisconnect),await Fh(this.reconnectQueue,this.dialQueue,this.connectionPruner);const e=[];for(const t of this.connections.values())for(const n of t)e.push((async()=>{try{await n.close()}catch(e){this.log.error(e)}})());this.log("closing %d connections",e.length),await Promise.all(e),this.connections.clear(),this.log("stopped")}getMaxConnections(){return this.maxConnections}onConnect(e){this._onConnect(e).catch((e=>{this.log.error(e)}))}async _onConnect(e){var t;const{detail:n}=e;if(!this.started)return void await n.close();if("open"!==n.status)return;const r=n.remotePeer,i=!this.connections.has(r),o=null!==(t=this.connections.get(r))&&void 0!==t?t:[];o.push(n),this.connections.set(r,o),null!=r.publicKey&&"RSA"===r.type&&await this.peerStore.patch(r,{publicKey:r.publicKey}),i&&this.events.safeDispatchEvent("peer:connect",{detail:n.remotePeer})}onDisconnect(e){var t;const{detail:n}=e,r=n.remotePeer,i=(null!==(t=this.connections.get(r))&&void 0!==t?t:[]).filter((e=>e.id!==n.id));this.connections.set(r,i),0===i.length&&(this.log("onDisconnect remove all connections for peer %p",r),this.connections.delete(r),this.events.safeDispatchEvent("peer:disconnect",{detail:n.remotePeer}))}getConnections(e){var t;if(null!=e)return null!==(t=this.connections.get(e))&&void 0!==t?t:[];let n=[];for(const r of this.connections.values())n=n.concat(r);return n}getConnectionsMap(){return this.connections}async openConnection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.started)throw new j("Not started");this.outboundPendingConnections++;try{var n,r;null===(n=t.signal)||void 0===n||n.throwIfAborted();const{peerId:o}=Ef(e);if(this.peerId.equals(o))throw new O("Can not dial self");if(null!=o&&!0!==t.force){this.log("dial %p",o);const e=this.getConnections(o).find((e=>null==e.limits));var i;if(null!=e)return this.log("had an existing non-limited connection to %p",o),null===(i=t.onProgress)||void 0===i||i.call(t,new ba("dial-queue:already-connected")),e}const s=await this.dialQueue.dial(e,E(E({},t),{},{priority:null!==(r=t.priority)&&void 0!==r?r:up}));if("open"!==s.status)throw new T("Remote closed connection during opening");let a=this.connections.get(s.remotePeer);null==a&&(a=[],this.connections.set(s.remotePeer,a));let l=!1;for(const e of a)if(e.id===s.id&&(l=!0),!0!==t.force&&e.id!==s.id&&e.remoteAddr.equals(s.remoteAddr))return s.abort(new z("Duplicate multiaddr connection")),e;return l||a.push(s),s}finally{this.outboundPendingConnections--}}async closeConnections(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=null!==(t=this.connections.get(e))&&void 0!==t?t:[];await Promise.all(r.map((async e=>{try{await e.close(n)}catch(t){e.abort(t)}})))}async acceptIncomingConnection(e){if(this.deny.some((t=>t.contains(e.remoteAddr.nodeAddress().address))))return this.log("connection from %a refused - connection remote address was in deny list",e.remoteAddr),!1;if(this.allow.some((t=>t.contains(e.remoteAddr.nodeAddress().address))))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.maxIncomingPendingConnections)return this.log("connection from %a refused - incomingPendingConnections exceeded by host",e.remoteAddr),!1;if(e.remoteAddr.isThinWaistAddress()){const n=e.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(n,1)}catch(t){return this.log("connection from %a refused - inboundConnectionThreshold exceeded by host %s",e.remoteAddr,n),!1}}return this.getConnections().length<this.maxConnections?(this.incomingPendingConnections++,!0):(this.log("connection from %a refused - maxConnections exceeded",e.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}getDialQueue(){const e={queued:"queued",running:"active",errored:"error",complete:"success"};return this.dialQueue.queue.queue.map((t=>({id:t.id,status:e[t.status],peerId:t.options.peerId,multiaddrs:[...t.options.multiaddrs].map((e=>fc(e)))})))}async isDialable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.dialQueue.isDialable(e,t)}}function gp(e){if(isNaN(e)||e<=0)throw new C("random bytes length must be a Number bigger than 0");return Rn(e)}class mp{constructor(e){w(this,"movingAverage",void 0),w(this,"variance",void 0),w(this,"deviation",void 0),w(this,"forecast",void 0),w(this,"timeSpan",void 0),w(this,"previousTime",void 0),this.timeSpan=e,this.movingAverage=0,this.variance=0,this.deviation=0,this.forecast=0}alpha(e,t){return 1-Math.exp(-(e-t)/this.timeSpan)}push(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();if(null!=this.previousTime){const n=this.alpha(t,this.previousTime),r=e-this.movingAverage,i=n*r;this.movingAverage=n*e+(1-n)*this.movingAverage,this.variance=(1-n)*(this.variance+r*i),this.deviation=Math.sqrt(this.variance),this.forecast=this.movingAverage+n*r}else this.movingAverage=e;this.previousTime=t}}class vp{constructor(){var e,t,n,r,i,o;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var a;(w(this,"success",void 0),w(this,"failure",void 0),w(this,"next",void 0),w(this,"metric",void 0),w(this,"timeoutMultiplier",void 0),w(this,"failureMultiplier",void 0),w(this,"minTimeout",void 0),this.success=new mp(null!==(e=s.interval)&&void 0!==e?e:5e3),this.failure=new mp(null!==(t=s.interval)&&void 0!==t?t:5e3),this.next=new mp(null!==(n=s.interval)&&void 0!==n?n:5e3),this.failureMultiplier=null!==(r=s.failureMultiplier)&&void 0!==r?r:2,this.timeoutMultiplier=null!==(i=s.timeoutMultiplier)&&void 0!==i?i:1.2,this.minTimeout=null!==(o=s.minTimeout)&&void 0!==o?o:5e3,null!=s.metricName)&&(this.metric=null===(a=s.metrics)||void 0===a?void 0:a.registerMetricGroup(s.metricName))}getTimeoutSignal(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=Math.max(Math.round(this.next.movingAverage*(null!==(e=t.timeoutFactor)&&void 0!==e?e:this.timeoutMultiplier)),this.minTimeout),r=AbortSignal.timeout(n),i=Vf([t.signal,r]);return i.start=Date.now(),i.timeout=n,i}cleanUp(e){const t=Date.now()-e.start;var n,r;e.aborted?(this.failure.push(t),this.next.push(t*this.failureMultiplier),null===(n=this.metric)||void 0===n||n.update({failureMovingAverage:this.failure.movingAverage,failureDeviation:this.failure.deviation,failureForecast:this.failure.forecast,failureVariance:this.failure.variance,failure:t})):(this.success.push(t),this.next.push(t),null===(r=this.metric)||void 0===r||r.update({successMovingAverage:this.success.movingAverage,successDeviation:this.success.deviation,successForecast:this.success.forecast,successVariance:this.success.variance,success:t}))}}class yp{constructor(){w(this,"readNext",void 0),w(this,"haveNext",void 0),w(this,"ended",void 0),w(this,"nextResult",void 0),w(this,"error",void 0),this.ended=!1,this.readNext=If(),this.haveNext=If()}[Symbol.asyncIterator](){return this}async next(){if(null==this.nextResult&&await this.haveNext.promise,null==this.nextResult)throw new Error("HaveNext promise resolved but nextResult was undefined");const e=this.nextResult;return this.nextResult=void 0,this.readNext.resolve(),this.readNext=If(),e}async throw(e){this.ended=!0,this.error=e,null!=e&&(this.haveNext.promise.catch((()=>{})),this.haveNext.reject(e));return{done:!0,value:void 0}}async return(){const e={done:!0,value:void 0};return this.ended=!0,this.nextResult=e,this.haveNext.resolve(),e}async push(e,t){await this._push(e,t)}async end(e,t){null!=e?await this.throw(e):await this._push(void 0,t)}async _push(e,t){var n;if(null!=e&&this.ended)throw null!==(n=this.error)&&void 0!==n?n:new Error("Cannot push value onto an ended pushable");for(;null!=this.nextResult;)await this.readNext.promise;null!=e?this.nextResult={done:!1,value:e}:(this.ended=!0,this.nextResult={done:!0,value:void 0}),this.haveNext.resolve(),this.haveNext=If(),await zf(this.readNext.promise,null===t||void 0===t?void 0:t.signal,t)}}function wp(){return new yp}class bp extends Error{constructor(){super(...arguments),w(this,"name","UnexpectedEOFError"),w(this,"code","ERR_UNEXPECTED_EOF")}}function Ep(e,t){const n=wp();e.sink(n).catch((async e=>{await n.end(e)})),e.sink=async e=>{var t,r=!1,i=!1;try{for(var o,s=Kc(e);r=!(o=await s.next()).done;r=!1){const e=o.value;await n.push(e)}}catch(a){i=!0,t=a}finally{try{r&&null!=s.return&&await s.return()}finally{if(i)throw t}}await n.end()};let r=e.source;null!=e.source[Symbol.iterator]?r=e.source[Symbol.iterator]():null!=e.source[Symbol.asyncIterator]&&(r=e.source[Symbol.asyncIterator]());const i=new se;return{read:async e=>{var t;if(null===e||void 0===e||null===(t=e.signal)||void 0===t||t.throwIfAborted(),null==(null===e||void 0===e?void 0:e.bytes)){const{done:t,value:n}=await zf(r.next(),null===e||void 0===e?void 0:e.signal);return!0===t?null:n}for(;i.byteLength<e.bytes;){const{value:t,done:n}=await zf(r.next(),null===e||void 0===e?void 0:e.signal);if(!0===n)throw new bp("unexpected end of input");i.append(t)}const n=i.sublist(0,e.bytes);return i.consume(e.bytes),n},write:async(e,t)=>{var r;null===t||void 0===t||null===(r=t.signal)||void 0===r||r.throwIfAborted(),e instanceof Uint8Array?await n.push(e,t):await n.push(e.subarray(),t)},unwrap:()=>{if(i.byteLength>0){const n=e.source;e.source=ru((function*(){!1===(null===t||void 0===t?void 0:t.yieldBytes)?yield i:yield*dd(Kc(i)),yield*dd(Kc(n))}))()}return e}}}class Sp{constructor(e){var t,n,r,i;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"protocol",void 0),w(this,"components",void 0),w(this,"log",void 0),w(this,"heartbeatInterval",void 0),w(this,"pingIntervalMs",void 0),w(this,"abortController",void 0),w(this,"timeout",void 0),w(this,"abortConnectionOnPingFailure",void 0),w(this,Symbol.toStringTag,"@libp2p/connection-monitor"),w(this,Uh,["@libp2p/connection-monitor"]),this.components=e,this.protocol="/".concat(null!==(t=o.protocolPrefix)&&void 0!==t?t:"ipfs","/").concat("ping","/").concat("1.0.0"),this.log=e.logger.forComponent("libp2p:connection-monitor"),this.pingIntervalMs=null!==(n=o.pingInterval)&&void 0!==n?n:1e4,this.abortConnectionOnPingFailure=null===(r=o.abortConnectionOnPingFailure)||void 0===r||r,this.timeout=new vp(E(E({},null!==(i=o.pingTimeout)&&void 0!==i?i:{}),{},{metrics:e.metrics,metricName:"libp2p_connection_monitor_ping_time_milliseconds"}))}start(){this.abortController=new AbortController,this.abortController.signal,this.heartbeatInterval=setInterval((()=>{this.components.connectionManager.getConnections().forEach((e=>{Promise.resolve().then((async()=>{let t=Date.now();try{var n;const r=this.timeout.getTimeoutSignal({signal:null===(n=this.abortController)||void 0===n?void 0:n.signal}),i=Ep(await e.newStream(this.protocol,{signal:r,runOnLimitedConnection:!0}));t=Date.now(),await Promise.all([i.write(gp(32),{signal:r}),i.read({bytes:32,signal:r})]),e.rtt=Date.now()-t,await i.unwrap().close({signal:r})}catch(r){if("UnsupportedProtocolError"!==r.name)throw r;e.rtt=(Date.now()-t)/2}})).catch((t=>{this.log.error("error during heartbeat",t),this.abortConnectionOnPingFailure?(this.log.error("aborting connection due to ping failure"),e.abort(t)):this.log("connection ping failed, but not aborting due to abortConnectionOnPingFailure flag")}))}))}),this.pingIntervalMs)}stop(){var e;null===(e=this.abortController)||void 0===e||e.abort(),null!=this.heartbeatInterval&&clearInterval(this.heartbeatInterval)}}function kp(){return kp=ru((function*(e){const t=new AbortController,n=wp();(async function(e,t,n){try{await Promise.all(e.map((async e=>{var r,i=!1,o=!1;try{for(var s,a=Kc(e);i=!(s=await a.next()).done;i=!1){const e=s.value;await t.push(e,{signal:n}),n.throwIfAborted()}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&await a.return()}finally{if(o)throw r}}}))),await t.end(void 0,{signal:n})}catch(r){await t.end(r,{signal:n}).catch((()=>{}))}})(e,n,t.signal).catch((()=>{}));try{yield*dd(Kc(n))}finally{t.abort()}})),kp.apply(this,arguments)}const xp=function(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)null==i[Symbol.asyncIterator]&&e.push(i);return e.length===n.length?function*(e){for(const t of e)yield*t}(e):function(e){return kp.apply(this,arguments)}(n)};class Cp{constructor(e,t){var n,r,i,o,s,a,l,c,u,d,h;w(this,"routers",void 0),w(this,"started",void 0),w(this,"components",void 0),w(this,Symbol.toStringTag,"@libp2p/content-routing"),this.routers=null!==(n=t.routers)&&void 0!==n?n:[],this.started=!1,this.components=e,this.findProviders=null!==(r=null===(i=e.metrics)||void 0===i?void 0:i.traceFunction("libp2p.contentRouting.findProviders",this.findProviders.bind(this),{optionsIndex:1,getAttributesFromArgs:(e,t)=>{let[n]=e;return E(E({},t),{},{cid:n.toString()})},getAttributesFromYieldedValue:(e,t)=>E(E({},t),{},{providers:[...Array.isArray(t.providers)?t.providers:[],e.id.toString()]})}))&&void 0!==r?r:this.findProviders,this.provide=null!==(o=null===(s=e.metrics)||void 0===s?void 0:s.traceFunction("libp2p.contentRouting.provide",this.provide.bind(this),{optionsIndex:1,getAttributesFromArgs:(e,t)=>{let[n]=e;return E(E({},t),{},{cid:n.toString()})}}))&&void 0!==o?o:this.provide,this.cancelReprovide=null!==(a=null===(l=e.metrics)||void 0===l?void 0:l.traceFunction("libp2p.contentRouting.cancelReprovide",this.cancelReprovide.bind(this),{optionsIndex:1,getAttributesFromArgs:(e,t)=>{let[n]=e;return E(E({},t),{},{cid:n.toString()})}}))&&void 0!==a?a:this.cancelReprovide,this.put=null!==(c=null===(u=e.metrics)||void 0===u?void 0:u.traceFunction("libp2p.contentRouting.put",this.put.bind(this),{optionsIndex:2,getAttributesFromArgs:e=>{let[t]=e;return{key:Wt(t,"base36")}}}))&&void 0!==c?c:this.put,this.get=null!==(d=null===(h=e.metrics)||void 0===h?void 0:h.traceFunction("libp2p.contentRouting.get",this.get.bind(this),{optionsIndex:1,getAttributesFromArgs:e=>{let[t]=e;return{key:Wt(t,"base36")}}}))&&void 0!==d?d:this.get}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}findProviders(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){if(0===t.routers.length)throw new jh("No content routers available");const r=t,i=new Vc;var o,s=!1,a=!1;try{for(var l,c=Kc(xp(...r.routers.filter((e=>e.findProviders instanceof Function)).map((t=>t.findProviders(e,n)))));s=!(l=yield nu(c.next())).done;s=!1){const e=l.value;null!=e&&(e.multiaddrs.length>0&&(yield nu(t.components.peerStore.merge(e.id,{multiaddrs:e.multiaddrs}))),i.has(e.id)||(i.add(e.id),yield e))}}catch(u){a=!0,o=u}finally{try{s&&null!=c.return&&(yield nu(c.return()))}finally{if(a)throw o}}}()})).apply(this,arguments)}async provide(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.routers.length)throw new jh("No content routers available");await Promise.all(this.routers.filter((e=>e.provide instanceof Function)).map((async n=>{await n.provide(e,t)})))}async cancelReprovide(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(0===this.routers.length)throw new jh("No content routers available");await Promise.all(this.routers.filter((e=>e.cancelReprovide instanceof Function)).map((async n=>{await n.cancelReprovide(e,t)})))}async put(e,t,n){if(!this.isStarted())throw new j;await Promise.all(this.routers.filter((e=>e.put instanceof Function)).map((async r=>{await r.put(e,t,n)})))}async get(e,t){if(!this.isStarted())throw new j;return Promise.any(this.routers.filter((e=>e.get instanceof Function)).map((async n=>n.get(e,t))))}}var Pp;const Ap=null!==(Pp=globalThis.CustomEvent)&&void 0!==Pp?Pp:Event;function Ip(e){return _p.apply(this,arguments)}function _p(){return _p=ru((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(n,r){let i=null!==(n=t.concurrency)&&void 0!==n?n:1/0;i<1&&(i=1/0);const o=null!==(r=t.ordered)&&void 0!==r&&r,s=new EventTarget,a=[];let l,c=If(),u=If(),d=!1,h=!1;function f(){var e;return o?null===(e=a[0])||void 0===e?void 0:e.done:Boolean(a.find((e=>e.done)))}function*p(){for(;a.length>0&&a[0].done;){const e=a[0];if(a.shift(),!e.ok)throw h=!0,c.resolve(),e.err;yield e.value,c.resolve()}}function*g(){for(;f();)for(let e=0;e<a.length;e++)if(a[e].done){const t=a[e];if(a.splice(e,1),e--,!t.ok)throw h=!0,c.resolve(),t.err;yield t.value,c.resolve()}}for(s.addEventListener("task-complete",(()=>{u.resolve()})),Promise.resolve().then((async()=>{try{var t,n=!1,r=!1;try{for(var o,u=Kc(e);n=!(o=await u.next()).done;n=!1){const e=o.value;{if(a.length===i&&(c=If(),await c.promise),h)break;const t={done:!1};a.push(t),e().then((e=>{t.done=!0,t.ok=!0,t.value=e,s.dispatchEvent(new Ap("task-complete"))}),(e=>{t.done=!0,t.err=e,s.dispatchEvent(new Ap("task-complete"))}))}}}catch(f){r=!0,t=f}finally{try{n&&null!=u.return&&await u.return()}finally{if(r)throw t}}d=!0,s.dispatchEvent(new Ap("task-complete"))}catch(f){l=f,s.dispatchEvent(new Ap("task-complete"))}}));;){if(f()||(u=If(),yield nu(u.promise)),null!=l)throw l;if(o?yield*dd(Kc(p())):yield*dd(Kc(g())),null!=l)throw l;if(d&&0===a.length)break}}()})),_p.apply(this,arguments)}class Tp{constructor(e){var t,n,r,i,o;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"log",void 0),w(this,"peerId",void 0),w(this,"peerStore",void 0),w(this,"routers",void 0),w(this,Symbol.toStringTag,"@libp2p/peer-routing"),this.log=e.logger.forComponent("libp2p:peer-routing"),this.peerId=e.peerId,this.peerStore=e.peerStore,this.routers=null!==(t=s.routers)&&void 0!==t?t:[],this.findPeer=null!==(n=null===(r=e.metrics)||void 0===r?void 0:r.traceFunction("libp2p.peerRouting.findPeer",this.findPeer.bind(this),{optionsIndex:1,getAttributesFromArgs:(e,t)=>{let[n]=e;return E(E({},t),{},{peer:n.toString()})}}))&&void 0!==n?n:this.findPeer,this.getClosestPeers=null!==(i=null===(o=e.metrics)||void 0===o?void 0:o.traceFunction("libp2p.peerRouting.getClosestPeers",this.getClosestPeers.bind(this),{optionsIndex:1,getAttributesFromArgs:(e,t)=>{let[n]=e;return E(E({},t),{},{key:Wt(n,"base36")})},getAttributesFromYieldedValue:(e,t)=>E(E({},t),{},{peers:[...Array.isArray(t.peers)?t.peers:[],e.id.toString()]})}))&&void 0!==i?i:this.getClosestPeers}async findPeer(e,t){if(0===this.routers.length)throw new Wh("No peer routers available");if(e.toString()===this.peerId.toString())throw new Hh("Should not try to find self");const n=this,r=xp(...this.routers.filter((e=>e.findPeer instanceof Function)).map((r=>ru((function*(){try{yield yield nu(r.findPeer(e,t))}catch(i){n.log.error(i)}}))())));var i,o=!1,s=!1;try{for(var a,l=Kc(r);o=!(a=await l.next()).done;o=!1){const e=a.value;if(null!=e)return e.multiaddrs.length>0&&await this.peerStore.merge(e.id,{multiaddrs:e.multiaddrs}),e}}catch(c){s=!0,i=c}finally{try{o&&null!=l.return&&await l.return()}finally{if(s)throw i}}throw new D}getClosestPeers(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){if(0===t.routers.length)throw new Wh("No peer routers available");const r=t,i=_d(1024);var o,s=!1,a=!1;try{for(var l,c=Kc(Ip(ru((function*(){const t=xp(...r.routers.filter((e=>e.getClosestPeers instanceof Function)).map((t=>t.getClosestPeers(e,n))));var i,o=!1,s=!1;try{for(var a,l=Kc(t);o=!(a=yield nu(l.next())).done;o=!1){let e=a.value;yield async()=>{if(0===e.multiaddrs.length)try{e=await r.findPeer(e.id,E(E({},n),{},{useCache:!1}))}catch(t){return void r.log.error("could not find peer multiaddrs",t)}return e}}}catch(c){s=!0,i=c}finally{try{o&&null!=l.return&&(yield nu(l.return()))}finally{if(s)throw i}}}))()));s=!(l=yield nu(c.next())).done;s=!1){const e=l.value;null!=e&&(e.multiaddrs.length>0&&(yield nu(t.peerStore.merge(e.id,{multiaddrs:e.multiaddrs}))),i.has(e.id.toMultihash().bytes)||(i.add(e.id.toMultihash().bytes),yield e))}}catch(u){a=!0,o=u}finally{try{s&&null!=c.return&&(yield nu(c.return()))}finally{if(a)throw o}}}()})).apply(this,arguments)}}class Lp extends wc{constructor(e){super(),w(this,"peerRouting",void 0),w(this,"log",void 0),w(this,"walking",void 0),w(this,"walkers",void 0),w(this,"shutdownController",void 0),w(this,"walkController",void 0),w(this,"needNext",void 0),w(this,Symbol.toStringTag,"@libp2p/random-walk"),this.log=e.logger.forComponent("libp2p:random-walk"),this.peerRouting=e.peerRouting,this.walkers=0,this.walking=!1,this.shutdownController=new AbortController,this.shutdownController.signal}start(){this.shutdownController=new AbortController,this.shutdownController.signal}stop(){this.shutdownController.abort()}walk(e){var t=this;return ru((function*(){t.walking||t.startWalk(),t.walkers++;const n=Vf([t.shutdownController.signal,null===e||void 0===e?void 0:e.signal]);try{for(;;){var r;null===(r=t.needNext)||void 0===r||r.resolve(),t.needNext=If();const e=yield nu(Df(t,"walk:peer",n,{errorEvent:"walk:error"}));yield e.detail}}finally{var i;if(n.clear(),t.walkers--,0===t.walkers)null===(i=t.walkController)||void 0===i||i.abort(),t.walkController=void 0}}))()}startWalk(){this.walking=!0,this.walkController=new AbortController,this.walkController.signal;const e=Vf([this.walkController.signal,this.shutdownController.signal]),t=Date.now();let n=0;Promise.resolve().then((async()=>{for(this.log("start walk");this.walkers>0;)try{const l=gp(32);let c=Date.now();var t,r=!1,i=!1;try{for(var o,s=Kc(this.peerRouting.getClosestPeers(l,{signal:e}));r=!(o=await s.next()).done;r=!1){const t=o.value;e.aborted&&this.log("aborting walk"),e.throwIfAborted(),this.log("found peer %p after %dms for %d walkers",t.id,Date.now()-c,this.walkers),n++,this.safeDispatchEvent("walk:peer",{detail:t}),1===this.walkers&&null!=this.needNext&&(this.log("wait for need next"),await zf(this.needNext.promise,e)),c=Date.now()}}catch(a){i=!0,t=a}finally{try{r&&null!=s.return&&await s.return()}finally{if(i)throw t}}this.log("walk iteration for %b and %d walkers finished, found %d peers",l,this.walkers,n)}catch(a){this.log.error("random walk errored",a),this.safeDispatchEvent("walk:error",{detail:a})}this.log("no walkers left, ended walk")})).catch((e=>{this.log.error("random walk errored",e)})).finally((()=>{this.log("finished walk, found %d peers after %dms",n,Date.now()-t),this.walking=!1}))}}class Rp{constructor(e){w(this,"log",void 0),w(this,"topologies",void 0),w(this,"handlers",void 0),w(this,"components",void 0),w(this,Symbol.toStringTag,"@libp2p/registrar"),this.log=e.logger.forComponent("libp2p:registrar"),this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onPeerUpdate=this._onPeerUpdate.bind(this),this._onPeerIdentify=this._onPeerIdentify.bind(this),this.components.events.addEventListener("peer:disconnect",this._onDisconnect),this.components.events.addEventListener("peer:update",this._onPeerUpdate),this.components.events.addEventListener("peer:identify",this._onPeerIdentify)}getProtocols(){return Array.from(new Set([...this.handlers.keys()])).sort()}getHandler(e){const t=this.handlers.get(e);if(null==t)throw new Qh("No handler registered for protocol ".concat(e));return t}getTopologies(e){const t=this.topologies.get(e);return null==t?[]:[...t.values()]}async handle(e,t,n){if(this.handlers.has(e)&&!0!==(null===n||void 0===n?void 0:n.force))throw new Gh("Handler already registered for protocol ".concat(e));const r=wa.bind({ignoreUndefined:!0})({maxInboundStreams:32,maxOutboundStreams:64},n);this.handlers.set(e,{handler:t,options:r}),await this.components.peerStore.merge(this.components.peerId,{protocols:[e]})}async unhandle(e){(Array.isArray(e)?e:[e]).forEach((e=>{this.handlers.delete(e)})),await this.components.peerStore.patch(this.components.peerId,{protocols:this.getProtocols()})}async register(e,t){if(null==t)throw new C("invalid topology");const n="".concat((1e9*Math.random()).toString(36)).concat(Date.now());let r=this.topologies.get(e);return null==r&&(r=new Map,this.topologies.set(e,r)),r.set(n,t),n}unregister(e){for(const[t,n]of this.topologies.entries())n.has(e)&&(n.delete(e),0===n.size&&this.topologies.delete(t))}_onDisconnect(e){const t=e.detail;this.components.peerStore.get(t).then((e=>{for(const o of e.protocols){const e=this.topologies.get(o);if(null!=e)for(const o of e.values()){var n,r,i;!1!==(null===(n=o.filter)||void 0===n?void 0:n.has(t))&&(null===(r=o.filter)||void 0===r||r.remove(t),null===(i=o.onDisconnect)||void 0===i||i.call(o,t))}}})).catch((e=>{"NotFoundError"!==e.name&&this.log.error("could not inform topologies of disconnecting peer %p",t,e)}))}_onPeerUpdate(e){var t;const{peer:n,previous:r}=e.detail,i=(null!==(t=null===r||void 0===r?void 0:r.protocols)&&void 0!==t?t:[]).filter((e=>!n.protocols.includes(e)));for(const l of i){const e=this.topologies.get(l);if(null!=e)for(const t of e.values()){var o,s,a;!1!==(null===(o=t.filter)||void 0===o?void 0:o.has(n.id))&&(null===(s=t.filter)||void 0===s||s.remove(n.id),null===(a=t.onDisconnect)||void 0===a||a.call(t,n.id))}}}_onPeerIdentify(e){const t=e.detail.protocols,n=e.detail.connection,r=e.detail.peerId;for(const a of t){const e=this.topologies.get(a);if(null!=e)for(const t of e.values()){var i,o,s;null!=n.limits&&!0!==t.notifyOnLimitedConnection||!0!==(null===(i=t.filter)||void 0===i?void 0:i.has(r))&&(null===(o=t.filter)||void 0===o||o.add(r),null===(s=t.onConnect)||void 0===s||s.call(t,r,n))}}}}class Np extends Map{constructor(e){super(),w(this,"metric",void 0);const{name:t,metrics:n}=e;this.metric=n.registerMetric(t),this.updateComponentMetric()}set(e,t){return super.set(e,t),this.updateComponentMetric(),this}delete(e){const t=super.delete(e);return this.updateComponentMetric(),t}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}class Mp{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"log",void 0),w(this,"components",void 0),w(this,"transports",void 0),w(this,"listeners",void 0),w(this,"faultTolerance",void 0),w(this,"started",void 0),w(this,Symbol.toStringTag,"@libp2p/transport-manager"),this.log=e.logger.forComponent("libp2p:transports"),this.components=e,this.started=!1,this.transports=new Map,this.listeners=function(e){const{name:t,metrics:n}=e;let r;return r=null!=n?new Np({name:t,metrics:n}):new Map,r}({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=null!==(t=n.faultTolerance)&&void 0!==t?t:la.FATAL_ALL}add(e){const t=e[Symbol.toStringTag];if(null==t)throw new C("Transport must have a valid tag");if(this.transports.has(t))throw new C("There is already a transport with the tag ".concat(t));this.log("adding transport %s",t),this.transports.set(t,e),this.listeners.has(t)||this.listeners.set(t,[])}isStarted(){return this.started}start(){this.started=!0}async afterStart(){const e=this.components.addressManager.getListenAddrs();await this.listen(e)}async stop(){const e=[];for(const[t,n]of this.listeners)for(this.log("closing listeners for %s",t);n.length>0;){const t=n.pop();null!=t&&e.push(t.close())}await Promise.all(e),this.log("all listeners closed");for(const t of this.listeners.keys())this.listeners.set(t,[]);this.started=!1}async dial(e,t){var n;const r=this.dialTransportForMultiaddr(e);if(null==r)throw new rf("No transport available for address ".concat(String(e)));return null===t||void 0===t||null===(n=t.onProgress)||void 0===n||n.call(t,new ba("transport-manager:selected-transport",r[Symbol.toStringTag])),r.dial(e,E(E({},t),{},{upgrader:this.components.upgrader}))}getAddrs(){let e=[];for(const t of this.listeners.values())for(const n of t)e=[...e,...n.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}getListeners(){return Array.of(...this.listeners.values()).flat()}dialTransportForMultiaddr(e){for(const t of this.transports.values()){if(t.dialFilter([e]).length>0)return t}}listenTransportForMultiaddr(e){for(const t of this.transports.values()){if(t.listenFilter([e]).length>0)return t}}async listen(e){if(!this.isStarted())throw new j("Not started");if(null==e||0===e.length)return void this.log("no addresses were provided for listening, this node is dial only");const t={errors:new Map,ipv4:{success:0,attempts:0},ipv6:{success:0,attempts:0}};e.forEach((e=>{t.errors.set(e.toString(),new $h)}));const n=[];for(const[o,s]of this.transports.entries()){const i=s.listenFilter(e);for(const e of i){var r;this.log("creating listener for %s on %a",o,e);const i=s.createListener({upgrader:this.components.upgrader});let a=null!==(r=this.listeners.get(o))&&void 0!==r?r:[];null==a&&(a=[],this.listeners.set(o,a)),a.push(i),i.addEventListener("listening",(()=>{this.components.events.safeDispatchEvent("transport:listening",{detail:i})})),i.addEventListener("close",(()=>{const e=a.findIndex((e=>e===i));a.splice(e,1),this.components.events.safeDispatchEvent("transport:close",{detail:i})})),eh.matches(e)?t.ipv4.attempts++:th.matches(e)&&t.ipv6.attempts++,n.push(i.listen(e).then((()=>{t.errors.delete(e.toString()),eh.matches(e)&&t.ipv4.success++,th.matches(e)&&t.ipv6.success++}),(n=>{throw this.log.error("transport %s could not listen on address %a - %e",o,e,n),t.errors.set(e.toString(),n),n})))}}const i=await Promise.allSettled(n);if(!(i.length>0&&i.every((e=>"fulfilled"===e.status))))if(this.ipv6Unsupported(t))this.log("all IPv4 addresses succeed but all IPv6 failed");else{if(this.faultTolerance!==la.NO_FATAL)throw new Xh("Some configured addresses failed to be listened on, you may need to remove one or more listen addresses from your configuration or set `transportManager.faultTolerance` to NO_FATAL:\n".concat([...t.errors.entries()].map((e=>{var t;let[n,r]=e;return"\n  ".concat(n,": ").concat("".concat(null!==(t=r.stack)&&void 0!==t?t:r).split("\n").join("\n  "),"\n")})).join("")));this.log("failed to listen on any address but fault tolerance allows this")}}ipv6Unsupported(e){if(0===e.ipv4.attempts||0===e.ipv6.attempts)return!1;const t=e.ipv4.attempts===e.ipv4.success,n=0===e.ipv6.success;return t&&n}async remove(e){var t;const n=null!==(t=this.listeners.get(e))&&void 0!==t?t:[];this.log.trace("removing transport %s",e);const r=[];for(this.log.trace("closing listeners for %s",e);n.length>0;){const e=n.pop();null!=e&&r.push(e.close())}await Promise.all(r),this.transports.delete(e),this.listeners.delete(e)}async removeAll(){const e=[];for(const t of this.transports.keys())e.push(this.remove(t));await Promise.all(e)}}const Dp=4194304;class Op extends Error{constructor(){super(...arguments),w(this,"name","InvalidMessageLengthError"),w(this,"code","ERR_INVALID_MSG_LENGTH")}}class zp extends Error{constructor(){super(...arguments),w(this,"name","InvalidDataLengthError"),w(this,"code","ERR_MSG_DATA_TOO_LONG")}}class Fp extends Error{constructor(){super(...arguments),w(this,"name","InvalidDataLengthLengthError"),w(this,"code","ERR_MSG_LENGTH_TOO_LONG")}}class Up extends Error{constructor(){super(...arguments),w(this,"name","UnexpectedEOFError"),w(this,"code","ERR_UNEXPECTED_EOF")}}function Bp(e){return null!=e[Symbol.asyncIterator]}function qp(e,t){if(e.byteLength>t)throw new zp("Message length too long")}const Vp=e=>{const t=ho(e),n=ee(t);return go(e,n),Vp.bytes=t,n};function Kp(e,t){var n,r,i;const o=null!==(n=(t=null!==t&&void 0!==t?t:{}).lengthEncoder)&&void 0!==n?n:Vp,s=null!==(r=null===(i=t)||void 0===i?void 0:i.maxDataLength)&&void 0!==r?r:Dp;function*a(e){qp(e,s);const t=o(e.byteLength);t instanceof Uint8Array?yield t:yield*t,e instanceof Uint8Array?yield e:yield*e}return Bp(e)?ru((function*(){var t,n=!1,r=!1;try{for(var i,o=Kc(e);n=!(i=yield nu(o.next())).done;n=!1){const e=i.value;yield*dd(Kc(a(e)))}}catch(s){r=!0,t=s}finally{try{n&&null!=o.return&&(yield nu(o.return()))}finally{if(r)throw t}}}))():function*(){for(const t of e)yield*a(t)}()}var jp;Vp.bytes=0,Kp.single=(e,t)=>{var n,r,i;const o=null!==(n=(t=null!==t&&void 0!==t?t:{}).lengthEncoder)&&void 0!==n?n:Vp;return qp(e,null!==(r=null===(i=t)||void 0===i?void 0:i.maxDataLength)&&void 0!==r?r:Dp),new se(o(e.byteLength),e)},function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"}(jp||(jp={}));const Wp=e=>{const t=mo(e);return Wp.bytes=ho(t),t};function Hp(e,t){var n,r,i;const o=new se;let s=jp.LENGTH,a=-1;const l=null!==(n=null===t||void 0===t?void 0:t.lengthDecoder)&&void 0!==n?n:Wp,c=null!==(r=null===t||void 0===t?void 0:t.maxLengthLength)&&void 0!==r?r:8,u=null!==(i=null===t||void 0===t?void 0:t.maxDataLength)&&void 0!==i?i:Dp;function*d(){for(;o.byteLength>0;){if(s===jp.LENGTH)try{if(a=l(o),a<0)throw new Op("Invalid message length");if(a>u)throw new zp("Message length too long");const e=l.bytes;o.consume(e),null!=(null===t||void 0===t?void 0:t.onLength)&&t.onLength(a),s=jp.DATA}catch(e){if(e instanceof RangeError){if(o.byteLength>c)throw new Fp("Message length length too long");break}throw e}if(s===jp.DATA){if(o.byteLength<a)break;const e=o.sublist(0,a);o.consume(a),null!=(null===t||void 0===t?void 0:t.onData)&&t.onData(e),yield e,s=jp.LENGTH}}}return Bp(e)?ru((function*(){var t,n=!1,r=!1;try{for(var i,s=Kc(e);n=!(i=yield nu(s.next())).done;n=!1){const e=i.value;o.append(e),yield*dd(Kc(d()))}}catch(a){r=!0,t=a}finally{try{n&&null!=s.return&&(yield nu(s.return()))}finally{if(r)throw t}}if(o.byteLength>0)throw new Up("Unexpected end of input")}))():function*(){for(const t of e)o.append(t),yield*d();if(o.byteLength>0)throw new Up("Unexpected end of input")}()}Wp.bytes=0,Hp.fromReader=(e,t)=>{let n=1;return Hp(ru((function*(){for(;;)try{const{done:t,value:r}=yield nu(e.next(n));if(!0===t)return;null!=r&&(yield r)}catch(t){if("ERR_UNDER_READ"===t.code)return{done:!0,value:null};throw t}finally{n=1}}))(),E(E({},null!==t&&void 0!==t?t:{}),{},{onLength:e=>{n=e}}))};class Qp extends Error{constructor(){super(...arguments),w(this,"name","InvalidMessageLengthError"),w(this,"code","ERR_INVALID_MSG_LENGTH")}}class Gp extends Error{constructor(){super(...arguments),w(this,"name","InvalidDataLengthError"),w(this,"code","ERR_MSG_DATA_TOO_LONG")}}class Yp extends Error{constructor(){super(...arguments),w(this,"name","InvalidDataLengthLengthError"),w(this,"code","ERR_MSG_LENGTH_TOO_LONG")}}function $p(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=Ep(e,r);null!=r.maxDataLength&&null==r.maxLengthLength&&(r.maxLengthLength=ho(r.maxDataLength));const o=null!==(t=null===r||void 0===r?void 0:r.lengthDecoder)&&void 0!==t?t:mo,s=null!==(n=null===r||void 0===r?void 0:r.lengthEncoder)&&void 0!==n?n:go;return{read:async e=>{let t=-1;const n=new se;for(;;){n.append(await i.read(E(E({},e),{},{bytes:1})));try{t=o(n)}catch(s){if(s instanceof RangeError)continue;throw s}if(t<0)throw new Qp("Invalid message length");if(null!=(null===r||void 0===r?void 0:r.maxLengthLength)&&n.byteLength>r.maxLengthLength)throw new Yp("message length length too long");if(t>-1)break}if(null!=(null===r||void 0===r?void 0:r.maxDataLength)&&t>r.maxDataLength)throw new Gp("message length too long");return i.read(E(E({},e),{},{bytes:t}))},write:async(e,t)=>{await i.write(new se(s(e.byteLength),e),t)},writeV:async(e,t)=>{const n=new se(...e.flatMap((e=>[s(e.byteLength),e])));await i.write(n,t)},unwrap:()=>i.unwrap()}}const Xp="/multistream/1.0.0",Zp=1024,Jp=jt("\n");async function eg(e,t,n){await e.write(t,n)}async function tg(e,t){const n=await async function(e,t){const n=await e.read(t);if(0===n.byteLength||n.get(n.byteLength-1)!==Jp[0])throw t.log.error("Invalid mss message - missing newline",n),new q("Missing newline");return n.sublist(0,-1)}(e,t);return Wt(n.subarray())}async function ng(e,t,n){t=Array.isArray(t)?t:[t],n.log.trace("handle: available protocols %s",t);const r=$p(e,E(E({},n),{},{maxDataLength:Zp,maxLengthLength:2}));for(;;){n.log.trace("handle: reading incoming string");const e=await tg(r,n);if(n.log.trace('handle: read "%s"',e),e!==Xp){if(t.includes(e))return n.log.trace('handle: respond with "%s" for "%s"',e,e),await eg(r,jt("".concat(e,"\n")),n),n.log.trace('handle: responded with "%s" for "%s"',e,e),{stream:r.unwrap(),protocol:e};if("ls"!==e)n.log.trace('handle: respond with "na" for "%s"',e),await eg(r,jt("na\n"),n),n.log('handle: responded with "na" for "%s"',e);else{const i=new se(...t.map((e=>Kp.single(jt("".concat(e,"\n"))))),jt("\n"));n.log.trace('handle: respond with "%s" for %s',t,e),await eg(r,i,n),n.log.trace('handle: responded with "%s" for %s',t,e)}}else n.log.trace('handle: respond with "%s" for "%s"',Xp,e),await eg(r,jt("".concat(Xp,"\n")),n),n.log.trace('handle: responded with "%s" for "%s"',Xp,e)}}async function rg(e,t,n){if(1===(t=Array.isArray(t)?[...t]:[t]).length&&!1===n.negotiateFully)return function(e,t,n){const r=e.sink.bind(e),i=e.source;let o=!1,s=!1;const a=If();let l=!1,c=!1;const u=If();let d=!1,h=!1;const f=If(),p=$p({sink:r,source:i},E(E({},n),{},{maxDataLength:Zp}));async function g(){if(s)return n.log.trace("optimistic: already negotiating %s stream",t),void await a.promise;s=!0;try{l||(n.log.trace("optimistic: doing send protocol for %s stream",t),await m()),d||(n.log.trace("optimistic: doing read protocol for %s stream",t),await v())}finally{s=!1,o=!0,a.resolve()}}async function m(){if(c)await u.promise;else{c=!0;try{n.log.trace('optimistic: write ["%s", "%s", data] in source',Xp,t),await p.writeV([jt("".concat(Xp,"\n")),jt("".concat(t,"\n"))]),n.log.trace('optimistic: wrote ["%s", "%s", data] in source',Xp,t)}finally{l=!0,c=!1,u.resolve()}}}async function v(){if(h)await f.promise;else{h=!0;try{n.log.trace("optimistic: reading multistream select header");let e=await tg(p,n);if(n.log.trace('optimistic: read multistream select header "%s"',e),e===Xp&&(e=await tg(p,n)),n.log.trace('optimistic: read protocol "%s", expecting "%s"',e,t),e!==t)throw new B("protocol selection failed")}finally{d=!0,h=!1,f.resolve()}}}if(e.sink=async e=>{const{sink:r}=p.unwrap();await r(ru((function*(){let r=!1;var i,o=!1,s=!1;try{for(var a,d=Kc(e);o=!(a=yield nu(d.next())).done;o=!1){const e=a.value;if(c&&(yield nu(u.promise)),l)yield e;else{c=!0,n.log.trace('optimistic: write ["%s", "%s", data(%d)] in sink',Xp,t,e.byteLength);const r="".concat(t,"\n");yield new se(Uint8Array.from([19]),jt("".concat(Xp,"\n")),go(r.length),jt(r),e).subarray(),n.log.trace('optimistic: wrote ["%s", "%s", data(%d)] in sink',Xp,t,e.byteLength),l=!0,c=!1,u.resolve(),g().catch((e=>{n.log.error("could not finish optimistic protocol negotiation of %s",t,e)}))}r=!0}}catch(h){s=!0,i=h}finally{try{o&&null!=d.return&&(yield nu(d.return()))}finally{if(s)throw i}}r||(yield nu(g()))}))())},e.source=ru((function*(){yield nu(g()),n.log.trace('optimistic: reading data from "%s" stream',t),yield*dd(Kc(p.unwrap().source))}))(),null!=e.closeRead){const t=e.closeRead.bind(e);e.closeRead=async e=>{o||await g().catch((e=>{n.log.error("could not negotiate protocol before close read",e)})),await t(e)}}if(null!=e.closeWrite){const t=e.closeWrite.bind(e);e.closeWrite=async e=>{o||await g().catch((e=>{n.log.error("could not negotiate protocol before close write",e)})),await t(e)}}if(null!=e.close){const t=e.close.bind(e);e.close=async e=>{const n=[];c&&n.push(u.promise),h&&n.push(f.promise),n.length>0?await zf(Promise.all(n),null===e||void 0===e?void 0:e.signal):(o=!0,s=!1,a.resolve()),await t(e)}}return{stream:e,protocol:t}}(e,t[0],n);const r=$p(e,E(E({},n),{},{maxDataLength:Zp})),i=t.shift();if(null==i)throw new Error("At least one protocol must be specified");n.log.trace('select: write ["%s", "%s"]',Xp,i);const o=jt("".concat(Xp,"\n")),s=jt("".concat(i,"\n"));await async function(e,t,n){await e.writeV(t,n)}(r,[o,s],n),n.log.trace("select: reading multistream-select header");let a=await tg(r,n);if(n.log.trace('select: read "%s"',a),a===Xp&&(n.log.trace("select: reading protocol response"),a=await tg(r,n),n.log.trace('select: read "%s"',a)),a===i)return{stream:r.unwrap(),protocol:i};for(const l of t){n.log.trace('select: write "%s"',l),await eg(r,jt("".concat(l,"\n")),n),n.log.trace("select: reading protocol response");const e=await tg(r,n);if(n.log.trace('select: read "%s" for "%s"',e,l),e===l)return{stream:r.unwrap(),protocol:l}}throw new B("protocol selection failed")}const ig=Symbol.for("@libp2p/connection");class og{constructor(e){w(this,"id",void 0),w(this,"remoteAddr",void 0),w(this,"remotePeer",void 0),w(this,"direction",void 0),w(this,"timeline",void 0),w(this,"multiplexer",void 0),w(this,"encryption",void 0),w(this,"status",void 0),w(this,"limits",void 0),w(this,"log",void 0),w(this,"tags",void 0),w(this,"_newStream",void 0),w(this,"_close",void 0),w(this,"_abort",void 0),w(this,"_getStreams",void 0),w(this,Symbol.toStringTag,"Connection"),w(this,ig,!0);const{remoteAddr:t,remotePeer:n,newStream:r,close:i,abort:o,getStreams:s}=e;this.id="".concat(parseInt(String(1e9*Math.random())).toString(36)).concat(Date.now()),this.remoteAddr=t,this.remotePeer=n,this.direction=e.direction,this.status="open",this.timeline=e.timeline,this.multiplexer=e.multiplexer,this.encryption=e.encryption,this.limits=e.limits,this.log=e.logger.forComponent("libp2p:connection:".concat(this.direction,":").concat(this.id)),null==this.remoteAddr.getPeerId()&&(this.remoteAddr=this.remoteAddr.encapsulate("/p2p/".concat(this.remotePeer))),this._newStream=r,this._close=i,this._abort=o,this._getStreams=s,this.tags=[]}get streams(){return this._getStreams()}async newStream(e,t){if("closing"===this.status)throw new _("the connection is being closed");if("closed"===this.status)throw new T("the connection is closed");if(Array.isArray(e)||(e=[e]),null!=this.limits&&!0!==(null===t||void 0===t?void 0:t.runOnLimitedConnection))throw new G("Cannot open protocol stream on limited connection");const n=await this._newStream(e,t);return n.direction="outbound",n}async close(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("closed"!==this.status&&"closing"!==this.status){if(this.log("closing connection to %a",this.remoteAddr),this.status="closing",null==e.signal){const t=AbortSignal.timeout(500);e=E(E({},e),{},{signal:t})}try{this.log.trace("closing underlying transport"),await this._close(e),this.log.trace("updating timeline with close time"),this.status="closed",this.timeline.close=Date.now()}catch(t){this.log.error("error encountered during graceful close of connection to %a",this.remoteAddr,t),this.abort(t)}}}abort(e){"closed"!==this.status&&(this.log.error("aborting connection to %a due to error",this.remoteAddr,e),this.status="closing",this._abort(e),this.status="closed",this.timeline.close=Date.now())}}function sg(e,t,n){let r=0;return n.streams.forEach((n=>{n.direction===t&&n.protocol===e&&r++})),r}class ag{constructor(e,t){var n,r,i,o,s;w(this,"components",void 0),w(this,"connectionEncrypters",void 0),w(this,"streamMuxers",void 0),w(this,"inboundUpgradeTimeout",void 0),w(this,"inboundStreamProtocolNegotiationTimeout",void 0),w(this,"outboundStreamProtocolNegotiationTimeout",void 0),w(this,"events",void 0),w(this,"metrics",void 0),w(this,Symbol.toStringTag,"@libp2p/upgrader"),this.components=e,this.connectionEncrypters=new Map,t.connectionEncrypters.forEach((e=>{this.connectionEncrypters.set(e.protocol,e)})),this.streamMuxers=new Map,t.streamMuxers.forEach((e=>{this.streamMuxers.set(e.protocol,e)})),this.inboundUpgradeTimeout=null!==(n=t.inboundUpgradeTimeout)&&void 0!==n?n:1e4,this.inboundStreamProtocolNegotiationTimeout=null!==(r=t.inboundStreamProtocolNegotiationTimeout)&&void 0!==r?r:1e4,this.outboundStreamProtocolNegotiationTimeout=null!==(i=t.outboundStreamProtocolNegotiationTimeout)&&void 0!==i?i:1e4,this.events=e.events,this.metrics={dials:null===(o=e.metrics)||void 0===o?void 0:o.registerCounterGroup("libp2p_connection_manager_dials_total"),errors:null===(s=e.metrics)||void 0===s?void 0:s.registerCounterGroup("libp2p_connection_manager_dial_errors_total")}}async shouldBlockConnection(e){const t=this.components.connectionGater[e];if(null==t)return;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(!0===await t.apply(this.components.connectionGater,r))throw new Jh("The multiaddr connection is blocked by gater.".concat(e))}createInboundAbortSignal(e){const t=Vf([AbortSignal.timeout(this.inboundUpgradeTimeout),e]);return t}async upgradeInbound(e,t){let n=!1;const r=this.createInboundAbortSignal(t.signal);try{var i;if(null===(i=this.metrics.dials)||void 0===i||i.increment({inbound:!0}),n=await this.components.connectionManager.acceptIncomingConnection(e),!n)throw new ef("Connection denied");await this.shouldBlockConnection("denyInboundConnection",e),await this._performUpgrade(e,"inbound",E(E({},t),{},{signal:r}))}catch(s){var o;throw null===(o=this.metrics.errors)||void 0===o||o.increment({inbound:!0}),s}finally{r.clear(),n&&this.components.connectionManager.afterUpgradeInbound()}}async upgradeOutbound(e,t){try{var n;null===(n=this.metrics.dials)||void 0===n||n.increment({outbound:!0});const r=e.remoteAddr.getPeerId();let i;null!=r&&(i=ra(r),await this.shouldBlockConnection("denyOutboundConnection",i,e));let o="outbound";return!1===t.initiator&&(o="inbound"),await this._performUpgrade(e,o,t)}catch(i){var r;throw null===(r=this.metrics.errors)||void 0===r||r.increment({outbound:!0}),i}}async _performUpgrade(e,t,n){var r;let i,o,s,a,l;null===(r=this.components.metrics)||void 0===r||r.trackMultiaddrConnection(e),e.log.trace("starting the %s connection upgrade",t);let c=e;if(!0!==(null===n||void 0===n?void 0:n.skipProtection)){const r=this.components.connectionProtector;null!=r&&(e.log("protecting the %s connection",t),c=await r.protect(e,n))}try{if(i=c,!0!==(null===n||void 0===n?void 0:n.skipEncryption)){var u;null===n||void 0===n||null===(u=n.onProgress)||void 0===u||u.call(n,new ba("upgrader:encrypt-".concat(t,"-connection"))),({conn:i,remotePeer:o,protocol:l,streamMuxer:a}=await("inbound"===t?this._encryptInbound(c,n):this._encryptOutbound(c,n)));const e=E(E({},c),i);await this.shouldBlockConnection("inbound"===t?"denyInboundEncryptedConnection":"denyOutboundEncryptedConnection",o,e)}else{const n=e.remoteAddr.getPeerId();if(null==n)throw new z("".concat(t," connection that skipped encryption must have a peer id"));const r=ra(n);l="native",o=r}if(o.equals(this.components.peerId)){const t=new O("Can not dial self");throw e.abort(t),t}if(s=i,null!=(null===n||void 0===n?void 0:n.muxerFactory))a=n.muxerFactory;else if(null==a&&this.streamMuxers.size>0){var d;null===n||void 0===n||null===(d=n.onProgress)||void 0===d||d.call(n,new ba("upgrader:multiplex-".concat(t,"-connection")));const e=await("inbound"===t?this._multiplexInbound(E(E({},c),i),this.streamMuxers,n):this._multiplexOutbound(E(E({},c),i),this.streamMuxers,n));a=e.muxerFactory,s=e.stream}}catch(h){throw e.log.error("failed to upgrade inbound connection %s %a - %e","inbound"===t?"from":"to",e.remoteAddr,h),h}return await this.shouldBlockConnection("inbound"===t?"denyInboundUpgradedConnection":"denyOutboundUpgradedConnection",o,e),e.log("successfully upgraded %s connection",t),this._createConnection({cryptoProtocol:l,direction:t,maConn:e,upgradedConn:s,muxerFactory:a,remotePeer:o,limits:null===n||void 0===n?void 0:n.limits})}_createConnection(e){var t,n=this;const{cryptoProtocol:r,direction:i,maConn:o,upgradedConn:s,remotePeer:a,muxerFactory:l,limits:c}=e;let u,d,h;null!=l&&(u=l.createStreamMuxer({direction:i,onIncomingStream:e=>{null!=h&&Promise.resolve().then((async()=>{var t;const n=this.components.registrar.getProtocols(),r=AbortSignal.timeout(this.inboundStreamProtocolNegotiationTimeout),{stream:i,protocol:o}=await ng(e,n,{signal:r,log:e.log,yieldBytes:!1});if(null==h)return;h.log("incoming stream opened on %s",o);const s=function(e,t){try{const{options:n}=t.getHandler(e);return n.maxInboundStreams}catch(n){if("UnhandledProtocolError"!==n.name)throw n}return 32}(o,this.components.registrar);if(sg(o,"inbound",h)===s){const t=new Y('Too many inbound protocol streams for protocol "'.concat(o,'" - limit ').concat(s));throw e.abort(t),t}e.source=i.source,e.sink=i.sink,e.protocol=o,null!=i.closeWrite&&(e.closeWrite=i.closeWrite),null!=i.closeRead&&(e.closeRead=i.closeRead),null!=i.close&&(e.close=i.close),await this.components.peerStore.merge(a,{protocols:[o]}),null===(t=this.components.metrics)||void 0===t||t.trackProtocolStream(e,h),this._onStream({connection:h,stream:e,protocol:o})})).catch((async t=>{h.log.error("error handling incoming stream id %s - %e",e.id,t),null==e.timeline.close&&await e.close()}))}}),d=async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==u)throw new tf("Connection is not multiplexed");h.log.trace("starting new stream for protocols %s",t);const o=await u.newStream();h.log.trace("started new stream %s for protocols %s",o.id,t);try{var s;if(null==r.signal){o.log("no abort signal was passed while trying to negotiate protocols %s falling back to default timeout",t);const e=AbortSignal.timeout(n.outboundStreamProtocolNegotiationTimeout);r=E(E({},r),{},{signal:e})}o.log.trace("selecting protocol from protocols %s",t);const{stream:e,protocol:i}=await rg(o,t,E(E({},r),{},{log:o.log,yieldBytes:!0}));o.log.trace("selected protocol %s",i);const l=function(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const{options:n}=t.getHandler(e);if(null!=n.maxOutboundStreams)return n.maxOutboundStreams}catch(i){if("UnhandledProtocolError"!==i.name)throw i}return null!==(n=r.maxOutboundStreams)&&void 0!==n?n:64}(i,n.components.registrar,r),c=sg(i,"outbound",h);if(c>=l){const e=new $('Too many outbound protocol streams for protocol "'.concat(i,'" - ').concat(c,"/").concat(l));throw o.abort(e),e}return await n.components.peerStore.merge(a,{protocols:[i]}),o.source=e.source,o.sink=e.sink,o.protocol=i,null!=e.closeWrite&&(o.closeWrite=e.closeWrite),null!=e.closeRead&&(o.closeRead=e.closeRead),null!=e.close&&(o.close=e.close),null===(s=n.components.metrics)||void 0===s||s.trackProtocolStream(o,h),o}catch(l){throw h.log.error("could not create new outbound stream on connection %s %a for protocols %s - %e","inbound"===i?"from":"to",e.maConn.remoteAddr,t,l),null==o.timeline.close&&o.abort(l),l}},Promise.all([u.sink(s.source),s.sink(u.source)]).catch((e=>{h.log.error("error piping data through muxer - %e",e)})));const f=o.timeline;o.timeline=new Proxy(f,{set:function(){return"close"===(arguments.length<=1?void 0:arguments[1])&&null!=(arguments.length<=2?void 0:arguments[2])&&null==f.close&&(async()=>{try{"open"===h.status&&await h.close()}catch(e){h.log.error("error closing connection after timeline close %e",e)}finally{n.events.safeDispatchEvent("connection:close",{detail:h})}})().catch((e=>{h.log.error("error thrown while dispatching connection:close event %e",e)})),Reflect.set(...arguments)}}),o.timeline.upgraded=Date.now();var p;return p={remoteAddr:o.remoteAddr,remotePeer:a,status:"open",direction:i,timeline:o.timeline,multiplexer:null===(t=u)||void 0===t?void 0:t.protocol,encryption:r,limits:c,logger:this.components.logger,newStream:null!==d&&void 0!==d?d:()=>{throw new tf("Connection is not multiplexed")},getStreams:()=>{var e,t;return null!==(e=null===(t=u)||void 0===t?void 0:t.streams)&&void 0!==e?e:[]},close:async e=>{var t;await(null===(t=u)||void 0===t?void 0:t.close(e)),await o.close(e)},abort:e=>{var t;o.abort(e),null===(t=u)||void 0===t||t.abort(e)}},h=new og(p),this.events.safeDispatchEvent("connection:open",{detail:h}),h.__maConnTimeline=f,h}_onStream(e){const{connection:t,stream:n,protocol:r}=e,{handler:i,options:o}=this.components.registrar.getHandler(r);if(null!=t.limits&&!0!==o.runOnLimitedConnection)throw new G("Cannot open protocol stream on limited connection");i({connection:t,stream:n})}async _encryptInbound(e,t){const n=Array.from(this.connectionEncrypters.keys());try{const{stream:r,protocol:i}=await ng(e,n,E(E({},t),{},{log:e.log})),o=this.connectionEncrypters.get(i);if(null==o)throw new nf("no crypto module found for ".concat(i));return e.log("encrypting inbound connection to %a using %s",e.remoteAddr,i),E(E({},await o.secureInbound(r,t)),{},{protocol:i})}catch(r){throw e.log.error("encrypting inbound connection from %a failed",e.remoteAddr,r),new nf(r.message)}}async _encryptOutbound(e,t){const n=Array.from(this.connectionEncrypters.keys());try{e.log.trace("selecting encrypter from %s",n);const{stream:r,protocol:i}=await rg(e,n,E(E({},t),{},{log:e.log,yieldBytes:!0})),o=this.connectionEncrypters.get(i);if(null==o)throw new nf("no crypto module found for ".concat(i));return e.log("encrypting outbound connection to %a using %s",e.remoteAddr,i),E(E({},await o.secureOutbound(r,t)),{},{protocol:i})}catch(r){throw e.log.error("encrypting outbound connection to %a failed",e.remoteAddr,r),new nf(r.message)}}async _multiplexOutbound(e,t,n){const r=Array.from(t.keys());e.log("outbound selecting muxer %s",r);try{e.log.trace("selecting stream muxer from %s",r);const{stream:i,protocol:o}=await rg(e,r,E(E({},n),{},{log:e.log,yieldBytes:!0}));e.log("selected %s as muxer protocol",o);return{stream:i,muxerFactory:t.get(o)}}catch(i){throw e.log.error("error multiplexing outbound connection",i),new tf(String(i))}}async _multiplexInbound(e,t,n){const r=Array.from(t.keys());e.log("inbound handling muxers %s",r);try{const{stream:i,protocol:o}=await ng(e,r,E(E({},n),{},{log:e.log}));return{stream:i,muxerFactory:t.get(o)}}catch(i){throw e.log.error("error multiplexing inbound connection",i),new tf(String(i))}}getConnectionEncrypters(){return this.connectionEncrypters}getStreamMuxers(){return this.streamMuxers}}const lg="2.8.8",cg="js-libp2p";var ug=new WeakSet;class dg extends wc{constructor(e){var t,n,r,i,o,s,a,l,c,u,d,h,f,p,g,m,v,y,b,S,k,x;super(),Sa(this,ug),w(this,"peerId",void 0),w(this,"peerStore",void 0),w(this,"contentRouting",void 0),w(this,"peerRouting",void 0),w(this,"metrics",void 0),w(this,"services",void 0),w(this,"logger",void 0),w(this,"status",void 0),w(this,"components",void 0),w(this,"log",void 0),this.status="stopped";const C=new wc,P=C.dispatchEvent.bind(C);C.dispatchEvent=e=>{const t=P(e),n=this.dispatchEvent(new CustomEvent(e.type,{detail:e.detail}));return t||n},this.peerId=e.peerId,this.logger=null!==(t=e.logger)&&void 0!==t?t:zc(),this.log=this.logger.forComponent("libp2p"),this.services={};const A=null!==(n=null===(r=e.nodeInfo)||void 0===r?void 0:r.name)&&void 0!==n?n:cg,I=null!==(i=null===(o=e.nodeInfo)||void 0===o?void 0:o.version)&&void 0!==i?i:lg,_=this.components=function(){const e=new of(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return new Proxy(e,{get(t,n,r){if("string"===typeof n&&!af.includes(n)){const t=e.components[n];if(null==t&&!sf.includes(n))throw new Vh("".concat(n," not set"));return t}return Reflect.get(t,n,r)},set:(t,n,r)=>("string"===typeof n?e.components[n]=r:Reflect.set(t,n,r),!0)})}({peerId:e.peerId,privateKey:e.privateKey,nodeInfo:{name:A,version:I,userAgent:null!==(s=null===(a=e.nodeInfo)||void 0===a?void 0:a.userAgent)&&void 0!==s?s:(T=A,L=I,"".concat(null!==T&&void 0!==T?T:cg,"/").concat(null!==L&&void 0!==L?L:lg," browser/").concat(globalThis.navigator.userAgent))},logger:this.logger,events:C,datastore:null!==(l=e.datastore)&&void 0!==l?l:new gd,connectionGater:df(e.connectionGater),dns:e.dns});var T,L;this.peerStore=this.configureComponent("peerStore",function(e){return new Zu(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(_,E({addressFilter:this.components.connectionGater.filterMultiaddrForPeer},e.peerStore))),null!=e.metrics&&(this.metrics=this.configureComponent("metrics",e.metrics(this.components))),_.events.addEventListener("peer:update",(e=>{if(null==e.detail.previous){const t={id:e.detail.peer.id,multiaddrs:e.detail.peer.addresses.map((e=>e.multiaddr))};_.events.safeDispatchEvent("peer:discovery",{detail:t})}})),null!=e.connectionProtector&&this.configureComponent("connectionProtector",e.connectionProtector(_)),this.components.upgrader=new ag(this.components,{connectionEncrypters:(null!==(c=e.connectionEncrypters)&&void 0!==c?c:[]).map(((e,t)=>this.configureComponent("connection-encryption-".concat(t),e(this.components)))),streamMuxers:(null!==(u=e.streamMuxers)&&void 0!==u?u:[]).map(((e,t)=>this.configureComponent("stream-muxers-".concat(t),e(this.components)))),inboundUpgradeTimeout:null===(d=e.connectionManager)||void 0===d?void 0:d.inboundUpgradeTimeout,inboundStreamProtocolNegotiationTimeout:null!==(h=null===(f=e.connectionManager)||void 0===f?void 0:f.inboundStreamProtocolNegotiationTimeout)&&void 0!==h?h:null===(p=e.connectionManager)||void 0===p?void 0:p.protocolNegotiationTimeout,outboundStreamProtocolNegotiationTimeout:null!==(g=null===(m=e.connectionManager)||void 0===m?void 0:m.outboundStreamProtocolNegotiationTimeout)&&void 0!==g?g:null===(v=e.connectionManager)||void 0===v?void 0:v.protocolNegotiationTimeout}),this.configureComponent("transportManager",new Mp(this.components,e.transportManager)),this.configureComponent("connectionManager",new pp(this.components,e.connectionManager)),!1!==(null===(y=e.connectionMonitor)||void 0===y?void 0:y.enabled)&&this.configureComponent("connectionMonitor",new Sp(this.components,e.connectionMonitor)),this.configureComponent("registrar",new Rp(this.components)),this.configureComponent("addressManager",new Dh(this.components,e.addresses));const R=(null!==(b=e.peerRouters)&&void 0!==b?b:[]).map(((e,t)=>this.configureComponent("peer-router-".concat(t),e(this.components))));this.peerRouting=this.components.peerRouting=this.configureComponent("peerRouting",new Tp(this.components,{routers:R}));const N=(null!==(S=e.contentRouters)&&void 0!==S?S:[]).map(((e,t)=>this.configureComponent("content-router-".concat(t),e(this.components))));if(this.contentRouting=this.components.contentRouting=this.configureComponent("contentRouting",new Cp(this.components,{routers:N})),this.configureComponent("randomWalk",new Lp(this.components)),(null!==(k=e.peerDiscovery)&&void 0!==k?k:[]).forEach(((e,t)=>{this.configureComponent("peer-discovery-".concat(t),e(this.components)).addEventListener("peer",(e=>{xa(ug,this,hg).call(this,e)}))})),null===(x=e.transports)||void 0===x||x.forEach(((e,t)=>{this.components.transportManager.add(this.configureComponent("transport-".concat(t),e(this.components)))})),null!=e.services)for(const w of Object.keys(e.services)){const t=(0,e.services[w])(this.components);var M,D;if(null!=t){if(this.services[w]=t,this.configureComponent(w,t),null!=t[bc]&&(this.log("registering service %s for content routing",w),N.push(t[bc])),null!=t[Ec]&&(this.log("registering service %s for peer routing",w),R.push(t[Ec])),null!=t[Sc])this.log("registering service %s for peer discovery",w),null===(M=(D=t[Sc]).addEventListener)||void 0===M||M.call(D,"peer",(e=>{xa(ug,this,hg).call(this,e)}))}else this.log.error("service factory %s returned null or undefined instance",w)}!function(e){const t={};for(const n of Object.values(e.components))for(const e of lf(n))t[e]=!0;for(const n of Object.values(e.components))for(const e of cf(n))if(!0!==t[e])throw new Kh('Service "'.concat(uf(n),'" required capability "').concat(e,'" but it was not provided by any component, you may need to add additional configuration when creating your node.'))}(_)}configureComponent(e,t){return null==t&&this.log.error("component %s was null or undefined",e),this.components[e]=t,t}async start(){if("stopped"===this.status){this.status="starting",this.log("libp2p is starting");try{var e,t,n,r;await(null===(e=(t=this.components).beforeStart)||void 0===e?void 0:e.call(t)),await this.components.start(),await(null===(n=(r=this.components).afterStart)||void 0===n?void 0:n.call(r)),this.status="started",this.safeDispatchEvent("start",{detail:this}),this.log("libp2p has started")}catch(i){throw this.log.error("An error occurred starting libp2p",i),this.status="started",await this.stop(),i}}}async stop(){var e,t,n,r;"started"===this.status&&(this.log("libp2p is stopping"),this.status="stopping",await(null===(e=(t=this.components).beforeStop)||void 0===e?void 0:e.call(t)),await this.components.stop(),await(null===(n=(r=this.components).afterStop)||void 0===n?void 0:n.call(r)),this.status="stopped",this.safeDispatchEvent("stop",{detail:this}),this.log("libp2p has stopped"))}getConnections(e){return this.components.connectionManager.getConnections(e)}getDialQueue(){return this.components.connectionManager.getDialQueue()}getPeers(){const e=new Vc;for(const t of this.components.connectionManager.getConnections())e.add(t.remotePeer);return Array.from(e)}async dial(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.components.connectionManager.openConnection(e,E({priority:75},t))}async dialProtocol(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==t)throw new C("no protocols were provided to open a stream");if(0===(t=Array.isArray(t)?t:[t]).length)throw new C("no protocols were provided to open a stream");return(await this.dial(e,n)).newStream(t,n)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;hc(e)&&(e=ra(null!==(n=e.getPeerId())&&void 0!==n?n:""));await this.components.connectionManager.closeConnections(e,t)}async getPublicKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.log("getPublicKey %p",e),null!=e.publicKey)return e.publicKey;try{const t=await this.peerStore.get(e);if(null!=t.id.publicKey)return t.id.publicKey}catch(i){if("NotFoundError"!==i.name)throw i}const n=te([jt("/pk/"),e.toMultihash().bytes]),r=Hs(await this.contentRouting.get(n,t));return await this.peerStore.patch(e,{publicKey:r}),r}async handle(e,t,n){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.handle(e,t,n)})))}async unhandle(e){Array.isArray(e)||(e=[e]),await Promise.all(e.map((async e=>{await this.components.registrar.unhandle(e)})))}async register(e,t){return this.components.registrar.register(e,t)}unregister(e){this.components.registrar.unregister(e)}async isDialable(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.components.connectionManager.isDialable(e,t)}}function hg(e){const{detail:t}=e;t.id.toString()!==this.peerId.toString()?this.components.peerStore.merge(t.id,{multiaddrs:t.multiaddrs}).catch((e=>{this.log.error(e)})):this.log.error("peer discovery mechanism discovered self")}async function fg(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null!==(e=t.privateKey)&&void 0!==e||(t.privateKey=await Ws("Ed25519"));const n=new dg(E(E({},await async function(e){var t;const n=wa(vc,e);if(null===n.connectionProtector&&null!=(null===(t=globalThis.process)||void 0===t||null===(t=t.env)||void 0===t?void 0:t.LIBP2P_FORCE_PNET))throw new C("Private network is enforced, but no protector was provided");return n}(t)),{},{peerId:(r=t.privateKey,ia(r.publicKey))}));var r;return!1!==t.start&&await n.start(),n}const pg=[Ol("tcp").code,Ol("dns").code,Ol("dnsaddr").code,Ol("dns4").code,Ol("dns6").code];function gg(e){var t;return null===(t=vg("sni",e))||void 0===t?void 0:t[1]}function mg(e){var t;const n=null===(t=vg("tcp",e))||void 0===t?void 0:t[1];return null==n?"":":".concat(n)}function vg(e,t){let n;try{n=Ol(e).code}catch(r){return}for(const[i,o]of t)if(i===n&&null!=o)return[i,o]}function yg(e){return e.some((e=>{let[t,n]=e;return t===Ol("tls").code}))}function wg(e,t,n){const r=bg[Ol(e).name];if(null==r)throw new Error("Can't interpret protocol ".concat(Ol(e).name));const i=r(t,n);return e===Ol("ip6").code?"[".concat(i,"]"):i}const bg={ip4:(e,t)=>e,ip6:(e,t)=>0===t.length?e:"[".concat(e,"]"),tcp:(e,t)=>{var n;const r=t.pop();if(null==r)throw new Error("Unexpected end of multiaddr");return"tcp://".concat(wg(r[0],null!==(n=r[1])&&void 0!==n?n:"",t),":").concat(e)},udp:(e,t)=>{var n;const r=t.pop();if(null==r)throw new Error("Unexpected end of multiaddr");return"udp://".concat(wg(r[0],null!==(n=r[1])&&void 0!==n?n:"",t),":").concat(e)},dnsaddr:(e,t)=>e,dns4:(e,t)=>e,dns6:(e,t)=>e,dns:(e,t)=>e,ipfs:(e,t)=>{var n;const r=t.pop();if(null==r)throw new Error("Unexpected end of multiaddr");return"".concat(wg(r[0],null!==(n=r[1])&&void 0!==n?n:"",t))},p2p:(e,t)=>{var n;const r=t.pop();if(null==r)throw new Error("Unexpected end of multiaddr");return"".concat(wg(r[0],null!==(n=r[1])&&void 0!==n?n:"",t))},http:(e,t)=>{var n;const r=yg(t),i=gg(t),o=mg(t);if(r&&null!=i)return"https://".concat(i).concat(o);const s=r?"https://":"http://",a=t.pop();if(null==a)throw new Error("Unexpected end of multiaddr");let l=wg(a[0],null!==(n=a[1])&&void 0!==n?n:"",t);return l=l.replace("tcp://",""),"".concat(s).concat(l)},"http-path":(e,t)=>{var n;const r=t.pop();if(null==r)throw new Error("Unexpected end of multiaddr");const i=wg(r[0],null!==(n=r[1])&&void 0!==n?n:"",t),o=decodeURIComponent(e);return"".concat(i,"/").concat(o)},tls:(e,t)=>{var n;const r=t.pop();if(null==r)throw new Error("Unexpected end of multiaddr");return wg(r[0],null!==(n=r[1])&&void 0!==n?n:"",t)},sni:(e,t)=>{var n;const r=t.pop();if(null==r)throw new Error("Unexpected end of multiaddr");return wg(r[0],null!==(n=r[1])&&void 0!==n?n:"",t)},https:(e,t)=>{var n;const r=t.pop();if(null==r)throw new Error("Unexpected end of multiaddr");let i=wg(r[0],null!==(n=r[1])&&void 0!==n?n:"",t);return i=i.replace("tcp://",""),"https://".concat(i)},ws:(e,t)=>{var n;const r=yg(t),i=gg(t),o=mg(t);if(r&&null!=i)return"wss://".concat(i).concat(o);const s=r?"wss://":"ws://",a=t.pop();if(null==a)throw new Error("Unexpected end of multiaddr");let l=wg(a[0],null!==(n=a[1])&&void 0!==n?n:"",t);return l=l.replace("tcp://",""),"".concat(s).concat(l)},wss:(e,t)=>{var n;const r=t.pop();if(null==r)throw new Error("Unexpected end of multiaddr");let i=wg(r[0],null!==(n=r[1])&&void 0!==n?n:"",t);return i=i.replace("tcp://",""),"wss://".concat(i)}};const Eg=async e=>{if(e.readyState>=2)throw new Error("socket closed");1!==e.readyState&&await new Promise(((t,n)=>{function r(){e.removeEventListener("open",i),e.removeEventListener("error",o)}function i(){r(),t()}function o(t){var i;r(),n(null!==(i=t.error)&&void 0!==i?i:new Error("connect ECONNREFUSED ".concat(e.url)))}e.addEventListener("open",i),e.addEventListener("error",o)}))},Sg=(e,t)=>{(t=null!==t&&void 0!==t?t:{}).closeOnEnd=!1!==t.closeOnEnd;return async n=>{var r,i=!1,o=!1;try{for(var s,a=Kc(n);i=!(s=await a.next()).done;i=!1){const t=s.value;try{await Eg(e)}catch(l){if("socket closed"===l.message)break;throw l}if(e.readyState===e.CLOSING||e.readyState===e.CLOSED)break;e.send(t)}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&await a.return()}finally{if(o)throw r}}null!=t.closeOnEnd&&e.readyState<=1&&await new Promise(((t,n)=>{e.addEventListener("close",(e=>{if(e.wasClean||1006===e.code)t();else{const t=Object.assign(new Error("ws error"),{event:e});n(t)}})),setTimeout((()=>{e.close()}))}))}};var kg=n(605);function xg(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===e||void 0===e||null===(t=e.constructor)||void 0===t?void 0:t.name)&&"number"===typeof(null===e||void 0===e?void 0:e.byteLength)}const Cg=(e,t)=>{t=null!==t&&void 0!==t?t:{};const n=(e=>{e.binaryType="arraybuffer";const t=async()=>{await new Promise(((t,n)=>{if(i)return void t();if(null!=r)return void n(r);const o=t=>{e.removeEventListener("open",s),e.removeEventListener("error",a),t()},s=()=>{o(t)},a=t=>{o((()=>{var r;n(null!==(r=t.error)&&void 0!==r?r:new Error("connect ECONNREFUSED ".concat(e.url)))}))};e.addEventListener("open",s),e.addEventListener("error",a)}))},n=ru((function*(){const n=new kg.PP((t=>{let{push:n,stop:r,fail:i}=t;const o=e=>{let t=null;"string"===typeof e.data&&(t=jt(e.data)),xg(e.data)&&(t=new Uint8Array(e.data)),e.data instanceof Uint8Array&&(t=e.data),null!=t&&n(t)},s=e=>{var t;i(null!==(t=e.error)&&void 0!==t?t:new Error("Socket error"))};return e.addEventListener("message",o),e.addEventListener("error",s),e.addEventListener("close",r),()=>{e.removeEventListener("message",o),e.removeEventListener("error",s),e.removeEventListener("close",r)}}),{highWaterMark:1/0});yield nu(t());var r,i=!1,o=!1;try{for(var s,a=Kc(n);i=!(s=yield nu(a.next())).done;i=!1){const e=s.value;yield xg(e)?new Uint8Array(e):e}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}))();let r,i=1===e.readyState;return e.addEventListener("open",(()=>{i=!0,r=null})),e.addEventListener("close",(()=>{i=!1,r=null})),e.addEventListener("error",(t=>{var n;i||(r=null!==(n=t.error)&&void 0!==n?n:new Error("connect ECONNREFUSED ".concat(e.url)))})),Object.assign(n,{connected:t})})(e);let r=t.remoteAddress,i=t.remotePort;if(null!=e.url)try{const t=new URL(e.url);r=t.hostname,i=parseInt(t.port,10)}catch(o){}if(null==r||null==i)throw new Error("Remote connection did not have address and/or port");return{sink:Sg(e,t),source:n,connected:async()=>{await n.connected()},close:async()=>{e.readyState!==e.CONNECTING&&e.readyState!==e.OPEN||await new Promise((t=>{e.addEventListener("close",(()=>{t()})),e.close()}))},destroy:()=>{null!=e.terminate?e.terminate():e.close()},remoteAddress:r,remotePort:i,socket:e}},Pg=WebSocket,Ag={"http:":"ws:","https:":"wss:"};function Ig(e,t){t=null!==t&&void 0!==t?t:{};const n=((e,t)=>{var n;if(e.startsWith("//")&&(e="".concat(null!==(n=null===t||void 0===t?void 0:t.protocol)&&void 0!==n?n:"ws:").concat(e)),e.startsWith("/")&&null!=t){var r;const n=null!==(r=t.protocol)&&void 0!==r?r:"ws:",i=t.host,o=null!=t.port&&!0!==(null===i||void 0===i?void 0:i.endsWith(":".concat(t.port)))?":".concat(t.port):"";e="".concat(n,"//").concat(i).concat(o).concat(e)}const i=new URL(e);for(const[o,s]of Object.entries(Ag))i.protocol===o&&(i.protocol=s);return i})(e,"undefined"===typeof window?void 0:window.location),r=new Pg(n.toString(),t.websocket);return Cg(r,t)}class _g{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"log",void 0),w(this,"init",void 0),w(this,"logger",void 0),w(this,"metrics",void 0),w(this,"components",void 0),w(this,aa,!0),w(this,Symbol.toStringTag,"@libp2p/websockets"),w(this,Uh,["@libp2p/transport"]),this.log=e.logger.forComponent("libp2p:websockets"),this.logger=e.logger,this.components=e,this.init=t,null!=e.metrics&&(this.metrics={dialerEvents:e.metrics.registerCounterGroup("libp2p_websockets_dialer_events_total",{label:"event",help:"Total count of WebSockets dialer events by type"})})}async dial(e,t){var n;this.log("dialing %s",e),t=null!==t&&void 0!==t?t:{};const r=function(e,t,n){var r;const i=n.logger.forComponent("libp2p:websockets:maconn"),o=n.metrics,s=null!==(r=n.metricPrefix)&&void 0!==r?r:"",a={log:i,async sink(t){try{await e.sink(ru((function*(){var e,n=!1,r=!1;try{for(var i,o=Kc(t);n=!(i=yield nu(o.next())).done;n=!1){const e=i.value;e instanceof Uint8Array?yield e:yield e.subarray()}}catch(s){r=!0,e=s}finally{try{n&&null!=o.return&&(yield nu(o.return()))}finally{if(r)throw e}}}))())}catch(n){"aborted"!==n.type&&i.error(n)}},source:e.source,remoteAddr:t,timeline:{open:Date.now()},async close(){var t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=Date.now();if(null==n.signal){const e=AbortSignal.timeout(500);n=E(E({},n),{},{signal:e})}const o=()=>{const{host:e,port:t}=a.remoteAddr.toOptions();i("timeout closing stream to %s:%s after %dms, destroying it manually",e,t,Date.now()-r),this.abort(new S("Socket close timeout"))};null===(t=n.signal)||void 0===t||t.addEventListener("abort",o);try{await e.close()}catch(l){i.error("error closing WebSocket gracefully",l),this.abort(l)}finally{var s;null===(s=n.signal)||void 0===s||s.removeEventListener("abort",o),a.timeline.close=Date.now()}},abort(t){const{host:n,port:r}=a.remoteAddr.toOptions();i("timeout closing stream to %s:%s due to error",n,r,t),e.destroy(),a.timeline.close=Date.now(),null===o||void 0===o||o.increment({["".concat(s,"error")]:!0})}};return e.socket.addEventListener("close",(()=>{null===o||void 0===o||o.increment({["".concat(s,"close")]:!0}),null==a.timeline.close&&(a.timeline.close=Date.now())}),{once:!0}),a}(await this._connect(e,t),e,{logger:this.logger,metrics:null===(n=this.metrics)||void 0===n?void 0:n.dialerEvents});this.log("new outbound connection %s",r.remoteAddr);const i=await t.upgrader.upgradeOutbound(r,t);return this.log("outbound connection %s upgraded",r.remoteAddr),i}async _connect(e,t){var n,r;null===t||void 0===t||null===(n=t.signal)||void 0===n||n.throwIfAborted();const i=e.toOptions();this.log("dialing %s:%s",i.host,i.port);const o=If(),s=Ig(function(e,t){var n;const r=fc(e).stringTuples(),i=r.pop();if(null==i)throw new Error("Unexpected end of multiaddr");const o=Ol(i[0]),s=bg[o.name];if(null==s)throw new Error("No interpreter found for ".concat(o.name));let a=s(null!==(n=i[1])&&void 0!==n?n:"",r);return!1!==(null===t||void 0===t?void 0:t.assumeHttp)&&pg.includes(i[0])&&(a=a.replace(/^.*:\/\//,""),a="443"===i[1]?"https://".concat(a):"http://".concat(a)),(a.startsWith("http://")||a.startsWith("https://")||a.startsWith("ws://")||a.startsWith("wss://"))&&(a=new URL(a).toString(),a.endsWith("/")&&(a=a.substring(0,a.length-1))),a}(e),this.init);s.socket.addEventListener("error",(()=>{var t;const n=new L("Could not connect to ".concat(e.toString()));this.log.error("connection error:",n),null===(t=this.metrics)||void 0===t||t.dialerEvents.increment({error:!0}),o.reject(n)}));try{var a;null===(a=t.onProgress)||void 0===a||a.call(t,new ba("websockets:open-connection")),await zf(Promise.race([s.connected(),o.promise]),t.signal)}catch(u){var l,c;if(null!==(l=t.signal)&&void 0!==l&&l.aborted)null===(c=this.metrics)||void 0===c||c.dialerEvents.increment({abort:!0});throw s.close().catch((e=>{this.log.error("error closing raw socket",e)})),u}return this.log("connected %s",e),null===(r=this.metrics)||void 0===r||r.dialerEvents.increment({connect:!0}),s}createListener(e){return function(){throw new Error("WebSocket Servers can not be created in the browser!")}((this.logger,this.components.events,this.components.metrics),E(E({},this.init),e))}listenFilter(e){var t,n;return e=Array.isArray(e)?e:[e],null!=(null===(t=this.init)||void 0===t?void 0:t.filter)?null===(n=this.init)||void 0===n?void 0:n.filter(e):function(e){return e.filter((e=>fh.exactMatch(e)||dh.exactMatch(e)))}(e)}dialFilter(e){return this.listenFilter(e)}}function Tg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new _g(t,e)}function Lg(e){if(null!=e){if("function"===typeof e[Symbol.iterator])return e[Symbol.iterator]();if("function"===typeof e[Symbol.asyncIterator])return e[Symbol.asyncIterator]();if("function"===typeof e.next)return e}throw new Error("argument is not an iterator or iterable")}function Rg(e,t){var n,r;const i=null===(n=(r=Lg(e)).return)||void 0===n?void 0:n.call(r);var o;null!=(o=i)&&"function"===typeof o.then&&"function"===typeof o.catch&&"function"===typeof o.finally&&i.catch((e=>{t.error("could not cause iterator to return",e)}))}function Ng(e){if(null==e)throw new Error("Empty pipeline");if(zg(e)){const t=e;e=()=>t.source}else if(Og(e)||Dg(e)){const t=e;e=()=>t}for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=[e,...n];if(i.length>1&&zg(i[i.length-1])&&(i[i.length-1]=i[i.length-1].sink),i.length>2)for(let o=1;o<i.length-1;o++)zg(i[o])&&(i[o]=Fg(i[o]));return Mg(...i)}const Mg=function(){let e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(;n.length>0;)e=n.shift()(e);return e},Dg=e=>null!=(null===e||void 0===e?void 0:e[Symbol.asyncIterator]),Og=e=>null!=(null===e||void 0===e?void 0:e[Symbol.iterator]),zg=e=>null!=e&&(null!=e.sink&&null!=e.source),Fg=e=>t=>{const n=e.sink(t);if(null!=(null===n||void 0===n?void 0:n.then)){const t=Rf({objectMode:!0});let r;n.then((()=>{t.end()}),(e=>{t.end(e)}));const i=e.source;if(Dg(i))r=function(){var e=ru((function*(){yield*dd(Kc(i)),t.end()}));return function(){return e.apply(this,arguments)}}();else{if(!Og(i))throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");r=function*(){yield*i,t.end()}}return xp(t,r())}return e.source};var Ug;!function(e){e[e.NEW_STREAM=0]="NEW_STREAM",e[e.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",e[e.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",e[e.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",e[e.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",e[e.RESET_RECEIVER=5]="RESET_RECEIVER",e[e.RESET_INITIATOR=6]="RESET_INITIATOR"}(Ug||(Ug={}));const Bg=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),qg=Object.freeze({NEW_STREAM:Ug.NEW_STREAM,MESSAGE:Ug.MESSAGE_INITIATOR,CLOSE:Ug.CLOSE_INITIATOR,RESET:Ug.RESET_INITIATOR}),Vg=Object.freeze({MESSAGE:Ug.MESSAGE_RECEIVER,CLOSE:Ug.CLOSE_RECEIVER,RESET:Ug.RESET_RECEIVER}),Kg=1<<20;class jg{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kg,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4194304;w(this,"_buffer",void 0),w(this,"_headerInfo",void 0),w(this,"_maxMessageSize",void 0),w(this,"_maxUnprocessedMessageQueueSize",void 0),this._buffer=new se,this._headerInfo=null,this._maxMessageSize=e,this._maxUnprocessedMessageQueueSize=t}write(e){if(null==e||0===e.length)return[];if(this._buffer.append(e),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw new q("Unprocessed message queue size too large!");const t=[];for(;0!==this._buffer.length;){if(null==this._headerInfo)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(n){if("InvalidMessageError"===n.name)throw n;break}const{id:e,type:r,length:i,offset:o}=this._headerInfo;if(this._buffer.length-o<i)break;const s={id:e,type:r};r!==Ug.NEW_STREAM&&r!==Ug.MESSAGE_INITIATOR&&r!==Ug.MESSAGE_RECEIVER||(s.data=this._buffer.sublist(o,o+i)),t.push(s),this._buffer.consume(o+i),this._headerInfo=null}return t}_decodeHeader(e){const{value:t,offset:n}=Qg(e),{value:r,offset:i}=Qg(e,n),o=7&t;if(null==Bg[o])throw new Error("Invalid type received: ".concat(o));if(r>this._maxMessageSize)throw new q("Message size too large");return{id:t>>3,type:o,offset:n+i,length:r}}}const Wg=128,Hg=127;function Qg(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=0,i=0,o=n;const s=e.length;do{if(o>=s||i>49)throw n=0,new RangeError("Could not decode varint");t=e.get(o++),r+=i<28?(t&Hg)<<i:(t&Hg)*Math.pow(2,i),i+=7}while(t>=Wg);return n=o-n,{value:r,offset:n}}const Gg=10240;const Yg=new class{constructor(){w(this,"_pool",void 0),w(this,"_poolOffset",void 0),this._pool=ee(Gg),this._poolOffset=0}write(e,t){const n=this._pool;let r=this._poolOffset;go(e.id<<3|e.type,n,r),r+=ho(e.id<<3|e.type),e.type!==Ug.NEW_STREAM&&e.type!==Ug.MESSAGE_INITIATOR&&e.type!==Ug.MESSAGE_RECEIVER||null==e.data?(go(0,n,r),r+=ho(0)):(go(e.data.length,n,r),r+=ho(e.data.length));const i=n.subarray(this._poolOffset,r);Gg-r<100?(this._pool=ee(Gg),this._poolOffset=0):this._poolOffset=r,t.append(i),e.type!==Ug.NEW_STREAM&&e.type!==Ug.MESSAGE_INITIATOR&&e.type!==Ug.MESSAGE_RECEIVER||null==e.data||t.append(e.data)}};function $g(){return $g=ru((function*(e){var t,n=!1,r=!1;try{for(var i,o=Kc(e);n=!(i=yield nu(o.next())).done;n=!1){const e=i.value;{const t=new se;Yg.write(e,t),yield t}}}catch(s){r=!0,t=s}finally{try{n&&null!=o.return&&(yield nu(o.return()))}finally{if(r)throw t}}})),$g.apply(this,arguments)}class Xg extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Stream input buffer error"),this.name="StreamInputBufferError"}}function Zg(e){return null!=e&&("function"===typeof e.then&&"function"===typeof e.catch&&"function"===typeof e.finally)}class Jg{constructor(e){var t,n;w(this,"id",void 0),w(this,"direction",void 0),w(this,"timeline",void 0),w(this,"protocol",void 0),w(this,"metadata",void 0),w(this,"source",void 0),w(this,"status",void 0),w(this,"readStatus",void 0),w(this,"writeStatus",void 0),w(this,"log",void 0),w(this,"sinkController",void 0),w(this,"sinkEnd",void 0),w(this,"closed",void 0),w(this,"endErr",void 0),w(this,"streamSource",void 0),w(this,"onEnd",void 0),w(this,"onCloseRead",void 0),w(this,"onCloseWrite",void 0),w(this,"onReset",void 0),w(this,"onAbort",void 0),w(this,"sendCloseWriteTimeout",void 0),w(this,"sendingData",void 0),this.sinkController=new AbortController,this.sinkEnd=If(),this.closed=If(),this.log=e.log,this.status="open",this.readStatus="ready",this.writeStatus="ready",this.id=e.id,this.metadata=null!==(t=e.metadata)&&void 0!==t?t:{},this.direction=e.direction,this.timeline={open:Date.now()},this.sendCloseWriteTimeout=null!==(n=e.sendCloseWriteTimeout)&&void 0!==n?n:5e3,this.onEnd=e.onEnd,this.onCloseRead=e.onCloseRead,this.onCloseWrite=e.onCloseWrite,this.onReset=e.onReset,this.onAbort=e.onAbort,this.source=this.streamSource=Rf({onEnd:e=>{null!=e?this.log.trace("source ended with error",e):this.log.trace("source ended"),this.onSourceEnd(e)}}),this.sink=this.sink.bind(this)}async sink(e){if("ready"!==this.writeStatus)throw new M('writable end state is "'.concat(this.writeStatus,'" not "ready"'));try{this.writeStatus="writing";const a={signal:this.sinkController.signal};if("outbound"===this.direction){const e=this.sendNewStream(a);Zg(e)&&await e}const l=()=>{Rg(e,this.log)};try{this.sinkController.signal.addEventListener("abort",l),this.log.trace("sink reading from source");var t,n=!1,r=!1;try{for(var i,o=Kc(e);n=!(i=await o.next()).done;n=!1){let e=i.value;{e=e instanceof Uint8Array?new se(e):e;const t=this.sendData(e,a);Zg(t)&&(this.sendingData=If(),await t,this.sendingData.resolve(),this.sendingData=void 0)}}}catch(s){r=!0,t=s}finally{try{n&&null!=o.return&&await o.return()}finally{if(r)throw t}}}finally{this.sinkController.signal.removeEventListener("abort",l)}this.log.trace('sink finished reading from source, write status is "%s"',this.writeStatus),"writing"===this.writeStatus&&(this.writeStatus="closing",this.log.trace("send close write to remote"),await this.sendCloseWrite({signal:AbortSignal.timeout(this.sendCloseWriteTimeout)}),this.writeStatus="closed"),this.onSinkEnd()}catch(s){throw this.log.trace("sink ended with error, calling abort with error",s),this.abort(s),s}finally{this.log.trace("resolve sink end"),this.sinkEnd.resolve()}}onSourceEnd(e){var t;null==this.timeline.closeRead&&(this.timeline.closeRead=Date.now(),this.readStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseRead)||void 0===t||t.call(this),null!=this.timeline.closeWrite?(this.log.trace("source and sink ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr),this.closed.resolve()):this.log.trace("source ended, waiting for sink to end"))}onSinkEnd(e){var t;null==this.timeline.closeWrite&&(this.timeline.closeWrite=Date.now(),this.writeStatus="closed",null!=e&&null==this.endErr&&(this.endErr=e),null===(t=this.onCloseWrite)||void 0===t||t.call(this),null!=this.timeline.closeRead?(this.log.trace("sink and source ended"),this.timeline.close=Date.now(),"aborted"!==this.status&&"reset"!==this.status&&(this.status="closed"),null!=this.onEnd&&this.onEnd(this.endErr),this.closed.resolve()):this.log.trace("sink ended, waiting for source to end"))}async close(e){"open"===this.status&&(this.log.trace("closing gracefully"),this.status="closing",await zf(Promise.all([this.closeWrite(e),this.closeRead(e),this.closed.promise]),null===e||void 0===e?void 0:e.signal),this.status="closed",this.log.trace("closed gracefully"))}async closeRead(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("closing"===this.readStatus||"closed"===this.readStatus)return;this.log.trace('closing readable end of stream with starting read status "%s"',this.readStatus);const t=this.readStatus;this.readStatus="closing","reset"!==this.status&&"aborted"!==this.status&&null==this.timeline.closeRead&&(this.log.trace("send close read to remote"),await this.sendCloseRead(e)),"ready"===t&&(this.log.trace("ending internal source queue with %d queued bytes",this.streamSource.readableLength),this.streamSource.end()),this.log.trace("closed readable end of stream")}async closeWrite(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"closing"!==this.writeStatus&&"closed"!==this.writeStatus&&(this.log.trace('closing writable end of stream with starting write status "%s"',this.writeStatus),"ready"===this.writeStatus&&(this.log.trace("sink was never sunk, sink an empty array"),await zf(this.sink([]),e.signal)),"writing"===this.writeStatus&&(null!=this.sendingData&&await zf(this.sendingData.promise,e.signal),this.log.trace("aborting source passed to .sink"),this.sinkController.abort(),await zf(this.sinkEnd.promise,e.signal)),this.writeStatus="closed",this.log.trace("closed writable end of stream"))}abort(e){var t;if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;this.log("abort with error",e),this.log("try to send reset to remote");const n=this.sendReset();Zg(n)&&n.catch((e=>{this.log.error("error sending reset message",e)})),this.status="aborted",this.timeline.abort=Date.now(),this._closeSinkAndSource(e),null===(t=this.onAbort)||void 0===t||t.call(this,e)}reset(){var e;if("closed"===this.status||"aborted"===this.status||"reset"===this.status)return;const t=new N("stream reset");this.status="reset",this.timeline.reset=Date.now(),this._closeSinkAndSource(t),null===(e=this.onReset)||void 0===e||e.call(this)}_closeSinkAndSource(e){this._closeSink(e),this._closeSource(e)}_closeSink(e){"writing"===this.writeStatus&&(this.log.trace("end sink source"),this.sinkController.abort()),this.onSinkEnd(e)}_closeSource(e){"closing"!==this.readStatus&&"closed"!==this.readStatus&&(this.log.trace("ending source with %d bytes to be read by consumer",this.streamSource.readableLength),this.readStatus="closing",this.streamSource.end(e))}remoteCloseWrite(){"closing"!==this.readStatus&&"closed"!==this.readStatus?(this.log.trace("remote close write"),this._closeSource()):this.log("received remote close write but local source is already closed")}remoteCloseRead(){"closing"!==this.writeStatus&&"closed"!==this.writeStatus?(this.log.trace("remote close read"),this._closeSink()):this.log("received remote close read but local sink is already closed")}destroy(){"closed"!==this.status&&"aborted"!==this.status&&"reset"!==this.status?(this.log.trace("stream destroyed"),this._closeSinkAndSource()):this.log("received destroy but we are already closed")}sourcePush(e){this.streamSource.push(e)}sourceReadableLength(){return this.streamSource.readableLength}}class em extends Jg{constructor(e){super(e),w(this,"name",void 0),w(this,"streamId",void 0),w(this,"send",void 0),w(this,"types",void 0),w(this,"maxDataSize",void 0),this.types="outbound"===e.direction?qg:Vg,this.send=e.send,this.name=e.name,this.streamId=e.streamId,this.maxDataSize=e.maxDataSize}async sendNewStream(){await this.send({id:this.streamId,type:qg.NEW_STREAM,data:new se(jt(this.name))})}async sendData(e){for(e=e.sublist();e.byteLength>0;){const t=Math.min(e.byteLength,this.maxDataSize);await this.send({id:this.streamId,type:this.types.MESSAGE,data:e.sublist(0,t)}),e.consume(t)}}async sendReset(){await this.send({id:this.streamId,type:this.types.RESET})}async sendCloseWrite(){await this.send({id:this.streamId,type:this.types.CLOSE})}async sendCloseRead(){}}function tm(e){const t=E(E({},e),{},{type:"".concat(Bg[e.type]," (").concat(e.type,")")});return e.type===Ug.NEW_STREAM&&(t.data=Wt(e.data instanceof Uint8Array?e.data:e.data.subarray())),e.type!==Ug.MESSAGE_INITIATOR&&e.type!==Ug.MESSAGE_RECEIVER||(t.data=Wt(e.data instanceof Uint8Array?e.data:e.data.subarray(),"base16")),t}class nm{constructor(e,t){var n,r;w(this,"protocol","/mplex/6.7.0"),w(this,"sink",void 0),w(this,"source",void 0),w(this,"log",void 0),w(this,"_streamId",void 0),w(this,"_streams",void 0),w(this,"_init",void 0),w(this,"_source",void 0),w(this,"closeController",void 0),w(this,"rateLimiter",void 0),w(this,"closeTimeout",void 0),w(this,"logger",void 0),t=null!==t&&void 0!==t?t:{},this.log=e.logger.forComponent("libp2p:mplex"),this.logger=e.logger,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=t,this.closeTimeout=null!==(n=t.closeTimeout)&&void 0!==n?n:500,this.sink=this._createSink(),this._source=Rf({objectMode:!0,onEnd:()=>{for(const e of this._streams.initiators.values())e.destroy();for(const e of this._streams.receivers.values())e.destroy()}}),this.source=Ng(this._source,(e=>function(e){return $g.apply(this,arguments)}(e))),this.closeController=new AbortController,this.rateLimiter=new wf({points:null!==(r=t.disconnectThreshold)&&void 0!==r?r:5,duration:1})}get streams(){const e=[];for(const t of this._streams.initiators.values())e.push(t);for(const t of this._streams.receivers.values())e.push(t);return e}newStream(e){if(this.closeController.signal.aborted)throw new R("Muxer already closed");const t=this._streamId++;e=null==e?t.toString():e.toString();const n=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:n})}async close(e){var t;if(this.closeController.signal.aborted)return;const n=null!==(t=null===e||void 0===e?void 0:e.signal)&&void 0!==t?t:AbortSignal.timeout(this.closeTimeout);try{await Promise.all(this.streams.map((async e=>e.close({signal:n})))),this._source.end(),await this._source.onEmpty({signal:n}),this.closeController.abort()}catch(r){this.abort(r)}}abort(e){this.closeController.signal.aborted||(this.streams.forEach((t=>{t.abort(e)})),this.closeController.abort(e))}_newReceiverStream(e){const{id:t,name:n}=e,r=this._streams.receivers;return this._newStream({id:t,name:n,type:"receiver",registry:r})}_newStream(e){var t;const{id:n,name:r,type:i,registry:o}=e;if(this.log("new %s stream %s",i,n),"initiator"===i&&this._streams.initiators.size===(null!==(t=this._init.maxOutboundStreams)&&void 0!==t?t:1024))throw new $("Too many outbound streams open");if(o.has(n))throw new Error("".concat(i," stream ").concat(n," already exists!"));const s=function(e){const{id:t,name:n,send:r,onEnd:i,type:o="initiator",maxMsgSize:s=Kg}=e;return new em({id:"initiator"===o?"i".concat(t):"r".concat(t),streamId:t,name:"".concat(null!==n&&void 0!==n?n:t),direction:"initiator"===o?"outbound":"inbound",maxDataSize:s,onEnd:i,send:r,log:e.logger.forComponent("libp2p:mplex:stream:".concat(o,":").concat(t))})}({id:n,name:r,send:async e=>{this.log.enabled&&this.log.trace("%s stream %s send",i,n,tm(e)),this._source.push(e)},type:i,onEnd:()=>{this.log("%s stream with id %s and protocol %s ended",i,n,s.protocol),o.delete(n),null!=this._init.onStreamEnd&&this._init.onStreamEnd(s)},maxMsgSize:this._init.maxMsgSize,logger:this.logger});return o.set(n,s),s}_createSink(){return async e=>{const t=()=>{Rg(e,this.log)};this.closeController.signal.addEventListener("abort",t);try{const t=new jg(this._init.maxMsgSize,this._init.maxUnprocessedMessageQueueSize);var n,r=!1,i=!1;try{for(var o,s=Kc(e);r=!(o=await s.next()).done;r=!1){const e=o.value;for(const n of t.write(e))await this._handleIncoming(n)}}catch(a){i=!0,n=a}finally{try{r&&null!=s.return&&await s.return()}finally{if(i)throw n}}this._source.end()}catch(a){this.log("error in sink",a),this._source.end(a)}finally{this.closeController.signal.removeEventListener("abort",t)}}}async _handleIncoming(e){var t;const{id:n,type:r}=e;if(this.log.enabled&&this.log.trace("incoming message",tm(e)),e.type===Ug.NEW_STREAM){var i;if(this._streams.receivers.size===(null!==(i=this._init.maxInboundStreams)&&void 0!==i?i:1024)){this.log("too many inbound streams open"),this._source.push({id:n,type:Ug.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch(a){return this.log("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),void this.abort(new Error("Too many open streams"))}return}const t=this._newReceiverStream({id:n,name:Wt(e.data instanceof Uint8Array?e.data:e.data.subarray())});return void(null!=this._init.onIncomingStream&&this._init.onIncomingStream(t))}const o=(1===(1&r)?this._streams.initiators:this._streams.receivers).get(n);if(null==o){this.log("missing stream %s for message type %s",n,Bg[r]);try{await this.rateLimiter.consume("missing-stream",1)}catch(l){return this.log("rate limit hit when receiving messages for streams that do not exist - closing remote connection"),void this.abort(new Error("Too many messages for missing streams"))}return}const s=null!==(t=this._init.maxStreamBufferSize)&&void 0!==t?t:4194304;try{switch(r){case Ug.MESSAGE_INITIATOR:case Ug.MESSAGE_RECEIVER:if(o.sourceReadableLength()>s)throw this._source.push({id:e.id,type:r===Ug.MESSAGE_INITIATOR?Ug.RESET_RECEIVER:Ug.RESET_INITIATOR}),new Xg("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers");o.sourcePush(e.data);break;case Ug.CLOSE_INITIATOR:case Ug.CLOSE_RECEIVER:o.remoteCloseWrite();break;case Ug.RESET_INITIATOR:case Ug.RESET_RECEIVER:o.reset();break;default:this.log("unknown message type %s",r)}}catch(c){this.log.error("error while processing message",c),o.abort(c)}}}class rm{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"protocol","/mplex/6.7.0"),w(this,"_init",void 0),w(this,"components",void 0),w(this,Symbol.toStringTag,"@libp2p/mplex"),w(this,Uh,["@libp2p/stream-multiplexing"]),this.components=e,this._init=t}createStreamMuxer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new nm(this.components,E(E({},e),this._init))}}function im(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new rm(t,e)}class om extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The frame was invalid"),this.name="InvalidFrameError"}}w(om,"name","InvalidFrameError");class sm extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unrequested ping error"),this.name="UnrequestedPingError"}}w(sm,"name","UnrequestedPingError");class am extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unrequested ping error"),this.name="NotMatchingPingError"}}w(am,"name","NotMatchingPingError");class lm extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid state"),this.name="InvalidStateError"}}w(lm,"name","InvalidStateError");class cm extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Strean already exists"),this.name="StreamAlreadyExistsError"}}w(cm,"name","StreamAlreadyExistsError");class um extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Decode invalid version"),this.name="DecodeInvalidVersionError"}}w(um,"name","DecodeInvalidVersionError");class dm extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Both clients"),this.name="BothClientsError"}}w(dm,"name","BothClientsError");class hm extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Receive window exceeded"),this.name="ReceiveWindowExceededError"}}w(hm,"name","ReceiveWindowExceededError");const fm=new Set([om.name,sm.name,am.name,cm.name,um.name,dm.name,hm.name]),pm=262144,gm={enableKeepAlive:!0,keepAliveInterval:3e4,maxInboundStreams:1e3,maxOutboundStreams:1e3,initialStreamWindowSize:pm,maxStreamWindowSize:16777216,maxMessageSize:65536};var mm,vm;!function(e){e[e.Data=0]="Data",e[e.WindowUpdate=1]="WindowUpdate",e[e.Ping=2]="Ping",e[e.GoAway=3]="GoAway"}(mm||(mm={})),function(e){e[e.SYN=1]="SYN",e[e.ACK=2]="ACK",e[e.FIN=4]="FIN",e[e.RST=8]="RST"}(vm||(vm={}));Object.values(vm).filter((e=>"string"!==typeof e));var ym;!function(e){e[e.NormalTermination=0]="NormalTermination",e[e.ProtocolError=1]="ProtocolError",e[e.InternalError=2]="InternalError"}(ym||(ym={}));const wm=2**24;class bm{constructor(e){w(this,"source",void 0),w(this,"buffer",void 0),w(this,"frameInProgress",void 0),this.source=function(e){if(void 0!==e[Symbol.iterator]){const t=e[Symbol.iterator]();return t.return=void 0,{[Symbol.iterator]:()=>t}}if(void 0!==e[Symbol.asyncIterator]){const t=e[Symbol.asyncIterator]();return t.return=void 0,{[Symbol.asyncIterator]:()=>t}}throw new Error("a source must be either an iterable or an async iterable")}(e),this.buffer=new se,this.frameInProgress=!1}emitFrames(){var e=this;return ru((function*(){var t,n=!1,r=!1;try{for(var i,o=Kc(e.source);n=!(i=yield nu(o.next())).done;n=!1){const t=i.value;for(e.buffer.append(t);;){const t=e.readHeader();if(void 0===t)break;const{type:n,length:r}=t;n===mm.Data?(e.frameInProgress=!0,yield{header:t,readData:e.readBytes.bind(e,r)}):yield{header:t}}}}catch(s){r=!0,t=s}finally{try{n&&null!=o.return&&(yield nu(o.return()))}finally{if(r)throw t}}}))()}readHeader(){if(this.frameInProgress)throw new lm("decoding frame already in progress");if(this.buffer.length<12)return;const e=function(e){if(0!==e[0])throw new om("Invalid frame version");return{type:e[1],flag:(e[2]<<8)+e[3],streamID:e[4]*wm+(e[5]<<16)+(e[6]<<8)+e[7],length:e[8]*wm+(e[9]<<16)+(e[10]<<8)+e[11]}}(this.buffer.subarray(0,12));return this.buffer.consume(12),e}async readBytes(e){if(this.buffer.length<e){var t,n=!1,r=!1;try{for(var i,o=Kc(this.source);n=!(i=await o.next()).done;n=!1){const t=i.value;if(this.buffer.append(t),this.buffer.length>=e)break}}catch(a){r=!0,t=a}finally{try{n&&null!=o.return&&await o.return()}finally{if(r)throw t}}}const s=this.buffer.sublist(0,e);return this.buffer.consume(e),this.frameInProgress=!1,s}}function Em(e){const t=new Uint8Array(12);return t[1]=e.type,t[2]=e.flag>>>8,t[3]=e.flag,t[4]=e.streamID>>>24,t[5]=e.streamID>>>16,t[6]=e.streamID>>>8,t[7]=e.streamID,t[8]=e.length>>>24,t[9]=e.length>>>16,t[10]=e.length>>>8,t[11]=e.length,t}function Sm(e){return null!=(null===e||void 0===e?void 0:e.then)}const km=function(e,t){let n=0;if(null!=e[Symbol.asyncIterator])return ru((function*(){var r,i=!1,o=!1;try{for(var s,a=Kc(e);i=!(s=yield nu(a.next())).done;i=!1){const e=s.value;{const r=t(e,n++);Sm(r)&&(yield nu(r)),yield e}}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}))();const r=cd(e),{value:i,done:o}=r.next();if(!0===o)return function*(){}();const s=t(i,n++);if("function"===typeof(null===s||void 0===s?void 0:s.then))return ru((function*(){yield i;var e,o=!1,s=!1;try{for(var a,l=Kc(r);o=!(a=yield nu(l.next())).done;o=!1){const e=a.value;{const r=t(e,n++);Sm(r)&&(yield nu(r)),yield e}}}catch(c){s=!0,e=c}finally{try{o&&null!=l.return&&(yield nu(l.return()))}finally{if(s)throw e}}}))();const a=t;return function*(){yield i;for(const e of r)a(e,n++),yield e}()};var xm;!function(e){e[e.Init=0]="Init",e[e.SYNSent=1]="SYNSent",e[e.SYNReceived=2]="SYNReceived",e[e.Established=3]="Established",e[e.Finished=4]="Finished"}(xm||(xm={}));class Cm extends Jg{constructor(e){super(E(E({},e),{},{onEnd:t=>{var n;this.state=xm.Finished,null===(n=e.onEnd)||void 0===n||n.call(e,t)}})),w(this,"name",void 0),w(this,"state",void 0),w(this,"config",void 0),w(this,"_id",void 0),w(this,"sendWindowCapacity",void 0),w(this,"sendWindowCapacityUpdate",void 0),w(this,"recvWindow",void 0),w(this,"recvWindowCapacity",void 0),w(this,"epochStart",void 0),w(this,"getRTT",void 0),w(this,"sendFrame",void 0),this.config=e.config,this._id=parseInt(e.id,10),this.name=e.name,this.state=e.state,this.sendWindowCapacity=pm,this.recvWindow=this.config.initialStreamWindowSize,this.recvWindowCapacity=this.recvWindow,this.epochStart=Date.now(),this.getRTT=e.getRTT,this.sendFrame=e.sendFrame,this.source=km(this.source,(()=>{this.sendWindowUpdate()}))}async sendNewStream(){}async sendData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};for(e=e.sublist();0!==e.byteLength;){var n,r;if(0===this.sendWindowCapacity)if(null===(n=this.log)||void 0===n||n.trace("wait for send window capacity, status %s",this.status),await this.waitForSendWindowCapacity(t),"closed"===this.status||"aborted"===this.status||"reset"===this.status)return void(null===(r=this.log)||void 0===r||r.trace("%s while waiting for send window capacity",this.status));const i=Math.min(this.sendWindowCapacity,this.config.maxMessageSize-12,e.length),o=this.getSendFlags();this.sendFrame({type:mm.Data,flag:o,streamID:this._id,length:i},e.sublist(0,i)),this.sendWindowCapacity-=i,e.consume(i)}}async sendReset(){this.sendFrame({type:mm.WindowUpdate,flag:vm.RST,streamID:this._id,length:0})}async sendCloseWrite(){const e=this.getSendFlags()|vm.FIN;this.sendFrame({type:mm.WindowUpdate,flag:e,streamID:this._id,length:0})}async sendCloseRead(){}async waitForSendWindowCapacity(){var e;let t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.sendWindowCapacity>0)return;const i=()=>{"open"===this.status||"closing"===this.status?n(new S("Stream aborted")):t()};null===(e=r.signal)||void 0===e||e.addEventListener("abort",i);try{await new Promise(((e,r)=>{this.sendWindowCapacityUpdate=()=>{e()},n=r,t=e}))}finally{var o;null===(o=r.signal)||void 0===o||o.removeEventListener("abort",i)}}handleWindowUpdate(e){var t;null===(t=this.log)||void 0===t||t.trace("stream received window update id=%s",this._id),this.processFlags(e.flag);const n=this.sendWindowCapacity;var r;(this.sendWindowCapacity+=e.length,0===n&&e.length>0)&&(null===(r=this.sendWindowCapacityUpdate)||void 0===r||r.call(this))}async handleData(e,t){var n;if(null===(n=this.log)||void 0===n||n.trace("stream received data id=%s",this._id),this.processFlags(e.flag),this.recvWindowCapacity<e.length)throw new hm("Receive window exceeded");const r=await t();this.recvWindowCapacity-=e.length,this.sourcePush(r)}processFlags(e){(e&vm.ACK)===vm.ACK&&this.state===xm.SYNSent&&(this.state=xm.Established),(e&vm.FIN)===vm.FIN&&this.remoteCloseWrite(),(e&vm.RST)===vm.RST&&this.reset()}getSendFlags(){switch(this.state){case xm.Init:return this.state=xm.SYNSent,vm.SYN;case xm.SYNReceived:return this.state=xm.Established,vm.ACK;default:return 0}}sendWindowUpdate(){const e=this.getSendFlags(),t=Date.now(),n=this.getRTT();if(0===e&&n>-1&&t-this.epochStart<4*n&&(this.recvWindow=Math.min(2*this.recvWindow,this.config.maxStreamWindowSize)),this.recvWindowCapacity>=this.recvWindow&&0===e)return;const r=this.recvWindow-this.recvWindowCapacity;this.recvWindowCapacity=this.recvWindow,this.epochStart=t,this.sendFrame({type:mm.WindowUpdate,flag:e,streamID:this._id,length:r})}}const Pm="/yamux/1.0.0";class Am{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"protocol",Pm),w(this,"_components",void 0),w(this,"_init",void 0),w(this,Symbol.toStringTag,"@chainsafe/libp2p-yamux"),w(this,Uh,["@libp2p/stream-multiplexing"]),this._components=e,this._init=t}createStreamMuxer(e){return new Im(this._components,E(E({},this._init),e))}}class Im{constructor(e,t){var n;w(this,"protocol",Pm),w(this,"source",void 0),w(this,"sink",void 0),w(this,"config",void 0),w(this,"log",void 0),w(this,"logger",void 0),w(this,"closeController",void 0),w(this,"nextStreamID",void 0),w(this,"_streams",void 0),w(this,"nextPingID",void 0),w(this,"activePing",void 0),w(this,"rtt",void 0),w(this,"client",void 0),w(this,"localGoAway",void 0),w(this,"remoteGoAway",void 0),w(this,"numInboundStreams",void 0),w(this,"numOutboundStreams",void 0),w(this,"onIncomingStream",void 0),w(this,"onStreamEnd",void 0),this.client="outbound"===t.direction,this.config=E(E({},gm),t),this.logger=e.logger,this.log=this.logger.forComponent("libp2p:yamux"),function(e){if(e.keepAliveInterval<=0)throw new C("keep-alive interval must be positive");if(e.maxInboundStreams<0)throw new C("max inbound streams must be larger or equal 0");if(e.maxOutboundStreams<0)throw new C("max outbound streams must be larger or equal 0");if(e.initialStreamWindowSize<pm)throw new C("InitialStreamWindowSize must be larger or equal 256 kB");if(e.maxStreamWindowSize<e.initialStreamWindowSize)throw new C("MaxStreamWindowSize must be larger than the InitialStreamWindowSize");if(e.maxStreamWindowSize>2**32-1)throw new C("MaxStreamWindowSize must be less than equal MAX_UINT32");if(e.maxMessageSize<1024)throw new C("MaxMessageSize must be greater than a kilobyte")}(this.config),this.closeController=new AbortController,this.closeController.signal,this.onIncomingStream=t.onIncomingStream,this.onStreamEnd=t.onStreamEnd,this._streams=new Map,this.source=Rf({onEnd:()=>{var e;null===(e=this.log)||void 0===e||e.trace("muxer source ended"),this._streams.forEach((e=>{e.destroy()}))}}),this.sink=async e=>{var t;const n=()=>{const t=Lg(e);if(null!=t.return){const e=t.return();null!=(n=e)&&"function"===typeof n.then&&e.catch((e=>{var t;null===(t=this.log)||void 0===t||t.call(this,"could not cause sink source to return",e)}))}var n};let r,i;try{const t=new bm(e);try{this.closeController.signal.addEventListener("abort",n);var o,s=!1,a=!1;try{for(var l,c=Kc(t.emitFrames());s=!(l=await c.next()).done;s=!1){const e=l.value;await this.handleFrame(e.header,e.readData)}}catch(h){a=!0,o=h}finally{try{s&&null!=c.return&&await c.return()}finally{if(a)throw o}}}finally{this.closeController.signal.removeEventListener("abort",n)}r=ym.NormalTermination}catch(h){var u,d;if(fm.has(h.name))null===(u=this.log)||void 0===u||u.error("protocol error in sink",h),r=ym.ProtocolError;else null===(d=this.log)||void 0===d||d.error("internal error in sink",h),r=ym.InternalError;i=h}null===(t=this.log)||void 0===t||t.trace("muxer sink ended"),null!=i?this.abort(i,r):await this.close({reason:r})},this.numInboundStreams=0,this.numOutboundStreams=0,this.nextStreamID=this.client?1:2,this.nextPingID=0,this.rtt=-1,null===(n=this.log)||void 0===n||n.trace("muxer created"),this.config.enableKeepAlive&&this.keepAliveLoop().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("keepalive error: %s",e)})),this.ping().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("ping error: %s",e)}))}get streams(){return Array.from(this._streams.values())}newStream(e){var t;if(void 0!==this.remoteGoAway)throw new R("Muxer closed remotely");if(void 0!==this.localGoAway)throw new R("Muxer closed locally");const n=this.nextStreamID;if(this.nextStreamID+=2,this.numOutboundStreams>=this.config.maxOutboundStreams)throw new $("max outbound streams exceeded");null===(t=this.log)||void 0===t||t.trace("new outgoing stream id=%s",n);const r=this._newStream(n,e,xm.Init,"outbound");return this._streams.set(n,r),this.numOutboundStreams++,r.sendWindowUpdate(),r}async ping(){if(void 0!==this.remoteGoAway)throw new R("Muxer closed remotely");if(void 0!==this.localGoAway)throw new R("Muxer closed locally");if(void 0===this.activePing){let e=()=>{};this.activePing={id:this.nextPingID++,promise:new Promise(((t,n)=>{const r=()=>{n(new R("Muxer closed locally"))};this.closeController.signal.addEventListener("abort",r,{once:!0}),e=()=>{this.closeController.signal.removeEventListener("abort",r),t()}})),resolve:e};const t=Date.now();this.sendPing(this.activePing.id);try{await this.activePing.promise}finally{delete this.activePing}const n=Date.now();this.rtt=n-t}else await this.activePing.promise;return this.rtt}getRTT(){return this.rtt}async close(){var e,t,n;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.closeController.signal.aborted)return;const i=null!==(e=null===(t=r)||void 0===t?void 0:t.reason)&&void 0!==e?e:ym.NormalTermination;if(null===(n=this.log)||void 0===n||n.trace("muxer close reason=%s",i),null==r.signal){const e=AbortSignal.timeout(500);r=E(E({},r),{},{signal:e})}try{await Promise.all([...this._streams.values()].map((async e=>e.close(r)))),this.sendGoAway(i),this._closeMuxer()}catch(o){this.abort(o)}}abort(e,t){var n;if(!this.closeController.signal.aborted){t=null!==t&&void 0!==t?t:ym.InternalError,null===(n=this.log)||void 0===n||n.error("muxer abort reason=%s error=%s",t,e);for(const t of this._streams.values())t.abort(e);this.sendGoAway(t),this._closeMuxer()}}isClosed(){return this.closeController.signal.aborted}_closeMuxer(){this.closeController.abort(),this.source.end()}_newStream(e,t,n,r){if(null!=this._streams.get(e))throw new C("Stream already exists with that id");const i=new Cm({id:e.toString(),name:t,state:n,direction:r,sendFrame:this.sendFrame.bind(this),onEnd:()=>{var t;this.closeStream(e),null===(t=this.onStreamEnd)||void 0===t||t.call(this,i)},log:this.logger.forComponent("libp2p:yamux:".concat(r,":").concat(e)),config:this.config,getRTT:this.getRTT.bind(this)});return i}closeStream(e){this.client===(e%2===0)?this.numInboundStreams--:this.numOutboundStreams--,this._streams.delete(e)}async keepAliveLoop(){var e;const t=new Promise(((e,t)=>{this.closeController.signal.addEventListener("abort",t,{once:!0})}));for(null===(e=this.log)||void 0===e||e.trace("muxer keepalive enabled interval=%s",this.config.keepAliveInterval);;){let e;try{await Promise.race([t,new Promise((t=>{e=setTimeout(t,this.config.keepAliveInterval)}))]),this.ping().catch((e=>{var t;return null===(t=this.log)||void 0===t?void 0:t.error("ping error: %s",e)}))}catch(n){return void clearInterval(e)}}}async handleFrame(e,t){var n;const{streamID:r,type:i,length:o}=e;if(null===(n=this.log)||void 0===n||n.trace("received frame %o",e),0===r)switch(i){case mm.Ping:return void this.handlePing(e);case mm.GoAway:return void this.handleGoAway(o);default:throw new om("Invalid frame type")}else switch(e.type){case mm.Data:case mm.WindowUpdate:return void await this.handleStreamMessage(e,t);default:throw new om("Invalid frame type")}}handlePing(e){if(e.flag===vm.SYN){var t;null===(t=this.log)||void 0===t||t.trace("received ping request pingId=%s",e.length),this.sendPing(e.length,vm.ACK)}else{if(e.flag!==vm.ACK)throw new om("Invalid frame flag");var n;null===(n=this.log)||void 0===n||n.trace("received ping response pingId=%s",e.length),this.handlePingResponse(e.length)}}handlePingResponse(e){if(void 0===this.activePing)throw new sm("ping not requested");if(this.activePing.id!==e)throw new am("ping doesn't match our id");this.activePing.resolve()}handleGoAway(e){var t,n;null===(t=this.log)||void 0===t||t.trace("received GoAway reason=%s",null!==(n=ym[e])&&void 0!==n?n:"unknown"),this.remoteGoAway=e;for(const r of this._streams.values())r.reset();this._closeMuxer()}async handleStreamMessage(e,t){const{streamID:n,flag:r,type:i}=e;(r&vm.SYN)===vm.SYN&&this.incomingStream(n);const o=this._streams.get(n);if(void 0!==o)switch(i){case mm.WindowUpdate:return void o.handleWindowUpdate(e);case mm.Data:if(void 0===t)throw new Error("unreachable");return void await o.handleData(e,t);default:throw new Error("unreachable")}else if(i===mm.Data){var s;if(null===(s=this.log)||void 0===s||s.call(this,"discarding data for stream id=%s",n),void 0===t)throw new Error("unreachable");await t()}else{var a;null===(a=this.log)||void 0===a||a.trace("frame for missing stream id=%s",n)}}incomingStream(e){var t,n,r;if(this.client!==(e%2===0))throw new C("Both endpoints are clients");if(this._streams.has(e))return;if(null===(t=this.log)||void 0===t||t.trace("new incoming stream id=%s",e),void 0!==this.localGoAway)return void this.sendFrame({type:mm.WindowUpdate,flag:vm.RST,streamID:e,length:0});if(this.numInboundStreams>=this.config.maxInboundStreams)return null===(r=this.log)||void 0===r||r.call(this,"maxIncomingStreams exceeded, forcing stream reset"),void this.sendFrame({type:mm.WindowUpdate,flag:vm.RST,streamID:e,length:0});const i=this._newStream(e,void 0,xm.SYNReceived,"inbound");this.numInboundStreams++,this._streams.set(e,i),null===(n=this.onIncomingStream)||void 0===n||n.call(this,i)}sendFrame(e,t){var n;if(null===(n=this.log)||void 0===n||n.trace("sending frame %o",e),e.type===mm.Data){if(void 0===t)throw new om("Invalid frame");this.source.push(new se(Em(e),t))}else this.source.push(Em(e))}sendPing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vm.SYN;var n,r;t===vm.SYN?null===(n=this.log)||void 0===n||n.trace("sending ping request pingId=%s",e):null===(r=this.log)||void 0===r||r.trace("sending ping response pingId=%s",e);this.sendFrame({type:mm.Ping,flag:t,streamID:0,length:e})}sendGoAway(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ym.NormalTermination;null===(e=this.log)||void 0===e||e.call(this,"sending GoAway reason=%s",ym[t]),this.localGoAway=t,this.sendFrame({type:mm.GoAway,flag:0,streamID:0,length:t})}}function _m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Am(t,e)}function Tm(){const e=If();let t=!1;return{sink:async n=>{if(t)throw new Error("already piped");t=!0,e.resolve(n)},source:ru((function*(){const t=yield nu(e.promise);yield*dd(Kc(t))}))()}}var Lm;const Rm=65535,Nm=Boolean(null===(Lm=globalThis.process)||void 0===Lm||null===(Lm=Lm.env)||void 0===Lm?void 0:Lm.DUMP_SESSION_KEYS);function Mm(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Dm(e){if("boolean"!==typeof e)throw new Error("boolean expected, not ".concat(e))}function Om(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function zm(e){if(!Mm(e))throw new Error("Uint8Array expected");for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.length>0&&!n.includes(e.length))throw new Error("Uint8Array expected of length "+n+", got length="+e.length)}function Fm(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Um(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Bm(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;r++)t[r].fill(0)}const qm=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])();function Vm(e){if("string"===typeof e)e=function(e){if("string"!==typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!Mm(e))throw new Error("Uint8Array expected, got "+typeof e);e=Qm(e)}return e}const Km=(e,t)=>{function n(n){if(zm(n),!qm)throw new Error("Non little-endian hardware is not yet supported");for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];if(void 0!==e.nonceLength){const t=i[0];if(!t)throw new Error("nonce / iv required");e.varSizeNonce?zm(t):zm(t,e.nonceLength)}const s=e.tagLength;s&&void 0!==i[1]&&zm(i[1]);const a=t(n,...i),l=(e,t)=>{if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");zm(t)}};let c=!1;return{encrypt(e,t){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,zm(e),l(a.encrypt.length,t),a.encrypt(e,t)},decrypt(e,t){if(zm(e),s&&e.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return l(a.decrypt.length,t),a.decrypt(e,t)}}}return Object.assign(n,e),n};function jm(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&t.byteOffset%4!==0)throw new Error("invalid output, must be aligned");return t}function Wm(e,t,n,r){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),l=r?4:0,c=r?0:4;e.setUint32(t+l,s,r),e.setUint32(t+c,a,r)}function Hm(e,t,n){Dm(n);const r=new Uint8Array(16),i=(o=r,new DataView(o.buffer,o.byteOffset,o.byteLength));var o;return Wm(i,0,BigInt(t),n),Wm(i,8,BigInt(e),n),r}function Qm(e){return Uint8Array.from(e)}const Gm=e=>Uint8Array.from(e.split("").map((e=>e.charCodeAt(0)))),Ym=Gm("expand 16-byte k"),$m=Gm("expand 32-byte k"),Xm=Um(Ym),Zm=Um($m);function Jm(e,t){return e<<t|e>>>32-t}function ev(e){return e.byteOffset%4===0}const tv=2**32-1,nv=new Uint32Array;function rv(e,t){const{allowShortKeys:n,extendNonceFn:r,counterLength:i,counterRight:o,rounds:s}=function(e,t){if(null==t||"object"!==typeof t)throw new Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!==typeof e)throw new Error("core must be a function");return Om(i),Om(s),Dm(o),Dm(n),function(t,a,l,c){let u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;zm(t),zm(a),zm(l);const d=l.length;if(void 0===c&&(c=new Uint8Array(d)),zm(c),Om(u),u<0||u>=tv)throw new Error("arx: counter overflow");if(c.length<d)throw new Error("arx: output (".concat(c.length,") is shorter than data (").concat(d,")"));const h=[];let f,p,g=t.length;if(32===g)h.push(f=Qm(t)),p=Zm;else{if(16!==g||!n)throw new Error("arx: invalid 32-byte key, got length=".concat(g));f=new Uint8Array(32),f.set(t),f.set(t,16),p=Xm,h.push(f)}ev(a)||h.push(a=Qm(a));const m=Um(f);if(r){if(24!==a.length)throw new Error("arx: extended nonce must be 24 bytes");r(p,m,Um(a.subarray(0,16)),m),a=a.subarray(16)}const v=16-i;if(v!==a.length)throw new Error("arx: nonce must be ".concat(v," or 16 bytes"));if(12!==v){const e=new Uint8Array(12);e.set(a,o?0:12-a.length),a=e,h.push(a)}const y=Um(a);return function(e,t,n,r,i,o,s,a){const l=i.length,c=new Uint8Array(64),u=Um(c),d=ev(i)&&ev(o),h=d?Um(i):nv,f=d?Um(o):nv;for(let p=0;p<l;s++){if(e(t,n,r,u,s,a),s>=tv)throw new Error("arx: counter overflow");const g=Math.min(64,l-p);if(d&&64===g){const e=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let t,n=0;n<16;n++)t=e+n,f[t]=h[t]^u[n];p+=64}else{for(let e,t=0;t<g;t++)e=p+t,o[e]=i[e]^c[t];p+=g}}}(e,p,m,y,l,c,u,s),Bm(...h),c}}const iv=(e,t)=>255&e[t++]|(255&e[t++])<<8;class ov{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,zm(e=Vm(e),32);const t=iv(e,0),n=iv(e,2),r=iv(e,4),i=iv(e,6),o=iv(e,8),s=iv(e,10),a=iv(e,12),l=iv(e,14);this.r[0]=8191&t,this.r[1]=8191&(t>>>13|n<<3),this.r[2]=7939&(n>>>10|r<<6),this.r[3]=8191&(r>>>7|i<<9),this.r[4]=255&(i>>>4|o<<12),this.r[5]=o>>>1&8190,this.r[6]=8191&(o>>>14|s<<2),this.r[7]=8065&(s>>>11|a<<5),this.r[8]=8191&(a>>>8|l<<8),this.r[9]=l>>>5&127;for(let c=0;c<8;c++)this.pad[c]=iv(e,16+2*c)}process(e,t){const n=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?0:2048,{h:r,r:i}=this,o=i[0],s=i[1],a=i[2],l=i[3],c=i[4],u=i[5],d=i[6],h=i[7],f=i[8],p=i[9],g=iv(e,t+0),m=iv(e,t+2),v=iv(e,t+4),y=iv(e,t+6),w=iv(e,t+8),b=iv(e,t+10),E=iv(e,t+12),S=iv(e,t+14);let k=r[0]+(8191&g),x=r[1]+(8191&(g>>>13|m<<3)),C=r[2]+(8191&(m>>>10|v<<6)),P=r[3]+(8191&(v>>>7|y<<9)),A=r[4]+(8191&(y>>>4|w<<12)),I=r[5]+(w>>>1&8191),_=r[6]+(8191&(w>>>14|b<<2)),T=r[7]+(8191&(b>>>11|E<<5)),L=r[8]+(8191&(E>>>8|S<<8)),R=r[9]+(S>>>5|n),N=0,M=N+k*o+x*(5*p)+C*(5*f)+P*(5*h)+A*(5*d);N=M>>>13,M&=8191,M+=I*(5*u)+_*(5*c)+T*(5*l)+L*(5*a)+R*(5*s),N+=M>>>13,M&=8191;let D=N+k*s+x*o+C*(5*p)+P*(5*f)+A*(5*h);N=D>>>13,D&=8191,D+=I*(5*d)+_*(5*u)+T*(5*c)+L*(5*l)+R*(5*a),N+=D>>>13,D&=8191;let O=N+k*a+x*s+C*o+P*(5*p)+A*(5*f);N=O>>>13,O&=8191,O+=I*(5*h)+_*(5*d)+T*(5*u)+L*(5*c)+R*(5*l),N+=O>>>13,O&=8191;let z=N+k*l+x*a+C*s+P*o+A*(5*p);N=z>>>13,z&=8191,z+=I*(5*f)+_*(5*h)+T*(5*d)+L*(5*u)+R*(5*c),N+=z>>>13,z&=8191;let F=N+k*c+x*l+C*a+P*s+A*o;N=F>>>13,F&=8191,F+=I*(5*p)+_*(5*f)+T*(5*h)+L*(5*d)+R*(5*u),N+=F>>>13,F&=8191;let U=N+k*u+x*c+C*l+P*a+A*s;N=U>>>13,U&=8191,U+=I*o+_*(5*p)+T*(5*f)+L*(5*h)+R*(5*d),N+=U>>>13,U&=8191;let B=N+k*d+x*u+C*c+P*l+A*a;N=B>>>13,B&=8191,B+=I*s+_*o+T*(5*p)+L*(5*f)+R*(5*h),N+=B>>>13,B&=8191;let q=N+k*h+x*d+C*u+P*c+A*l;N=q>>>13,q&=8191,q+=I*a+_*s+T*o+L*(5*p)+R*(5*f),N+=q>>>13,q&=8191;let V=N+k*f+x*h+C*d+P*u+A*c;N=V>>>13,V&=8191,V+=I*l+_*a+T*s+L*o+R*(5*p),N+=V>>>13,V&=8191;let K=N+k*p+x*f+C*h+P*d+A*u;N=K>>>13,K&=8191,K+=I*c+_*l+T*a+L*s+R*o,N+=K>>>13,K&=8191,N=(N<<2)+N|0,N=N+M|0,M=8191&N,N>>>=13,D+=N,r[0]=M,r[1]=D,r[2]=O,r[3]=z,r[4]=F,r[5]=U,r[6]=B,r[7]=q,r[8]=V,r[9]=K}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let r=e[1]>>>13;e[1]&=8191;for(let s=2;s<10;s++)e[s]+=r,r=e[s]>>>13,e[s]&=8191;e[0]+=5*r,r=e[0]>>>13,e[0]&=8191,e[1]+=r,r=e[1]>>>13,e[1]&=8191,e[2]+=r,n[0]=e[0]+5,r=n[0]>>>13,n[0]&=8191;for(let s=1;s<10;s++)n[s]=e[s]+r,r=n[s]>>>13,n[s]&=8191;n[9]-=8192;let i=(1^r)-1;for(let s=0;s<10;s++)n[s]&=i;i=~i;for(let s=0;s<10;s++)e[s]=e[s]&i|n[s];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let o=e[0]+t[0];e[0]=65535&o;for(let s=1;s<8;s++)o=(e[s]+t[s]|0)+(o>>>16)|0,e[s]=65535&o;Bm(n)}update(e){Fm(this),zm(e=Vm(e));const{buffer:t,blockLen:n}=this,r=e.length;for(let i=0;i<r;){const o=Math.min(n-this.pos,r-i);if(o!==n)t.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(t,0,!1),this.pos=0);else for(;n<=r-i;i+=n)this.process(e,i)}return this}destroy(){Bm(this.h,this.r,this.buffer,this.pad)}digestInto(e){Fm(this),function(e,t){zm(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:r}=this;if(r){for(t[r++]=1;r<16;r++)t[r]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}const sv=function(e){const t=(t,n)=>e(n).update(Vm(t)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t}((e=>new ov(e)));function av(e,t,n,r,i){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:20,s=e[0],a=e[1],l=e[2],c=e[3],u=t[0],d=t[1],h=t[2],f=t[3],p=t[4],g=t[5],m=t[6],v=t[7],y=i,w=n[0],b=n[1],E=n[2],S=s,k=a,x=l,C=c,P=u,A=d,I=h,_=f,T=p,L=g,R=m,N=v,M=y,D=w,O=b,z=E;for(let U=0;U<o;U+=2)S=S+P|0,M=Jm(M^S,16),T=T+M|0,P=Jm(P^T,12),S=S+P|0,M=Jm(M^S,8),T=T+M|0,P=Jm(P^T,7),k=k+A|0,D=Jm(D^k,16),L=L+D|0,A=Jm(A^L,12),k=k+A|0,D=Jm(D^k,8),L=L+D|0,A=Jm(A^L,7),x=x+I|0,O=Jm(O^x,16),R=R+O|0,I=Jm(I^R,12),x=x+I|0,O=Jm(O^x,8),R=R+O|0,I=Jm(I^R,7),C=C+_|0,z=Jm(z^C,16),N=N+z|0,_=Jm(_^N,12),C=C+_|0,z=Jm(z^C,8),N=N+z|0,_=Jm(_^N,7),S=S+A|0,z=Jm(z^S,16),R=R+z|0,A=Jm(A^R,12),S=S+A|0,z=Jm(z^S,8),R=R+z|0,A=Jm(A^R,7),k=k+I|0,M=Jm(M^k,16),N=N+M|0,I=Jm(I^N,12),k=k+I|0,M=Jm(M^k,8),N=N+M|0,I=Jm(I^N,7),x=x+_|0,D=Jm(D^x,16),T=T+D|0,_=Jm(_^T,12),x=x+_|0,D=Jm(D^x,8),T=T+D|0,_=Jm(_^T,7),C=C+P|0,O=Jm(O^C,16),L=L+O|0,P=Jm(P^L,12),C=C+P|0,O=Jm(O^C,8),L=L+O|0,P=Jm(P^L,7);let F=0;r[F++]=s+S|0,r[F++]=a+k|0,r[F++]=l+x|0,r[F++]=c+C|0,r[F++]=u+P|0,r[F++]=d+A|0,r[F++]=h+I|0,r[F++]=f+_|0,r[F++]=p+T|0,r[F++]=g+L|0,r[F++]=m+R|0,r[F++]=v+N|0,r[F++]=y+M|0,r[F++]=w+D|0,r[F++]=b+O|0,r[F++]=E+z|0}const lv=rv(av,{counterRight:!1,counterLength:4,allowShortKeys:!1}),cv=rv(av,{counterRight:!1,counterLength:8,extendNonceFn:function(e,t,n,r){let i=e[0],o=e[1],s=e[2],a=e[3],l=t[0],c=t[1],u=t[2],d=t[3],h=t[4],f=t[5],p=t[6],g=t[7],m=n[0],v=n[1],y=n[2],w=n[3];for(let E=0;E<20;E+=2)i=i+l|0,m=Jm(m^i,16),h=h+m|0,l=Jm(l^h,12),i=i+l|0,m=Jm(m^i,8),h=h+m|0,l=Jm(l^h,7),o=o+c|0,v=Jm(v^o,16),f=f+v|0,c=Jm(c^f,12),o=o+c|0,v=Jm(v^o,8),f=f+v|0,c=Jm(c^f,7),s=s+u|0,y=Jm(y^s,16),p=p+y|0,u=Jm(u^p,12),s=s+u|0,y=Jm(y^s,8),p=p+y|0,u=Jm(u^p,7),a=a+d|0,w=Jm(w^a,16),g=g+w|0,d=Jm(d^g,12),a=a+d|0,w=Jm(w^a,8),g=g+w|0,d=Jm(d^g,7),i=i+c|0,w=Jm(w^i,16),p=p+w|0,c=Jm(c^p,12),i=i+c|0,w=Jm(w^i,8),p=p+w|0,c=Jm(c^p,7),o=o+u|0,m=Jm(m^o,16),g=g+m|0,u=Jm(u^g,12),o=o+u|0,m=Jm(m^o,8),g=g+m|0,u=Jm(u^g,7),s=s+d|0,v=Jm(v^s,16),h=h+v|0,d=Jm(d^h,12),s=s+d|0,v=Jm(v^s,8),h=h+v|0,d=Jm(d^h,7),a=a+l|0,y=Jm(y^a,16),f=f+y|0,l=Jm(l^f,12),a=a+l|0,y=Jm(y^a,8),f=f+y|0,l=Jm(l^f,7);let b=0;r[b++]=i,r[b++]=o,r[b++]=s,r[b++]=a,r[b++]=m,r[b++]=v,r[b++]=y,r[b++]=w},allowShortKeys:!1}),uv=new Uint8Array(16),dv=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(uv.subarray(n))},hv=new Uint8Array(32);function fv(e,t,n,r,i){const o=e(t,n,hv),s=sv.create(o);i&&dv(s,i),dv(s,r);const a=Hm(r.length,i?i.length:0,!0);s.update(a);const l=s.digest();return Bm(o,a),l}const pv=e=>(t,n,r)=>{const i=16;return{encrypt(o,s){const a=o.length;(s=jm(a+i,s,!1)).set(o);const l=s.subarray(0,-16);e(t,n,l,l,1);const c=fv(e,t,n,l,r);return s.set(c,a),Bm(c),s},decrypt(o,s){s=jm(o.length-i,s,!1);const a=o.subarray(0,-16),l=o.subarray(-16),c=fv(e,t,n,a,r);if(!function(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n}(l,c))throw new Error("invalid tag");return s.set(o.subarray(0,-16)),e(t,n,s,s,1),Bm(c),s}}},gv=Km({blockSize:64,nonceLength:12,tagLength:16},pv(lv));pv(cv);function mv(e,t,n){return kn(e),void 0===n&&(n=new Uint8Array(e.outputLen)),ws(e,_n(n),_n(t))}const vv=Uint8Array.from([0]),yv=Uint8Array.of();function wv(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32;kn(e),En(r);const i=e.outputLen;if(r>255*i)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/i);void 0===n&&(n=yv);const s=new Uint8Array(o*i),a=ws.create(e,t),l=a._cloneInto(),c=new Uint8Array(a.outputLen);for(let u=0;u<o;u++)vv[0]=u+1,l.update(0===u?yv:c).update(n).update(vv).digestInto(c),s.set(c,i*u),a._cloneInto(l);return a.destroy(),l.destroy(),Cn(c,vv),s.slice(0,r)}const bv={hashSHA256:e=>rs(e.subarray()),getHKDF(e,t){const n=mv(rs,t,e),r=wv(rs,n,void 0,96);return[r.subarray(0,32),r.subarray(32,64),r.subarray(64,96)]},generateX25519KeyPair(){const e=Gi.utils.randomPrivateKey();return{publicKey:Gi.getPublicKey(e),privateKey:e}},generateX25519KeyPairFromSeed:e=>({publicKey:Gi.getPublicKey(e),privateKey:e}),generateX25519SharedKey:(e,t)=>Gi.getSharedSecret(e.subarray(),t.subarray()),chaCha20Poly1305Encrypt:(e,t,n,r)=>gv(r,t,n).encrypt(e.subarray()),chaCha20Poly1305Decrypt:(e,t,n,r,i)=>gv(r,t,n).decrypt(e.subarray(),i)},Ev=bv;const Sv=e=>{const t=ee(2);return t[0]=e>>8,t[1]=e,t};Sv.bytes=2;const kv=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");if(e instanceof Uint8Array){let t=0;return t+=e[0]<<8,t+=e[1],t}return e.getUint16(0)};function xv(e,t){t.enabled&&Nm&&(e?(t("LOCAL_STATIC_PUBLIC_KEY ".concat(Wt(e.publicKey,"hex"))),t("LOCAL_STATIC_PRIVATE_KEY ".concat(Wt(e.privateKey,"hex")))):t("Missing local static keys."))}function Cv(e,t){t.enabled&&Nm&&(e?(t("LOCAL_PUBLIC_EPHEMERAL_KEY ".concat(Wt(e.publicKey,"hex"))),t("LOCAL_PRIVATE_EPHEMERAL_KEY ".concat(Wt(e.privateKey,"hex")))):t("Missing local ephemeral keys."))}function Pv(e,t){t.enabled&&Nm&&t(e?"REMOTE_EPHEMERAL_PUBLIC_KEY ".concat(Wt(e.subarray(),"hex")):"Missing remote ephemeral keys.")}function Av(e,t,n){n.enabled&&Nm&&(n("CIPHER_STATE_1 ".concat(e.n.getUint64()," ").concat(e.k&&Wt(e.k,"hex"))),n("CIPHER_STATE_2 ".concat(t.n.getUint64()," ").concat(t.k&&Wt(t.k,"hex"))))}kv.bytes=2;class Iv extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid crypto exchange"),w(this,"code",void 0),this.code=Iv.code}}w(Iv,"code","ERR_INVALID_CRYPTO_EXCHANGE");class _v{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;w(this,"n",void 0),w(this,"bytes",void 0),w(this,"view",void 0),this.n=e,this.bytes=J(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,e,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error("Cipherstate has reached maximum n, a new handshake must be performed")}}const Tv=J(0);class Lv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;w(this,"k",void 0),w(this,"n",void 0),w(this,"crypto",void 0),this.crypto=e,this.k=t,this.n=new _v(n)}hasKey(){return Boolean(this.k)}encryptWithAd(e,t){if(!this.hasKey())return t;this.n.assertValue();const n=this.crypto.encrypt(t,this.n.getBytes(),e,this.k);return this.n.increment(),n}decryptWithAd(e,t,n){if(!this.hasKey())return t;this.n.assertValue();const r=this.crypto.decrypt(t,this.n.getBytes(),e,this.k,n);return this.n.increment(),r}}class Rv{constructor(e,t){w(this,"cs",void 0),w(this,"ck",void 0),w(this,"h",void 0),w(this,"crypto",void 0),this.crypto=e;const n=jt(t,"utf-8");this.h=function(e,t){if(t.length<=32){const e=J(32);return e.set(t),e}return e.hash(t)}(e,n),this.ck=this.h,this.cs=new Lv(e)}mixKey(e){const[t,n]=this.crypto.hkdf(this.ck,e);this.ck=t,this.cs=new Lv(this.crypto,n)}mixHash(e){this.h=this.crypto.hash(new se(this.h,e))}encryptAndHash(e){const t=this.cs.encryptWithAd(this.h,e);return this.mixHash(t),t}decryptAndHash(e){const t=this.cs.decryptWithAd(this.h,e);return this.mixHash(e),t}split(){const[e,t]=this.crypto.hkdf(this.ck,Tv);return[new Lv(this.crypto,e),new Lv(this.crypto,t)]}}class Nv{constructor(e){w(this,"ss",void 0),w(this,"s",void 0),w(this,"e",void 0),w(this,"rs",void 0),w(this,"re",void 0),w(this,"initiator",void 0),w(this,"crypto",void 0);const{crypto:t,protocolName:n,prologue:r,initiator:i,s:o,e:s,rs:a,re:l}=e;this.crypto=t,this.ss=new Rv(t,n),this.ss.mixHash(r),this.initiator=i,this.s=o,this.e=s,this.rs=a,this.re=l}writeE(){if(this.e)throw new Error("ephemeral keypair is already set");const e=this.crypto.generateKeypair();return this.ss.mixHash(e.publicKey),this.e=e,e.publicKey}writeS(){if(!this.s)throw new Error("static keypair is not set");return this.ss.encryptAndHash(this.s.publicKey)}writeEE(){if(!this.e)throw new Error("ephemeral keypair is not set");if(!this.re)throw new Error("remote ephemeral public key is not set");this.ss.mixKey(this.crypto.dh(this.e,this.re))}writeES(){if(this.initiator){if(!this.e)throw new Error("ephemeral keypair is not set");if(!this.rs)throw new Error("remote static public key is not set");this.ss.mixKey(this.crypto.dh(this.e,this.rs))}else{if(!this.s)throw new Error("static keypair is not set");if(!this.re)throw new Error("remote ephemeral public key is not set");this.ss.mixKey(this.crypto.dh(this.s,this.re))}}writeSE(){if(this.initiator){if(!this.s)throw new Error("static keypair is not set");if(!this.re)throw new Error("remote ephemeral public key is not set");this.ss.mixKey(this.crypto.dh(this.s,this.re))}else{if(!this.e)throw new Error("ephemeral keypair is not set");if(!this.rs)throw new Error("remote static public key is not set");this.ss.mixKey(this.crypto.dh(this.e,this.rs))}}readE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.re)throw new Error("remote ephemeral public key is already set");if(e.byteLength<t+32)throw new Error("message is not long enough");this.re=e.sublist(t,t+32),this.ss.mixHash(this.re)}readS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.rs)throw new Error("remote static public key is already set");const n=32+(this.ss.cs.hasKey()?16:0);if(e.byteLength<t+n)throw new Error("message is not long enough");const r=e.sublist(t,t+n);return this.rs=this.ss.decryptAndHash(r),n}readEE(){this.writeEE()}readES(){this.writeES()}readSE(){this.writeSE()}}class Mv extends Nv{writeMessageA(e){return new se(this.writeE(),this.ss.encryptAndHash(e))}writeMessageB(e){const t=this.writeE();this.writeEE();const n=this.writeS();return this.writeES(),new se(t,n,this.ss.encryptAndHash(e))}writeMessageC(e){const t=this.writeS();return this.writeSE(),new se(t,this.ss.encryptAndHash(e))}readMessageA(e){try{return this.readE(e),this.ss.decryptAndHash(e.sublist(32))}catch(t){throw new Iv("handshake stage 0 validation fail: ".concat(t.message))}}readMessageB(e){try{this.readE(e),this.readEE();const t=this.readS(e,32);return this.readES(),this.ss.decryptAndHash(e.sublist(32+t))}catch(t){throw new Iv("handshake stage 1 validation fail: ".concat(t.message))}}readMessageC(e){try{const t=this.readS(e);return this.readSE(),this.ss.decryptAndHash(e.sublist(t))}catch(t){throw new Iv("handshake stage 2 validation fail: ".concat(t.message))}}}var Dv,Ov;async function zv(e,t,n){const r=await e.sign(Uv(t));return Ov.encode({identityKey:Qs(e.publicKey),identitySig:r,extensions:n})}async function Fv(e,t,n){try{const r=Ov.decode(e),i=Hs(r.identityKey);if(!1===(null===n||void 0===n?void 0:n.equals(i)))throw new Error("Payload identity key ".concat(i," does not match expected remote identity key ").concat(n));if(!t)throw new Error("Remote static does not exist");const o=Uv(t);if(!await i.verify(o,r.identitySig))throw new Error("Invalid payload signature");return r}catch(r){throw new k(r.message)}}function Uv(e){const t=jt("noise-libp2p-static-key:");return e instanceof Uint8Array?te([t,e],t.length+e.length):(e.prepend(t),e)}async function Bv(e,t){const{log:n,connection:r,crypto:i,privateKey:o,prologue:s,s:a,remoteIdentityKey:l,extensions:c}=e,u=await zv(o,a.publicKey,c),d=new Mv({crypto:i,protocolName:"Noise_XX_25519_ChaChaPoly_SHA256",initiator:!0,prologue:s,s:a});xv(d.s,n),n.trace("Stage 0 - Initiator starting to send first message."),await r.write(d.writeMessageA(Tv),t),n.trace("Stage 0 - Initiator finished sending first message."),Cv(d.e,n),n.trace("Stage 1 - Initiator waiting to receive first message from responder...");const h=d.readMessageB(await r.read(t));var f,p;n.trace("Stage 1 - Initiator received the message."),Pv(d.re,n),f=d.rs,(p=n).enabled&&Nm&&p(f?"REMOTE_STATIC_PUBLIC_KEY ".concat(Wt(f.subarray(),"hex")):"Missing remote static public key."),n.trace("Initiator going to check remote's signature...");const g=await Fv(h,d.rs,l);n.trace("All good with the signature!"),n.trace("Stage 2 - Initiator sending third handshake message."),await r.write(d.writeMessageC(u),t),n.trace("Stage 2 - Initiator sent message with signed payload.");const[m,v]=d.ss.split();return Av(m,v,n),{payload:g,encrypt:e=>m.encryptWithAd(Tv,e),decrypt:(e,t)=>v.decryptWithAd(Tv,e,t)}}!function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.webtransportCerthashes)for(const r of e.webtransportCerthashes)t.uint32(10),t.bytes(r);if(null!=e.streamMuxers)for(const r of e.streamMuxers)t.uint32(18),t.string(r);!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={webtransportCerthashes:[],streamMuxers:[]},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:var o;if(null!=(null===(o=n.limits)||void 0===o?void 0:o.webtransportCerthashes)&&r.webtransportCerthashes.length===n.limits.webtransportCerthashes)throw new ts('Decode error - map field "webtransportCerthashes" had too many elements');r.webtransportCerthashes.push(e.bytes());break;case 2:var s;if(null!=(null===(s=n.limits)||void 0===s?void 0:s.streamMuxers)&&r.streamMuxers.length===n.limits.streamMuxers)throw new ts('Decode error - map field "streamMuxers" had too many elements');r.streamMuxers.push(e.string());break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(Dv||(Dv={})),function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.identityKey&&e.identityKey.byteLength>0&&(t.uint32(10),t.bytes(e.identityKey)),null!=e.identitySig&&e.identitySig.byteLength>0&&(t.uint32(18),t.bytes(e.identitySig)),null!=e.extensions&&(t.uint32(34),Dv.codec().encode(e.extensions,t)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={identityKey:J(0),identitySig:J(0)},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:r.identityKey=e.bytes();break;case 2:r.identitySig=e.bytes();break;case 4:var o;r.extensions=Dv.codec().decode(e,e.uint32(),{limits:null===(o=n.limits)||void 0===o?void 0:o.extensions});break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(Ov||(Ov={}));class qv{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"protocol","/noise"),w(this,"crypto",void 0),w(this,"prologue",void 0),w(this,"staticKey",void 0),w(this,"extensions",void 0),w(this,"metrics",void 0),w(this,"components",void 0),w(this,Symbol.toStringTag,"@chainsafe/libp2p-noise"),w(this,Uh,["@libp2p/connection-encryption","@chainsafe/libp2p-noise"]);const{staticNoiseKey:n,extensions:r,crypto:i,prologueBytes:o}=t,{metrics:s}=e;this.components=e;const a=null!==i&&void 0!==i?i:Ev;this.crypto=function(e){return{generateKeypair:e.generateX25519KeyPair,dh:(t,n)=>e.generateX25519SharedKey(t.privateKey,n).subarray(0,32),encrypt:e.chaCha20Poly1305Encrypt,decrypt:e.chaCha20Poly1305Decrypt,hash:e.hashSHA256,hkdf:e.getHKDF}}(a),this.extensions=E({webtransportCerthashes:[]},r),this.metrics=s?function(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}(s):void 0,this.staticKey=n?a.generateX25519KeyPairFromSeed(n):a.generateX25519KeyPair(),this.prologue=null!==o&&void 0!==o?o:J(0)}async secureOutbound(e,t){var n,r;const i=$p(e,{lengthEncoder:Sv,lengthDecoder:kv,maxDataLength:Rm}),o=await this.performHandshakeInitiator(i,this.components.privateKey,null===t||void 0===t||null===(n=t.remotePeer)||void 0===n?void 0:n.publicKey,t),s=await this.createSecureConnection(i,o);e.source=s.source,e.sink=s.sink;const a=Hs(o.payload.identityKey);return{conn:e,remoteExtensions:o.payload.extensions,remotePeer:ia(a),streamMuxer:!0===(null===t||void 0===t?void 0:t.skipStreamMuxerNegotiation)?void 0:this.getStreamMuxer(null===(r=o.payload.extensions)||void 0===r?void 0:r.streamMuxers)}}getStreamMuxer(e){if(null==e||0===e.length)return;const t=this.components.upgrader.getStreamMuxers();if(null!=t)for(const n of e){const e=t.get(n);if(null!=e)return e}if(e.length)throw new x("Early muxer negotiation was requested but the initiator and responder had no common muxers")}async secureInbound(e,t){var n,r;const i=$p(e,{lengthEncoder:Sv,lengthDecoder:kv,maxDataLength:Rm}),o=await this.performHandshakeResponder(i,this.components.privateKey,null===t||void 0===t||null===(n=t.remotePeer)||void 0===n?void 0:n.publicKey,t),s=await this.createSecureConnection(i,o);e.source=s.source,e.sink=s.sink;const a=Hs(o.payload.identityKey);return{conn:e,remoteExtensions:o.payload.extensions,remotePeer:ia(a),streamMuxer:!0===(null===t||void 0===t?void 0:t.skipStreamMuxerNegotiation)?void 0:this.getStreamMuxer(null===(r=o.payload.extensions)||void 0===r?void 0:r.streamMuxers)}}async performHandshakeInitiator(e,t,n,r){let i;const o=!0===(null===r||void 0===r?void 0:r.skipStreamMuxerNegotiation)?[]:[...this.components.upgrader.getStreamMuxers().keys()];try{var s;i=await Bv({connection:e,privateKey:t,remoteIdentityKey:n,log:this.components.logger.forComponent("libp2p:noise:xxhandshake"),crypto:this.crypto,prologue:this.prologue,s:this.staticKey,extensions:E({streamMuxers:o,webtransportCerthashes:[]},this.extensions)},r),null===(s=this.metrics)||void 0===s||s.xxHandshakeSuccesses.increment()}catch(l){var a;throw null===(a=this.metrics)||void 0===a||a.xxHandshakeErrors.increment(),l}return i}async performHandshakeResponder(e,t,n,r){let i;const o=!0===(null===r||void 0===r?void 0:r.skipStreamMuxerNegotiation)?[]:[...this.components.upgrader.getStreamMuxers().keys()];try{var s;i=await async function(e,t){const{log:n,connection:r,crypto:i,privateKey:o,prologue:s,s:a,remoteIdentityKey:l,extensions:c}=e,u=await zv(o,a.publicKey,c),d=new Mv({crypto:i,protocolName:"Noise_XX_25519_ChaChaPoly_SHA256",initiator:!1,prologue:s,s:a});xv(d.s,n),n.trace("Stage 0 - Responder waiting to receive first message."),d.readMessageA(await r.read(t)),n.trace("Stage 0 - Responder received first message."),Pv(d.re,n),n.trace("Stage 1 - Responder sending out first message with signed payload and static key."),await r.write(d.writeMessageB(u),t),n.trace("Stage 1 - Responder sent the second handshake message with signed payload."),Cv(d.e,n),n.trace("Stage 2 - Responder waiting for third handshake message...");const h=d.readMessageC(await r.read(t));n.trace("Stage 2 - Responder received the message, finished handshake.");const f=await Fv(h,d.rs,l),[p,g]=d.ss.split();return Av(p,g,n),{payload:f,encrypt:e=>g.encryptWithAd(Tv,e),decrypt:(e,t)=>p.decryptWithAd(Tv,e,t)}}({connection:e,privateKey:t,remoteIdentityKey:n,log:this.components.logger.forComponent("libp2p:noise:xxhandshake"),crypto:this.crypto,prologue:this.prologue,s:this.staticKey,extensions:E({streamMuxers:o,webtransportCerthashes:[]},this.extensions)},r),null===(s=this.metrics)||void 0===s||s.xxHandshakeSuccesses.increment()}catch(l){var a;throw null===(a=this.metrics)||void 0===a||a.xxHandshakeErrors.increment(),l}return i}async createSecureConnection(e,t){const[n,r]=function(){const e=Tm(),t=Tm();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}(),i=e.unwrap();return await Ng(n,function(e,t){return function(){var n=ru((function*(n){var r,i=!1,o=!1;try{for(var s,a=Kc(n);i=!(s=yield nu(a.next())).done;i=!1){const n=s.value;for(let r=0;r<n.length;r+=65519){let i,o=r+65519;o>n.length&&(o=n.length),i=n instanceof Uint8Array?e.encrypt(n.subarray(r,o)):e.encrypt(n.sublist(r,o)),null===t||void 0===t||t.encryptedPackets.increment(),yield new se(Sv(i.byteLength),i)}}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}));return function(e){return n.apply(this,arguments)}}()}(t,this.metrics),i,(e=>Hp(e,{lengthDecoder:kv})),function(e,t){return function(){var n=ru((function*(n){var r,i=!1,o=!1;try{for(var s,a=Kc(n);i=!(s=yield nu(a.next())).done;i=!1){const n=s.value;for(let r=0;r<n.length;r+=Rm){let i=r+Rm;if(i>n.length&&(i=n.length),i-16<r)throw new Error("Invalid chunk");const o=n.sublist(r,i),s=n.subarray(r,i-16);try{const n=e.decrypt(o,s);null===t||void 0===t||t.decryptedPackets.increment(),yield n}catch(l){throw null===t||void 0===t||t.decryptErrors.increment(),l}}}}catch(c){o=!0,r=c}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}));return function(e){return n.apply(this,arguments)}}()}(t,this.metrics),n),r}}function Vv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new qv(t,e)}const Kv=36e5,jv=36*Kv,Wv=48*Kv,Hv=Kv,Qv="".concat(ep,"-kad-dht");var Gv;function Yv(e){const t=e.getUTCFullYear(),n=String(e.getUTCMonth()+1).padStart(2,"0"),r=String(e.getUTCDate()).padStart(2,"0"),i=String(e.getUTCHours()).padStart(2,"0"),o=String(e.getUTCMinutes()).padStart(2,"0"),s=String(e.getUTCSeconds()).padStart(2,"0"),a=e.getUTCMilliseconds(),l=String(1e3*a*1e3).padStart(9,"0");return"".concat(t,"-").concat(n,"-").concat(r,"T").concat(i,":").concat(o,":").concat(s,".").concat(l,"Z")}!function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&e.key.byteLength>0&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&e.value.byteLength>0&&(t.uint32(18),t.bytes(e.value)),null!=e.timeReceived&&""!==e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={key:J(0),value:J(0),timeReceived:""},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(Gv||(Gv={}));class $v{constructor(e,t,n){if(w(this,"key",void 0),w(this,"value",void 0),w(this,"timeReceived",void 0),!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=n}serialize(){return Gv.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:Yv(this.timeReceived)}}static deserialize(e){const t=Gv.decode(e);return new $v(t.key,t.value,new Date(t.timeReceived))}static fromDeserialized(e){const t=function(e){const t=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),n=String(e).trim().match(t);if(null==n)throw new Error("Invalid format");const r=parseInt(n[1],10),i=parseInt(n[2],10)-1,o=parseInt(n[3],10),s=parseInt(n[4],10),a=parseInt(n[5],10),l=parseInt(n[6],10),c=parseInt(n[7].slice(0,-6),10);return new Date(Date.UTC(r,i,o,s,a,l,c))}(e.timeReceived);if(null==e.key)throw new Error("key missing from deserialized object");if(null==e.value)throw new Error("value missing from deserialized object");return new $v(e.key,e.value,t)}}const Xv=function(e,t){let n=0;if(null!=e[Symbol.asyncIterator])return ru((function*(){var r,i=!1,o=!1;try{for(var s,a=Kc(e);i=!(s=yield nu(a.next())).done;i=!1){const e=s.value;yield t(e,n++)}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}))();const r=cd(e),{value:i,done:o}=r.next();if(!0===o)return function*(){}();const s=t(i,n++);if("function"===typeof s.then)return ru((function*(){yield yield nu(s);var e,i=!1,o=!1;try{for(var a,l=Kc(r);i=!(a=yield nu(l.next())).done;i=!1){const e=a.value;yield t(e,n++)}}catch(c){o=!0,e=c}finally{try{i&&null!=l.return&&(yield nu(l.return()))}finally{if(o)throw e}}}))();const a=t;return function*(){yield s;for(const e of r)yield a(e,n++)}()};class Zv extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Query error"),this.name="QueryError"}}class Jv extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Query aborted"),this.name="QueryAbortedError"}}class ey extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid record"),this.name="InvalidRecordError"}}class ty extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"No selector function configured for prefix"),this.name="MissingSelectorError"}}var ny,ry,iy,oy,sy,ay,ly;function cy(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=E(E({},e),{},{name:"SEND_QUERY",type:0,messageName:e.type,messageType:e.type});return null===(t=n.onProgress)||void 0===t||t.call(n,new CustomEvent("kad-dht:query:send-query",{detail:r})),r}function uy(e){var t,n,r;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=E(E({},e),{},{name:"PEER_RESPONSE",type:1,messageName:e.messageType,closer:null!==(t=e.closer)&&void 0!==t?t:[],providers:null!==(n=e.providers)&&void 0!==n?n:[]});return null===(r=i.onProgress)||void 0===r||r.call(i,new CustomEvent("kad-dht:query:peer-response",{detail:o})),o}function dy(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=E(E({},e),{},{name:"FINAL_PEER",type:2});return null===(t=n.onProgress)||void 0===t||t.call(n,new CustomEvent("kad-dht:query:final-peer",{detail:r})),r}function hy(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=E(E({},e),{},{name:"QUERY_ERROR",type:3});return null===(t=n.onProgress)||void 0===t||t.call(n,new CustomEvent("kad-dht:query:query-error",{detail:r})),r}function fy(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=E(E({},e),{},{name:"PROVIDER",type:4});return null===(t=n.onProgress)||void 0===t||t.call(n,new CustomEvent("kad-dht:query:provider",{detail:r})),r}function py(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=E(E({},e),{},{name:"VALUE",type:5});return null===(t=n.onProgress)||void 0===t||t.call(n,new CustomEvent("kad-dht:query:value",{detail:r})),r}function gy(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=E(E({},e),{},{name:"DIAL_PEER",type:7});return null===(t=n.onProgress)||void 0===t||t.call(n,new CustomEvent("kad-dht:query:dial-peer",{detail:r})),r}!function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&t.fork(),null!=e.key&&(t.uint32(10),t.bytes(e.key)),null!=e.value&&(t.uint32(18),t.bytes(e.value)),null!=e.author&&(t.uint32(26),t.bytes(e.author)),null!=e.signature&&(t.uint32(34),t.bytes(e.signature)),null!=e.timeReceived&&(t.uint32(42),t.string(e.timeReceived)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){const n={},r=null==t?e.len:e.pos+t;for(;e.pos<r;){const t=e.uint32();switch(t>>>3){case 1:n.key=e.bytes();break;case 2:n.value=e.bytes();break;case 3:n.author=e.bytes();break;case 4:n.signature=e.bytes();break;case 5:n.timeReceived=e.string();break;default:e.skipType(7&t)}}return n}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(ny||(ny={})),function(e){e.PUT_VALUE="PUT_VALUE",e.GET_VALUE="GET_VALUE",e.ADD_PROVIDER="ADD_PROVIDER",e.GET_PROVIDERS="GET_PROVIDERS",e.FIND_NODE="FIND_NODE",e.PING="PING"}(ry||(ry={})),function(e){e[e.PUT_VALUE=0]="PUT_VALUE",e[e.GET_VALUE=1]="GET_VALUE",e[e.ADD_PROVIDER=2]="ADD_PROVIDER",e[e.GET_PROVIDERS=3]="GET_PROVIDERS",e[e.FIND_NODE=4]="FIND_NODE",e[e.PING=5]="PING"}(iy||(iy={})),function(e){e.codec=()=>Jo(iy)}(ry||(ry={})),function(e){e.NOT_CONNECTED="NOT_CONNECTED",e.CONNECTED="CONNECTED",e.CAN_CONNECT="CAN_CONNECT",e.CANNOT_CONNECT="CANNOT_CONNECT"}(oy||(oy={})),function(e){e[e.NOT_CONNECTED=0]="NOT_CONNECTED",e[e.CONNECTED=1]="CONNECTED",e[e.CAN_CONNECT=2]="CAN_CONNECT",e[e.CANNOT_CONNECT=3]="CANNOT_CONNECT"}(sy||(sy={})),function(e){e.codec=()=>Jo(sy)}(oy||(oy={})),function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.id&&e.id.byteLength>0&&(t.uint32(10),t.bytes(e.id)),null!=e.multiaddrs)for(const r of e.multiaddrs)t.uint32(18),t.bytes(r);null!=e.connection&&(t.uint32(24),oy.codec().encode(e.connection,t)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={id:J(0),multiaddrs:[]},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:r.id=e.bytes();break;case 2:var o;if(null!=(null===(o=n.limits)||void 0===o?void 0:o.multiaddrs)&&r.multiaddrs.length===n.limits.multiaddrs)throw new ts('Decode error - map field "multiaddrs" had too many elements');r.multiaddrs.push(e.bytes());break;case 3:r.connection=oy.codec().decode(e);break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(ay||(ay={})),function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.type&&0!==iy[e.type]&&(t.uint32(8),ry.codec().encode(e.type,t)),null!=e.clusterLevel&&(t.uint32(80),t.int32(e.clusterLevel)),null!=e.key&&(t.uint32(18),t.bytes(e.key)),null!=e.record&&(t.uint32(26),t.bytes(e.record)),null!=e.closer)for(const r of e.closer)t.uint32(66),ay.codec().encode(r,t);if(null!=e.providers)for(const r of e.providers)t.uint32(74),ay.codec().encode(r,t);!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={type:ry.PUT_VALUE,closer:[],providers:[]},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 1:r.type=ry.codec().decode(e);break;case 10:r.clusterLevel=e.int32();break;case 2:r.key=e.bytes();break;case 3:r.record=e.bytes();break;case 8:var o,s;if(null!=(null===(o=n.limits)||void 0===o?void 0:o.closer)&&r.closer.length===n.limits.closer)throw new ts('Decode error - map field "closer" had too many elements');r.closer.push(ay.codec().decode(e,e.uint32(),{limits:null===(s=n.limits)||void 0===s?void 0:s.closer$}));break;case 9:var a,l;if(null!=(null===(a=n.limits)||void 0===a?void 0:a.providers)&&r.providers.length===n.limits.providers)throw new ts('Decode error - map field "providers" had too many elements');r.providers.push(ay.codec().decode(e,e.uint32(),{limits:null===(l=n.limits)||void 0===l?void 0:l.providers$}));break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(ly||(ly={}));const my={pk:function(e,t){return 0}};async function vy(e,t){const n=t.key,r=Wt(n).split("/");if(r.length<3)return;const i=e[r[1].toString()];if(null==i)throw new C('No validator available for key type "'.concat(r[1],'"'));await i(n,t.value)}const yy={pk:async(e,t)=>{if(!(e instanceof Uint8Array))throw new C('"key" must be a Uint8Array');if(e.byteLength<5)throw new C("Invalid public key record");if("/pk/"!==Wt(e.subarray(0,4)))throw new C("key was not prefixed with /pk/");const n=Hs(t);if(!ne(e.slice(4),n.toMultihash().bytes))throw new C("public key does not match passed in key")}},wy=jt("/pk/");function by(e){return E(E({},e),{},{multiaddrs:e.multiaddrs.filter((e=>{const[[t,n]]=e.stringTuples();if(53===t||54===t||55===t)return"localhost"!==n;if(4!==t&&6!==t)return!1;if(null==n)return!1;const r=Nd(n);return null==r||!r}))})}async function Ey(e){return(await _t.digest(e)).digest}async function Sy(e){return Ey(e.toMultihash().bytes)}function ky(e,t){return new Du("".concat(e,"/").concat(Wt(t,"base32")),!1)}function xy(e,t){const n=new Date;return new $v(e,t,n).serialize()}function Cy(e){const t=e.toString().split("/"),n=t.pop(),r=t.pop();if(null==n||null==r)throw new Error("incorrectly formatted provider entry key in datastore: ".concat(e.toString()));return{cid:Mt.createV1(Ze,St(jt(r,"base32"))),peerId:ra(n)}}function Py(e,t,n){const r=[e,"string"===typeof t?t:Wt(t.multihash.bytes,"base32")];return null!=n&&r.push(n.toString()),new Du(r.join("/"))}function Ay(e){return new Date(mo(e))}function Iy(e,t,n){return ru((function*(){var r,i;const o=null===(r=t.queryTime)||void 0===r?void 0:r.timer(n),s=null===(i=t.errorTime)||void 0===i?void 0:i.timer(n);let a=!1;try{var l;null===(l=t.queries)||void 0===l||l.increment({[n]:!0}),yield*dd(Kc(e(...arguments)))}catch(d){var c;throw a=!0,null===s||void 0===s||s(),null===(c=t.errors)||void 0===c||c.increment({[n]:!0}),d}finally{var u;null===(u=t.queries)||void 0===u||u.decrement({[n]:!0}),a||null===o||void 0===o||o()}}))}function _y(e,t,n){return async function(){var r,i;const o=null===t||void 0===t||null===(r=t.queryTime)||void 0===r?void 0:r.timer(n),s=null===t||void 0===t||null===(i=t.errorTime)||void 0===i?void 0:i.timer(n);let a=!1;try{var l;return null===(l=t.queries)||void 0===l||l.increment({[n]:!0}),await e(...arguments)}catch(d){var c;throw a=!0,null===s||void 0===s||s(),null===(c=t.errors)||void 0===c||c.increment({[n]:!0}),d}finally{var u;null===(u=t.queries)||void 0===u||u.decrement({[n]:!0}),a||null===o||void 0===o||o()}}}class Ty{constructor(e,t){var n,r,i,o;w(this,"log",void 0),w(this,"components",void 0),w(this,"validators",void 0),w(this,"selectors",void 0),w(this,"peerRouting",void 0),w(this,"queryManager",void 0),w(this,"network",void 0),w(this,"datastorePrefix",void 0);const{validators:s,selectors:a,peerRouting:l,queryManager:c,network:u,logPrefix:d}=t;this.components=e,this.log=e.logger.forComponent("".concat(d,":content-fetching")),this.datastorePrefix="".concat(t.datastorePrefix,"/record"),this.validators=s,this.selectors=a,this.peerRouting=l,this.queryManager=c,this.network=u,this.get=null!==(n=null===(r=e.metrics)||void 0===r?void 0:r.traceFunction("libp2p.kadDHT.get",this.get.bind(this),{optionsIndex:1}))&&void 0!==n?n:this.get,this.put=null!==(i=null===(o=e.metrics)||void 0===o?void 0:o.traceFunction("libp2p.kadDHT.put",this.put.bind(this),{optionsIndex:2}))&&void 0!==i?i:this.put}async getLocal(e){this.log("getLocal %b",e);const t=ky(this.datastorePrefix,e);this.log("fetching record for key %k",t);const n=await this.components.datastore.get(t);this.log("found %k in local datastore",t);const r=$v.deserialize(n);return await vy(this.validators,r),r}sendCorrectionRecord(e,t,n,r){var i=this;return ru((function*(){i.log("sendCorrection for %b",e);const o=xy(e,n);for(const{value:h,from:f}of t){if(ne(h,n)){i.log("record was ok");continue}if(i.components.peerId.equals(f)){try{const t=ky(i.datastorePrefix,e);i.log("Storing corrected record for key ".concat(t.toString())),yield nu(i.components.datastore.put(t,o.subarray()))}catch(d){i.log.error("Failed error correcting self",d)}continue}let t=!1;const p={type:ry.PUT_VALUE,key:e,record:o};var s,a=!1,l=!1;try{for(var c,u=Kc(i.network.sendRequest(f,p,r));a=!(c=yield nu(u.next())).done;a=!1){const e=c.value;"PEER_RESPONSE"===e.name&&null!=e.record&&ne(e.record.value,$v.deserialize(o).value)&&(t=!0),yield e}}catch(d){l=!0,s=d}finally{try{a&&null!=u.return&&(yield nu(u.return()))}finally{if(l)throw s}}if(!t)throw new Zv("Could not send correction");i.log.error("Failed error correcting entry")}}))()}put(e,t,n){var r=this;return ru((function*(){r.log("put key %b value %b",e,t);const i=xy(e,t),o=ky(r.datastorePrefix,e);r.log("storing record for key ".concat(o.toString())),yield nu(r.components.datastore.put(o,i.subarray())),yield*dd(Kc(Ng(r.peerRouting.getClosestPeers(e,E(E({},n),{},{signal:n.signal})),(t=>Xv(t,(t=>async()=>{if("FINAL_PEER"!==t.name)return[t];const o=[],s={type:ry.PUT_VALUE,key:e,record:i};r.log("send put to %p",t.peer.id);var a,l=!1,c=!1;try{for(var u,d=Kc(r.network.sendRequest(t.peer.id,s,E(E({},n),{},{path:t.path})));l=!(u=await d.next()).done;l=!1){const e=u.value;(o.push(e),"PEER_RESPONSE"===e.name)&&(null!=e.record&&ne(e.record.value,$v.deserialize(i).value)||o.push(hy({from:t.peer.id,error:new Zv("Value not put correctly"),path:e.path},n)))}}catch(h){c=!0,a=h}finally{try{l&&null!=d.return&&await d.return()}finally{if(c)throw a}}return o}))),(e=>Ip(e,{ordered:!1,concurrency:10})),function(){var e=ru((function*(e){var t,n=!1,r=!1;try{for(var i,o=Kc(e);n=!(i=yield nu(o.next())).done;n=!1){const e=i.value;yield*dd(Kc(e))}}catch(s){r=!0,t=s}finally{try{n&&null!=o.return&&(yield nu(o.return()))}finally{if(r)throw t}}}));return function(t){return e.apply(this,arguments)}}())))}))()}get(e,t){var n=this;return ru((function*(){n.log("get %b",e);const r=[];var i,o=!1,s=!1;try{for(var a,l=Kc(n.getMany(e,t));o=!(a=yield nu(l.next())).done;o=!1){const e=a.value;"VALUE"!==e.name?yield e:r.push(e)}}catch(h){s=!0,i=h}finally{try{o&&null!=l.return&&(yield nu(l.return()))}finally{if(s)throw i}}if(0===r.length)return;const c=r.map((e=>e.value));let u=0;try{u=function(e,t,n){if(0===n.length)throw new C("No records given");const r=Wt(t).split("/");if(r.length<3)throw new C("Record key does not have a selector function");const i=e[r[1].toString()];if(null==i)throw new ty('No selector function configured for key type "'.concat(r[1],'"'));return 1===n.length?0:i(t,n)}(n.selectors,e,c)}catch(h){if("InvalidParametersError"!==h.name)throw h}const d=c[u];if(n.log("GetValue %b %b",e,d),null==d)throw new D("Best value was not found");yield*dd(Kc(n.sendCorrectionRecord(e,r,d,E(E({},t),{},{path:{index:-1,queued:0,running:0,total:0}})))),yield r[u]}))()}getMany(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){t.log("getMany values for %b",e);try{const r=yield nu(t.getLocal(e));yield py({value:r.value,from:t.components.peerId,path:{index:-1,running:0,queued:0,total:0}},n)}catch(o){t.log("error getting local value for %b",e,o)}const r=t,i=function(){var t=ru((function(t){let{peer:i,signal:s,path:a}=t;return function*(){var t,l=!1,c=!1;try{for(var u,d=Kc(r.peerRouting.getValueOrPeers(i.id,e,E(E({},n),{},{signal:s,path:a})));l=!(u=yield nu(d.next())).done;l=!1){const e=u.value;yield e,"PEER_RESPONSE"===e.name&&null!=e.record&&(yield py({from:i.id,value:e.record.value,path:a},n))}}catch(o){c=!0,t=o}finally{try{l&&null!=d.return&&(yield nu(d.return()))}finally{if(c)throw t}}}()}));return function(e){return t.apply(this,arguments)}}();yield*dd(Kc(t.queryManager.run(e,i,n)))}()})).apply(this,arguments)}}function Ly(e,t){var n;const r={id:e.id.toMultihash().bytes,multiaddrs:(null!==(n=e.multiaddrs)&&void 0!==n?n:[]).map((e=>e.bytes)),connection:t};return r}function Ry(e){var t;if(null==e.id)throw new Error("Invalid peer in message");return{id:oa(St(e.id)),multiaddrs:(null!==(t=e.multiaddrs)&&void 0!==t?t:[]).map((e=>fc(e)))}}class Ny{constructor(e,t){var n,r,i,o;w(this,"log",void 0),w(this,"components",void 0),w(this,"network",void 0),w(this,"peerRouting",void 0),w(this,"queryManager",void 0),w(this,"routingTable",void 0),w(this,"providers",void 0);const{network:s,peerRouting:a,queryManager:l,routingTable:c,providers:u,logPrefix:d}=t;this.components=e,this.log=e.logger.forComponent("".concat(d,":content-routing")),this.network=s,this.peerRouting=a,this.queryManager=l,this.routingTable=c,this.providers=u,this.findProviders=null!==(n=null===(r=e.metrics)||void 0===r?void 0:r.traceFunction("libp2p.kadDHT.findProviders",this.findProviders.bind(this),{optionsIndex:1,getAttributesFromYieldedValue:(e,t)=>{var n;"PROVIDER"===e.name&&(null!==(n=t.providers)&&void 0!==n||(t.providers=[]),t.providers.push(...e.providers.map((e=>e.id.toString()))));return t}}))&&void 0!==n?n:this.findProviders,this.provide=null!==(i=null===(o=e.metrics)||void 0===o?void 0:o.traceFunction("libp2p.kadDHT.provide",this.provide.bind(this),{optionsIndex:1,getAttributesFromYieldedValue:(e,t)=>{var n;"PEER_RESPONSE"===e.name&&"ADD_PROVIDER"===e.messageName&&(null!==(n=t.providers)&&void 0!==n||(t.providers=[]),t.providers.push(e.from.toString()));return t}}))&&void 0!==i?i:this.provide}provide(e,t){var n=this;return ru((function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function*(){n.log("provide %s",e);const i=e.multihash.bytes;yield nu(n.providers.addProvider(e,n.components.peerId));const o={type:ry.ADD_PROVIDER,key:i,providers:[Ly({id:n.components.peerId,multiaddrs:t})]};let s=0;const a=n;function l(){return(l=ru((function*(t){try{a.log("sending provider record for %s to %p",e,t.peer.id);var n,i=!1,l=!1;try{for(var c,u=Kc(a.network.sendMessage(t.peer.id,o,E(E({},r),{},{path:t.path})));i=!(c=yield nu(u.next())).done;i=!1){const n=c.value;"PEER_RESPONSE"===n.name&&(a.log("sent provider record for %s to %p",e,t.peer.id),s++),yield n}}catch(d){l=!0,n=d}finally{try{i&&null!=u.return&&(yield nu(u.return()))}finally{if(l)throw n}}}catch(d){a.log.error("error sending provide record to peer %p",t.peer.id,d),yield hy({from:t.peer.id,error:d,path:t.path},r)}}))).apply(this,arguments)}const c=Rf({objectMode:!0}),u=new Bf({concurrency:10});u.addEventListener("idle",(()=>{c.end()})),u.addEventListener("error",(e=>{n.log.error("error publishing provider record to peer - %e",e)})),u.add((async()=>{const e=[];var t,o=!1,s=!1;try{for(var a,d=Kc(n.peerRouting.getClosestPeers(i,r));o=!(a=await d.next()).done;o=!1){const t=a.value;(c.push(t),"FINAL_PEER"===t.name)&&e.push(t)}}catch(h){s=!0,t=h}finally{try{o&&null!=d.return&&await d.return()}finally{if(s)throw t}}e.forEach((e=>{u.add((async()=>{var t,n=!1,r=!1;try{for(var i,o=Kc(function(e){return l.apply(this,arguments)}(e));n=!(i=await o.next()).done;n=!1){const e=i.value;c.push(e)}}catch(h){r=!0,t=h}finally{try{n&&null!=o.return&&await o.return()}finally{if(r)throw t}}})).catch((e=>{n.log.error("error publishing provider record to peer - %e",e)}))}))})).catch((e=>{c.end(e)})),yield*dd(Kc(c)),n.log("sent provider records to %d peers",s)}()})).apply(this,arguments)}findProviders(e,t){var n=this;return ru((function*(){const r=n.routingTable.kBucketSize;let i=0;const o=e.multihash.bytes,s=n;n.log("findProviders %c",e);const a=yield nu(n.providers.getProviders(e));if(a.length>0){const e=[];for(const t of a.slice(0,r))try{const r=yield nu(n.components.peerStore.get(t));e.push({id:t,multiaddrs:r.addresses.map((e=>{let{multiaddr:t}=e;return t}))})}catch(g){if("NotFoundError"!==g.name)throw g;n.log("no peer store entry for %p",t)}if(yield uy({from:n.components.peerId,messageType:ry.GET_PROVIDERS,providers:e,path:{index:-1,queued:0,running:0,total:0}},t),yield fy({from:n.components.peerId,providers:e,path:{index:-1,queued:0,running:0,total:0}},t),i+=e.length,i>=r)return}const l=function(){var e=ru((function(e){let{peer:n,signal:r,path:i}=e;return function*(){const e={type:ry.GET_PROVIDERS,key:o};yield*dd(Kc(s.network.sendRequest(n.id,e,E(E({},t),{},{signal:r,path:i}))))}()}));return function(t){return e.apply(this,arguments)}}(),c=new Vc(a);var u,d=!1,h=!1;try{for(var f,p=Kc(n.queryManager.run(o,l,t));d=!(f=yield nu(p.next())).done;d=!1){const o=f.value;if(yield o,"PEER_RESPONSE"===o.name){n.log("Found %d provider entries for %c and %d closer peers",o.providers.length,e,o.closer.length);const s=[];for(const e of o.providers)c.has(e.id)||(c.add(e.id),s.push(e));if(s.length>0&&(yield fy({from:o.from,providers:s,path:o.path},t),i+=s.length,i>=r))return}}}catch(g){h=!0,u=g}finally{try{d&&null!=p.return&&(yield nu(p.return()))}finally{if(h)throw u}}}))()}}function My(e,t){const n=$p(e,t),r={read:async(e,t)=>{const r=await n.read(t);return e.decode(r)},write:async(e,t,r)=>{await n.write(t.encode(e),r)},writeV:async(e,t,r)=>{await n.writeV(e.map((e=>t.encode(e))),r)},pb:e=>({read:async t=>r.read(e,t),write:async(t,n)=>r.write(t,e,n),writeV:async(t,n)=>r.writeV(t,e,n),unwrap:()=>r}),unwrap:()=>n.unwrap()};return r}class Dy extends wc{constructor(e,t){var n,r,i,o,s,a,l;super(),w(this,"log",void 0),w(this,"protocol",void 0),w(this,"running",void 0),w(this,"components",void 0),w(this,"timeout",void 0),w(this,"metrics",void 0),this.components=e,this.log=e.logger.forComponent("".concat(t.logPrefix,":network")),this.running=!1,this.protocol=t.protocol,this.timeout=new vp(E(E({},null!==(n=t.timeout)&&void 0!==n?n:{}),{},{metrics:e.metrics,metricName:"".concat(t.metricsPrefix,"_network_message_send_times_milliseconds")})),this.metrics={operations:null===(r=e.metrics)||void 0===r?void 0:r.registerCounterGroup("".concat(t.metricsPrefix,"_outbound_rpc_requests_total")),errors:null===(i=e.metrics)||void 0===i?void 0:i.registerCounterGroup("".concat(t.metricsPrefix,"_outbound_rpc_errors_total"))},this.sendRequest=null!==(o=null===(s=e.metrics)||void 0===s?void 0:s.traceFunction("libp2p.kadDHT.sendRequest",this.sendRequest.bind(this),{optionsIndex:2,getAttributesFromArgs(e,t){let[n,r]=e;return E(E({},t),{},{to:n.toString(),"message type":"".concat(r.type)})},getAttributesFromYieldedValue:(e,t)=>("PEER_RESPONSE"===e.name&&(e.providers.length>0&&e.providers.forEach(((e,n)=>{t["providers-".concat(n)]=e.id.toString()})),e.closer.length>0&&e.closer.forEach(((e,n)=>{t["closer-".concat(n)]=e.id.toString()}))),t)}))&&void 0!==o?o:this.sendRequest,this.sendMessage=null!==(a=null===(l=e.metrics)||void 0===l?void 0:l.traceFunction("libp2p.kadDHT.sendMessage",this.sendMessage.bind(this),{optionsIndex:2,getAttributesFromArgs(e,t){let[n,r]=e;return E(E({},t),{},{to:n.toString(),"message type":"".concat(r.type)})},getAttributesFromYieldedValue:(e,t)=>("PEER_RESPONSE"===e.name&&(e.providers.length>0&&e.providers.forEach(((e,n)=>{t["providers-".concat(n)]=e.id.toString()})),e.closer.length>0&&e.closer.forEach(((e,n)=>{t["closer-".concat(n)]=e.id.toString()}))),t)}))&&void 0!==a?a:this.sendMessage}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}sendRequest(e,t,n){var r=this;return ru((function*(){if(!r.running)return;const i=t.type;if(null==i)throw new C("Message type was missing");let o;const s=r.timeout.getTimeoutSignal(n);n=E(E({},n),{},{signal:s});try{var a;null===(a=r.metrics.operations)||void 0===a||a.increment({[i]:!0}),r.log("dialling %p",e),yield gy({peer:e,path:n.path},n);const s=yield nu(r.components.connectionManager.openConnection(e,n));o=yield nu(s.newStream(r.protocol,n)),r.log("sending %s to %p",t.type,e),yield cy({to:e,type:i,path:n.path},n);const l=yield nu(r._writeReadMessage(o,t,n));o.close(n).catch((t=>{var n;r.log.error("error closing stream to %p",e,t),null===(n=o)||void 0===n||n.abort(t)})),yield uy({from:e,messageType:l.type,closer:l.closer.map(Ry),providers:l.providers.map(Ry),record:null==l.record?void 0:$v.deserialize(l.record),path:n.path},n)}catch(d){var l,c,u;null===(l=r.metrics.errors)||void 0===l||l.increment({[i]:!0}),null===(c=o)||void 0===c||c.abort(d),!0!==(null===(u=n.signal)||void 0===u?void 0:u.aborted)&&r.log.error("could not send %s to %p - %e",t.type,e,d),yield hy({from:e,error:d,path:n.path},n)}finally{r.timeout.cleanUp(s)}}))()}sendMessage(e,t,n){var r=this;return ru((function*(){if(!r.running)return;const i=t.type;if(null==i)throw new C("Message type was missing");let o;const s=r.timeout.getTimeoutSignal(n);n=E(E({},n),{},{signal:s});try{var a;null===(a=r.metrics.operations)||void 0===a||a.increment({[i]:!0}),r.log("dialling %p",e),yield gy({peer:e,path:n.path},n);const s=yield nu(r.components.connectionManager.openConnection(e,n));o=yield nu(s.newStream(r.protocol,n)),r.log("sending %s to %p",t.type,e),yield cy({to:e,type:i,path:n.path},n),yield nu(r._writeMessage(o,t,n)),o.close(n).catch((t=>{var n;r.log.error("error closing stream to %p",e,t),null===(n=o)||void 0===n||n.abort(t)})),yield uy({from:e,messageType:i,path:n.path},n)}catch(u){var l,c;null===(l=r.metrics.errors)||void 0===l||l.increment({[i]:!0}),null===(c=o)||void 0===c||c.abort(u),yield hy({from:e,error:u,path:n.path},n)}finally{r.timeout.cleanUp(s)}}))()}async _writeMessage(e,t,n){const r=My(e);await r.write(t,ly,n)}async _writeReadMessage(e,t,n){const r=My(e);await r.write(t,ly,n);const i=await r.read(ly,n);return i.closer.forEach((e=>{this.safeDispatchEvent("peer",{detail:Ry(e)})})),i.providers.forEach((e=>{this.safeDispatchEvent("peer",{detail:Ry(e)})})),i}}function Oy(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");const n=ee(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}function zy(e,t){if(e.byteLength!==t.byteLength)throw new Error("Inputs should have the same length");for(let n=0;n<e.byteLength;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}class Fy{constructor(e,t){w(this,"originDhtKey",void 0),w(this,"capacity",void 0),w(this,"peerDistances",void 0),this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return[...this.peerDistances]}async add(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{index:-1,queued:0,running:0,total:0};const n=await Sy(e.id);this.addWithKadId(e,n,t)}addWithKadId(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{index:-1,queued:0,running:0,total:0};if(null!=this.peerDistances.find((t=>t.peer.id.equals(e.id))))return;const r={peer:e,distance:Oy(this.originDhtKey,t),path:n};if(this.peerDistances.length===this.capacity){const e=this.peerDistances[this.peerDistances.length-1];if(null!=e&&-1!==zy(r.distance,e.distance))return}let i=!1;for(let o=0;o<this.peerDistances.length;o++){const e=zy(this.peerDistances[o].distance,r.distance);if(0===e||1===e){i=!0,this.peerDistances.splice(o,0,r);break}}i||this.peerDistances.push(r),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async isCloser(e){if(0===this.length)return!0;return-1===zy(Oy(await Sy(e),this.originDhtKey),this.peerDistances[this.peerDistances.length-1].distance)}async anyCloser(e){return 0!==e.length&&Promise.any(e.map((async e=>this.isCloser(e))))}}class Uy{constructor(e,t){var n,r,i,o;w(this,"log",void 0),w(this,"routingTable",void 0),w(this,"network",void 0),w(this,"validators",void 0),w(this,"queryManager",void 0),w(this,"components",void 0),this.routingTable=t.routingTable,this.network=t.network,this.validators=t.validators,this.queryManager=t.queryManager,this.components=e,this.log=e.logger.forComponent("".concat(t.logPrefix,":peer-routing")),this.findPeer=null!==(n=null===(r=e.metrics)||void 0===r?void 0:r.traceFunction("libp2p.kadDHT.findPeer",this.findPeer.bind(this),{optionsIndex:1}))&&void 0!==n?n:this.findPeer,this.getClosestPeers=null!==(i=null===(o=e.metrics)||void 0===o?void 0:o.traceFunction("libp2p.kadDHT.getClosestPeers",this.getClosestPeers.bind(this),{optionsIndex:1}))&&void 0!==i?i:this.getClosestPeers}async findPeerLocal(e){let t;const n=await this.routingTable.find(e);if(null!=n){this.log("findPeerLocal found %p in routing table",e);try{t=await this.components.peerStore.get(n)}catch(r){if("NotFoundError"!==r.name)throw r}}if(null==t)try{t=await this.components.peerStore.get(e)}catch(r){if("NotFoundError"!==r.name)throw r}if(null!=t)return this.log("findPeerLocal found %p in peer store",e),{id:t.id,multiaddrs:t.addresses.map((e=>e.multiaddr))}}_getValueSingle(e,t,n){var r=this;return ru((function*(){const i={type:ry.GET_VALUE,key:t};yield*dd(Kc(r.network.sendRequest(e,i,n)))}))()}getPublicKeyFromNode(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const r=function(e){return te([wy,e.toMultihash().bytes])}(e),i={index:-1,queued:0,running:0,total:0};var o,s=!1,a=!1;try{for(var l,c=Kc(t._getValueSingle(e,r,E(E({},n),{},{path:i})));s=!(l=yield nu(c.next())).done;s=!1){const t=l.value;if(yield t,"PEER_RESPONSE"===t.name&&null!=t.record){const r=ia(Hs(t.record.value));if(!r.equals(e))throw new P("public key does not match id");if(null==r.publicKey)throw new P("public key missing");yield py({from:e,value:t.record.value,path:i},n)}}}catch(u){a=!0,o=u}finally{try{s&&null!=c.return&&(yield nu(c.return()))}finally{if(a)throw o}}throw new Zv("Node not responding with its public key: ".concat(e.toString()))}()})).apply(this,arguments)}findPeer(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){if(t.log("findPeer %p",e),!1!==n.useCache){const r=yield nu(t.findPeerLocal(e));if(null!=r)return t.log("found local"),void(yield dy({from:t.components.peerId,peer:r,path:{index:-1,queued:0,running:0,total:0}},n))}let r=!1;if(!1!==n.useNetwork){const u=t,d=function(){var t=ru((function(t){let{peer:r,signal:i,path:o}=t;return function*(){const t={type:ry.FIND_NODE,key:e.toMultihash().bytes};var s,a=!1,l=!1;try{for(var c,d=Kc(u.network.sendRequest(r.id,t,E(E({},n),{},{signal:i,path:o})));a=!(c=yield nu(d.next())).done;a=!1){const t=c.value;if(yield t,"PEER_RESPONSE"===t.name){const r=t.closer.find((t=>t.id.equals(e)));null!=r&&(yield dy({from:t.from,peer:r,path:t.path},n))}}}catch(h){l=!0,s=h}finally{try{a&&null!=d.return&&(yield nu(d.return()))}finally{if(l)throw s}}}()}));return function(e){return t.apply(this,arguments)}}();var i,o=!1,s=!1;try{for(var a,l=Kc(t.queryManager.run(e.toMultihash().bytes,d,n));o=!(a=yield nu(l.next())).done;o=!1){const e=a.value;"FINAL_PEER"===e.name&&(r=!0),yield e}}catch(c){s=!0,i=c}finally{try{o&&null!=l.return&&(yield nu(l.return()))}finally{if(s)throw i}}}if(!r)throw new D("Not found")}()})).apply(this,arguments)}getClosestPeers(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){t.log("getClosestPeers to %b",e);const r=yield nu(Ey(e)),i=new Fy(r,t.routingTable.kBucketSize),o=t,s=function(){var t=ru((function(t){let{peer:r,path:s,peerKadId:a,signal:l}=t;return function*(){o.log("getClosestPeers asking %p",r);const t={type:ry.FIND_NODE,key:e};yield*dd(Kc(o.network.sendRequest(r.id,t,E(E({},n),{},{signal:l,path:s})))),i.addWithKadId(r,a,s)}()}));return function(e){return t.apply(this,arguments)}}();yield*dd(Kc(t.queryManager.run(e,s,n))),t.log("found %d peers close to %b",i.length,e);for(let{peer:e,path:l}of i.peers)try{if(0===e.multiaddrs.length&&(e=yield nu(o.components.peerStore.getInfo(e.id))),0===e.multiaddrs.length)continue;yield dy({from:t.components.peerId,peer:yield nu(o.components.peerStore.getInfo(e.id)),path:{index:l.index,queued:0,running:0,total:0}},n)}catch(a){continue}}()})).apply(this,arguments)}getValueOrPeers(e,t,n){var r=this;return ru((function*(){var i,o=!1,s=!1;try{for(var a,l=Kc(r._getValueSingle(e,t,n));o=!(a=yield nu(l.next())).done;o=!1){const e=a.value;if("PEER_RESPONSE"===e.name&&null!=e.record)try{yield nu(r._verifyRecordOnline(e.record))}catch(c){const t="invalid record received, discarded";r.log(t),yield hy({from:e.from,error:new Zv(t),path:n.path},n);continue}yield e}}catch(c){s=!0,i=c}finally{try{o&&null!=l.return&&(yield nu(l.return()))}finally{if(s)throw i}}}))()}async _verifyRecordOnline(e){if(null==e.timeReceived)throw new ey("invalid record received");await vy(this.validators,new $v(e.key,e.value,e.timeReceived))}async getCloserPeersOffline(e,t){const n=[];try{const t=oa(St(e)),r=await this.components.peerStore.get(t);n.push({id:r.id,multiaddrs:r.addresses.map((e=>{let{multiaddr:t}=e;return t}))})}catch(s){}const r=await Ey(e),i=this.routingTable.closestPeers(r),o=Oy(await Sy(t),r);for(const l of i){if(-1===zy(Oy(await Sy(l),r),o))try{n.push(await this.components.peerStore.getInfo(l))}catch(a){if("NotFoundError"!==a.name)throw a}}return n.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",n.length,e,t):this.log("getCloserPeersOffline could not find peer closer to %b than %p with %d peers in the routing table",e,t,this.routingTable.size),n}}class By{constructor(e,t){w(this,"log",void 0),w(this,"datastore",void 0),w(this,"datastorePrefix",void 0),w(this,"lock",void 0),this.log=e.logger.forComponent("".concat(t.logPrefix,":providers")),this.datastorePrefix="".concat(t.datastorePrefix,"/provider"),this.datastore=e.datastore,this.lock=t.lock}async addProvider(e,t,n){const r=await this.lock.readLock();try{this.log.trace("%p provides %s",t,e),await this.writeProviderEntry(e,t)}finally{r()}}async removeProvider(e,t,n){const r=await this.lock.writeLock();try{const n=Py(this.datastorePrefix,e,t);this.log.trace("%p no longer provides %s",t,e),await this.datastore.delete(n)}finally{r()}}async getProviders(e,t){const n=await this.lock.readLock();try{this.log.trace("get providers for %c",e);const n=await this.loadProviders(e,t);return this.log.trace("got %d providers for %c",n.size,e),[...n.keys()]}finally{n()}}async writeProviderEntry(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Date,r=arguments.length>3?arguments[3]:void 0;const i=Py(this.datastorePrefix,e,t),o=go(n.getTime());await this.datastore.put(i,o,r)}async loadProviders(e,t){const n=new hf,r=Py(this.datastorePrefix,e);var i,o=!1,s=!1;try{for(var a,l=Kc(this.datastore.query({prefix:r.toString()},t));o=!(a=await l.next()).done;o=!1){const e=a.value;{const{peerId:t}=Cy(e.key);n.set(t,Ay(e.value))}}}catch(c){s=!0,i=c}finally{try{o&&null!=l.return&&await l.return()}finally{if(s)throw i}}return n}}const qy=e=>{const t=e.addEventListener||e.on||e.addListener,n=e.removeEventListener||e.off||e.removeListener;if(!t||!n)throw new TypeError("Emitter is not compatible");return{addListener:t.bind(e),removeListener:n.bind(e)}};function Vy(e,t,n){"function"===typeof n&&(n={filter:n});const r=function(e,t,n){let r;const i=new Promise(((i,o)=>{var s;if(!((n=E({rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1},n)).count>=0)||n.count!==Number.POSITIVE_INFINITY&&!Number.isInteger(n.count))throw new TypeError("The `count` option should be at least 0 or more");null===(s=n.signal)||void 0===s||s.throwIfAborted();const a=[t].flat(),l=[],{addListener:c,removeListener:u}=qy(e),d=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];const s=n.multiArgs?t:t[0];n.filter&&!n.filter(s)||(l.push(s),n.count===l.length&&(r(),i(l)))},h=e=>{r(),o(e)};r=()=>{for(const e of a)u(e,d);for(const e of n.rejectionEvents)u(e,h)};for(const e of a)c(e,d);for(const e of n.rejectionEvents)c(e,h);n.signal&&n.signal.addEventListener("abort",(()=>{h(n.signal.reason)}),{once:!0}),n.resolveImmediately&&i(l)}));if(i.cancel=r,"number"===typeof n.timeout){const e=Na(i,{milliseconds:n.timeout});return e.cancel=r,e}return i}(e,t,n=E(E({},n),{},{count:1,resolveImmediately:!1})),i=r.then((e=>e[0]));return i.cancel=r.cancel,i}function Ky(){return Ky=ru((function*(e){const{key:t,startingPeers:n,ourPeerId:r,query:i,alpha:o,path:s,numPaths:a,log:l,peersSeen:c,connectionManager:u,signal:d}=e,h=Rf({objectMode:!0}),f=new Bf({concurrency:o,sort:(e,t)=>zy(e.options.distance,t.options.distance)});f.addEventListener("idle",(()=>{h.push(function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=E(E({},e),{},{name:"PATH_ENDED",type:8});return null===(t=n.onProgress)||void 0===t||t.call(n,new CustomEvent("kad-dht:query:path-ended",{detail:r})),r}({path:{index:s,queued:f.queued,running:f.running,total:f.size}},e)),h.end()})),f.addEventListener("error",(e=>{l.error("error during query - %e",e.detail)})),d.addEventListener("abort",(()=>{f.abort(),h.end(new Jv)}));const p=yield nu(Ey(t));function g(n,o){if(null==n)return;c.add(n.id.toMultihash().bytes);const m=Oy(o,p);f.add((async()=>{try{var v,y=!1,w=!1;try{for(var b,S=Kc(i(E(E({},e),{},{key:t,peer:n,path:{index:s,queued:f.queued,running:f.running,total:f.size},numPaths:a,peerKadId:o,signal:d})));y=!(b=await S.next()).done;y=!1){const e=b.value;if("PEER_RESPONSE"===e.name)for(const i of e.closer){if(c.has(i.id.toMultihash().bytes)){l("already seen %p in query",i.id);continue}if(r.equals(i.id)){l("not querying ourselves");continue}if(!await u.isDialable(i.multiaddrs)){l("not querying undialable peer");continue}const e=await Sy(i.id);-1===zy(Oy(e,p),m)?(l("querying closer peer %p",i.id),g(i,e)):l("skipping %p as they are not closer to %b than %p",i.id,t,n)}h.push(E(E({},e),{},{path:{index:s,queued:f.queued,running:f.running,total:f.size}}))}}catch(k){w=!0,v=k}finally{try{y&&null!=S.return&&await S.return()}finally{if(w)throw v}}}catch(k){h.push(hy({from:n.id,error:k,path:{index:s,queued:f.queued,running:f.running-1,total:f.size-1}},e))}}),{distance:m}).catch((e=>{l.error("error during query - %e",e)}))}yield nu(Promise.all(n.map((async e=>{g({id:e,multiaddrs:[]},await Sy(e))})))),yield*dd(Kc(h))})),Ky.apply(this,arguments)}class jy{constructor(e,t){var n,r,i;w(this,"disjointPaths",void 0),w(this,"alpha",void 0),w(this,"shutDownController",void 0),w(this,"running",void 0),w(this,"logger",void 0),w(this,"peerId",void 0),w(this,"connectionManager",void 0),w(this,"routingTable",void 0),w(this,"initialQuerySelfHasRun",void 0),w(this,"logPrefix",void 0),w(this,"allowQueryWithZeroPeers",void 0),this.logPrefix=t.logPrefix,this.disjointPaths=null!==(n=t.disjointPaths)&&void 0!==n?n:20,this.alpha=null!==(r=t.alpha)&&void 0!==r?r:10,this.initialQuerySelfHasRun=t.initialQuerySelfHasRun,this.routingTable=t.routingTable,this.logger=e.logger,this.peerId=e.peerId,this.connectionManager=e.connectionManager,this.allowQueryWithZeroPeers=null!==(i=t.allowQueryWithZeroPeers)&&void 0!==i&&i,this.shutDownController=new AbortController,this.shutDownController.signal,this.running=!1}isStarted(){return this.running}async start(){this.running||(this.running=!0,this.shutDownController=new AbortController,this.shutDownController.signal)}async stop(){this.running=!1,this.shutDownController.abort()}run(e,t){var n=this;return ru((function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function*(){if(!n.running)throw new Error("QueryManager not started");if(null==r.signal){const e=AbortSignal.timeout(18e4);r=E(E({},r),{},{signal:e})}const i=new AbortController,o=Vf([n.shutDownController.signal,i.signal,r.signal]);i.signal;const s=n.logger.forComponent("".concat(n.logPrefix,":query:")+Wt(e,"base58btc"));let a=!1;try{0!==n.routingTable.size||n.allowQueryWithZeroPeers||(s("routing table was empty, waiting for some peers before running%s query",!0===r.isSelfQuery?" self":""),yield nu(Vy(n.routingTable,"peer:add",{signal:o,filter:e=>!n.peerId.equals(e.detail)})),s("routing table has peers, continuing with%s query",!0===r.isSelfQuery?" self":"")),!0!==r.isSelfQuery&&null!=n.initialQuerySelfHasRun&&(s("waiting for initial self query before continuing"),yield nu(zf(n.initialQuerySelfHasRun.promise,o)),n.initialQuerySelfHasRun=void 0),s("query:start");const i=yield nu(Ey(e)),p=n.routingTable.closestPeers(i,n.routingTable.kBucketSize),g=p.sort((()=>Math.random()>.5?1:-1)).reduce(((e,t,r)=>(e[r%n.disjointPaths].push(t),e)),new Array(n.disjointPaths).fill(0).map((()=>[]))).filter((e=>e.length>0));if(0===p.length)return void s.error("running query with no peers");const m=_d(1024),v=g.map(((i,a)=>function(e){return Ky.apply(this,arguments)}(E(E({},r),{},{key:e,startingPeers:i,ourPeerId:n.peerId,signal:o,query:t,path:a,numPaths:g.length,alpha:n.alpha,log:s,peersSeen:m,onProgress:r.onProgress,connectionManager:n.connectionManager}))));var l,c=!1,u=!1;try{for(var d,h=Kc(xp(...v));c=!(d=yield nu(h.next())).done;c=!1){const e=d.value;if("QUERY_ERROR"===e.name&&s.error("query error",e.error),"PEER_RESPONSE"===e.name)for(const t of[...e.closer,...e.providers])(yield nu(n.connectionManager.isDialable(t.multiaddrs,{signal:o})))&&(yield nu(n.routingTable.add(t.id,{signal:o})));o.throwIfAborted(),yield e}}catch(f){u=!0,l=f}finally{try{c&&null!=h.return&&(yield nu(h.return()))}finally{if(u)throw l}}a=!0}catch(f){if(n.running)throw f}finally{a||(s("query exited early"),i.abort()),o.clear(),s("query finished")}}()})).apply(this,arguments)}}const Wy=function(e){if(null!=e[Symbol.asyncIterator])return(async()=>{let t=0;var n,r=!1,i=!1;try{for(var o,s=Kc(e);r=!(o=await s.next()).done;r=!1){o.value;t++}}catch(a){i=!0,n=a}finally{try{r&&null!=s.return&&await s.return()}finally{if(i)throw n}}return t})();{let t=0;for(const n of e)t++;return t}};class Hy{constructor(e,t){var n,r,i,o;w(this,"log",void 0),w(this,"peerId",void 0),w(this,"peerRouting",void 0),w(this,"events",void 0),w(this,"count",void 0),w(this,"interval",void 0),w(this,"initialInterval",void 0),w(this,"queryTimeout",void 0),w(this,"running",void 0),w(this,"timeoutId",void 0),w(this,"controller",void 0),w(this,"initialQuerySelfHasRun",void 0),w(this,"querySelfPromise",void 0),this.peerId=e.peerId,this.log=e.logger.forComponent("".concat(t.logPrefix,":query-self")),this.events=e.events,this.running=!1,this.peerRouting=t.peerRouting,this.count=null!==(n=t.count)&&void 0!==n?n:20,this.interval=null!==(r=t.interval)&&void 0!==r?r:3e5,this.initialInterval=null!==(i=t.initialInterval)&&void 0!==i?i:1e3,this.queryTimeout=null!==(o=t.queryTimeout)&&void 0!==o?o:5e3,this.initialQuerySelfHasRun=t.initialQuerySelfHasRun,this.querySelf=_y(this.querySelf.bind(this),t.operationMetrics,"SELF_QUERY")}isStarted(){return this.running}start(){this.running||(this.running=!0,clearTimeout(this.timeoutId),this.timeoutId=setTimeout((()=>{this.querySelf().catch((e=>{this.log.error("error running self-query",e)}))}),this.initialInterval))}stop(){this.running=!1,null!=this.timeoutId&&clearTimeout(this.timeoutId),null!=this.controller&&this.controller.abort()}async querySelf(){if(this.running){if(null!=this.querySelfPromise)return this.log("joining existing self query"),this.querySelfPromise.promise;if(this.querySelfPromise=If(),this.running){this.controller=new AbortController;const t=[this.controller.signal];if(null==this.initialQuerySelfHasRun){const e=AbortSignal.timeout(this.queryTimeout);t.push(e)}const n=Vf(t);this.controller.signal;try{this.log("run self-query, look for %d peers timing out after %dms",this.count,this.queryTimeout);const e=Date.now(),t=await Ng(this.peerRouting.getClosestPeers(this.peerId.toMultihash().bytes,{signal:n,isSelfQuery:!0}),(e=>fd(e,this.count)),(async e=>Wy(e))),r=Date.now()-e;this.log("self-query found %d peers in %dms",t,r),this.events.dispatchEvent(new CustomEvent("kad-dht:query:self",{detail:{peers:t,duration:r}}))}catch(e){this.log.error("self-query error",e)}finally{n.clear(),null!=this.initialQuerySelfHasRun&&(this.initialQuerySelfHasRun.resolve(),this.initialQuerySelfHasRun=void 0)}}this.querySelfPromise.resolve(),this.querySelfPromise=void 0,this.running&&(this.timeoutId=setTimeout((()=>{this.querySelf().catch((e=>{this.log.error("error running self-query",e)}))}),this.interval))}else this.log("skip self-query because we are not started")}}class Qy extends wc{constructor(e,t){var n,r,i,o,s,a;super(),w(this,"log",void 0),w(this,"reprovideQueue",void 0),w(this,"maxQueueSize",void 0),w(this,"datastore",void 0),w(this,"timeout",void 0),w(this,"reprovideTimeout",void 0),w(this,"running",void 0),w(this,"shutdownController",void 0),w(this,"reprovideThreshold",void 0),w(this,"contentRouting",void 0),w(this,"datastorePrefix",void 0),w(this,"addressManager",void 0),w(this,"validity",void 0),w(this,"interval",void 0),w(this,"lock",void 0),w(this,"peerId",void 0),this.log=e.logger.forComponent("".concat(t.logPrefix,":reprovider")),this.peerId=e.peerId,this.reprovideQueue=new Bf({concurrency:null!==(n=t.concurrency)&&void 0!==n?n:10,metrics:e.metrics,metricName:"".concat(t.metricsPrefix,"_reprovide_queue")}),this.reprovideTimeout=new vp(E(E({},null!==(r=t.timeout)&&void 0!==r?r:{}),{},{metrics:e.metrics,metricName:"".concat(t.metricsPrefix,"_reprovide_timeout_milliseconds")})),this.datastore=e.datastore,this.addressManager=e.addressManager,this.datastorePrefix="".concat(t.datastorePrefix,"/provider"),this.reprovideThreshold=null!==(i=t.threshold)&&void 0!==i?i:864e5,this.maxQueueSize=null!==(o=t.maxQueueSize)&&void 0!==o?o:16384,this.validity=null!==(s=t.validity)&&void 0!==s?s:Wv,this.interval=null!==(a=t.interval)&&void 0!==a?a:Hv,this.contentRouting=t.contentRouting,this.lock=t.lock,this.running=!1,this.reprovide=_y(this.reprovide.bind(this),t.operationMetrics,"PROVIDE")}start(){this.running||(this.running=!0,this.shutdownController=new AbortController,this.shutdownController.signal,this.timeout=setTimeout((()=>{this.cleanUp().catch((e=>{this.log.error("error running reprovide/cleanup - %e",e)}))}),this.interval))}stop(){var e;this.running=!1,this.reprovideQueue.clear(),clearTimeout(this.timeout),null===(e=this.shutdownController)||void 0===e||e.abort()}async cleanUp(){const e=await this.lock.writeLock();try{this.safeDispatchEvent("reprovide:start");var t,n=!1,r=!1;try{for(var i,o=Kc(this.datastore.query({prefix:this.datastorePrefix}));n=!(i=await o.next()).done;n=!1){const e=i.value;try{const{cid:t,peerId:n}=Cy(e.key),r=Ay(e.value).getTime(),i=r+this.validity,o=Date.now(),s=o>i;this.log.trace("comparing: %d < %d = %s %s",r,o-this.validity,s,s?"(expired)":""),s&&await this.datastore.delete(e.key),this.peerId.equals(n)&&o-i<this.reprovideThreshold&&this.queueReprovide(t).catch((e=>{this.log.error("could not reprovide %c - %e",t,e)}))}catch(s){this.log.error("error processing datastore key %s - %e",e.key,s.message)}}}catch(s){r=!0,t=s}finally{try{n&&null!=o.return&&await o.return()}finally{if(r)throw t}}this.log("reprovide/cleanup successful")}finally{e(),this.safeDispatchEvent("reprovide:end"),this.running&&(this.timeout=setTimeout((()=>{this.cleanUp().catch((e=>{this.log.error("error running re-provide - %e",e)}))}),this.interval))}}async queueReprovide(e){var t;if(!this.running)return;this.log.trace("waiting for queue capacity before adding %c to re-provide queue",e),await this.reprovideQueue.onSizeLessThan(this.maxQueueSize);const n=this.reprovideQueue.queue.find((t=>t.options.cid.equals(e)));if(null!=n)return this.log.trace("not adding %c to re-provide queue - already in queue",e),n.join();this.log.trace("adding %c to re-provide queue",e),this.reprovideQueue.add((async t=>{var n;if(null===(n=t.signal)||void 0===n||n.throwIfAborted(),!this.running)return;this.log.trace("re-providing %c",e);const r=this.reprovideTimeout.getTimeoutSignal(t);try{await this.reprovide(t.cid,t)}finally{this.reprovideTimeout.cleanUp(r)}this.log.trace("re-provided %c",e)}),{signal:null===(t=this.shutdownController)||void 0===t?void 0:t.signal,cid:e}).catch((t=>{this.log.error("could not re-provide key %c - %e",e,t)}))}async reprovide(e,t){await ld(this.contentRouting.provide(e,this.addressManager.getAddresses(),t))}}class Gy{constructor(e,t){var n,r,i,o;w(this,"routingTable",void 0),w(this,"components",void 0),w(this,"closestPeers",void 0),w(this,"newPeers",void 0),w(this,"refreshInterval",void 0),w(this,"peerSetSize",void 0),w(this,"timeout",void 0),w(this,"closeTagName",void 0),w(this,"closeTagValue",void 0),w(this,"log",void 0),w(this,"running",void 0),this.components=e,this.log=e.logger.forComponent("".concat(t.logPrefix,":routing-table")),this.routingTable=t.routingTable,this.refreshInterval=null!==(n=t.refreshInterval)&&void 0!==n?n:5e3,this.peerSetSize=null!==(r=t.peerSetSize)&&void 0!==r?r:20,this.closeTagName=null!==(i=t.closeTagName)&&void 0!==i?i:"kad-close",this.closeTagValue=null!==(o=t.closeTagValue)&&void 0!==o?o:50,this.closestPeers=new Vc,this.onPeerPing=this.onPeerPing.bind(this),this.running=!1}async start(){if(this.running)return;this.running=!0;const e=await Sy(this.components.peerId);this.newPeers=new Fy(e,this.peerSetSize),this.routingTable.addEventListener("peer:ping",this.onPeerPing),this.timeout=setInterval((()=>{this.updatePeerTags().catch((e=>{this.log.error("error updating peer tags - %e",e)}))}),this.refreshInterval)}stop(){this.running=!1,this.routingTable.removeEventListener("peer:ping",this.onPeerPing),clearTimeout(this.timeout)}onPeerPing(e){var t;null===(t=this.newPeers)||void 0===t||t.add({id:e.detail,multiaddrs:[]}).catch((e=>{this.log.error("error adding peer to distance list - %e",e)}))}async updatePeerTags(){var e;const t=new Vc(null===(e=this.newPeers)||void 0===e?void 0:e.peers.map((e=>{let{peer:t}=e;return t.id}))),n=t.difference(this.closestPeers),r=this.closestPeers.difference(t);this.closestPeers=t,await Promise.all([...[...n].map((async e=>{await this.components.peerStore.merge(e,{tags:{[this.closeTagName]:{value:this.closeTagValue},[Qv]:{value:1}}})})),...[...r].map((async e=>{await this.components.peerStore.merge(e,{tags:{[this.closeTagName]:void 0,[Qv]:void 0}})}))])}}function Yy(e){return Array.isArray(null===e||void 0===e?void 0:e.peers)}class $y{constructor(e){var t,n,r,i,o;w(this,"root",void 0),w(this,"localPeer",void 0),w(this,"prefixLength",void 0),w(this,"splitThreshold",void 0),w(this,"kBucketSize",void 0),w(this,"numberOfNodesToPing",void 0),w(this,"lastPingThreshold",void 0),w(this,"ping",void 0),w(this,"verify",void 0),w(this,"onAdd",void 0),w(this,"onRemove",void 0),w(this,"onMove",void 0),w(this,"addingPeerMap",void 0),this.prefixLength=null!==(t=e.prefixLength)&&void 0!==t?t:Zy,this.kBucketSize=null!==(n=e.kBucketSize)&&void 0!==n?n:Xy,this.splitThreshold=null!==(r=e.splitThreshold)&&void 0!==r?r:this.kBucketSize,this.numberOfNodesToPing=null!==(i=e.numberOfOldContactsToPing)&&void 0!==i?i:Jy,this.lastPingThreshold=null!==(o=e.lastPingThreshold)&&void 0!==o?o:tw,this.ping=e.ping,this.verify=e.verify,this.onAdd=e.onAdd,this.onRemove=e.onRemove,this.addingPeerMap=new hf,this.root={prefix:"",depth:0,peers:[]}}async addSelfPeer(e){this.localPeer={peerId:e,kadId:await Sy(e),lastPing:Date.now()}}async add(e,t){const n={peerId:e,kadId:await Sy(e),lastPing:0},r=this.addingPeerMap.get(e);if(null!=r)return r;try{const r=this._add(n,t);this.addingPeerMap.set(e,r),await r}finally{this.addingPeerMap.delete(e)}}async _add(e,t){const n=this._determineBucket(e.kadId);if(this._indexOf(n,e.kadId)>-1)return;if(n.peers.length===this.splitThreshold&&n.depth<this.prefixLength)return await this._split(n),void await this._add(e,t);if(n.peers.length<this.kBucketSize){var r;if(!function(e,t){return e.lastPing<Date.now()-t}(e,this.lastPingThreshold))return n.peers.push(e),void await(null===(r=this.onAdd)||void 0===r?void 0:r.call(this,e,n));return void(await this.verify(e,t)&&(e.lastPing=Date.now(),await this._add(e,t)))}const i=n.peers.filter((e=>{var t;return!e.peerId.equals(null===(t=this.localPeer)||void 0===t?void 0:t.peerId)&&!(e.lastPing>Date.now()-this.lastPingThreshold)})).sort(((e,t)=>e.lastPing<t.lastPing?-1:e.lastPing>t.lastPing?1:0)).slice(0,this.numberOfNodesToPing);let o=!1;var s,a=!1,l=!1;try{for(var c,u=Kc(this.ping(i,t));a=!(c=await u.next()).done;a=!1){const e=c.value;o=!0,await this.remove(e.kadId)}}catch(d){l=!0,s=d}finally{try{a&&null!=u.return&&await u.return()}finally{if(l)throw s}}o&&await this._add(e,t)}closest(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.kBucketSize;return function*(){const r=new Fy(e,n);for(const e of t.toIterable())r.addWithKadId({id:e.peerId,multiaddrs:[]},e.kadId);yield*Xv(r.peers,(e=>{let{peer:t}=e;return t.id}))}()}count(){return function e(t){if(Yy(t))return t.peers.length;let n=0;return null!=t.left&&(n+=e(t.left)),null!=t.right&&(n+=e(t.right)),n}(this.root)}get(e){const t=this._determineBucket(e),n=this._indexOf(t,e);return t.peers[n]}async remove(e){const t=this._determineBucket(e),n=this._indexOf(t,e);if(n>-1){var r;const e=t.peers.splice(n,1)[0];await(null===(r=this.onRemove)||void 0===r?void 0:r.call(this,e,t))}}*toIterable(){yield*function*e(t){Yy(t)?yield*t.peers:(yield*e(t.left),yield*e(t.right))}(this.root)}distance(e,t){return BigInt("0x"+Wt(Oy(e,t),"base16"))}_determineBucket(e){const t=Wt(e,"base2");return function e(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Yy(n)?n:e("0"===t[r]?n.left:n.right,r+1)}(this.root)}_indexOf(e,t){return e.peers.findIndex((e=>ne(e.kadId,t)))}async _split(e){const t={prefix:"0",depth:e.depth+1,peers:[]},n={prefix:"1",depth:e.depth+1,peers:[]};for(const o of e.peers){var r,i;if("0"===Wt(o.kadId,"base2")[e.depth])t.peers.push(o),await(null===(r=this.onMove)||void 0===r?void 0:r.call(this,o,e,t));else n.peers.push(o),await(null===(i=this.onMove)||void 0===i?void 0:i.call(this,o,e,n))}!function(e,t,n){delete e.peers,e.left=t,e.right=n,""===e.prefix&&(delete e.depth,delete e.prefix)}(e,t,n)}}const Xy=20,Zy=6,Jy=3,ew="kad-peer",tw=6e5;class nw extends wc{constructor(e,t){var n,r,i,o,s,a,l,c,u,d,h;super(),w(this,"kBucketSize",void 0),w(this,"kb",void 0),w(this,"network",void 0),w(this,"closestPeerTagger",void 0),w(this,"log",void 0),w(this,"components",void 0),w(this,"running",void 0),w(this,"pingNewContactTimeout",void 0),w(this,"pingNewContactQueue",void 0),w(this,"pingOldContactTimeout",void 0),w(this,"pingOldContactQueue",void 0),w(this,"populateFromDatastoreOnStart",void 0),w(this,"populateFromDatastoreLimit",void 0),w(this,"protocol",void 0),w(this,"peerTagName",void 0),w(this,"peerTagValue",void 0),w(this,"metrics",void 0),this.components=e,this.log=e.logger.forComponent("".concat(t.logPrefix,":routing-table")),this.kBucketSize=null!==(n=t.kBucketSize)&&void 0!==n?n:Xy,this.running=!1,this.protocol=t.protocol,this.network=t.network,this.peerTagName=null!==(r=t.peerTagName)&&void 0!==r?r:ew,this.peerTagValue=null!==(i=t.peerTagValue)&&void 0!==i?i:1,this.pingOldContacts=this.pingOldContacts.bind(this),this.verifyNewContact=this.verifyNewContact.bind(this),this.peerAdded=this.peerAdded.bind(this),this.peerRemoved=this.peerRemoved.bind(this),this.populateFromDatastoreOnStart=null===(o=t.populateFromDatastoreOnStart)||void 0===o||o,this.populateFromDatastoreLimit=null!==(s=t.populateFromDatastoreLimit)&&void 0!==s?s:1e3,this.pingOldContactQueue=new tp({concurrency:null!==(a=t.pingOldContactConcurrency)&&void 0!==a?a:20,metricName:"".concat(t.metricsPrefix,"_ping_old_contact_queue"),metrics:this.components.metrics,maxSize:null!==(l=t.pingOldContactMaxQueueSize)&&void 0!==l?l:100}),this.pingOldContactTimeout=new vp(E(E({},null!==(c=t.pingOldContactTimeout)&&void 0!==c?c:{}),{},{metrics:this.components.metrics,metricName:"".concat(t.metricsPrefix,"_routing_table_ping_old_contact_time_milliseconds")})),this.pingNewContactQueue=new tp({concurrency:null!==(u=t.pingNewContactConcurrency)&&void 0!==u?u:20,metricName:"".concat(t.metricsPrefix,"_ping_new_contact_queue"),metrics:this.components.metrics,maxSize:null!==(d=t.pingNewContactMaxQueueSize)&&void 0!==d?d:100}),this.pingNewContactTimeout=new vp(E(E({},null!==(h=t.pingNewContactTimeout)&&void 0!==h?h:{}),{},{metrics:this.components.metrics,metricName:"".concat(t.metricsPrefix,"_routing_table_ping_new_contact_time_milliseconds")})),this.kb=new $y({kBucketSize:t.kBucketSize,prefixLength:t.prefixLength,splitThreshold:t.splitThreshold,numberOfOldContactsToPing:t.numberOfOldContactsToPing,lastPingThreshold:t.lastPingThreshold,ping:this.pingOldContacts,verify:this.verifyNewContact,onAdd:this.peerAdded,onRemove:this.peerRemoved}),this.closestPeerTagger=new Gy(this.components,{logPrefix:t.logPrefix,routingTable:this,peerSetSize:t.closestPeerSetSize,refreshInterval:t.closestPeerSetRefreshInterval,closeTagName:t.closeTagName,closeTagValue:t.closeTagValue}),null!=this.components.metrics&&(this.metrics={routingTableSize:this.components.metrics.registerMetric("".concat(t.metricsPrefix,"_routing_table_size")),routingTableKadBucketTotal:this.components.metrics.registerMetric("".concat(t.metricsPrefix,"_routing_table_kad_bucket_total")),routingTableKadBucketAverageOccupancy:this.components.metrics.registerMetric("".concat(t.metricsPrefix,"_routing_table_kad_bucket_average_occupancy")),routingTableKadBucketMinOccupancy:this.components.metrics.registerMetric("".concat(t.metricsPrefix,"_routing_table_kad_bucket_min_occupancy")),routingTableKadBucketMaxOccupancy:this.components.metrics.registerMetric("".concat(t.metricsPrefix,"_routing_table_kad_bucket_max_occupancy")),routingTableKadBucketMaxDepth:this.components.metrics.registerMetric("".concat(t.metricsPrefix,"_routing_table_kad_bucket_max_depth")),kadBucketEvents:this.components.metrics.registerCounterGroup("".concat(t.metricsPrefix,"_kad_bucket_events_total"))})}isStarted(){return this.running}async start(){this.running||(this.running=!0,await zh(this.closestPeerTagger),await this.kb.addSelfPeer(this.components.peerId))}async afterStart(){Promise.resolve().then((async()=>{if(!this.populateFromDatastoreOnStart)return;let e=0;for(const n of await this.components.peerStore.all({filters:[e=>e.protocols.includes(this.protocol)&&e.tags.has(ew)],limit:this.populateFromDatastoreLimit})){if(!this.running)return;try{await this.add(n.id),e++}catch(t){this.log("failed to add peer %p to routing table, removing kad-dht peer tags - %e"),await this.components.peerStore.merge(n.id,{tags:{[this.peerTagName]:void 0}})}}this.log("added %d peer store peers to the routing table",e)})).catch((e=>{this.log.error("error adding peer store peers to the routing table %e",e)}))}async stop(){this.running=!1,await Fh(this.closestPeerTagger),this.pingOldContactQueue.abort(),this.pingNewContactQueue.abort()}async peerAdded(e,t){var n;this.components.peerId.equals(e.peerId)||await this.components.peerStore.merge(e.peerId,{tags:{[this.peerTagName]:{value:this.peerTagValue}}}),this.updateMetrics(),null===(n=this.metrics)||void 0===n||n.kadBucketEvents.increment({peer_added:!0}),this.safeDispatchEvent("peer:add",{detail:e.peerId})}async peerRemoved(e,t){var n;this.components.peerId.equals(e.peerId)||await this.components.peerStore.merge(e.peerId,{tags:{[this.peerTagName]:void 0}}),this.updateMetrics(),null===(n=this.metrics)||void 0===n||n.kadBucketEvents.increment({peer_removed:!0}),this.safeDispatchEvent("peer:remove",{detail:e.peerId})}pingOldContacts(e,t){var n=this;return ru((function*(){if(!n.running)return;const r=[];for(const d of e){var i;null!=n.kb.get(d.kadId)?(null===(i=n.metrics)||void 0===i||i.kadBucketEvents.increment({ping_old_contact:!0}),r.push((async()=>{const e=n.pingOldContactQueue.find(d.peerId);if(null!=e){n.log("asked to ping contact %p was already being pinged",d.peerId);return await e.join(t)?void 0:d}if(!await n.pingOldContactQueue.add((async e=>{const t=n.pingOldContactTimeout.getTimeoutSignal(),r=Vf([t,null===e||void 0===e?void 0:e.signal]);try{return await n.pingContact(d,e)}catch(o){var i;return null===(i=n.metrics)||void 0===i||i.kadBucketEvents.increment({ping_old_contact_error:!0}),!0}finally{n.pingOldContactTimeout.cleanUp(t),r.clear()}}),{peerId:d.peerId,signal:null===t||void 0===t?void 0:t.signal}))return d}))):n.log("asked to ping contact %p that was not in routing table",d.peerId)}var o,s=!1,a=!1;try{for(var l,c=Kc(Ip(r));s=!(l=yield nu(c.next())).done;s=!1){const e=l.value;null!=e&&(yield e)}}catch(u){a=!0,o=u}finally{try{s&&null!=c.return&&(yield nu(c.return()))}finally{if(a)throw o}}}))()}async verifyNewContact(e,t){const n=this.pingNewContactTimeout.getTimeoutSignal(),r=Vf([n,null===t||void 0===t?void 0:t.signal]);try{const t=this.pingNewContactQueue.find(e.peerId);return null!=t?(this.log("joining existing ping to add new peer %p to routing table",e.peerId),await t.join({signal:r})):await this.pingNewContactQueue.add((async t=>{var n;return null===(n=this.metrics)||void 0===n||n.kadBucketEvents.increment({ping_new_contact:!0}),this.log("pinging new peer %p before adding to routing table",e.peerId),this.pingContact(e,t)}),{peerId:e.peerId,signal:r})}catch(o){var i;return this.log.trace("tried to add peer %p but they were not online",e.peerId),null===(i=this.metrics)||void 0===i||i.kadBucketEvents.increment({ping_new_contact_error:!0}),!1}finally{this.pingNewContactTimeout.cleanUp(n),r.clear()}}async pingContact(e,t){try{return this.log("pinging contact %p",e.peerId),await this.components.ping.ping(e.peerId,t),this.log("contact %p ping ok",e.peerId),this.safeDispatchEvent("peer:ping",{detail:e.peerId}),!0}catch(n){return this.log("error pinging old contact %p - %e",e.peerId,n),!1}}get size(){return null==this.kb?0:this.kb.count()}async find(e){var t;const n=await Sy(e);return null===(t=this.kb.get(n))||void 0===t?void 0:t.peerId}closestPeer(e){const t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.kBucketSize;return null==this.kb?[]:[...this.kb.closest(e,t)]}async add(e,t){if(null==this.kb)throw new Error("RoutingTable is not started");await this.kb.add(e,t)}async remove(e){if(null==this.kb)throw new Error("RoutingTable is not started");const t=await Sy(e);await this.kb.remove(t)}updateMetrics(){if(null==this.metrics||null==this.kb)return;let e=0,t=0,n=0,r=20,i=0;!function o(s){if(Yy(s))return s.depth>n&&(n=s.depth),t++,e+=s.peers.length,s.peers.length<r&&(r=s.peers.length),void(s.peers.length>i&&(i=s.peers.length));o(s.left),o(s.right)}(this.kb.root),this.metrics.routingTableSize.update(e),this.metrics.routingTableKadBucketTotal.update(t),this.metrics.routingTableKadBucketAverageOccupancy.update(Math.round(e/t)),this.metrics.routingTableKadBucketMinOccupancy.update(r),this.metrics.routingTableKadBucketMaxOccupancy.update(i),this.metrics.routingTableKadBucketMaxDepth.update(n)}}const rw=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];class iw{constructor(e,t){w(this,"log",void 0),w(this,"peerRouting",void 0),w(this,"routingTable",void 0),w(this,"refreshInterval",void 0),w(this,"refreshQueryTimeout",void 0),w(this,"commonPrefixLengthRefreshedAt",void 0),w(this,"refreshTimeoutId",void 0);const{peerRouting:n,routingTable:r,refreshInterval:i,refreshQueryTimeout:o,logPrefix:s}=t;this.log=e.logger.forComponent("".concat(s,":routing-table:refresh")),this.peerRouting=n,this.routingTable=r,this.refreshInterval=null!==i&&void 0!==i?i:3e5,this.refreshQueryTimeout=null!==o&&void 0!==o?o:3e4,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async afterStart(){this.log("refreshing routing table every ".concat(this.refreshInterval,"ms")),this.refreshTable(!0)}async stop(){null!=this.refreshTimeoutId&&clearTimeout(this.refreshTimeoutId)}refreshTable(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.log("refreshing routing table");const t=this._maxCommonPrefix(),n=this._getTrackedCommonPrefixLengthsForRefresh(t);this.log("max common prefix length ".concat(t)),this.log("tracked CPLs [ ".concat(n.map((e=>e.toISOString())).join(", ")," ]")),Promise.all(n.map((async(r,i)=>{try{if(await this._refreshCommonPrefixLength(i,r,e),0===this._numPeersForCpl(t)){const t=Math.min(2*(i+1),n.length-1);for(let n=i+1;n<t+1;n++)try{await this._refreshCommonPrefixLength(n,r,e)}catch(o){this.log.error(o)}}}catch(o){this.log.error(o)}}))).catch((e=>{this.log.error(e)})).then((()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),null!=this.refreshTimeoutId.unref&&this.refreshTimeoutId.unref()})).catch((e=>{this.log.error(e)}))}async _refreshCommonPrefixLength(e,t,n){if(!n&&t.getTime()>Date.now()-this.refreshInterval)return void this.log("not running refresh for cpl %s as time since last refresh not above interval",e);const r=await this._generateRandomPeerId(e);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,r,this.routingTable.size);const i=AbortSignal.timeout(this.refreshQueryTimeout),o=await Wy(this.peerRouting.getClosestPeers(r.toMultihash().bytes,{signal:i}));this.log("found ".concat(o," peers that were close to imaginary peer %p"),r),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,r,this.routingTable.size)}_getTrackedCommonPrefixLengthsForRefresh(e){e>15&&(e=15);const t=[];for(let r=0;r<=e;r++){var n;t[r]=null!==(n=this.commonPrefixLengthRefreshedAt[r])&&void 0!==n?n:new Date}return t}async _generateRandomPeerId(e){if(null==this.routingTable.kb)throw new Error("Routing table not started");if(null==this.routingTable.kb.localPeer)throw new Error("Local peer not set");const t=gp(2),n=(t[1]<<8)+t[0];return oa(St(await this._makePeerId(this.routingTable.kb.localPeer.kadId,n,e)))}async _makePeerId(e,t,n){if(n>15)throw new Error("Cannot generate peer ID for common prefix length greater than ".concat(15));const r=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1),i=65535<<16-(n+1),o=rw[(r^32768>>n)&i|t&~i],s=new ArrayBuffer(34),a=new DataView(s,0,s.byteLength);return a.setUint8(0,_t.code),a.setUint8(1,32),a.setUint32(2,o,!1),new Uint8Array(a.buffer,a.byteOffset,a.byteLength)}_maxCommonPrefix(){let e=0;for(const t of this._prefixLengths())t>e&&(e=t);return e}_numPeersForCpl(e){let t=0;for(const n of this._prefixLengths())n===e&&t++;return t}*_prefixLengths(){var e;if(null!=(null===(e=this.routingTable.kb)||void 0===e?void 0:e.localPeer))for(const{kadId:t}of this.routingTable.kb.toIterable()){const e=Oy(this.routingTable.kb.localPeer.kadId,t);let n=0;for(const t of e){if(0!==t)break;n++}yield n}}}class ow{constructor(e,t){w(this,"peerId",void 0),w(this,"providers",void 0),w(this,"peerStore",void 0),w(this,"log",void 0),this.log=e.logger.forComponent("".concat(t.logPrefix,":rpc:handlers:add-provider")),this.peerId=e.peerId,this.providers=t.providers,this.peerStore=e.peerStore}async handle(e,t){if(null==t.key||0===t.key.length)throw new q("Missing key");let n;try{n=Mt.decode(t.key)}catch(r){throw new q("Invalid CID")}null!=t.providers&&0!==t.providers.length||this.log.error("no providers found in message"),this.log("%p asked us, %p to store provider record for for %c",e,this.peerId,n),await Promise.all(t.providers.map((async t=>{const r=oa(St(t.id)),i=t.multiaddrs.map((e=>fc(e)));e.equals(r)?t.multiaddrs.length<1?this.log("no valid addresses for provider %p. Ignore",e):(this.log.trace("received provider %p for %s (addrs %s)",e,n,i),await this.providers.addProvider(n,r),await this.peerStore.merge(r,{multiaddrs:i})):this.log("invalid provider peer %p from %p",t.id,e)})))}}class sw{constructor(e,t){w(this,"peerRouting",void 0),w(this,"peerInfoMapper",void 0),w(this,"peerId",void 0),w(this,"addressManager",void 0),w(this,"log",void 0);const{peerRouting:n,logPrefix:r}=t;this.log=e.logger.forComponent("".concat(r,":rpc:handlers:find-node")),this.peerId=e.peerId,this.addressManager=e.addressManager,this.peerRouting=n,this.peerInfoMapper=t.peerInfoMapper}async handle(e,t){if(this.log("incoming request from %p for peers closer to %b",e,t.key),null==t.key)throw new q("Invalid FIND_NODE message received - key was missing");const n=await this.peerRouting.getCloserPeersOffline(t.key,e);ne(this.peerId.toMultihash().bytes,t.key)&&n.push({id:this.peerId,multiaddrs:this.addressManager.getAddresses().map((e=>e.decapsulateCode(Ol("p2p").code)))});const r={type:ry.FIND_NODE,clusterLevel:t.clusterLevel,closer:n.map(this.peerInfoMapper).filter((e=>{let{multiaddrs:t}=e;return t.length})).map((e=>({id:e.id.toMultihash().bytes,multiaddrs:e.multiaddrs.map((e=>e.bytes))}))),providers:[]};return 0===r.closer.length&&this.log("could not find any peers closer to %b than %p",t.key,e),r}}class aw{constructor(e,t){w(this,"peerId",void 0),w(this,"peerRouting",void 0),w(this,"providers",void 0),w(this,"peerStore",void 0),w(this,"peerInfoMapper",void 0),w(this,"log",void 0);const{peerRouting:n,providers:r,logPrefix:i}=t;this.log=e.logger.forComponent("".concat(i,":rpc:handlers:get-providers")),this.peerId=e.peerId,this.peerStore=e.peerStore,this.peerRouting=n,this.providers=r,this.peerInfoMapper=t.peerInfoMapper}async handle(e,t){if(null==t.key)throw new q("Invalid GET_PROVIDERS message received - key was missing");let n;try{n=Mt.decode(t.key)}catch(s){throw new q("Invalid CID")}this.log("%p asking for providers for %s",e,n);const[r,i]=await Promise.all([eu(Xv(await this.providers.getProviders(n),(async e=>{const t=await this.peerStore.get(e),n={id:t.id,multiaddrs:t.addresses.map((e=>{let{multiaddr:t}=e;return t}))};return n}))),this.peerRouting.getCloserPeersOffline(t.key,e)]),o={type:ry.GET_PROVIDERS,key:t.key,clusterLevel:t.clusterLevel,closer:i.map(this.peerInfoMapper).filter((e=>{let{id:t,multiaddrs:n}=e;return n.length>0})).map((e=>({id:e.id.toMultihash().bytes,multiaddrs:e.multiaddrs.map((e=>e.bytes))}))),providers:r.map(this.peerInfoMapper).filter((e=>{let{id:t,multiaddrs:n}=e;return n.length>0})).map((e=>({id:e.id.toMultihash().bytes,multiaddrs:e.multiaddrs.map((e=>e.bytes))})))};return this.log("got %s providers %s closerPeers",o.providers.length,o.closer.length),o}async _getAddresses(e){return[]}}class lw{constructor(e,t){w(this,"peerStore",void 0),w(this,"datastore",void 0),w(this,"peerRouting",void 0),w(this,"log",void 0),w(this,"datastorePrefix",void 0),this.log=e.logger.forComponent("".concat(t.logPrefix,":rpc:handlers:get-value")),this.datastorePrefix="".concat(t.datastorePrefix,"/record"),this.peerStore=e.peerStore,this.datastore=e.datastore,this.peerRouting=t.peerRouting}async handle(e,t){const n=t.key;if(this.log("%p asked for key %b",e,n),null==n||0===n.length)throw new q("Invalid key");const r={type:ry.GET_VALUE,key:n,clusterLevel:t.clusterLevel,closer:[],providers:[]};if(function(e){return"/pk/"===Wt(e.subarray(0,4))}(n)){this.log("is public key");const e=function(e){return oa(St(e.subarray(4)))}(n);let t;try{const n=await this.peerStore.get(e);if(null==n.id.publicKey)throw new D("No public key found in key book");t=Qs(n.id.publicKey)}catch(s){if("NotFoundError"!==s.name)throw s}if(null!=t)return this.log("returning found public key"),r.record=new $v(n,t,new Date).serialize(),r}const[i,o]=await Promise.all([this._checkLocalDatastore(n),this.peerRouting.getCloserPeersOffline(n,e)]);return null!=i&&(this.log("had record for %b in local datastore",n),r.record=i.serialize()),o.length>0&&(this.log("had %s closer peers in routing table",o.length),r.closer=o.map((e=>({id:e.id.toMultihash().bytes,multiaddrs:e.multiaddrs.map((e=>e.bytes))})))),r}async _checkLocalDatastore(e){this.log("checkLocalDatastore looking for %b",e);const t=ky(this.datastorePrefix,e);let n;try{n=await this.datastore.get(t)}catch(i){if("NotFoundError"===i.name)return;throw i}const r=$v.deserialize(n);if(!(null==r.timeReceived||Date.now()-r.timeReceived.getTime()>jv))return r;await this.datastore.delete(t)}}class cw{constructor(e,t){w(this,"log",void 0),this.log=e.logger.forComponent("".concat(t.logPrefix,":rpc:handlers:ping"))}async handle(e,t){return this.log("ping from %p",e),t}}class uw{constructor(e,t){w(this,"components",void 0),w(this,"validators",void 0),w(this,"log",void 0),w(this,"datastorePrefix",void 0);const{validators:n}=t;this.components=e,this.log=e.logger.forComponent("".concat(t.logPrefix,":rpc:handlers:put-value")),this.datastorePrefix="".concat(t.datastorePrefix,"/record"),this.validators=n}async handle(e,t){const n=t.key;if(this.log("%p asked us to store value for key %b",e,n),null==t.record){const t="Empty record from: ".concat(e.toString());throw this.log.error(t),new q(t)}try{const e=$v.deserialize(t.record);await vy(this.validators,e),e.timeReceived=new Date;const r=ky(this.datastorePrefix,e.key);await this.components.datastore.put(r,e.serialize().subarray()),this.log("put record for %b into datastore under key %k",n,r)}catch(r){this.log("did not put record for key %b into datastore %o",n,r)}return t}}class dw{constructor(e,t){var n,r;w(this,"handlers",void 0),w(this,"routingTable",void 0),w(this,"log",void 0),w(this,"metrics",void 0),this.metrics={operations:null===(n=e.metrics)||void 0===n?void 0:n.registerCounterGroup("".concat(t.metricsPrefix,"_inbound_rpc_requests_total")),errors:null===(r=e.metrics)||void 0===r?void 0:r.registerCounterGroup("".concat(t.metricsPrefix,"_inbound_rpc_errors_total"))},this.log=e.logger.forComponent("".concat(t.logPrefix,":rpc")),this.routingTable=t.routingTable,this.handlers={[ry.GET_VALUE.toString()]:new lw(e,t),[ry.PUT_VALUE.toString()]:new uw(e,t),[ry.FIND_NODE.toString()]:new sw(e,t),[ry.ADD_PROVIDER.toString()]:new ow(e,t),[ry.GET_PROVIDERS.toString()]:new aw(e,t),[ry.PING.toString()]:new cw(e,t)}}async handleMessage(e,t){const n=this.handlers[t.type];if(null!=n)try{var r;return null===(r=this.metrics.operations)||void 0===r||r.increment({[t.type]:!0}),await n.handle(e,t)}catch(o){var i;null===(i=this.metrics.errors)||void 0===i||i.increment({[t.type]:!0})}else this.log.error("no handler found for message type: ".concat(t.type))}onIncomingStream(e){let t="unknown";Promise.resolve().then((async()=>{const{stream:n,connection:r}=e,i=r.remotePeer,o=this;await Ng(n,(e=>Hp(e)),function(){var e=ru((function*(e){var n,r=!1,s=!1;try{for(var a,l=Kc(e);r=!(a=yield nu(l.next())).done;r=!1){const e=a.value;{const n=ly.decode(e);t=n.type,o.log("incoming %s from %p",n.type,i);const r=yield nu(o.handleMessage(i,n));null!=r&&(yield ly.encode(r))}}}catch(c){s=!0,n=c}finally{try{r&&null!=l.return&&(yield nu(l.return()))}finally{if(s)throw n}}}));return function(t){return e.apply(this,arguments)}}(),(e=>Kp(e)),n)})).catch((n=>{this.log.error("error handling %s RPC message from %p - %e",t,e.connection.remotePeer,n)}))}}class hw extends wc{constructor(e,t){super(),w(this,"log",void 0),w(this,"components",void 0),w(this,"protocol",void 0),w(this,"running",void 0),w(this,"registrarId",void 0);const{protocol:n,logPrefix:r}=t;this.components=e,this.log=e.logger.forComponent("".concat(r,":topology-listener")),this.running=!1,this.protocol=n}isStarted(){return this.running}async start(){this.running||(this.running=!0,this.registrarId=await this.components.registrar.register(this.protocol,{onConnect:e=>{this.log("observed peer %p with protocol %s",e,this.protocol),this.dispatchEvent(new CustomEvent("peer",{detail:e}))}}))}async stop(){this.running=!1,null!=this.registrarId&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}class fw{constructor(e){w(this,"dht",void 0),this.dht=e}async provide(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await ld(this.dht.provide(e,t))}async cancelReprovide(e){await this.dht.cancelReprovide(e)}findProviders(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var r,i=!1,o=!1;try{for(var s,a=Kc(t.dht.findProviders(e,n));i=!(s=yield nu(a.next())).done;i=!1){const e=s.value;"PROVIDER"===e.name&&(yield*dd(Kc(e.providers)))}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}()})).apply(this,arguments)}async put(e,t,n){await ld(this.dht.put(e,t,n))}async get(e,t){var n,r=!1,i=!1;try{for(var o,s=Kc(this.dht.get(e,t));r=!(o=await s.next()).done;r=!1){const e=o.value;if("VALUE"===e.name)return e.value}}catch(a){i=!0,n=a}finally{try{r&&null!=s.return&&await s.return()}finally{if(i)throw n}}throw new D("Could not find value for key")}}class pw{constructor(e){w(this,"dht",void 0),this.dht=e}async findPeer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,r=!1,i=!1;try{for(var o,s=Kc(this.dht.findPeer(e,t));r=!(o=await s.next()).done;r=!1){const e=o.value;if("FINAL_PEER"===e.name)return e.peer}}catch(a){i=!0,n=a}finally{try{r&&null!=s.return&&await s.return()}finally{if(i)throw n}}throw new D("Peer not found")}getClosestPeers(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var r,i=!1,o=!1;try{for(var s,a=Kc(t.dht.getClosestPeers(e,n));i=!(s=yield nu(a.next())).done;i=!1){const e=s.value;"FINAL_PEER"===e.name&&(yield e.peer)}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&(yield nu(a.return()))}finally{if(o)throw r}}}()})).apply(this,arguments)}}class gw extends wc{constructor(e){var t,n,r,i,o,s,a,l,c,u,d,h,f,p,g;let m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),w(this,"k",void 0),w(this,"a",void 0),w(this,"d",void 0),w(this,"protocol",void 0),w(this,"routingTable",void 0),w(this,"providers",void 0),w(this,"network",void 0),w(this,"peerRouting",void 0),w(this,"components",void 0),w(this,"log",void 0),w(this,"running",void 0),w(this,"clientMode",void 0),w(this,"validators",void 0),w(this,"selectors",void 0),w(this,"queryManager",void 0),w(this,"contentFetching",void 0),w(this,"contentRouting",void 0),w(this,"routingTableRefresh",void 0),w(this,"rpc",void 0),w(this,"topologyListener",void 0),w(this,"querySelf",void 0),w(this,"maxInboundStreams",void 0),w(this,"maxOutboundStreams",void 0),w(this,"dhtContentRouting",void 0),w(this,"dhtPeerRouting",void 0),w(this,"peerInfoMapper",void 0),w(this,"reprovider",void 0),w(this,Symbol.toStringTag,"@libp2p/kad-dht"),w(this,Uh,["@libp2p/content-routing","@libp2p/peer-routing","@libp2p/peer-discovery"]),w(this,Bh,["@libp2p/identify","@libp2p/ping"]);const v=null!==(t=m.logPrefix)&&void 0!==t?t:"libp2p:kad-dht",y=null!==(n=m.datastorePrefix)&&void 0!==n?n:"/dht",b=null!==(r=m.metricsPrefix)&&void 0!==r?r:"libp2p_kad_dht",S={queries:null===(i=e.metrics)||void 0===i?void 0:i.registerMetricGroup("".concat(b,"_operations_total"),{label:"operation"}),errors:null===(o=e.metrics)||void 0===o?void 0:o.registerCounterGroup("".concat(b,"_operation_errors_total"),{label:"operation"}),queryTime:null===(s=e.metrics)||void 0===s?void 0:s.registerMetricGroup("".concat(b,"_operation_time_seconds"),{label:"operation"}),errorTime:null===(a=e.metrics)||void 0===a?void 0:a.registerMetricGroup("".concat(b,"_operation_error_time_seconds"),{label:"operation"})};this.running=!1,this.components=e,this.log=e.logger.forComponent(v),this.k=null!==(l=m.kBucketSize)&&void 0!==l?l:Xy,this.a=null!==(c=m.alpha)&&void 0!==c?c:10,this.d=null!==(u=m.disjointPaths)&&void 0!==u?u:this.a,this.protocol=null!==(d=m.protocol)&&void 0!==d?d:"/ipfs/kad/1.0.0",this.clientMode=null===(h=m.clientMode)||void 0===h||h,this.maxInboundStreams=null!==(f=m.maxInboundStreams)&&void 0!==f?f:32,this.maxOutboundStreams=null!==(p=m.maxOutboundStreams)&&void 0!==p?p:64,this.peerInfoMapper=null!==(g=m.peerInfoMapper)&&void 0!==g?g:by;const k=Eu();this.providers=new By(e,E(E({},m.providers),{},{logPrefix:v,datastorePrefix:y,lock:k})),this.validators=E(E({},yy),m.validators),this.selectors=E(E({},my),m.selectors),this.network=new Dy(e,{protocol:this.protocol,logPrefix:v,metricsPrefix:b}),this.routingTable=new nw(e,{kBucketSize:this.k,pingOldContactTimeout:m.pingOldContactTimeout,pingOldContactConcurrency:m.pingOldContactConcurrency,pingOldContactMaxQueueSize:m.pingOldContactMaxQueueSize,pingNewContactTimeout:m.pingNewContactTimeout,pingNewContactConcurrency:m.pingNewContactConcurrency,pingNewContactMaxQueueSize:m.pingNewContactMaxQueueSize,protocol:this.protocol,logPrefix:v,metricsPrefix:b,prefixLength:m.prefixLength,splitThreshold:m.kBucketSplitThreshold,network:this.network});const x=If();!0===m.allowQueryWithZeroPeers&&x.resolve(),this.queryManager=new jy(e,{disjointPaths:this.d,alpha:this.a,logPrefix:v,metricsPrefix:b,initialQuerySelfHasRun:x,routingTable:this.routingTable,allowQueryWithZeroPeers:m.allowQueryWithZeroPeers}),this.peerRouting=new Uy(e,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,logPrefix:v}),this.contentFetching=new Ty(e,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,network:this.network,logPrefix:v,datastorePrefix:y}),this.contentRouting=new Ny(e,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,logPrefix:v}),this.routingTableRefresh=new iw(e,{peerRouting:this.peerRouting,routingTable:this.routingTable,logPrefix:v}),this.rpc=new dw(e,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,logPrefix:v,metricsPrefix:b,datastorePrefix:y,peerInfoMapper:this.peerInfoMapper}),this.topologyListener=new hw(e,{protocol:this.protocol,logPrefix:v}),this.querySelf=new Hy(e,{peerRouting:this.peerRouting,interval:m.querySelfInterval,initialInterval:m.initialQuerySelfInterval,logPrefix:v,initialQuerySelfHasRun:x,operationMetrics:S}),this.reprovider=new Qy(e,E(E({},m.reprovide),{},{logPrefix:v,metricsPrefix:b,datastorePrefix:y,contentRouting:this.contentRouting,lock:k,operationMetrics:S})),this.network.addEventListener("peer",(e=>{const t=e.detail;this.onPeerConnect(t).catch((e=>{this.log.error("could not add %p to routing table",t.id,e)})),this.dispatchEvent(new CustomEvent("peer",{detail:t}))})),this.topologyListener.addEventListener("peer",(e=>{const t=e.detail;Promise.resolve().then((async()=>{const e=await this.components.peerStore.get(t),n={id:t,multiaddrs:e.addresses.map((e=>{let{multiaddr:t}=e;return t})),protocols:e.protocols};await this.onPeerConnect(n)})).catch((e=>{this.log.error("could not add %p to routing table - %e - %e",t,e)}))})),this.dhtPeerRouting=new pw(this),this.dhtContentRouting=new fw(this),null==m.clientMode&&e.events.addEventListener("self:peer:update",(e=>{this.log("received update of self-peer info"),Promise.resolve().then((async()=>{const t=e.detail.peer.addresses.some((e=>{let{multiaddr:t}=e;return function(e){const t=e.stringTuples();for(const n of t)if(290===n[0])return!1;if(54===t[0][0]||55===t[0][0]||56===t[0][0])return!0;if(4===t[0][0]||41===t[0][0]){const e=Nd("".concat(t[0][1]));return null==e||!e}return!1}(t)})),n=this.getMode();t&&"client"===n?await this.setMode("server"):"server"!==n||t||await this.setMode("client")})).catch((e=>{this.log.error("error setting dht server mode",e)}))})),this.get=Iy(this.get.bind(this),S,"GET_VALUE"),this.findProviders=Iy(this.findProviders.bind(this),S,"FIND_PROVIDERS"),this.findPeer=Iy(this.findPeer.bind(this),S,"FIND_PEER"),this.getClosestPeers=Iy(this.getClosestPeers.bind(this),S,"GET_CLOSEST_PEERS"),this.provide=Iy(this.provide.bind(this),S,"PROVIDE"),this.put=Iy(this.put.bind(this),S,"PUT_VALUE")}get[bc](){return this.dhtContentRouting}get[Ec](){return this.dhtPeerRouting}get[Sc](){return this}async onPeerConnect(e){if(this.log.trace("peer %p connected",e.id),0!==(e=this.peerInfoMapper(e)).multiaddrs.length)try{await this.routingTable.add(e.id)}catch(t){this.log.error("could not add %p to routing table",e.id,t)}else this.log.trace("ignoring %p as there were no valid addresses in %s after filtering",e.id,e.multiaddrs.map((e=>e.toString())))}isStarted(){return this.running}getMode(){return this.clientMode?"client":"server"}async setMode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e!==this.getMode()||t?(await this.components.registrar.unhandle(this.protocol),e!==this.getMode()||t?"client"===e?(this.log("enabling client mode while in %s mode",this.getMode()),this.clientMode=!0):(this.log("enabling server mode while in %s mode",this.getMode()),this.clientMode=!1,await this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams})):this.log("already in %s mode",e)):this.log("already in %s mode",e)}async start(){this.running||(this.running=!0,await this.setMode(this.clientMode?"client":"server",!0),await zh(this.routingTable,this.queryManager,this.network,this.topologyListener,this.routingTableRefresh,this.reprovider),await zh(this.querySelf))}async stop(){this.running=!1,await Fh(this.querySelf,this.queryManager,this.network,this.routingTable,this.routingTableRefresh,this.topologyListener,this.reprovider)}put(e,t){var n=this;return ru((function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function*(){yield*dd(Kc(n.contentFetching.put(e,t,r)))}()})).apply(this,arguments)}get(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){yield*dd(Kc(t.contentFetching.get(e,n)))}()})).apply(this,arguments)}provide(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){yield*dd(Kc(t.contentRouting.provide(e,t.components.addressManager.getAddresses(),n)))}()})).apply(this,arguments)}async cancelReprovide(e){await this.providers.removeProvider(e,this.components.peerId)}findProviders(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){yield*dd(Kc(t.contentRouting.findProviders(e,n)))}()})).apply(this,arguments)}findPeer(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){yield*dd(Kc(t.peerRouting.findPeer(e,n)))}()})).apply(this,arguments)}getClosestPeers(e){var t=this;return ru((function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){yield*dd(Kc(t.peerRouting.getClosestPeers(e,n)))}()})).apply(this,arguments)}async refreshRoutingTable(){this.routingTableRefresh.refreshTable(!0)}}var mw;function vw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new gw(t,e)}!function(e){e[e.SEND_QUERY=0]="SEND_QUERY",e[e.PEER_RESPONSE=1]="PEER_RESPONSE",e[e.FINAL_PEER=2]="FINAL_PEER",e[e.QUERY_ERROR=3]="QUERY_ERROR",e[e.PROVIDER=4]="PROVIDER",e[e.VALUE=5]="VALUE",e[e.ADD_PEER=6]="ADD_PEER",e[e.DIAL_PEER=7]="DIAL_PEER",e[e.PATH_ENDED=8]="PATH_ENDED"}(mw||(mw={}));const yw=Yw("dns4"),ww=Yw("dns6"),bw=Yw("dnsaddr"),Ew=Gw(Yw("dns"),bw,yw,ww),Sw=Gw(Yw("ip4"),Yw("ip6")),kw=Gw(Qw(Sw,Yw("tcp")),Qw(Ew,Yw("tcp"))),xw=Qw(Sw,Yw("udp")),Cw=Qw(xw,Yw("utp")),Pw=Qw(xw,Yw("quic")),Aw=Qw(xw,Yw("quic-v1")),Iw=Gw(Qw(kw,Yw("ws")),Qw(Ew,Yw("ws"))),_w=Gw(Qw(Iw,Yw("p2p")),Iw),Tw=Gw(Qw(kw,Yw("wss")),Qw(Ew,Yw("wss")),Qw(kw,Yw("tls"),Yw("ws")),Qw(Ew,Yw("tls"),Yw("ws"))),Lw=Gw(Qw(Tw,Yw("p2p")),Tw),Rw=Gw(Qw(kw,Yw("http")),Qw(Sw,Yw("http")),Qw(Ew,Yw("http"))),Nw=Gw(Qw(kw,Yw("https")),Qw(Sw,Yw("https")),Qw(Ew,Yw("https"))),Mw=Qw(xw,Yw("webrtc-direct"),Yw("certhash")),Dw=Gw(Qw(Mw,Yw("p2p")),Mw),Ow=Qw(Aw,Yw("webtransport"),Yw("certhash"),Yw("certhash")),zw=Gw(Qw(Ow,Yw("p2p")),Ow),Fw=Gw(Qw(_w,Yw("p2p-webrtc-star"),Yw("p2p")),Qw(Lw,Yw("p2p-webrtc-star"),Yw("p2p")),Qw(_w,Yw("p2p-webrtc-star")),Qw(Lw,Yw("p2p-webrtc-star"))),Uw=(Gw(Qw(_w,Yw("p2p-websocket-star"),Yw("p2p")),Qw(Lw,Yw("p2p-websocket-star"),Yw("p2p")),Qw(_w,Yw("p2p-websocket-star")),Qw(Lw,Yw("p2p-websocket-star"))),Gw(Qw(Rw,Yw("p2p-webrtc-direct"),Yw("p2p")),Qw(Nw,Yw("p2p-webrtc-direct"),Yw("p2p")),Qw(Rw,Yw("p2p-webrtc-direct")),Qw(Nw,Yw("p2p-webrtc-direct")))),Bw=Gw(Iw,Tw,Rw,Nw,Fw,Uw,kw,Cw,Pw,Ew,Dw,zw),qw=(Gw(Qw(Bw,Yw("p2p-stardust"),Yw("p2p")),Qw(Bw,Yw("p2p-stardust"))),Gw(Qw(Bw,Yw("p2p")),Fw,Uw,Dw,zw,Yw("p2p"))),Vw=Gw(Qw(qw,Yw("p2p-circuit"),qw),Qw(qw,Yw("p2p-circuit")),Qw(Yw("p2p-circuit"),qw),Qw(Bw,Yw("p2p-circuit")),Qw(Yw("p2p-circuit"),Bw),Yw("p2p-circuit")),Kw=()=>Gw(Qw(Vw,Kw),Vw),jw=Kw(),Ww=Gw(Qw(jw,qw,jw),Qw(qw,jw),Qw(jw,qw),jw,qw);Gw(Qw(jw,Yw("webrtc"),Yw("p2p")),Qw(jw,Yw("webrtc")),Qw(Bw,Yw("webrtc"),Yw("p2p")),Qw(Bw,Yw("webrtc")),Yw("webrtc"));function Hw(e){return function(t){let n;try{n=fc(t)}catch(i){return!1}const r=e(n.protoNames());return null!==r&&(!0===r||!1===r?r:0===r.length)}}function Qw(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(e){if(e.length<t.length)return null;let n=e;return t.some((t=>(n="function"===typeof t?t().partialMatch(e):t.partialMatch(e),Array.isArray(n)&&(e=n),null===n))),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Hw(r),partialMatch:r}}function Gw(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];function r(e){let n=null;return t.some((t=>{const r="function"===typeof t?t().partialMatch(e):t.partialMatch(e);return null!=r&&(n=r,!0)})),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Hw(r),partialMatch:r}}function Yw(e){const t=e;return{toString:function(){return t},matches:function(e){let n;try{n=fc(e)}catch(i){return!1}const r=n.protoNames();return 1===r.length&&r[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}class $w extends wc{constructor(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{list:[]};if(null==n.list||0===n.list.length)throw new Error("Bootstrap requires a list of peer addresses");super(),w(this,"log",void 0),w(this,"timer",void 0),w(this,"list",void 0),w(this,"timeout",void 0),w(this,"components",void 0),w(this,"_init",void 0),w(this,Sc,this),w(this,Symbol.toStringTag,"@libp2p/bootstrap"),w(this,Uh,["@libp2p/peer-discovery"]),this.components=e,this.log=e.logger.forComponent("libp2p:bootstrap"),this.timeout=null!==(t=n.timeout)&&void 0!==t?t:1e3,this.list=[];for(const r of n.list){if(!Ww.matches(r)){this.log.error("Invalid multiaddr");continue}const e=fc(r),t=e.getPeerId();if(null==t){this.log.error("Invalid bootstrap multiaddr without peer id");continue}const n={id:ra(t),multiaddrs:[e]};this.list.push(n)}this._init=n}isStarted(){return Boolean(this.timer)}start(){this.isStarted()||(this.log("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout((()=>{this._discoverBootstrapPeers().catch((e=>{this.log.error(e)}))}),this.timeout))}async _discoverBootstrapPeers(){if(null!=this.timer)for(const n of this.list){var e,t;if(await this.components.peerStore.merge(n.id,{tags:{[null!==(e=this._init.tagName)&&void 0!==e?e:"bootstrap"]:{value:null!==(t=this._init.tagValue)&&void 0!==t?t:50,ttl:this._init.tagTTL}},multiaddrs:n.multiaddrs}),null==this.timer)return;this.safeDispatchEvent("peer",{detail:n}),this.components.connectionManager.openConnection(n.id).catch((e=>{this.log.error("could not dial bootstrap peer %p",n.id,e)}))}}stop(){null!=this.timer&&clearTimeout(this.timer),this.timer=void 0}}w($w,"tag","bootstrap");class Xw{constructor(e){var t,n,r,i,o;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(this,"protocol",void 0),w(this,"components",void 0),w(this,"started",void 0),w(this,"timeout",void 0),w(this,"maxInboundStreams",void 0),w(this,"maxOutboundStreams",void 0),w(this,"runOnLimitedConnection",void 0),w(this,"log",void 0),w(this,Symbol.toStringTag,"@libp2p/ping"),w(this,Uh,["@libp2p/ping"]),this.components=e,this.log=e.logger.forComponent("libp2p:ping"),this.started=!1,this.protocol="/".concat(null!==(t=s.protocolPrefix)&&void 0!==t?t:"ipfs","/").concat("ping","/").concat("1.0.0"),this.timeout=null!==(n=s.timeout)&&void 0!==n?n:1e4,this.maxInboundStreams=null!==(r=s.maxInboundStreams)&&void 0!==r?r:2,this.maxOutboundStreams=null!==(i=s.maxOutboundStreams)&&void 0!==i?i:1,this.runOnLimitedConnection=null===(o=s.runOnLimitedConnection)||void 0===o||o,this.handleMessage=this.handleMessage.bind(this)}async start(){await this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnLimitedConnection:this.runOnLimitedConnection}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(e){this.log("incoming ping from %p",e.connection.remotePeer);const{stream:t}=e,n=Date.now(),r=Ep(t);let i=!1;Promise.resolve().then((async()=>{for(;;){const e=AbortSignal.timeout(this.timeout);e.addEventListener("abort",(()=>{null===t||void 0===t||t.abort(new K("ping timeout"))}));const n=await r.read({bytes:32,signal:e});await r.write(n,{signal:e}),i=!0}})).catch((n=>{i&&"UnexpectedEOFError"===n.name&&"ready"!==t.readStatus||(this.log.error("incoming ping from %p failed with error - %e",e.connection.remotePeer,n),null===t||void 0===t||t.abort(n))})).finally((()=>{const r=Date.now()-n;this.log("incoming ping from %p complete in %dms",e.connection.remotePeer,r);const i=AbortSignal.timeout(this.timeout);t.close({signal:i}).catch((n=>{this.log.error("error closing ping stream from %p - %e",e.connection.remotePeer,n),null===t||void 0===t||t.abort(n)}))}))}async ping(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.log("pinging %p",e);const n=Date.now(),r=gp(32),i=await this.components.connectionManager.openConnection(e,t);let o;if(null==t.signal){const e=AbortSignal.timeout(this.timeout);t=E(E({},t),{},{signal:e})}try{o=await i.newStream(this.protocol,E(E({},t),{},{runOnLimitedConnection:this.runOnLimitedConnection}));const e=Ep(o),[,s]=await Promise.all([e.write(r,t),e.read(E(E({},t),{},{bytes:32}))]),a=Date.now()-n;if(!ne(r,s.subarray()))throw new V("Received wrong ping ack after ".concat(a,"ms"));return this.log("ping %p complete in %dms",i.remotePeer,a),a}catch(a){var s;throw this.log.error("error while pinging %p",i.remotePeer,a),null===(s=o)||void 0===s||s.abort(a),a}finally{null!=o&&await o.close(t)}}}function Zw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new Xw(t,e)}function Jw(e){try{const[[n,r]]=e.stringTuples();if(null==r)return!1;if(41===n)return t=r,new Pl("2000::/3").contains(t)}catch(n){}var t;return!1}var eb;!function(e){let t;e.codec=()=>(null==t&&(t=es((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!1!==n.lengthDelimited&&t.fork(),null!=e.protocolVersion&&(t.uint32(42),t.string(e.protocolVersion)),null!=e.agentVersion&&(t.uint32(50),t.string(e.agentVersion)),null!=e.publicKey&&(t.uint32(10),t.bytes(e.publicKey)),null!=e.listenAddrs)for(const r of e.listenAddrs)t.uint32(18),t.bytes(r);if(null!=e.observedAddr&&(t.uint32(34),t.bytes(e.observedAddr)),null!=e.protocols)for(const r of e.protocols)t.uint32(26),t.string(r);null!=e.signedPeerRecord&&(t.uint32(66),t.bytes(e.signedPeerRecord)),!1!==n.lengthDelimited&&t.ldelim()}),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r={listenAddrs:[],protocols:[]},i=null==t?e.len:e.pos+t;for(;e.pos<i;){const t=e.uint32();switch(t>>>3){case 5:r.protocolVersion=e.string();break;case 6:r.agentVersion=e.string();break;case 1:r.publicKey=e.bytes();break;case 2:var o;if(null!=(null===(o=n.limits)||void 0===o?void 0:o.listenAddrs)&&r.listenAddrs.length===n.limits.listenAddrs)throw new ts('Decode error - map field "listenAddrs" had too many elements');r.listenAddrs.push(e.bytes());break;case 4:r.observedAddr=e.bytes();break;case 3:var s;if(null!=(null===(s=n.limits)||void 0===s?void 0:s.protocols)&&r.protocols.length===n.limits.protocols)throw new ts('Decode error - map field "protocols" had too many elements');r.protocols.push(e.string());break;case 8:r.signedPeerRecord=e.bytes();break;default:e.skipType(7&t)}}return r}))),t),e.encode=t=>Ho(t,e.codec()),e.decode=(t,n)=>Ro(t,e.codec(),n)}(eb||(eb={}));const tb={protocolPrefix:"ipfs",timeout:5e3,maxInboundStreams:1,maxOutboundStreams:1,maxObservedAddresses:10,maxMessageSize:8192,runOnConnectionOpen:!0,runOnSelfUpdate:!0,runOnLimitedConnection:!0,concurrency:32};class nb{constructor(e,t){var n,r,i,o,s,a,l,c,u;w(this,"host",void 0),w(this,"protocol",void 0),w(this,"started",void 0),w(this,"timeout",void 0),w(this,"peerId",void 0),w(this,"privateKey",void 0),w(this,"peerStore",void 0),w(this,"registrar",void 0),w(this,"addressManager",void 0),w(this,"maxInboundStreams",void 0),w(this,"maxOutboundStreams",void 0),w(this,"maxMessageSize",void 0),w(this,"maxObservedAddresses",void 0),w(this,"events",void 0),w(this,"runOnLimitedConnection",void 0),w(this,"log",void 0),this.protocol=t.protocol,this.started=!1,this.peerId=e.peerId,this.privateKey=e.privateKey,this.peerStore=e.peerStore,this.registrar=e.registrar,this.addressManager=e.addressManager,this.events=e.events,this.log=t.log,this.timeout=null!==(n=t.timeout)&&void 0!==n?n:tb.timeout,this.maxInboundStreams=null!==(r=t.maxInboundStreams)&&void 0!==r?r:tb.maxInboundStreams,this.maxOutboundStreams=null!==(i=t.maxOutboundStreams)&&void 0!==i?i:tb.maxOutboundStreams,this.maxMessageSize=null!==(o=t.maxMessageSize)&&void 0!==o?o:tb.maxMessageSize,this.maxObservedAddresses=null!==(s=t.maxObservedAddresses)&&void 0!==s?s:tb.maxObservedAddresses,this.runOnLimitedConnection=null!==(a=t.runOnLimitedConnection)&&void 0!==a?a:tb.runOnLimitedConnection,this.host={protocolVersion:"".concat(null!==(l=t.protocolPrefix)&&void 0!==l?l:tb.protocolPrefix,"/").concat("0.1.0"),agentVersion:(c=e.nodeInfo,u=t.agentVersion,null!=u?u:c.userAgent)}}isStarted(){return this.started}async start(){this.started||(await this.peerStore.merge(this.peerId,{metadata:{AgentVersion:jt(this.host.agentVersion),ProtocolVersion:jt(this.host.protocolVersion)}}),await this.registrar.handle(this.protocol,(e=>{this.handleProtocol(e).catch((e=>{this.log.error(e)}))}),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnLimitedConnection:this.runOnLimitedConnection}),this.started=!0)}async stop(){await this.registrar.unhandle(this.protocol),this.started=!1}}class rb extends nb{constructor(e){var t,n;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,E(E({},r),{},{protocol:"/".concat(null!==(t=r.protocolPrefix)&&void 0!==t?t:tb.protocolPrefix,"/").concat("id","/").concat("1.0.0"),log:e.logger.forComponent("libp2p:identify")})),w(this,Uh,["@libp2p/identify"]),(null!==(n=r.runOnConnectionOpen)&&void 0!==n?n:tb.runOnConnectionOpen)&&e.events.addEventListener("connection:open",(e=>{const t=e.detail;this.identify(t).catch((e=>{e.name!==B.name&&this.log.error("error during identify trigged by connection:open",e)}))}))}async _identify(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==n.signal){const e=AbortSignal.timeout(this.timeout);n=E(E({},n),{},{signal:e})}try{t=await e.newStream(this.protocol,E(E({},n),{},{runOnLimitedConnection:this.runOnLimitedConnection}));const r=My(t,{maxDataLength:this.maxMessageSize}).pb(eb),i=await r.read(n);return await t.close(n),i}catch(i){var r;throw null===(r=t)||void 0===r||r.abort(i),i}}async identify(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=await this._identify(e,t),{publicKey:r,protocols:i,observedAddr:o}=n;if(null==r)throw new q("public key was missing from identify message");const s=sa(Hs(r).toCID());if(!e.remotePeer.equals(s))throw new q("identified peer does not match the expected peer");if(this.peerId.equals(s))throw new q("identified peer is our own peer id?");return this.maybeAddObservedAddress(o),this.log("identify completed for peer %p and protocols %o",s,i),async function(e,t,n,r,i){if(n("received identify from %p",r.remotePeer),null==i)throw new q("message was null or undefined");const o={};if(i.listenAddrs.length>0&&(o.addresses=i.listenAddrs.map((e=>({isCertified:!1,multiaddr:fc(e)})))),i.protocols.length>0&&(o.protocols=i.protocols),null!=i.publicKey){const e=Hs(i.publicKey);if(!ia(e).equals(r.remotePeer))throw new q("public key did not match remote PeerId");o.publicKey=e}let s;if(null!=i.signedPeerRecord){n.trace("received signedPeerRecord from %p",r.remotePeer);let t=i.signedPeerRecord;const a=await Gc.openAndCertify(t,Jc.DOMAIN);let c=Jc.createFromProtobuf(a.payload);const u=sa(a.publicKey.toCID());if(!c.peerId.equals(u))throw new q("signing key does not match PeerId in the PeerRecord");if(!r.remotePeer.equals(c.peerId))throw new q("signing key does not match remote PeerId");let d;try{d=await e.get(c.peerId)}catch(l){if("NotFoundError"!==l.name)throw l}if(null!=d&&(o.metadata=d.metadata,null!=d.peerRecordEnvelope)){const e=await Gc.createFromProtobuf(d.peerRecordEnvelope),r=Jc.createFromProtobuf(e.payload);r.seqNumber>=c.seqNumber&&(n("sequence number was lower or equal to existing sequence number - stored: %d received: %d",r.seqNumber,c.seqNumber),c=r,t=d.peerRecordEnvelope)}o.peerRecordEnvelope=t,o.addresses=c.multiaddrs.map((e=>({isCertified:!0,multiaddr:e}))),s={seq:c.seqNumber,addresses:c.multiaddrs}}else n("%p did not send a signed peer record",r.remotePeer);if(n.trace("patching %p with",r.remotePeer,o),await e.patch(r.remotePeer,o),null!=i.agentVersion||null!=i.protocolVersion){const t={};null!=i.agentVersion&&(t.AgentVersion=jt(i.agentVersion)),null!=i.protocolVersion&&(t.ProtocolVersion=jt(i.protocolVersion)),n.trace("merging %p metadata",r.remotePeer,t),await e.merge(r.remotePeer,{metadata:t})}const a={peerId:r.remotePeer,protocolVersion:i.protocolVersion,agentVersion:i.agentVersion,publicKey:i.publicKey,listenAddrs:i.listenAddrs.map((e=>fc(e))),observedAddr:null==i.observedAddr?void 0:fc(i.observedAddr),protocols:i.protocols,signedPeerRecord:s,connection:r};return t.safeDispatchEvent("peer:identify",{detail:a}),a}(this.peerStore,this.events,this.log,e,n)}maybeAddObservedAddress(e){const t=function(e){if(null!=e&&e.length>0)try{return fc(e)}catch(t){}}(e);if(null==t)return;if(this.log.trace("our observed address was %a",t),Ch(t))return void this.log.trace("our observed address was private");41!==t.stringTuples()[0][0]||Jw(t)?ih.exactMatch(t)||(this.log.trace("storing the observed address"),this.addressManager.addObservedAddr(t)):this.log.trace("our observed address was IPv6 but not a global unicast address")}async handleProtocol(e){const{connection:t,stream:n}=e,r=AbortSignal.timeout(this.timeout);try{const e=await this.peerStore.get(this.peerId),i=this.addressManager.getAddresses().map((e=>e.decapsulateCode(Ol("p2p").code)));let o=e.peerRecordEnvelope;if(i.length>0&&null==o){const e=new Jc({peerId:this.peerId,multiaddrs:i});o=(await Gc.seal(e,this.privateKey)).marshal().subarray()}let s=t.remoteAddr.bytes;Jd.matches(t.remoteAddr)||(s=void 0);const a=My(n).pb(eb);await a.write({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:Qs(this.privateKey.publicKey),listenAddrs:i.map((e=>e.bytes)),signedPeerRecord:o,observedAddr:s,protocols:e.protocols},{signal:r}),await n.close({signal:r})}catch(i){this.log.error("could not respond to identify request",i),n.abort(i)}}}function ib(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>new rb(t,e)}async function ob(e,t,n){if(e)try{const c=await e.components.connectionManager.openConnection(t),u=await c.newStream(["/c9r/0.0.1"]);await Ng([jt(n+"\n")],u.sink);const d=new TextDecoder;var r,i=!1,o=!1;try{for(var s,a=Kc(u.source);i=!(s=await a.next()).done;i=!1){const e=s.value;{const t=e.subarray?e.subarray():e;return d.decode(t)}}}catch(l){o=!0,r=l}finally{try{i&&null!=a.return&&await a.return()}finally{if(o)throw r}}}catch(l){console.error("\u274c Failed to send message:",l)}else console.error("Libp2p node not ready")}var sb=n(579);const ab=function(){const[e,t]=(0,g.useState)(null),[n,r]=(0,g.useState)(null),[i,o]=(0,g.useState)(""),[s,a]=(0,g.useState)(!1),l="/ip4/192.168.88.196/tcp/8888/ws/p2p/QmZwxXXJKtf2gUwkoBQxqQpVSum9s7SYnJX7vHTS24ff3g",c=fc(l),u="CAASpwkwggSjAgEAAoIBAQC/wmFXkTS+RuzZtc1ERi80JzeaJJjUrIItwmU0a++WAw527kTsDhKOlOduxAYkDXdBek4gFsBYeu92H6NAQcbaieT+7u6TKCnH19epcvBKKAXALhU30FRX+yE6hXq1IeUviLCqqqlqcW5ppz8vDP3wF8ehFo5B8eb6xma1w0RW22CdiliIG0KDIJ5MK8Wq/lXPRcbMmwqIErfWHVCka8oX0lvpTH9E0GkX5naKMjm7s7Q6RxeLHDwkp7xcNGFyVrsDKVG+lwfyU3ZeRl/vTaBtUWRMWcZTS6cW5hvQQGW5iGAhYNnooftiCKM2z21LjcqNQvl8UhYGx56DvfDmL7SfAgMBAAECggEAEEnzuNuFzm/56Jhv4k/P7K80Iuze6pnoyPhNXoGYrXZ/AQ1GX4LmgqQVcKxIFUHrkm1QO5uTJTD0LGWNmYS83o1+HUWwkGGGAwrLsAIqdTInIucHOGGC+KJFdVInVUGW1U3YK/cpQvh1t5XUYSvKWl26wG1JEkL5Ku41hVUb9gCwt/Vm9E5f0SBXLJzIe4rwu+XDVGRyhA6DI0iktp2JCVz5New0ok6fXJd2TSRP4rVWSk8a+3fi0DG0NyD6/XcWwAzgRo2fT5wQDeml0bOvraqEqWZtlL1/Gs0GUyNPMVJjnbriDP2DJaTsbL652as6t3tsd+ORHGO6KkFD2cXWcQKBgQDF+39PUTMiJ0L2S6QV5irdQO7pWGjbSdhdng/I9TJ0AaZTCOv4hileL5fmzpmWcc5AkImWh1gzoujSZCInVB/imif8fH28QB13St8/ofVcXDfouVvqnrQthUzoKZihUKFIJekixm7uyFYXFHUCWWPlaoHvpjmwXe4P0QmpMOks2QKBgQD39Ad/xyW9sop0gC/ldvQblMzmF4vEoERqDBnarQ0dTKoCB4mQyrwefMFkP7rNu2x28bwoMNZeT8gvI3joGxVndsWhEXN6ou03l8Mb6t35O4jvmUmYygRrzjN6AEBgi/Z0oxtjFA5YvqqWud4jX+1EzGMjhxdLIMlv44VTBMxiNwKBgFp1Zt3ew/Y+6iGOvhIjcEJXgNGtS3umae2cYqn3Hm5SsqQN14NeCVi3djhG/XX32b02TScx/+LX9Hjst44wqcDnno2GdAynXs86rnZskab5m7IBvzWb/ccuuMz69HoAVTCZ4cO51sXTU0KIXk4MedBAsc3FrWYgBL3FTRy49FFBAoGBAIs8q+FjMZxe4EUfnsXakKXUX2NuIXyfCwwKE5Kqzsx/OpC9LtDyJ8VvBSKIbxwMfZIlmSVwl1CKuL1PzBt66gAZwEz8gb6CM3eeb2AD+fZ1KiZyC9QSzXzEZD/EWGJe9lz1IvH2V0Aagaz2Xvm6aoDRzXIr8DauCLAeMcY20ZbtAoGAQbRCSCZYsH0bWQMsDSkH8/1ulUI8BTVX9VbvYkwFrPzQaySddBBQxtDGh2ftQRamYN966sm068Z2CdmBlbFQmZ1S3HnIjzl9AW0HzfbxHtuUQr6MEiu++k+runAF/zPryAFr2Jlg5LYQEERd0wz0ElW/RzNduMmGS2tLX9ViBvg=";return(0,g.useEffect)((()=>{(async()=>{try{a(!0);const r=await async function(e){return Gs(Uint8Array.from(atob(e),(e=>e.charCodeAt(0))))}(u),i=await fg({privateKey:r,peerDiscovery:[(e={list:[l],interval:6e4,timeout:1e4,tagName:"bootstrap",tagValue:50,tagTTL:1/0},t=>new $w(t,e))],transports:[Tg()],streamMuxers:[im(),_m()],connectionEncrypters:[Vv()],services:{aminoDHT:vw({protocol:"/ipfs/kad/1.0.0",peerInfoMapper:by}),ping:Zw(),identify:ib()}});await i.start(),console.log("\u2705 Node started:",i.peerId.toString()),t(i);try{await i.dial(c),console.log("\u2705 Connection established"),a(!1)}catch(n){console.error("\u274c Connection error:",n)}i.handle("/c9r/0.0.1",(async e=>{let{stream:t}=e;const n=new TextDecoder,r=t.getReader();for(;;){const{done:e,value:t}=await r.read();if(e)break;console.log("\ud83d\udce8 Received message:",n.decode(t))}})),i.addEventListener("peer:discovery",(e=>{console.log("Found peer: ",e.detail.toString())})),i.addEventListener("peer:disconnect",(e=>{console.log("\u26a0\ufe0f Connection to the feast lost:",e.detail.toString())}))}catch(n){console.error("\u274c Connection failed:",n),a(!0)}var e})()}),[]),(0,sb.jsx)("div",{children:!s&&(0,sb.jsxs)(sb.Fragment,{children:[(0,sb.jsx)("h1",{children:"Libp2p browser client"}),(0,sb.jsx)("button",{onClick:async()=>{const t=await async function(e,t){return await ob(e,t,"<Hello></Hello>")}(e,c);o(null!==t?t:"Error")},children:"\ud83d\udce8 Test message"}),(0,sb.jsxs)("div",{style:{whiteSpace:"pre-wrap",marginTop:"1em"},children:[(0,sb.jsx)("strong",{children:"Response:"}),(0,sb.jsx)("br",{}),i]})]})})},lb=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:o,getTTFB:s}=t;n(e),r(e),i(e),o(e),s(e)}))};m.createRoot(document.getElementById("root")).render((0,sb.jsx)(g.StrictMode,{children:(0,sb.jsx)(ab,{})})),lb()})()})();
//# sourceMappingURL=main.f5f6ab12.js.map